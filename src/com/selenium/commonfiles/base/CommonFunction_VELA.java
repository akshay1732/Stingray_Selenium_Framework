package com.selenium.commonfiles.base;

import static com.selenium.commonfiles.util.TestUtil.WriteDataToXl;
import static com.selenium.commonfiles.util.TestUtil.reportStatus;

import java.awt.AWTException;
import java.awt.Robot;
import java.awt.Toolkit;
import java.awt.datatransfer.Clipboard;
import java.awt.datatransfer.DataFlavor;
import java.awt.datatransfer.UnsupportedFlavorException;
import java.io.File;
import java.io.FileInputStream;
import java.io.FileNotFoundException;
import java.io.IOException;
import java.text.DecimalFormat;
import java.text.ParseException;
import java.text.SimpleDateFormat;
import java.util.ArrayList;
import java.util.Calendar;
import java.util.Date;
import java.util.HashMap;
import java.util.Hashtable;
import java.util.Iterator;
import java.util.LinkedHashMap;
import java.util.List;
import java.util.Locale;
import java.util.Map;
import java.util.Properties;
import java.util.Set;
import java.util.regex.Pattern;

import org.apache.pdfbox.cos.COSDocument;
import org.apache.pdfbox.pdfparser.PDFParser;
import org.apache.pdfbox.pdmodel.PDDocument;
import org.apache.pdfbox.util.PDFTextStripper;
import org.openqa.selenium.By;
import org.openqa.selenium.JavascriptExecutor;
import org.openqa.selenium.Keys;
import org.openqa.selenium.Point;
import org.openqa.selenium.WebElement;
import org.openqa.selenium.interactions.Actions;
import org.openqa.selenium.support.ui.ExpectedConditions;
import org.openqa.selenium.support.ui.Select;
import org.openqa.selenium.support.ui.WebDriverWait;
import org.testng.Assert;

import com.selenium.commonfiles.util.ErrorUtil;
import com.selenium.commonfiles.util.Keywords;
import com.selenium.commonfiles.util.ObjectMap;
import com.selenium.commonfiles.util.TestUtil;
import com.selenium.commonfiles.util.XLS_Reader;

public class CommonFunction_VELA extends TestBase {
	public static String Environment = null;
	public static String loginUserName;
	public static String isRequote="No";
	public int pdf_count=0,err_count=0,final_err_pdf_count=0,trans_error_val=0,tran_err_count=0;
	public boolean isMTARewindFlow=false,isFPEntries=false,isMTARewindStarted=false, isNBRewindStarted = false, isNBRquoteStarted = false;
	public static int countOfCovers,countOfTableRows;
	public static int errorVal=0,counter = 0;
	public double totalGrossTax = 0.0,totalGrossTaxMTA = 0.0,totalGrossPremium = 0.0,totalGrossPremiumMTA=0.0,totalNetPremiumTax=0.0,totalNetPremiumTaxMTA=0.0;
	public static double Cover_TotalRate = 0.00, Cover_AdjustedRate = 0.00, Cover_Premium = 0.00, Cover_TotalPremium = 0.00;
	public static WebElement taxTable_tBody;
	public static WebElement objTable;
	public static WebElement taxTable_tHead;
	public static DecimalFormat f = new DecimalFormat("00.00");
	public static double adjustedPremium = 0.0,adjustedTotalPremium=0.0,adjustedTotalPremiumMTA=0.0,adjustedTotalTax=0.0,adjustedTotalTaxMTA=0.0,unAdjustedTotalTax=0.0,unAdjustedTotalTaxMTA=0.0;
	public static double PD_TotalRate = 0.0, PD_AdjustedRate = 0.0, PD_MD_Premium=0.0, PD_BI_Premium=0.0, PD_MD_TotalPremium = 0.00, PD_BI_TotalPremium = 0.00, finalMDPremium = 0.00, finalBIPremium= 0.00;
	public String currentRunningFlow ="NB";
	public static ArrayList<Object> inputarraylist = null;
	public static ArrayList<Object> inputarraylistMTA = null;
	public double PI_pdf_InsuranceTax = 0.0, PI_pdf_GrossPremium = 0.0,SEL_pdf_InsuranceTax = 0.0, SEL_pdf_GrossPremium = 0.0;
//	/public static ArrayList<Object> variableTaxAdjustmentIDs = null;
	public static Map<Object, Integer> variableTaxAdjustmentIDs = null;
	public static Map<Object, Integer> variableTaxAdjustmentIDsMTA = null;
	public static Map<Object, Double> grossTaxValues_Map = null;
	public static Map<Object, Map<Object, Object>> variableTaxAdjustmentVerificationMaps = null;
	public static Map<Object, Object> variableTaxAdjustmentDataMaps = null;
	public static Map<Object, Object> variableTaxAdjustmentDataMapsMTA = null;
	public static List<Object> headerNameStorage = null;
	public static List<Object> headerNameStorageMTA = null;
	public Map<String,Map<String,Double>> transaction_Details_Premium_Values = new HashMap<>();
	public Map<String, Map<String , String>> EndorsementCollectiveData = null;
	public Map<String, String> ExtraEndorsementList = new LinkedHashMap<>();
	public String quoteStatus = "";
	public boolean transTbleValue = false,isTaxSuccessful=false,isTransactionPremiumTable = false;
	public static int size;
	SimpleDateFormat df = new SimpleDateFormat();
	Date currentDate = new Date();
	public Map<Object, Object> NB_excel_data_map = null;
	public Map<Object, Object> MTA_excel_data_map = null;
	public Map<Object, Object> Rewind_excel_data_map = null;
	public Map<Object, Object> Renewal_excel_data_map = null;
	public Map<Object, Object> CAN_excel_data_map = null;
	public List<String> CoversDetails_data_list = null;
	public static Map<String, Double> Adjusted_Premium_map = null;
	
	public Map<String, List<Map<String, String>>> NB_Structure_of_InnerPagesMaps = null;
	public Map<String, List<Map<String, String>>> MTA_Structure_of_InnerPagesMaps = null;
	public Map<String, List<Map<String, String>>> Rewind_Structure_of_InnerPagesMaps = null;
	public Map<String, List<Map<String, String>>> Renewal_Structure_of_InnerPagesMaps = null;
	public Map<String, List<Map<String, String>>> CAN_Structure_of_InnerPagesMaps = null;
	DecimalFormat decim = new DecimalFormat("#.00");
	public Map<String,Integer> no_of_inner_data_sets = new HashMap<>();
	public Hashtable<String,String> GrosspremSmryData = new Hashtable<String,String>();

	// Premium Summary Data maps
	public Map<String,Map<String,Double>> transaction_Premium_Values = new HashMap<>();
	public Map<String,Map<String,Double>> transaction_Details_Premium_Values_EndorsemntRenewal = new HashMap<>();
	public Map<String,Map<String,Double>> Can_ReturnP_Values_Map = new HashMap<>();
	public boolean PremiumFlag = false;
	public List<String> referrals_list = new ArrayList<>();
	public List<String> quote_validations_list = new ArrayList<>();
	
	public String FP_Covers = null;
	public double rewindMTADoc_Premium = 0.00, rewindMTADoc_TerP = 0.00, rewindMTADoc_InsPTax = 0.00, rewindMTADoc_TotalP = 0.00;
	public double rewindDoc_Premium = 0.00, rewindDoc_TerP = 0.00, rewindDoc_InsPTax = 0.00, rewindDoc_TotalP = 0.00, rewindDoc_InsTaxTer = 0.00;
	public double rewindMTADoc_AddTaxTer = 0.00;
	public double TotalPremiumWithAdminDocAct = 0.00, TotalPremiumWithAdminDocExp = 0.00, PremiumExcTerrDocAct = 0.00,  PremiumExcTerrDocExp = 0.00, TerPremDocAct = 0.00, TerPremDocExp = 0.00, InsTaxDocAct = 0.00, InsTaxDocExp = 0.00;
	public double AdditionalPWithAdminDocAct = 0.00, AdditionalExcTerrDocAct = 0.00,  AdditionalTerPDocAct = 0.00, AdditionalInsTaxDocAct = 0.00;
	public double InsTaxTerrDoc = 0.00, tpTotal = 0.00, AddTaxTerrDoc = 0.00;
	public boolean PL_FP= false , EL_FP = false, AW_FP= false , SP_FP = false, OP_FP = false, HIP_FP= false , JCT_FP = false, TER_FP = false , POL_FP = false, LE_FP = false,HCP_FP = false;
	public int policy_duration_Trans=00;	
	

	/**
	 * 
	 * This method return Legal Expense "Annual Carrier Premium (Excludes IPT)"
	 * value based on DAS-Rules
	 * 
	 *
	 */
	public String getLEAnnualCarrierPremium(String product, String LimitOfLiability, String turnover, String wages) {

		Properties DAS_Rules = new Properties();
		DAS_Rules = OR.getORProperties();
		String v_annual_carrier_p = "0.0";
		String wages_cent_rate = "0.0";
		String Option2_TO_cent_rate = "0.0";
		String das_product = null;
		String LOI = LimitOfLiability.replaceAll(",", "");
		LOI = "_" + Integer.toString(Integer.parseInt(LOI) / 1000) + "k_LOI";
		LimitOfLiability = LimitOfLiability.replaceAll(",", "");
		final int _1M = 1000000, _2_5M = 2500000, _5M = 5000000, _10M = 10000000, _12_5M = 12500000, _15M = 15000000,
				_17_5M = 17500000, _20M = 20000000, _25M = 25000000, _50M = 50000000;
		final int _100K = 100000, _250K = 250000, _500K = 500000;

		switch (product) {

		case "CTA":
			das_product = product + "_";
			break;
		case "CCF":
		case "CCG":
			das_product = "COM_COMBINED" + "_";
			break;
		case "POB":
		case "POC":
			das_product = "PO" + "_";
			break;
		default:
			System.out.println("***..Product is not in scope for LE Annual Carrier Premium Calulcation..**");
			return "";

		}
		if (Integer.parseInt(turnover) < 0) {
			System.out.println("Turnover should be Non-negative.It is >" + turnover + "<");
			return "";
		}
		if (Integer.parseInt(wages) < 0) {
			System.out.println("Wages should be Non-negative.It is >" + wages + "<");
			return "";
		}
		// DAS - Option 1
		if ((Integer.parseInt(turnover) < _25M && das_product.equals("CTA_"))
				|| (Integer.parseInt(turnover) < _25M && das_product.equals("COM_COMBINED_"))) {

			if (Integer.parseInt(turnover) >= 0 && Integer.parseInt(turnover) <= 4999999) {
				v_annual_carrier_p = DAS_Rules.getProperty(das_product + "0_4,999,999" + LOI);
			} else if (Integer.parseInt(turnover) >= _5M && Integer.parseInt(turnover) <= 9999999) {
				v_annual_carrier_p = DAS_Rules.getProperty(das_product + "5m_9,999,999" + LOI);
			} else if (Integer.parseInt(turnover) >= _10M && Integer.parseInt(turnover) <= 12499999) {
				v_annual_carrier_p = DAS_Rules.getProperty(das_product + "10m_12,499,999" + LOI);
			} else if (Integer.parseInt(turnover) >= _12_5M && Integer.parseInt(turnover) <= 14999999) {
				v_annual_carrier_p = DAS_Rules.getProperty(das_product + "12.5m_14,999,999" + LOI);
			} else if (Integer.parseInt(turnover) >= _15M && Integer.parseInt(turnover) <= 17499999) {
				v_annual_carrier_p = DAS_Rules.getProperty(das_product + "15m_17,499,999" + LOI);
			} else if (Integer.parseInt(turnover) >= _17_5M && Integer.parseInt(turnover) <= 19999999) {
				v_annual_carrier_p = DAS_Rules.getProperty(das_product + "17.5m_19,999,999" + LOI);
			} else if (Integer.parseInt(turnover) >= _20M && Integer.parseInt(turnover) <= 24999999) {
				v_annual_carrier_p = DAS_Rules.getProperty(das_product + "20m_24,999,999" + LOI);
			}

			return v_annual_carrier_p;

			// DAS - Option 2
		} else if ((Integer.parseInt(turnover) >= _25M && Integer.parseInt(turnover) <= 49999999)
				&& das_product.equals("COM_COMBINED_")) {

			if (Integer.parseInt(wages) >= 0 && Integer.parseInt(wages) <= 99999) {
				wages_cent_rate = DAS_Rules.getProperty(das_product + "0_99,999" + LOI);
			} else if (Integer.parseInt(wages) >= _100K && Integer.parseInt(wages) <= 249999) {
				wages_cent_rate = DAS_Rules.getProperty(das_product + "100k_249,999" + LOI);
			} else if (Integer.parseInt(wages) >= _250K && Integer.parseInt(wages) <= 499999) {
				wages_cent_rate = DAS_Rules.getProperty(das_product + "250k_499,999" + LOI);
			} else if (Integer.parseInt(wages) >= _500K && Integer.parseInt(wages) <= 999999) {
				wages_cent_rate = DAS_Rules.getProperty(das_product + "500k_999,999" + LOI);
			} else if (Integer.parseInt(wages) >= _1M && Integer.parseInt(wages) <= 2499999) {
				wages_cent_rate = DAS_Rules.getProperty(das_product + "1m_2,499,999" + LOI);
			} else if (Integer.parseInt(wages) >= _2_5M && Integer.parseInt(wages) <= 4999999) {
				wages_cent_rate = DAS_Rules.getProperty(das_product + "2.5m_4,999,999" + LOI);
			} else if (Integer.parseInt(wages) >= _5M && Integer.parseInt(wages) <= 9999999) {
				wages_cent_rate = DAS_Rules.getProperty(das_product + "5m_9,999,999" + LOI);
			}

			// Minimum Premium Rule -->
			// //COM_COMBINED_MIN_P_TO_RATE_25m_49,999,999
			Option2_TO_cent_rate = DAS_Rules.getProperty(das_product + "MIN_P_TO_RATE_25m_49,999,999");

			String premium_before_minimum_rule = Double
					.toString((Integer.parseInt(wages) * Double.parseDouble(wages_cent_rate)) / 100
							+ (Integer.parseInt(turnover) * Double.parseDouble(Option2_TO_cent_rate)) / 100);
			String f_premium_before_minimum_rule = Double
					.toString(k.FMT(Double.parseDouble(premium_before_minimum_rule)));

			// COM_COMBINED_MIN_P_250k_LOI
			String min_premium_250k = DAS_Rules.getProperty(das_product + "MIN_P_250k_LOI");
			String min_premium_500k = DAS_Rules.getProperty(das_product + "MIN_P_500k_LOI");

			if (LimitOfLiability.equals("250000")
					&& (Double.parseDouble(f_premium_before_minimum_rule) <= Double.parseDouble(min_premium_250k))) {
				v_annual_carrier_p = min_premium_250k;
				return v_annual_carrier_p;
			} else if (LimitOfLiability.equals("500000")
					&& (Double.parseDouble(f_premium_before_minimum_rule) <= Double.parseDouble(min_premium_250k))) {
				v_annual_carrier_p = min_premium_500k;
				return v_annual_carrier_p;
			} else {
				return v_annual_carrier_p;
			}

			// DAS - Option 3
		} else if ((Integer.parseInt(turnover) < _25M && das_product.equals("PO_"))) {

			if (Integer.parseInt(turnover) >= 0 && Integer.parseInt(turnover) <= 4999999) {
				v_annual_carrier_p = DAS_Rules.getProperty(das_product + "0_4,999,999" + LOI);
			} else if (Integer.parseInt(turnover) >= _5M && Integer.parseInt(turnover) <= 9999999) {
				v_annual_carrier_p = DAS_Rules.getProperty(das_product + "5m_9,999,999" + LOI);
			} else if (Integer.parseInt(turnover) >= _10M && Integer.parseInt(turnover) <= 12499999) {
				v_annual_carrier_p = DAS_Rules.getProperty(das_product + "10m_12,499,999" + LOI);
			} else if (Integer.parseInt(turnover) >= _12_5M && Integer.parseInt(turnover) <= 14999999) {
				v_annual_carrier_p = DAS_Rules.getProperty(das_product + "12.5m_14,999,999" + LOI);
			} else if (Integer.parseInt(turnover) >= _15M && Integer.parseInt(turnover) <= 17499999) {
				v_annual_carrier_p = DAS_Rules.getProperty(das_product + "15m_17,499,999" + LOI);
			} else if (Integer.parseInt(turnover) >= _17_5M && Integer.parseInt(turnover) <= 19999999) {
				v_annual_carrier_p = DAS_Rules.getProperty(das_product + "17.5m_19,999,999" + LOI);
			} else if (Integer.parseInt(turnover) >= _20M && Integer.parseInt(turnover) <= 24999999) {
				v_annual_carrier_p = DAS_Rules.getProperty(das_product + "20m_24,999,999" + LOI);
			}

			return v_annual_carrier_p;
		}

		// DAS - Option 4 = Referral
		if (Integer.parseInt(turnover) >= _25M && das_product.equals("CTA_")
				|| Integer.parseInt(turnover) >= _25M && das_product.equals("PO_")) {
			return "Option 4 - Referral to DAS as turnover = " + turnover + " is Greater than /Equal to 25M";
		}

		if (Integer.parseInt(turnover) >= _50M && das_product.equals("COM_COMBINED_")) {
			return "Option 4 - Referral to DAS as turnover = " + turnover + " is Greater than /Equal to 50M";
		}

		return "";

	}

	

	/*
	 * Insurance tax adjustment handling
	 * 
	 */
	
	@SuppressWarnings("static-access")
	public boolean insuranceTaxAdjustmentHandling(String code , String event){
	 	Map<Object, Object> map_to_update=common.NB_excel_data_map;
		try {
			switch(TestBase.businessEvent){
			case "NB":
				map_to_update = common.NB_excel_data_map;
			break;
			case "MTA":
				if(common.currentRunningFlow.equals("NB")){
					map_to_update = common.NB_excel_data_map;
					event = "NB";
				}
				else{
					map_to_update = common.MTA_excel_data_map;
					event = "MTA";	
				}
			case "Requote":
				if(common.currentRunningFlow.equals("NB")){
					map_to_update = common.NB_excel_data_map;
					event = "NB";
				}
				else{
					map_to_update = common.Requote_excel_data_map;
					event = "Requote";	
				}
			break;
			case "Rewind":
				if(common.currentRunningFlow.equals("NB")){
					map_to_update = common.NB_excel_data_map;
					event = "NB";
				}
				else{
					map_to_update = common.Rewind_excel_data_map;
					event = "Rewind";	
				}
			break;
			case "Renewal":
				if(common.currentRunningFlow.equals("Renewal")){
					map_to_update = common.Renewal_excel_data_map;
					event = "Renewal";
				}
				else{
					map_to_update = common.Rewind_excel_data_map;
					event = "Rewind";	
				}
			break;
			}
			//common.funcButtonSelection("Insurance Tax");
			customAssert.assertTrue(k.Click("insuranceTxButon"),"Unable to click on Tax insurance button.");
			customAssert.assertTrue(funcPageNavigation("Tax Adjustment", ""),"Unable to land on Tax adjustment screen.");
			String sectionName;
			
			//customAssert.assertTrue(verifyCoverDetails(),"PremiumValue verification is causing issue(S).");
			//customAssert.assertTrue(verifyGrossPremiumValues(),"PremiumValue verification is causing issue(S).");
			String policy_status_actual = k.getText("Policy_status_header");
			
			switch ((String)map_to_update.get("PS_InsuranceTaxButton")) {
			case "Yes":
				String value = null;
				List<WebElement> list = k.findElements("insuranceTaxExemptionRadioButton");
				for(int i=0;i<list.size();i++){
					
					boolean selectedStatus =  list.get(i).isSelected();
					if(selectedStatus){
						value = list.get(i).getAttribute("Value");	
					}
				}
				
				if(((String)map_to_update.get("PS_TaxExempt")).equalsIgnoreCase("No") && value.equalsIgnoreCase("No")){
					customAssert.assertTrue(k.SelectRadioBtn("insuranceTaxExemptionRadioButton", (String)map_to_update.get("PS_InsuranceTaxButton")));
					k.waitTwoSeconds();
					customAssert.assertTrue(k.AcceptPopup(), "Unable to accept alert box.");
				}
				
				
				taxTable_tBody = k.getObject("inssuranceTaxMainTableBODY"); 
				List<WebElement> listOfCovers = taxTable_tBody.findElements(By.tagName("tr"));
				countOfCovers = listOfCovers.size();
				
				for(int j=0;j<countOfCovers-1;j++){
					
					sectionName = taxTable_tBody.findElement(By.xpath("tr["+(j+1)+"]/td[1]")).getText().replaceAll(" ", "");
					if(sectionName.contains("AnnualContractWorks")){
						sectionName = "AnnualWorks";
					}
					if(sectionName.contains("SingleProjectContractWorks")){
						sectionName = "SingleProject";
					}
					if(common.currentRunningFlow.equalsIgnoreCase("MTA")){
						if(((String)common.NB_excel_data_map.get("CD_"+sectionName)).equals("Yes") && ((String)common.MTA_excel_data_map.get("CD_"+sectionName)).equals("No")){
							//	NetNet_Premium = Double.parseDouble((String)common.NB_excel_data_map.get("PS_"+sectionName+"_NetNetPremium"));
								map_to_update = common.NB_excel_data_map;
							}else{
								map_to_update = common.MTA_excel_data_map;
							}
						map_to_update.put("PS_"+sectionName+"_GT", common.roundedOff("00.00"));
						map_to_update.put("PS_"+sectionName+"_IPT", common.roundedOff("00.00"));
						
						TestUtil.WriteDataToXl(code+"_"+event, "Premium Summary",(String)map_to_update.get("Automation Key"), "PS_"+sectionName+"_GT", common.roundedOff("00.00"), map_to_update);
						TestUtil.WriteDataToXl(code+"_"+event, "Premium Summary",(String)map_to_update.get("Automation Key"), "PS_"+sectionName+"_IPT", common.roundedOff("00.00"), map_to_update);
						//TestUtil.WriteDataToXl(code+"_"+event, "Premium Summary",(String)map_to_update.get("Automation Key"), "PS_"+sectionName+"_NPIPT", common.roundedOff("00.00"), map_to_update);
						totalGrossPremium = totalGrossPremium + Double.parseDouble(common.roundedOff((String)map_to_update.get("PS_"+sectionName+"_GP")));
						
					}else{
					
					map_to_update.put("PS_"+sectionName+"_GT", common.roundedOff("00.00"));
					map_to_update.put("PS_"+sectionName+"_IPT", common.roundedOff("00.00"));
					
					TestUtil.WriteDataToXl(code+"_"+event, "Premium Summary",(String)map_to_update.get("Automation Key"), "PS_"+sectionName+"_GT", common.roundedOff("00.00"), map_to_update);
					TestUtil.WriteDataToXl(code+"_"+event, "Premium Summary",(String)map_to_update.get("Automation Key"), "PS_"+sectionName+"_IPT", common.roundedOff("00.00"), map_to_update);
					//TestUtil.WriteDataToXl(code+"_"+event, "Premium Summary",(String)map_to_update.get("Automation Key"), "PS_"+sectionName+"_NPIPT", common.roundedOff("00.00"), map_to_update);
					totalGrossPremium = totalGrossPremium + Double.parseDouble(common.roundedOff((String)map_to_update.get("PS_"+sectionName+"_GP")));
				}
				}
				if(policy_status_actual.contains("Rewind")){
					common.totalGrossPremium = 0.0;
					common.totalGrossTax = 0.0;
					common.totalNetPremiumTax = 0.0;
					
					for(int j=0;j<countOfCovers-1;j++){
						
						taxTable_tBody = k.getObject("inssuranceTaxMainTableBODY");
						sectionName = taxTable_tBody.findElement(By.xpath("tr["+(j+1)+"]/td[1]")).getText();
						if(sectionName.contains("Annual Contract Works")){
							sectionName = "Annual Works";
						}
						if(sectionName.contains("Single Project Contract Works")){
							sectionName = "Single Project";
						}
						if(sectionName.equalsIgnoreCase("") || sectionName==null || sectionName.equalsIgnoreCase("Totals")){
							continue;
						}else{
							
							/*String actGP =  taxTable_tBody.findElement(By.xpath("tr["+(j+1)+"]/td[2]")).getText();
							String actGT =  taxTable_tBody.findElement(By.xpath("tr["+(j+1)+"]/td[5]")).getText();
							*/
							String expGP = (String)map_to_update.get("PS_"+sectionName.replaceAll(" ", "")+"_GP");
							String expGT = (String)map_to_update.get("PS_"+sectionName.replaceAll(" ", "")+"_GT");
							//String expNPIT = (String)map_to_update.get("PS_"+sectionName.replaceAll(" ", "")+"_NPIPT");
							
							common.totalGrossPremium = common.totalGrossPremium + Double.parseDouble(expGP);
							common.totalGrossTax = common.totalGrossTax + Double.parseDouble(expGT);
							//common.totalNetPremiumTax = common.totalNetPremiumTax + Double.parseDouble(expNPIT);
							
						}
						taxTable_tBody = k.getObject("inssuranceTaxMainTableBODY");
						List<WebElement> list3 = taxTable_tBody.findElements(By.tagName("tr"));
						countOfCovers = list3.size();
					}
				}
				TestUtil.reportStatus("<b> Tax adjustment operatios is completed. </b>", "Info", false);
				
				map_to_update.put("PS_Total_GP", common.roundedOff(Double.toString(totalGrossPremium)));
				map_to_update.put("PS_Total_GT", common.roundedOff("00.00"));
				
				//TestUtil.WriteDataToXl(code+"_"+event, "Premium Summary",(String)map_to_update.get("Automation Key"), "PS_Total_GP", common.roundedOff(Double.toString(totalGrossPremium)), map_to_update);
				TestUtil.WriteDataToXl(code+"_"+event, "Premium Summary",(String)map_to_update.get("Automation Key"), "PS_Total_GT", common.roundedOff("00.00"), map_to_update);
				//TestUtil.WriteDataToXl(code+"_"+event, "Premium Summary",(String)map_to_update.get("Automation Key"), "PS_Total_NPIPT", common.roundedOff("00.00"), map_to_update);
				TestUtil.reportStatus("<b>Policy Exempt from insurance tax radio button is selected as 'Yes' Hence skipped adjustment operation for all covers.</b>", "Info", false);
				break;
				
			case "No":
				
				TestUtil.reportStatus("<b> Tax adjustment operatios is started. </b>", "Info", false);
				customAssert.assertTrue(k.SelectRadioBtn("insuranceTaxExemptionRadioButton", (String)map_to_update.get("PS_InsuranceTaxButton")));
				//taxTable_tHead = k.getObject("inssuranceTaxMainTableHEAD");
				taxTable_tBody = k.getObject("inssuranceTaxMainTableBODY"); 
				List<WebElement> list2 = taxTable_tBody.findElements(By.tagName("tr"));
				countOfCovers = list2.size();
				
				
				for(int j=0;j<countOfCovers-1;j++){
					
					taxTable_tBody = k.getObject("inssuranceTaxMainTableBODY");
					sectionName = taxTable_tBody.findElement(By.xpath("tr["+(j+1)+"]/td[1]")).getText();
					if(sectionName.contains("Annual Contract Works")){
						sectionName = "Annual Works";
					}
					if(sectionName.contains("Single Project Contract Works")){
						sectionName = "Single Project";
					}
					String grossPremium =  taxTable_tBody.findElement(By.xpath("tr["+(j+1)+"]/td[2]")).getText();
					//String iptRate =  taxTable_tBody.findElement(By.xpath("tr["+(j+1)+"]/td[4]")).getText();
					//String grossTax =  taxTable_tBody.findElement(By.xpath("tr["+(j+1)+"]/td[5]")).getText();
					
					switch (sectionName) {
					case "":
					case "Totals":
						break;
					default:
						customAssert.assertTrue(adjustInsuranceTax(grossPremium,sectionName,code,event),"Adjust insurance Tax function is causing issue(S).");
						customAssert.assertTrue(verifyAdjustedTaxValues(sectionName,code,event),"Verify adjusted Tax function is having issue(S).");
						break;
					}
					
					
					/*if(sectionName.equalsIgnoreCase("") || sectionName==null || sectionName.equalsIgnoreCase("Totals")){
						continue;
					}else{
						
						customAssert.assertTrue(adjustInsuranceTax(grossPremium,sectionName,code,event),"Adjust insurance Tax function is causing issue(S).");
						customAssert.assertTrue(verifyAdjustedTaxValues(sectionName,code,event),"Verify adjusted Tax function is having issue(S).");
					}*/
						
					taxTable_tBody = k.getObject("inssuranceTaxMainTableBODY");
					List<WebElement> list3 = taxTable_tBody.findElements(By.tagName("tr"));
					countOfCovers = list3.size();
				}
				if(policy_status_actual.contains("Rewind")){
					common.totalGrossPremium = 0.0;
					common.totalGrossTax = 0.0;
					common.totalNetPremiumTax = 0.0;
					
					for(int j=0;j<countOfCovers-1;j++){
						
						taxTable_tBody = k.getObject("inssuranceTaxMainTableBODY");
						sectionName = taxTable_tBody.findElement(By.xpath("tr["+(j+1)+"]/td[1]")).getText();
						if(sectionName.contains("Annual Contract Works")){
							sectionName = "Annual Works";
						}
						if(sectionName.contains("Single Project Contract Works")){
							sectionName = "Single Project";
						}
						
						if(sectionName.equalsIgnoreCase("") || sectionName==null || sectionName.equalsIgnoreCase("Totals")){
							continue;
						}else{
							
							/*String actGP =  taxTable_tBody.findElement(By.xpath("tr["+(j+1)+"]/td[2]")).getText();
							String actGT =  taxTable_tBody.findElement(By.xpath("tr["+(j+1)+"]/td[5]")).getText();
							*/
							String expGP = (String)map_to_update.get("PS_"+sectionName.replaceAll(" ", "")+"_GP");
							String expGT = (String)map_to_update.get("PS_"+sectionName.replaceAll(" ", "")+"_GT");
							//String expNPIT = (String)map_to_update.get("PS_"+sectionName.replaceAll(" ", "")+"_NPIPT");
							
							common.totalGrossPremium = common.totalGrossPremium + Double.parseDouble(expGP);
							common.totalGrossTax = common.totalGrossTax + Double.parseDouble(expGT);
							//common.totalNetPremiumTax = common.totalNetPremiumTax + Double.parseDouble(expNPIT);
							
						}
						taxTable_tBody = k.getObject("inssuranceTaxMainTableBODY");
						List<WebElement> list3 = taxTable_tBody.findElements(By.tagName("tr"));
						countOfCovers = list3.size();
					}
				}
				if(policy_status_actual.contains("Endorsement Submitted")){
					common.totalGrossPremiumMTA = 0.0;
					common.totalGrossTaxMTA = 0.0;
					common.totalNetPremiumTaxMTA = 0.0;
					
					for(int j=0;j<countOfCovers-1;j++){
						
						taxTable_tBody = k.getObject("inssuranceTaxMainTableBODY");
						sectionName = taxTable_tBody.findElement(By.xpath("tr["+(j+1)+"]/td[1]")).getText();
						if(sectionName.contains("Excess of Loss")){
							sectionName = "Property Excess of Loss";
						}
						if(sectionName.contains("Annual Contract Works")){
							sectionName = "Annual Works";
						}
						if(sectionName.equalsIgnoreCase("") || sectionName==null || sectionName.equalsIgnoreCase("Totals")){
							continue;
						}else{
							
							/*String actGP =  taxTable_tBody.findElement(By.xpath("tr["+(j+1)+"]/td[2]")).getText();
							String actGT =  taxTable_tBody.findElement(By.xpath("tr["+(j+1)+"]/td[5]")).getText();
							*/
							String expGP = (String)map_to_update.get("PS_"+sectionName.replaceAll(" ", "")+"_GP");
							String expGT = (String)map_to_update.get("PS_"+sectionName.replaceAll(" ", "")+"_GT");
							//String expNPIT = (String)map_to_update.get("PS_"+sectionName.replaceAll(" ", "")+"_NPIPT");
							
							common.totalGrossPremiumMTA = common.totalGrossPremiumMTA + Double.parseDouble(expGP);
							common.totalGrossTaxMTA = common.totalGrossTaxMTA + Double.parseDouble(expGT);
							//common.totalNetPremiumTaxMTA = common.totalNetPremiumTaxMTA + Double.parseDouble(expNPIT);
							
						}
						taxTable_tBody = k.getObject("inssuranceTaxMainTableBODY");
						List<WebElement> list3 = taxTable_tBody.findElements(By.tagName("tr"));
						countOfCovers = list3.size();
					}
				}
				
				TestUtil.reportStatus("<b> Tax adjustment operatios is completed. </b>", "Info", false);
				if(common.currentRunningFlow.equalsIgnoreCase("MTA")){
					TestUtil.WriteDataToXl(code+"_"+event, "Premium Summary",(String)map_to_update.get("Automation Key"), "PS_Total_GP", common.roundedOff(Double.toString(totalGrossPremiumMTA)), map_to_update);
					TestUtil.WriteDataToXl(code+"_"+event, "Premium Summary",(String)map_to_update.get("Automation Key"), "PS_Total_GT", common.roundedOff(Double.toString(totalGrossTaxMTA)), map_to_update);
					TestUtil.WriteDataToXl(code+"_"+event, "Premium Summary",(String)map_to_update.get("Automation Key"), "PS_Total_NPIPT", common.roundedOff(Double.toString(totalNetPremiumTaxMTA)), map_to_update);
					
				}else{
					map_to_update.put("PS_Total_GP", common.roundedOff(Double.toString(totalGrossPremium)));
					map_to_update.put("PS_Total_GT", common.roundedOff(Double.toString(totalGrossTax)));
					map_to_update.put("PS_Total_NPIPT", common.roundedOff(Double.toString(totalNetPremiumTax)));
					
					//TestUtil.WriteDataToXl(code+"_"+event, "Premium Summary",(String)map_to_update.get("Automation Key"), "PS_Total_GP", common.roundedOff(Double.toString(totalGrossPremium)), map_to_update);
					//TestUtil.WriteDataToXl(code+"_"+event, "Premium Summary",(String)map_to_update.get("Automation Key"), "PS_Total_GT", common.roundedOff(Double.toString(totalGrossTax)), map_to_update);
					//TestUtil.WriteDataToXl(code+"_"+event, "Premium Summary",(String)map_to_update.get("Automation Key"), "PS_Total_NPIPT", common.roundedOff(Double.toString(totalNetPremiumTax)), map_to_update);
				}
				break;
			default:
				break;
			}
			
			common.funcPageNavigation("", "Save");
			k.Click("Tax_adj_BackBtn");
			//System.out.println(map_to_update);
			return true;
		}catch (Throwable t) {
			k.ImplicitWaitOn();
			return false;
		}
	}
	
	//This function will verify values from system with data sheet data.
	@SuppressWarnings("static-access")
	public static boolean verifyCoverDetails(){
		
		try {
			
			int count = 0 , count_datasheet = 0;
			String coverName = null , coverName_datasheet = null;
			customAssert.assertTrue(k.Click("insuranceTaxAddAdjustmentButton"),"Unable to click on Add adustment button on Insurance Tax screen.");
			List<WebElement> names = driver.findElements(By.tagName("option"));
			List<String> coversNameList = new ArrayList<>();
			String policy_status_actual = k.getText("Policy_status_header");
			String coverName_withoutSpace =null;
			
			for(int i=0;i<names.size();i++){
				coverName = names.get(i).getText();
				
				if(coverName.contains("Liability")){
					coverName_withoutSpace = "Liability";
				}else if(coverName.contains("Frozen Food")){
					coverName_withoutSpace = "FrozenFood";
				}else if(coverName.contains("Licence")){
					coverName_withoutSpace = "LossofLicence";
				}else if(coverName.contains("Excess of Loss")){
					coverName_withoutSpace = "PropertyExcessofLoss";
				}else{
					coverName_withoutSpace = coverName.replaceAll(" ", "");
				}
				coversNameList.add(coverName_withoutSpace);
				if(common.currentRunningFlow.equalsIgnoreCase("NB")){
				
				String key = "CD_"+coverName_withoutSpace;
				if((policy_status_actual).contains("Rewind")){
					key = "CD_Add_"+coverName_withoutSpace;
				}
				
				if(common.NB_excel_data_map.get(key).toString().equalsIgnoreCase("Yes")){
					continue;
				}else{
					if(common.NB_excel_data_map.get("CD_"+coverName_withoutSpace.replaceAll(" ", "")).toString().equalsIgnoreCase("Yes")){
						
					}else{
						TestUtil.reportStatus("Cover Name <b>  ["+coverName+"]  </b> should not present in the dropdown list as This cover is not selected on Cover Details page.", "FAIL", false);
						count++;
					}
					
				}
			}else if(common.currentRunningFlow.equalsIgnoreCase("MTA")){
				String key = "CD_AR"+coverName_withoutSpace;
								
				if(common.MTA_excel_data_map.get(key).toString().equalsIgnoreCase("Yes")){
					continue;
				}else{
					if(common.MTA_excel_data_map.get("CD_"+coverName_withoutSpace.replaceAll(" ", "")).toString().equalsIgnoreCase("Yes")){
						
					}else{
						TestUtil.reportStatus("Cover Name <b>  ["+coverName+"]  </b> should not present in the dropdown list as This cover is not selected on Cover Details page.", "FAIL", false);
						count++;
					}
					
				}
			}
				}
			for(int p=0;p<common.CoversDetails_data_list.size();p++){
				coverName_datasheet = common.CoversDetails_data_list.get(p);
				
				if(coversNameList.contains(coverName_datasheet)){
					continue;
				}else{
					TestUtil.reportStatus("Cover Name <b>  ["+coverName_datasheet+"]  </b> is selected as 'NO' in datasheet but still listed in the dropdown list.", "FAIL", false);
					count_datasheet++;
				}
			}
			
			WebElement adjustmentTax = k.getObject("insuranceTaxAddAdjustmentTable");
			customAssert.assertTrue(k.SelectBtnWebElement(adjustmentTax, "insuranceTaxAddAdjustmentSaveCancleButton", "Cancel"), "Unable to select Cancel button.");
			
			if(count==0 && count_datasheet==0){
				TestUtil.reportStatus("<b> Verified covers present in dropdown list of Adjustment Tax table. </b>", "Info", false);
			}
			
			return true;
		
		}catch (Throwable t) {
			
			return false;
		}
	}
	
	//This function will verify Gross premium values from system with datasheet data.
	@SuppressWarnings({ "static-access", "unused" })
	public static boolean verifyGrossPremiumValues(){
		
		try {
			
			int count = 0;
			taxTable_tBody = k.getObject("inssuranceTaxMainTableBODY"); 
			List<WebElement> coverNameList = taxTable_tBody.findElements(By.tagName("tr"));
			String policy_status_actual = k.getText("Policy_status_header");
			String NB_Status = (String)common.NB_excel_data_map.get("NB_Status");
			// Below code will check the covers from the table.
			String coverName_withoutSpace = null;
			Map<Object, Object> map_to_update=common.NB_excel_data_map;
			switch(TestBase.businessEvent){
			case "NB":
				map_to_update = common.NB_excel_data_map;
			break;
			case "MTA":
				if(common.currentRunningFlow.equals("NB")){
					map_to_update = common.NB_excel_data_map;
				}
				else{
					map_to_update = common.MTA_excel_data_map;					
				}
				
			break;
			}
			
			for(int i=0;i<coverNameList.size()-1;i++){
				
				String sectionName = taxTable_tBody.findElement(By.xpath("tr["+(i+1)+"]/td[1]")).getText();
				
				switch (sectionName) {
				case "":
					break;
				default:
					switch (sectionName) {
					case "Annual Contract Works":
						coverName_withoutSpace = "AnnualWorks";
						break;
					case "Single Project Contract Works":
						coverName_withoutSpace = "SingleProject";
						break;
					default:
						coverName_withoutSpace = sectionName.replaceAll(" ", "");
						break;
					}
					
					/*if(sectionName.contains("Annual Contract Works")){
						coverName_withoutSpace = "AnnualWorks";
					}else{
						coverName_withoutSpace = sectionName.replaceAll(" ", "");
					}*/
					
					String key = "CD_"+coverName_withoutSpace;
					String expectedIPTRate = (String)map_to_update.get("PS_"+coverName_withoutSpace+"_IPT");
					
					// This is for Rewind Flow.
					if((policy_status_actual).contains("Rewind")){
						key = "CD_Add_"+coverName_withoutSpace;
						if(sectionName.contains("Annual Contract Works")){
							coverName_withoutSpace = "AnnualWorks";
						} if(sectionName.contains("Single Project Contract Works")){
							coverName_withoutSpace = "SingleProject";
						}
						expectedIPTRate = (String)common.NB_excel_data_map.get("PS_"+coverName_withoutSpace+"_IPT");
						
					}
					if((policy_status_actual).contains("Submitted") && NB_Status.equalsIgnoreCase("ReQuote")){
						key = "CD_Add_"+coverName_withoutSpace;
						if(sectionName.contains("Annual Contract Works")){
							coverName_withoutSpace = "AnnualWorks";
						} if(sectionName.contains("Single Project Contract Works")){
							coverName_withoutSpace = "SingleProject";
						}
						expectedIPTRate = (String)common.NB_excel_data_map.get("PS_"+coverName_withoutSpace+"_IPT");
						
					}
					//This is for Endorsement flow.
					else if((policy_status_actual).contains("Endorsement Submitted")){
						key = "CD_"+coverName_withoutSpace;
						if(sectionName.contains("Annual Contract Works")){
							coverName_withoutSpace = "AnnualWorks";
						} if(sectionName.contains("Single Project Contract Works")){
							coverName_withoutSpace = "SingleProject";
						}
						
						expectedIPTRate = (String)common.MTA_excel_data_map.get("PS_"+coverName_withoutSpace+"_IPT");
						
					}
					
					//This is for NB flow.
					else{
						if(sectionName.contains("Annual Contract Works")){
							coverName_withoutSpace = "AnnualWorks";
						} if(sectionName.contains("Single Project Contract Works")){
							coverName_withoutSpace = "SingleProject";
						}
					}
					
					String actualGrossPremium , actualIPTRate , actualGrossTax ,  expectedGrossPremium , expectedGrossTax;
					switch (map_to_update.get(key).toString()) { 
					case "Yes":
						actualGrossPremium =  common.roundedOff(taxTable_tBody.findElement(By.xpath("tr["+(i+1)+"]/td[2]")).getText());
						actualIPTRate =  taxTable_tBody.findElement(By.xpath("tr["+(i+1)+"]/td[4]")).getText();
						actualGrossTax =  common.roundedOff(taxTable_tBody.findElement(By.xpath("tr["+(i+1)+"]/td[5]")).getText());
						
						//Changed - GrosspremSmryData to NB_excel_data_map for dry run.
						if(common.currentRunningFlow.equalsIgnoreCase("MTA") && common.product.equalsIgnoreCase("COB")){
						//	expectedGrossPremium = Double.toString(common_VELA.transaction_Details_Premium_Values.get(coverName_withoutSpace).get("Gross Premium"));
							expectedGrossPremium = common.roundedOff((String)common.MTA_excel_data_map.get("PS_"+coverName_withoutSpace+"_GP"));
						}else{
						expectedGrossPremium = common.roundedOff((String)common.NB_excel_data_map.get("PS_"+coverName_withoutSpace+"_GP"));
						}
						expectedGrossTax = common.roundedOff(Double.toString(((Double.parseDouble(expectedGrossPremium) * Double.parseDouble(expectedIPTRate)) / 100.0)));
						
						if(verification(actualGrossPremium, expectedGrossPremium, sectionName, "Gross Premium") && 
						   /*verification(actualIPTRate, expectedIPTRate, sectionName, "IPT Rate") &&*/
						   verification(actualGrossTax, expectedGrossTax, sectionName, "Gross Tax")){
						}
						break;

					default:
						switch (common.NB_excel_data_map.get("CD_"+coverName_withoutSpace).toString()) {
						case "Yes":
							actualGrossPremium =  common.roundedOff(taxTable_tBody.findElement(By.xpath("tr["+(i+1)+"]/td[2]")).getText());
							actualIPTRate =  taxTable_tBody.findElement(By.xpath("tr["+(i+1)+"]/td[4]")).getText();
							actualGrossTax =  common.roundedOff(taxTable_tBody.findElement(By.xpath("tr["+(i+1)+"]/td[5]")).getText());
							
							//Changed - GrosspremSmryData to NB_excel_data_map for dry run.
							expectedGrossPremium = common.roundedOff((String)common.NB_excel_data_map.get("PS_"+coverName_withoutSpace.replaceAll(" ", "")+"_GP"));
							expectedGrossTax = common.roundedOff(Double.toString(((Double.parseDouble(expectedGrossPremium) * Double.parseDouble(expectedIPTRate)) / 100.0)));
							
							if(verification(actualGrossPremium, expectedGrossPremium, sectionName, "Gross Premium") && 
							   /*verification(actualIPTRate, expectedIPTRate, sectionName, "IPT Rate") &&*/
							   verification(actualGrossTax, expectedGrossTax, sectionName, "Gross Tax")){
								
							}
							break;
						default:
							TestUtil.reportStatus("Cover Name <b>  ["+sectionName+"]  </b> should not present in the table as This cover is not selected on Cover Details page.", "FAIL", false);
							count++;
							break;
						}
						break;
					}
					
					
					
					
					/*if(map_to_update.get(key).toString().equalsIgnoreCase("Yes")){
						
						
						String actualGrossPremium =  common.roundedOff(taxTable_tBody.findElement(By.xpath("tr["+(i+1)+"]/td[2]")).getText());
						String actualIPTRate =  taxTable_tBody.findElement(By.xpath("tr["+(i+1)+"]/td[4]")).getText();
						String actualGrossTax =  common.roundedOff(taxTable_tBody.findElement(By.xpath("tr["+(i+1)+"]/td[5]")).getText());
						
						//Changed - GrosspremSmryData to NB_excel_data_map for dry run.
						String expectedGrossPremium = common.roundedOff((String)common.NB_excel_data_map.get("PS_"+coverName_withoutSpace+"_GP"));
						String expectedGrossTax = common.roundedOff(Double.toString(((Double.parseDouble(expectedGrossPremium) * Double.parseDouble(expectedIPTRate)) / 100.0)));
						
						if(verification(actualGrossPremium, expectedGrossPremium, sectionName, "Gross Premium") && 
						   verification(actualIPTRate, expectedIPTRate, sectionName, "IPT Rate") &&
						   verification(actualGrossTax, expectedGrossTax, sectionName, "Gross Tax")){
						}
						continue;
					}else{
						if(common.NB_excel_data_map.get("CD_"+coverName_withoutSpace).toString().equalsIgnoreCase("Yes")){
							
							String actualGrossPremium =  common.roundedOff(taxTable_tBody.findElement(By.xpath("tr["+(i+1)+"]/td[2]")).getText());
							String actualIPTRate =  taxTable_tBody.findElement(By.xpath("tr["+(i+1)+"]/td[4]")).getText();
							String actualGrossTax =  common.roundedOff(taxTable_tBody.findElement(By.xpath("tr["+(i+1)+"]/td[5]")).getText());
							
							//Changed - GrosspremSmryData to NB_excel_data_map for dry run.
							String expectedGrossPremium = common.roundedOff((String)common.NB_excel_data_map.get("PS_"+coverName_withoutSpace.replaceAll(" ", "")+"_GP"));
							String expectedGrossTax = common.roundedOff(Double.toString(((Double.parseDouble(expectedGrossPremium) * Double.parseDouble(expectedIPTRate)) / 100.0)));
							
							if(verification(actualGrossPremium, expectedGrossPremium, sectionName, "Gross Premium") && 
							   verification(actualIPTRate, expectedIPTRate, sectionName, "IPT Rate") &&
							   verification(actualGrossTax, expectedGrossTax, sectionName, "Gross Tax")){
								
							}
							
						}else{
							TestUtil.reportStatus("Cover Name <b>  ["+sectionName+"]  </b> should not present in the table as This cover is not selected on Cover Details page.", "FAIL", false);
							count++;
						}
					}*/
					break;
				}
				
				
				/*if(!(sectionName.equalsIgnoreCase(""))){
					if(sectionName.contains("Annual Contract Works")){
						coverName_withoutSpace = "AnnualWorks";
					}else{
						coverName_withoutSpace = sectionName.replaceAll(" ", "");
					}
					
					String key = "CD_"+coverName_withoutSpace;
					String expectedIPTRate = (String)common.NB_excel_data_map.get("PS_IPTRate");
					
					// This is for Rewind Flow.
					if((policy_status_actual).contains("Rewind")){
						key = "CD_Add_"+coverName_withoutSpace;
						if(sectionName.contains("Annual Contract Works")){
							coverName_withoutSpace = "AnnualWorks";
						}
						expectedIPTRate = (String)common.NB_excel_data_map.get("PS_"+coverName_withoutSpace+"_IPT");
						
					}
					
					//This is for Endorsement flow.
					else if((policy_status_actual).contains("Endorsement Submitted")){
						key = "CD_AR"+coverName_withoutSpace;
						if(sectionName.contains("Annual Contract Works")){
							coverName_withoutSpace = "AnnualWorks";
						}
						
						expectedIPTRate = (String)common.NB_excel_data_map.get("PS_"+coverName_withoutSpace+"_IPT");
						
					}
					
					//This is for NB flow.
					else{
						if(sectionName.contains("Annual Contract Works")){
							coverName_withoutSpace = "AnnualWorks";
						}
					}
					
					if(map_to_update.get(key).toString().equalsIgnoreCase("Yes")){
						
						
						String actualGrossPremium =  common.roundedOff(taxTable_tBody.findElement(By.xpath("tr["+(i+1)+"]/td[2]")).getText());
						String actualIPTRate =  taxTable_tBody.findElement(By.xpath("tr["+(i+1)+"]/td[4]")).getText();
						String actualGrossTax =  common.roundedOff(taxTable_tBody.findElement(By.xpath("tr["+(i+1)+"]/td[5]")).getText());
						
						//Changed - GrosspremSmryData to NB_excel_data_map for dry run.
						String expectedGrossPremium = common.roundedOff((String)common.NB_excel_data_map.get("PS_"+coverName_withoutSpace+"_GP"));
						String expectedGrossTax = common.roundedOff(Double.toString(((Double.parseDouble(expectedGrossPremium) * Double.parseDouble(expectedIPTRate)) / 100.0)));
						
						if(verification(actualGrossPremium, expectedGrossPremium, sectionName, "Gross Premium") && 
						   verification(actualIPTRate, expectedIPTRate, sectionName, "IPT Rate") &&
						   verification(actualGrossTax, expectedGrossTax, sectionName, "Gross Tax")){
						}
						continue;
					}else{
						if(common.NB_excel_data_map.get("CD_"+coverName_withoutSpace).toString().equalsIgnoreCase("Yes")){
							
							String actualGrossPremium =  common.roundedOff(taxTable_tBody.findElement(By.xpath("tr["+(i+1)+"]/td[2]")).getText());
							String actualIPTRate =  taxTable_tBody.findElement(By.xpath("tr["+(i+1)+"]/td[4]")).getText();
							String actualGrossTax =  common.roundedOff(taxTable_tBody.findElement(By.xpath("tr["+(i+1)+"]/td[5]")).getText());
							
							//Changed - GrosspremSmryData to NB_excel_data_map for dry run.
							String expectedGrossPremium = common.roundedOff((String)common.NB_excel_data_map.get("PS_"+coverName_withoutSpace.replaceAll(" ", "")+"_GP"));
							String expectedGrossTax = common.roundedOff(Double.toString(((Double.parseDouble(expectedGrossPremium) * Double.parseDouble(expectedIPTRate)) / 100.0)));
							
							if(verification(actualGrossPremium, expectedGrossPremium, sectionName, "Gross Premium") && 
							   verification(actualIPTRate, expectedIPTRate, sectionName, "IPT Rate") &&
							   verification(actualGrossTax, expectedGrossTax, sectionName, "Gross Tax")){
								
							}
							
						}else{
							TestUtil.reportStatus("Cover Name <b>  ["+sectionName+"]  </b> should not present in the table as This cover is not selected on Cover Details page.", "FAIL", false);
							count++;
						}
					}
				}*/
				
			}
			
			if(count==0){
				TestUtil.reportStatus("<b> Verified Gross Premium/Gross Tax/IPT Rate for each cover present under Tax Adjustment table. </b>", "Info", false);
			}
			
			return true;
		
		}catch (Throwable t) {
			
			return false;
		}
	}
	
	//This function will add 
		@SuppressWarnings("static-access")
		public static boolean adjustInsuranceTax(String grossPremium,String sectionName,String code,String event){
			try{
				Map<Object,Object> data_map = null;
				Map<String, List<Map<String, String>>> inner_data_map = null;
				
	   			switch (common.currentRunningFlow) {
	   			case "NB":
					data_map = common.NB_excel_data_map;
					inner_data_map = common.NB_Structure_of_InnerPagesMaps;
					break;
				case "MTA":
					data_map = common.MTA_excel_data_map;
					inner_data_map = common.MTA_Structure_of_InnerPagesMaps;
					break;
				case "Renewal":
					data_map = common.Renewal_excel_data_map;
					inner_data_map = common.Renewal_Structure_of_InnerPagesMaps;
					break;
				case "Requote":
					data_map = common.Requote_excel_data_map;
					inner_data_map = common.Requote_Structure_of_InnerPagesMaps;
					break;
				case "Rewind":
					data_map = common.Rewind_excel_data_map;
					inner_data_map = common.Rewind_Structure_of_InnerPagesMaps;
					break;
				case "CAN":
	 				data_map = common.CAN_excel_data_map;
	 				inner_data_map = common.CAN_Structure_of_InnerPagesMaps;
	 				break;
				}
				variableTaxAdjustmentDataMaps = new LinkedHashMap<>();
				variableTaxAdjustmentVerificationMaps = new LinkedHashMap<>();
				variableTaxAdjustmentIDs = new HashMap<>();
				grossTaxValues_Map = new HashMap<>();
				headerNameStorage = new ArrayList<>();
				inputarraylist = new ArrayList<>();
				inputarraylistMTA = new ArrayList<>();
				Adjusted_Premium_map = new HashMap<>();
				
				
				adjustedPremium = Double.parseDouble(common.roundedOff((String)data_map.get("PS_"+sectionName.replaceAll(" ", "")+"_GP")));
				
				int count = common.no_of_inner_data_sets.get("Variable Tax Adjustment");
						
				int counter = 0;
				String coverName = sectionName;
				String policy_status_actual = k.getText("Policy_status_header");
				for(int l=0;l<count;l++){
					//This is for Rewind for in NB.
					if(policy_status_actual.contains("Rewind")){
						if((((String)data_map.get("CD_Add_"+coverName.replaceAll(" ", ""))).equalsIgnoreCase("Yes") &&
								((String)data_map.get("CD_"+coverName.replaceAll(" ", ""))).equalsIgnoreCase("No"))){
							
							if(inner_data_map.get("Variable Tax Adjustment").get(l).get("VTA_SectionName").equalsIgnoreCase(sectionName) && 
									inner_data_map.get("Variable Tax Adjustment").get(l).get("Automation Key").contains("Rewind")){
									Assert.assertTrue(k.Click("insuranceTaxAddAdjustmentButton"),"Unable to click on Add adustment button on Insurance Tax screen.");
									
									WebElement adjustmentTax = k.getObject("insuranceTaxAddAdjustmentTable");
									Select select = new Select(adjustmentTax.findElement(By.xpath("//*[contains(@name,'section')]")));
									String timeStamp = new SimpleDateFormat("ddMMyyyyHHmmss", Locale.US).format(new Date());
									String description = null;
									description = inner_data_map.get("Variable Tax Adjustment").get(l).get("VTA_Description");
									
									if(!description.contains("_")){
										description = inner_data_map.get("Variable Tax Adjustment").get(l).get("VTA_Description")+"_"+timeStamp;
										TestUtil.WriteDataToXl_innerSheet(code+"_"+event, "Variable Tax Adjustment", inner_data_map.get("Variable Tax Adjustment").get(l).get("Automation Key"), "VTA_Description", description, inner_data_map.get("Variable Tax Adjustment").get(l));
									}
									select.selectByVisibleText(inner_data_map.get("Variable Tax Adjustment").get(l).get("VTA_SectionName"));
									customAssert.assertTrue(k.Input("InsuranceTaxAdjustmentPremium", inner_data_map.get("Variable Tax Adjustment").get(l).get("VTA_Premium") ), "Unable to enter Premium on insurance Tax adjustment.");
									customAssert.assertTrue(k.Input("InsuranceTaxAdjustmentTaxRate", inner_data_map.get("Variable Tax Adjustment").get(l).get("VTA_TaxRate") ), "Unable to enter Premium on insurance Tax adjustment.");
									customAssert.assertTrue(k.Input("InsuranceTaxAdjustmentDescription", description ), "Unable to enter Premium on insurance Tax adjustment.");
									
									//System.out.println(variableTaxAdjustmentDataMaps);
									
									variableTaxAdjustmentDataMaps.put(inner_data_map.get("Variable Tax Adjustment").get(l).get("Automation Key")+"_Section Name", inner_data_map.get("Variable Tax Adjustment").get(l).get("VTA_SectionName"));
									variableTaxAdjustmentDataMaps.put(inner_data_map.get("Variable Tax Adjustment").get(l).get("Automation Key")+"_Premium", inner_data_map.get("Variable Tax Adjustment").get(l).get("VTA_Premium"));
									variableTaxAdjustmentDataMaps.put(inner_data_map.get("Variable Tax Adjustment").get(l).get("Automation Key")+"_Tax Rate", inner_data_map.get("Variable Tax Adjustment").get(l).get("VTA_TaxRate"));
									variableTaxAdjustmentDataMaps.put(inner_data_map.get("Variable Tax Adjustment").get(l).get("Automation Key")+"_Description", inner_data_map.get("Variable Tax Adjustment").get(l).get("VTA_Description"));
									
									headerNameStorage.add(inner_data_map.get("Variable Tax Adjustment").get(l).get("Automation Key"));
									//variableTaxAdjustmentVerificationMaps.put(common.NB_Structure_of_InnerPagesMaps.get("Variable Tax Adjustment").get(l).get("Automation Key"), variableTaxAdjustmentDataMaps);
									
									List<WebElement> listOfButtons = adjustmentTax.findElements(By.tagName("a"));
									//System.out.println("****************Total present button "+listOfButtons.size()+"********************");
									
									for(int k=0;k<listOfButtons.size();k++){
										String buttonName = listOfButtons.get(k).getText();
										if(buttonName.equalsIgnoreCase("Save")){
											listOfButtons.get(k).click();
											counter++;
											if(!validationOnAdjustedPremium(sectionName,l)){
												break;
											}
											adjustedPremium = adjustedPremium - Double.parseDouble(inner_data_map.get("Variable Tax Adjustment").get(l).get("VTA_Premium"));
											break;
										}
									}
								}
							}
						}
					//This is for MTA.
					else if(policy_status_actual.contains("Endorsement Submitted")){
						if((((String)common.MTA_excel_data_map.get("CD_"+coverName.replaceAll(" ", ""))).equalsIgnoreCase("Yes") &&
								((String)common.NB_excel_data_map.get("CD_"+coverName.replaceAll(" ", ""))).equalsIgnoreCase("No"))){
							
							if(common.MTA_Structure_of_InnerPagesMaps.get("Variable Tax Adjustment").get(l).get("VTA_SectionName").equalsIgnoreCase(sectionName) && 
									common.MTA_Structure_of_InnerPagesMaps.get("Variable Tax Adjustment").get(l).get("Automation Key").contains("Endorsement Submitted")){
									Assert.assertTrue(k.Click("insuranceTaxAddAdjustmentButton"),"Unable to click on Add adustment button on Insurance Tax screen.");
									
									WebElement adjustmentTax = k.getObject("insuranceTaxAddAdjustmentTable");
									Select select = new Select(adjustmentTax.findElement(By.xpath("//*[contains(@name,'section')]")));
									String timeStamp = new SimpleDateFormat("ddMMyyyyHHmmss", Locale.US).format(new Date());
									String description = null;
									description = common.MTA_Structure_of_InnerPagesMaps.get("Variable Tax Adjustment").get(l).get("VTA_Description");
									
									if(!description.contains("_")){
										description = common.MTA_Structure_of_InnerPagesMaps.get("Variable Tax Adjustment").get(l).get("VTA_Description")+"_"+timeStamp;
										TestUtil.WriteDataToXl_innerSheet(code+"_"+event, "Variable Tax Adjustment", common.MTA_Structure_of_InnerPagesMaps.get("Variable Tax Adjustment").get(l).get("Automation Key"), "VTA_Description", description, common.MTA_Structure_of_InnerPagesMaps.get("Variable Tax Adjustment").get(l));
									}
									select.selectByVisibleText(common.MTA_Structure_of_InnerPagesMaps.get("Variable Tax Adjustment").get(l).get("VTA_SectionName"));
									customAssert.assertTrue(k.Input("InsuranceTaxAdjustmentPremium", common.MTA_Structure_of_InnerPagesMaps.get("Variable Tax Adjustment").get(l).get("VTA_Premium") ), "Unable to enter Premium on insurance Tax adjustment.");
									customAssert.assertTrue(k.Input("InsuranceTaxAdjustmentTaxRate", common.MTA_Structure_of_InnerPagesMaps.get("Variable Tax Adjustment").get(l).get("VTA_TaxRate") ), "Unable to enter Premium on insurance Tax adjustment.");
									customAssert.assertTrue(k.Input("InsuranceTaxAdjustmentDescription", description ), "Unable to enter Premium on insurance Tax adjustment.");
									
									//System.out.println(variableTaxAdjustmentDataMaps);
									
									variableTaxAdjustmentDataMaps.put(common.MTA_Structure_of_InnerPagesMaps.get("Variable Tax Adjustment").get(l).get("Automation Key")+"_Section Name", common.MTA_Structure_of_InnerPagesMaps.get("Variable Tax Adjustment").get(l).get("VTA_SectionName"));
									variableTaxAdjustmentDataMaps.put(common.MTA_Structure_of_InnerPagesMaps.get("Variable Tax Adjustment").get(l).get("Automation Key")+"_Premium", common.MTA_Structure_of_InnerPagesMaps.get("Variable Tax Adjustment").get(l).get("VTA_Premium"));
									variableTaxAdjustmentDataMaps.put(common.MTA_Structure_of_InnerPagesMaps.get("Variable Tax Adjustment").get(l).get("Automation Key")+"_Tax Rate", common.MTA_Structure_of_InnerPagesMaps.get("Variable Tax Adjustment").get(l).get("VTA_TaxRate"));
									variableTaxAdjustmentDataMaps.put(common.MTA_Structure_of_InnerPagesMaps.get("Variable Tax Adjustment").get(l).get("Automation Key")+"_Description", common.MTA_Structure_of_InnerPagesMaps.get("Variable Tax Adjustment").get(l).get("VTA_Description"));
									
									headerNameStorage.add(common.MTA_Structure_of_InnerPagesMaps.get("Variable Tax Adjustment").get(l).get("Automation Key"));
									//variableTaxAdjustmentVerificationMaps.put(common.NB_Structure_of_InnerPagesMaps.get("Variable Tax Adjustment").get(l).get("Automation Key"), variableTaxAdjustmentDataMaps);
									
									List<WebElement> listOfButtons = adjustmentTax.findElements(By.tagName("a"));
									//System.out.println("****************Total present button "+listOfButtons.size()+"********************");
									
									for(int k=0;k<listOfButtons.size();k++){
										String buttonName = listOfButtons.get(k).getText();
										if(buttonName.equalsIgnoreCase("Save")){
											listOfButtons.get(k).click();
											counter++;
											if(!validationOnAdjustedPremium(sectionName,l)){
												break;
											}
											adjustedPremium = adjustedPremium - Double.parseDouble(common.MTA_Structure_of_InnerPagesMaps.get("Variable Tax Adjustment").get(l).get("VTA_Premium"));
											break;
										}
									}
								}
							}
						}
					//This is for NB flow.
					else{
						if(sectionName.contains("Annual Works")){
							sectionName = "Annual Contract Works";
						}
						if(sectionName.contains("Single Project")){
							sectionName = "Single Project Contract Works";
						}
						if(inner_data_map.get("Variable Tax Adjustment").get(l).get("VTA_SectionName").equalsIgnoreCase(sectionName)
								&& 
								!(inner_data_map.get("Variable Tax Adjustment").get(l).get("Automation Key").contains("Rewind"))){
							//if(adjustedPremium > 0.0 &&  adjustedPremium!=0.0 && adjustedPremium >= Double.parseDouble(common.NB_Structure_of_InnerPagesMaps.get("Variable Tax Adjustment").get(l).get("VTA_Premium"))){
								Assert.assertTrue(k.Click("insuranceTaxAddAdjustmentButton"),"Unable to click on Add adustment button on Insurance Tax screen.");
								
								WebElement adjustmentTax = k.getObject("insuranceTaxAddAdjustmentTable");
								Select select = new Select(adjustmentTax.findElement(By.xpath("//*[contains(@name,'section')]")));
								String timeStamp = new SimpleDateFormat("ddMMyyyyHHmmss", Locale.US).format(new Date());
								String description = null;
								description = inner_data_map.get("Variable Tax Adjustment").get(l).get("VTA_Description");
								
								if(!description.contains("_")){
									description = inner_data_map.get("Variable Tax Adjustment").get(l).get("VTA_Description")+"_"+timeStamp;
									TestUtil.WriteDataToXl_innerSheet(code+"_"+event, "Variable Tax Adjustment", inner_data_map.get("Variable Tax Adjustment").get(l).get("Automation Key"), "VTA_Description", description, common.NB_Structure_of_InnerPagesMaps.get("Variable Tax Adjustment").get(l));
								}
								select.selectByVisibleText(inner_data_map.get("Variable Tax Adjustment").get(l).get("VTA_SectionName"));
								customAssert.assertTrue(k.Input("InsuranceTaxAdjustmentPremium", inner_data_map.get("Variable Tax Adjustment").get(l).get("VTA_Premium") ), "Unable to enter Premium on insurance Tax adjustment.");
								customAssert.assertTrue(k.Input("InsuranceTaxAdjustmentTaxRate", inner_data_map.get("Variable Tax Adjustment").get(l).get("VTA_TaxRate") ), "Unable to enter Premium on insurance Tax adjustment.");
								customAssert.assertTrue(k.Input("InsuranceTaxAdjustmentDescription", description ), "Unable to enter Premium on insurance Tax adjustment.");
								
								//System.out.println(variableTaxAdjustmentDataMaps);
								
								variableTaxAdjustmentDataMaps.put(inner_data_map.get("Variable Tax Adjustment").get(l).get("Automation Key")+"_Section Name", inner_data_map.get("Variable Tax Adjustment").get(l).get("VTA_SectionName"));
								variableTaxAdjustmentDataMaps.put(inner_data_map.get("Variable Tax Adjustment").get(l).get("Automation Key")+"_Premium", inner_data_map.get("Variable Tax Adjustment").get(l).get("VTA_Premium"));
								variableTaxAdjustmentDataMaps.put(inner_data_map.get("Variable Tax Adjustment").get(l).get("Automation Key")+"_Tax Rate", inner_data_map.get("Variable Tax Adjustment").get(l).get("VTA_TaxRate"));
								variableTaxAdjustmentDataMaps.put(inner_data_map.get("Variable Tax Adjustment").get(l).get("Automation Key")+"_Description", inner_data_map.get("Variable Tax Adjustment").get(l).get("VTA_Description"));
								
								headerNameStorage.add(inner_data_map.get("Variable Tax Adjustment").get(l).get("Automation Key"));
								//variableTaxAdjustmentVerificationMaps.put(common.NB_Structure_of_InnerPagesMaps.get("Variable Tax Adjustment").get(l).get("Automation Key"), variableTaxAdjustmentDataMaps);
								
								List<WebElement> listOfButtons = adjustmentTax.findElements(By.tagName("a"));
								//System.out.println("****************Total present button "+listOfButtons.size()+"********************");
								
								for(int k=0;k<listOfButtons.size();k++){
									String buttonName = listOfButtons.get(k).getText();
									if(buttonName.equalsIgnoreCase("Save")){
										listOfButtons.get(k).click();
										counter++;
										if(!validationOnAdjustedPremium(sectionName,l)){
											break;
										}
										adjustedPremium = adjustedPremium - Double.parseDouble(inner_data_map.get("Variable Tax Adjustment").get(l).get("VTA_Premium"));
										//Adjusted_Premium_map.put(sectionName+"_adjustedPremium", adjustedPremium);
										break;
									}
								}
							}
					}
				}
				variableTaxAdjustmentIDs.put(sectionName, counter);
				return true;
				
			}
			catch (Throwable t) {
				
				return false;
			}
		}
	
	public static boolean validationOnAdjustedPremium(String sectionName,int index){
		
		try {
			
			if(Double.parseDouble(common.NB_Structure_of_InnerPagesMaps.get("Variable Tax Adjustment").get(index).get("VTA_Premium")) > 0.0 && 
			   Double.parseDouble(common.NB_Structure_of_InnerPagesMaps.get("Variable Tax Adjustment").get(index).get("VTA_Premium")) <= adjustedPremium &&
			   Double.parseDouble(common.NB_Structure_of_InnerPagesMaps.get("Variable Tax Adjustment").get(index).get("VTA_TaxRate")) <= 100.0 &&
			   Double.parseDouble(common.NB_Structure_of_InnerPagesMaps.get("Variable Tax Adjustment").get(index).get("VTA_TaxRate")) >= 0.0
					){
				return true;
			}else{
				if(!(Double.parseDouble(common.NB_Structure_of_InnerPagesMaps.get("Variable Tax Adjustment").get(index).get("VTA_Premium")) > 0.0)){
					TestUtil.reportStatus("<p style='color:black'> Gross Premium should be <b> > 0.0 </b> .Entered Gross Premium is : <b>[  "+common.NB_Structure_of_InnerPagesMaps.get("Variable Tax Adjustment").get(index).get("VTA_Premium")+"  ]</b>. Skipped Tax adjustment for Data ID is : [<b>  "+common.NB_Structure_of_InnerPagesMaps.get("Variable Tax Adjustment").get(index).get("Automation Key")+"  </b>] AND Cover Name is :  <b>[  "+sectionName+"  ]</b> </p>", "Info", false);
				}else if(!(Double.parseDouble(common.NB_Structure_of_InnerPagesMaps.get("Variable Tax Adjustment").get(index).get("VTA_Premium")) <= adjustedPremium)){
					TestUtil.reportStatus("<p style='color:black'> Gross Premium limit is either completed or higher than Gross Premium. Available Gross Premium is : <b>[  "+adjustedPremium+"  ]</b> And Entered Gross Premium is : <b>[  "+common.NB_Structure_of_InnerPagesMaps.get("Variable Tax Adjustment").get(index).get("VTA_Premium")+"  ]</b>. Skipped Tax adjustment for Data ID is : [<b>  "+common.NB_Structure_of_InnerPagesMaps.get("Variable Tax Adjustment").get(index).get("Automation Key")+"  </b>] AND Cover Name is :  <b>[  "+sectionName+"  ]</b> </p>", "Info", false);
				}else if(!(Double.parseDouble(common.NB_Structure_of_InnerPagesMaps.get("Variable Tax Adjustment").get(index).get("VTA_TaxRate")) <= 100.0)){
					TestUtil.reportStatus("<p style='color:black'> Tax rate should be <b> <= 100.0 </b>. Entered Tax rate is : <b>[  "+common.NB_Structure_of_InnerPagesMaps.get("Variable Tax Adjustment").get(index).get("VTA_TaxRate")+"  ]</b>. Skipped Tax adjustment for Data ID is : [<b>  "+common.NB_Structure_of_InnerPagesMaps.get("Variable Tax Adjustment").get(index).get("Automation Key")+"  </b>] AND Cover Name is :  <b>[  "+sectionName+"  ]</b> </p>", "Info", false);
				}else if(!(Double.parseDouble(common.NB_Structure_of_InnerPagesMaps.get("Variable Tax Adjustment").get(index).get("VTA_TaxRate")) >= 0.0)){
					TestUtil.reportStatus("<p style='color:black'> Tax rate should be <b> >= 0.0 </b>.Entered Tax rate is : <b>[  "+common.NB_Structure_of_InnerPagesMaps.get("Variable Tax Adjustment").get(index).get("VTA_TaxRate")+"  ]</b> Skipped Tax adjustment for Data ID is : [<b>  "+common.NB_Structure_of_InnerPagesMaps.get("Variable Tax Adjustment").get(index).get("Automation Key")+"  </b>] AND Cover Name is :  <b>[  "+sectionName+"  ]</b> </p>", "Info", false);
				}
				
				@SuppressWarnings("static-access")
				WebElement adjustmentTax = k.getObject("insuranceTaxAddAdjustmentTable");
				customAssert.assertTrue(k.SelectBtnWebElement(adjustmentTax, "insuranceTaxAddAdjustmentSaveCancleButton", "Cancel"), "Unable to select Cancel button.");
				
				return false;
			}
			
		} catch (Throwable t) {
			
			return false;
		} 

	}
	
	@SuppressWarnings({ "static-access", "unused" })
	public static boolean verifyAdjustedTaxValues(String sectionName,String code , String event){
		
		String coverName = sectionName;
		adjustedTotalTax = 0.0;
		adjustedTotalPremium = 0.0;
		unAdjustedTotalTax = 0.0;
		inputarraylist.clear();
		inputarraylistMTA.clear();
		
		try {
			taxTable_tBody = k.getObject("inssuranceTaxMainTableBODY");
			List<WebElement> list2 = taxTable_tBody.findElements(By.tagName("tr"));
			countOfTableRows = list2.size();
			//System.out.println("Rows in table unde tBody : "+list2.size());
			
			Outer:
			for(int j=0;j<countOfCovers-1;j++){
				if(taxTable_tBody.findElement(By.xpath("tr["+(j+1)+"]/td[1]")).getText().equalsIgnoreCase("Totals")){
					//break Outer;
					break Outer;
				}
				if(sectionName.contains("Property Excess of Loss")){
					sectionName = "Excess of Loss";
				}
				String policy_status_actual = k.getText("Policy_status_header");
				if(policy_status_actual.contains("Rewind")){
					if(sectionName.equalsIgnoreCase(taxTable_tBody.findElement(By.xpath("tr["+(j+1)+"]/td[1]")).getText())){
							Inner :
							for(int m=0;m<=variableTaxAdjustmentIDs.get(sectionName)+1;m++){
								if(taxTable_tBody.findElement(By.xpath("tr["+(j+(m+1))+"]/td[1]")).getText().equalsIgnoreCase("Totals")){
									//break Outer;
									break Inner;
								}
								taxTable_tBody = k.getObject("inssuranceTaxMainTableBODY");
								//Verify Adjusted Values
								errorVal = errorVal + verifyAdjustedTaxCalculation(sectionName,j,m);
							}
							
							//Verify Unadjusted Values
							errorVal = errorVal + verifyUnAdjustedTaxCalculation(sectionName,j);
							//Verify Gross Tax values
							errorVal = errorVal + verifyGrossTaxCalculation(sectionName,j,code,event);
							break;
						}
						
				}else if(policy_status_actual.contains("Endorsement Submitted")){
					if((((String)common.MTA_excel_data_map.get("CD_Add_"+coverName.replaceAll(" ", ""))).equalsIgnoreCase("Yes") &&
							((String)common.NB_excel_data_map.get("CD_"+coverName.replaceAll(" ", ""))).equalsIgnoreCase("No"))){
						
						if(sectionName.equalsIgnoreCase(taxTable_tBody.findElement(By.xpath("tr["+(j+1)+"]/td[1]")).getText())){
							Inner :
							for(int m=0;m<=variableTaxAdjustmentIDs.get(sectionName)+1;m++){
								if(taxTable_tBody.findElement(By.xpath("tr["+(j+(m+1))+"]/td[1]")).getText().equalsIgnoreCase("Totals")){
									//break Outer;
									break Inner;
								}
								taxTable_tBody = k.getObject("inssuranceTaxMainTableBODY");
								//Verify Adjusted Values
								errorVal = errorVal + verifyAdjustedTaxCalculationMTA(sectionName,j,m);
							}
							
							//Verify Unadjusted Values
							errorVal = errorVal + verifyUnAdjustedTaxCalculationMTA(sectionName,j);
							//Verify Gross Tax values
							errorVal = errorVal + verifyGrossTaxCalculationMTA(sectionName,j,code,event);
							break;
						}
						
					}
				}else{
					if(sectionName.contains("Annual Works")){
						sectionName = "Annual Contract Works";
					}
					if(sectionName.contains("Single Project")){
						sectionName = "Single Project Contract Works";
					}
					if(sectionName.equalsIgnoreCase(taxTable_tBody.findElement(By.xpath("tr["+(j+1)+"]/td[1]")).getText())){
						Inner :
						for(int m=0;m<=variableTaxAdjustmentIDs.get(sectionName)+1;m++){
							if(taxTable_tBody.findElement(By.xpath("tr["+(j+(m+1))+"]/td[1]")).getText().equalsIgnoreCase("Totals")){
								//break Outer;
								break Inner;
							}
							taxTable_tBody = k.getObject("inssuranceTaxMainTableBODY");
							//Verify Adjusted Values
							errorVal = errorVal + verifyAdjustedTaxCalculation(sectionName,j,m);
						}
						
						//Verify Unadjusted Values
						errorVal = errorVal + verifyUnAdjustedTaxCalculation(sectionName,j);
						//Verify Gross Tax values
						errorVal = errorVal + verifyGrossTaxCalculation(sectionName,j,code,event);
						break;
					}
				}
				
			}
		} catch (Throwable t) {
			
			return false;
		} 
		
		return true;
	}
	
public static int verifyAdjustedTaxCalculation(String sectionName,int j,int m){
		
		try{
			Map<Object,Object> data_map = null;
			Map<String, List<Map<String, String>>> inner_data_map = null;
			
   			switch (common.currentRunningFlow) {
   			case "NB":
				data_map = common.NB_excel_data_map;
				inner_data_map = common.NB_Structure_of_InnerPagesMaps;
				break;
			case "MTA":
				data_map = common.MTA_excel_data_map;
				inner_data_map = common.MTA_Structure_of_InnerPagesMaps;
				break;
			case "Renewal":
				data_map = common.Renewal_excel_data_map;
				inner_data_map = common.Renewal_Structure_of_InnerPagesMaps;
				break;
			case "Requote":
				data_map = common.Requote_excel_data_map;
				inner_data_map = common.Requote_Structure_of_InnerPagesMaps;
				break;
			case "Rewind":
				data_map = common.Rewind_excel_data_map;
				inner_data_map = common.Rewind_Structure_of_InnerPagesMaps;
				break;
			case "CAN":
 				data_map = common.CAN_excel_data_map;
 				inner_data_map = common.CAN_Structure_of_InnerPagesMaps;
 				break;
			}
			String coverName = taxTable_tBody.findElement(By.xpath("tr["+(j+(m+1))+"]/td[1]")).getText();
			String adjustedPremium =  taxTable_tBody.findElement(By.xpath("tr["+(j+(m+1))+"]/td[3]")).getText();
			String iptRate =  taxTable_tBody.findElement(By.xpath("tr["+(j+(m+1))+"]/td[4]")).getText();
			String adjustedTax =  taxTable_tBody.findElement(By.xpath("tr["+(j+(m+1))+"]/td[6]")).getText();
			String description =  taxTable_tBody.findElement(By.xpath("tr["+(j+(m+1))+"]/td[7]")).getText();
			String adjustedBy =  taxTable_tBody.findElement(By.xpath("tr["+(j+(m+1))+"]/td[8]")).getText();
			
			int index = k.getText("BannerName").indexOf("\n");
			String adjustedByName = k.getText("BannerName").substring(0, index);
			//int count = 0;
			int noOfVariableTax = common.no_of_inner_data_sets.get("Variable Tax Adjustment");
			
			if((coverName==null || coverName.isEmpty() || coverName.equalsIgnoreCase("")) && !(description.equalsIgnoreCase("Unadjusted Premium"))){
				for(int p=0;p<variableTaxAdjustmentIDs.get(sectionName);p++){
					if(!inputarraylist.contains(p)){
						int count = 0;
						while(count < noOfVariableTax){
							
							if(description.equalsIgnoreCase((String) variableTaxAdjustmentDataMaps.get(headerNameStorage.get(p)+"_Description"))){
								if(inner_data_map.get("Variable Tax Adjustment").get(count).get("Automation Key").equalsIgnoreCase((String)headerNameStorage.get(p))){
									
									double adjustedPremium_calc = Double.parseDouble(inner_data_map.get("Variable Tax Adjustment").get(count).get("VTA_Premium"));
									double iptRate_calc = Double.parseDouble(inner_data_map.get("Variable Tax Adjustment").get(count).get("VTA_TaxRate"));
									String adjustedTax_calc = common.roundedOff(Double.toString((adjustedPremium_calc * iptRate_calc ) / 100.0));
									
									if(verification(common.roundedOff(adjustedPremium), common.roundedOff((String) variableTaxAdjustmentDataMaps.get(headerNameStorage.get(p)+"_Premium")), sectionName, "Adjusted Premium") &&
									   /*verification(common.roundedOff(iptRate), common.roundedOff((String) variableTaxAdjustmentDataMaps.get(headerNameStorage.get(p)+"_Tax Rate")), sectionName, "IPT Rate") &&*/
									   verification(common.roundedOff(adjustedTax), adjustedTax_calc, sectionName, "Adjusted Tax") &&
									   verification(description, (String) variableTaxAdjustmentDataMaps.get(headerNameStorage.get(p)+"_Description"), sectionName, "Description") &&
									   verification(adjustedBy, adjustedByName, sectionName, "Adjusted By")){
									   
										   inputarraylist.add(p);
										   adjustedTotalTax = adjustedTotalTax + Double.parseDouble(adjustedTax_calc);
										   adjustedTotalPremium = adjustedTotalPremium + adjustedPremium_calc;
										   return 0;
									
									}else{
									   return 1;
									}
								}
								
							}
							count++;
						}
						
					}
				}
			}
			return 0;
		}catch (Throwable t) {
			
			return 1;
		} 
	}
public static int verifyAdjustedTaxCalculationMTA(String sectionName,int j,int m){
	
	try{
		String coverName = taxTable_tBody.findElement(By.xpath("tr["+(j+(m+1))+"]/td[1]")).getText();
		String adjustedPremium =  taxTable_tBody.findElement(By.xpath("tr["+(j+(m+1))+"]/td[3]")).getText();
		String iptRate =  taxTable_tBody.findElement(By.xpath("tr["+(j+(m+1))+"]/td[4]")).getText();
		String adjustedTax =  taxTable_tBody.findElement(By.xpath("tr["+(j+(m+1))+"]/td[6]")).getText();
		String description =  taxTable_tBody.findElement(By.xpath("tr["+(j+(m+1))+"]/td[7]")).getText();
		String adjustedBy =  taxTable_tBody.findElement(By.xpath("tr["+(j+(m+1))+"]/td[8]")).getText();
		
		int index = k.getText("BannerName").indexOf("\n");
		String adjustedByName = k.getText("BannerName").substring(0, index);
		//int count = 0;
		int noOfVariableTax = common.no_of_inner_data_sets.get("Variable Tax Adjustment");
		
		if((coverName==null || coverName.isEmpty() || coverName.equalsIgnoreCase("")) && !(description.equalsIgnoreCase("Unadjusted Premium"))){
			for(int p=0;p<variableTaxAdjustmentIDs.get(sectionName);p++){
				if(!inputarraylistMTA.contains(p)){
					int count = 0;
					while(count < noOfVariableTax){
						
						if(description.equalsIgnoreCase((String) variableTaxAdjustmentDataMapsMTA.get(headerNameStorageMTA.get(p)+"_Description"))){
							if(common.MTA_Structure_of_InnerPagesMaps.get("Variable Tax Adjustment").get(count).get("Automation Key").equalsIgnoreCase((String)headerNameStorageMTA.get(p))){
								
								double adjustedPremium_calc = Double.parseDouble(common.MTA_Structure_of_InnerPagesMaps.get("Variable Tax Adjustment").get(count).get("VTA_Premium"));
								double iptRate_calc = Double.parseDouble(common.NB_Structure_of_InnerPagesMaps.get("Variable Tax Adjustment").get(count).get("VTA_TaxRate"));
								String adjustedTax_calc = common.roundedOff(Double.toString((adjustedPremium_calc * iptRate_calc ) / 100.0));
								
								if(verification(common.roundedOff(adjustedPremium), common.roundedOff((String) variableTaxAdjustmentDataMapsMTA.get(headerNameStorageMTA.get(p)+"_Premium")), sectionName, "Adjusted Premium") &&
								   /*verification(common.roundedOff(iptRate), common.roundedOff((String) variableTaxAdjustmentDataMaps.get(headerNameStorage.get(p)+"_Tax Rate")), sectionName, "IPT Rate") &&*/
								   verification(common.roundedOff(adjustedTax), adjustedTax_calc, sectionName, "Adjusted Tax") &&
								   verification(description, (String) variableTaxAdjustmentDataMapsMTA.get(headerNameStorageMTA.get(p)+"_Description"), sectionName, "Description") &&
								   verification(adjustedBy, adjustedByName, sectionName, "Adjusted By")){
								   
									   inputarraylistMTA.add(p);
									   adjustedTotalTaxMTA = adjustedTotalTaxMTA + Double.parseDouble(adjustedTax_calc);
									   adjustedTotalPremiumMTA = adjustedTotalPremiumMTA + adjustedPremium_calc;
									   return 0;
								
								}else{
								   return 1;
								}
							}
							
						}
						count++;
					}
					
				}
			}
		}
		return 0;
	}catch (Throwable t) {
		
		return 1;
	} 
}

	public static int verifyUnAdjustedTaxCalculation(String sectionName,int j){
		
		try{
			Map<Object,Object> data_map = null;
			Map<String, List<Map<String, String>>> inner_data_map = null;
			
   			switch (common.currentRunningFlow) {
   			case "NB":
				data_map = common.NB_excel_data_map;
				inner_data_map = common.NB_Structure_of_InnerPagesMaps;
				break;
			case "MTA":
				data_map = common.MTA_excel_data_map;
				inner_data_map = common.MTA_Structure_of_InnerPagesMaps;
				break;
			case "Renewal":
				data_map = common.Renewal_excel_data_map;
				inner_data_map = common.Renewal_Structure_of_InnerPagesMaps;
				break;
			case "Requote":
				data_map = common.Requote_excel_data_map;
				inner_data_map = common.Requote_Structure_of_InnerPagesMaps;
				break;
			case "Rewind":
				data_map = common.Rewind_excel_data_map;
				inner_data_map = common.Rewind_Structure_of_InnerPagesMaps;
				break;
			case "CAN":
 				data_map = common.CAN_excel_data_map;
 				inner_data_map = common.CAN_Structure_of_InnerPagesMaps;
 				break;
			}
			for(int m=0;m<=variableTaxAdjustmentIDs.get(sectionName)+1;m++){
				
				if(taxTable_tBody.findElement(By.xpath("tr["+(j+(m+1))+"]/td[1]")).getText().equalsIgnoreCase("Totals")){
					//break Outer;
					break;
				}
				
				String adjustedPremium =  taxTable_tBody.findElement(By.xpath("tr["+(j+(m+1))+"]/td[3]")).getText();
				String iptRate =  taxTable_tBody.findElement(By.xpath("tr["+(j+(m+1))+"]/td[4]")).getText();
				String adjustedTax =  taxTable_tBody.findElement(By.xpath("tr["+(j+(m+1))+"]/td[6]")).getText();
				String description =  taxTable_tBody.findElement(By.xpath("tr["+(j+(m+1))+"]/td[7]")).getText();
				String adjustedBy =  taxTable_tBody.findElement(By.xpath("tr["+(j+(m+1))+"]/td[8]")).getText();
				
				int index = k.getText("BannerName").indexOf("\n");
				String adjustedByName = k.getText("BannerName").substring(0, index);
				
				if(description.equalsIgnoreCase("Unadjusted Premium")){
					if(sectionName.contains("Annual Contract Works")){
						sectionName = "Annual Works";
					}
					if(sectionName.contains("Single Project Contract Works")){
						sectionName = "Single Project";
					}
					//Changed - GrosspremSmryData to NB_excel_data_map for dry run.
					String unAdjustedPremium = common.roundedOff(Double.toString(Double.parseDouble((String)data_map.get("PS_"+sectionName.replaceAll(" ", "")+"_GP")) - adjustedTotalPremium));
					String iptRate_calc =  common.roundedOff(Double.toString(Double.parseDouble((String)data_map.get("PS_IPTRate"))));
					String adjustedTax_calc = common.roundedOff(Double.toString((Double.parseDouble(unAdjustedPremium) * Double.parseDouble(iptRate_calc) ) / 100.0));
					unAdjustedTotalTax = Double.parseDouble(adjustedTax_calc);
					
					if(verification(common.roundedOff(adjustedPremium), unAdjustedPremium, sectionName, "Un Adjusted Premium") &&
					   /*verification(common.roundedOff(iptRate), iptRate_calc, sectionName, "IPT Rate") &&*/
					   verification(common.roundedOff(adjustedTax), adjustedTax_calc, sectionName, "Un Adjusted Tax") &&
					   verification(description, "Unadjusted Premium", sectionName, "Description") &&
					   verification(adjustedByName, adjustedBy, sectionName, "Adjusted By")){
						
						return 0;
					
					}else{
						return 1;
					}
				}
			}
			return 0;
		}catch (Throwable t) {
			
			return 1;
		}
	}
	
	public static int verifyUnAdjustedTaxCalculationMTA(String sectionName,int j){
		
		try{
			
			for(int m=0;m<=variableTaxAdjustmentIDsMTA.get(sectionName)+1;m++){
				
				if(taxTable_tBody.findElement(By.xpath("tr["+(j+(m+1))+"]/td[1]")).getText().equalsIgnoreCase("Totals")){
					//break Outer;
					break;
				}
				
				String adjustedPremium =  taxTable_tBody.findElement(By.xpath("tr["+(j+(m+1))+"]/td[3]")).getText();
				String iptRate =  taxTable_tBody.findElement(By.xpath("tr["+(j+(m+1))+"]/td[4]")).getText();
				String adjustedTax =  taxTable_tBody.findElement(By.xpath("tr["+(j+(m+1))+"]/td[6]")).getText();
				String description =  taxTable_tBody.findElement(By.xpath("tr["+(j+(m+1))+"]/td[7]")).getText();
				String adjustedBy =  taxTable_tBody.findElement(By.xpath("tr["+(j+(m+1))+"]/td[8]")).getText();
				
				int index = k.getText("BannerName").indexOf("\n");
				String adjustedByName = k.getText("BannerName").substring(0, index);
				
				if(description.equalsIgnoreCase("Unadjusted Premium")){
					if(sectionName.contains("Excess of Loss")){
						sectionName = "Property Excess of Loss";
					}
					String unAdjustedPremium = common.roundedOff(Double.toString(Double.parseDouble((String)common.GrosspremSmryData.get("PS_"+sectionName.replaceAll(" ", "")+"_GP")) - adjustedTotalPremium));
					String iptRate_calc =  common.roundedOff(Double.toString(Double.parseDouble((String)common.MTA_excel_data_map.get("PS_IPTRate"))));
					String adjustedTax_calc = common.roundedOff(Double.toString((Double.parseDouble(unAdjustedPremium) * Double.parseDouble(iptRate_calc) ) / 100.0));
					unAdjustedTotalTaxMTA = Double.parseDouble(adjustedTax_calc);
					
					if(verification(common.roundedOff(adjustedPremium), unAdjustedPremium, sectionName, "Un Adjusted Premium") &&
					   /*verification(common.roundedOff(iptRate), iptRate_calc, sectionName, "IPT Rate") &&*/
					   verification(common.roundedOff(adjustedTax), adjustedTax_calc, sectionName, "Un Adjusted Tax") &&
					   verification(description, "Unadjusted Premium", sectionName, "Description") &&
					   verification(adjustedByName, adjustedBy, sectionName, "Adjusted By")){
						
						return 0;
					
					}else{
						return 1;
					}
				}
			}
			return 0;
		}catch (Throwable t) {
			
			return 1;
		}
	}
	public static int verifyGrossTaxCalculation(String sectionName,int j,String code , String event){
		
		Map<Object,Object> data_map = null;
		Map<String, List<Map<String, String>>> inner_data_map = null;
		
			switch (common.currentRunningFlow) {
			case "NB":
			data_map = common.NB_excel_data_map;
			inner_data_map = common.NB_Structure_of_InnerPagesMaps;
			break;
		case "MTA":
			data_map = common.MTA_excel_data_map;
			inner_data_map = common.MTA_Structure_of_InnerPagesMaps;
			break;
		case "Renewal":
			data_map = common.Renewal_excel_data_map;
			inner_data_map = common.Renewal_Structure_of_InnerPagesMaps;
			break;
		case "Requote":
			data_map = common.Requote_excel_data_map;
			inner_data_map = common.Requote_Structure_of_InnerPagesMaps;
			break;
		case "Rewind":
			data_map = common.Rewind_excel_data_map;
			inner_data_map = common.Rewind_Structure_of_InnerPagesMaps;
			break;
		case "CAN":
				data_map = common.CAN_excel_data_map;
				inner_data_map = common.CAN_Structure_of_InnerPagesMaps;
				break;
		}
		String grossPremium =  common.roundedOff(taxTable_tBody.findElement(By.xpath("tr["+(j+1)+"]/td[2]")).getText());
		String iptRate =  taxTable_tBody.findElement(By.xpath("tr["+(j+1)+"]/td[4]")).getText();
		String grossTax =  common.roundedOff(taxTable_tBody.findElement(By.xpath("tr["+(j+1)+"]/td[5]")).getText());
		String colName = (String)data_map.get("Automation Key");
		if(sectionName.contains("Annual Contract Works")){
			sectionName = "Annual Works";
		}
		if(sectionName.contains("Single Project Contract Works")){
			sectionName = "Single Project";
		}
		String trimmedSectionName = sectionName.replaceAll(" ", "");
		//Changed - GrosspremSmryData to NB_excel_data_map for dry run.
		String finalGrossPremium = common.roundedOff((String)data_map.get("PS_"+trimmedSectionName+"_GP"));
		String finalGrossTax,finalIPTRate,finalNetPremiumTax = null;
		if(inputarraylist.size()!=0){
			finalGrossTax = common.roundedOff(Double.toString(unAdjustedTotalTax +  adjustedTotalTax));
			finalIPTRate = Double.toString(((Double.parseDouble(finalGrossTax) /Double.parseDouble(finalGrossPremium)) * 100.0 ));
		}else{
			//Changed - GrosspremSmryData to NB_excel_data_map for dry run.
			finalGrossTax = common.roundedOff(Double.toString((Double.parseDouble((String)data_map.get("PS_"+trimmedSectionName+"_GP")) * ((Double.parseDouble(iptRate) / 100.0)))));
			finalIPTRate = iptRate;
		}
		
		common.totalGrossTax = common.totalGrossTax + Double.parseDouble(finalGrossTax);
		common.totalGrossPremium = common.totalGrossPremium + Double.parseDouble(finalGrossPremium);
		
		//This will store individual data of adjustment tax screen.
		data_map.put("PS_"+sectionName.replaceAll(" ", "")+"_GT", finalGrossTax);
		data_map.put("PS_"+sectionName.replaceAll(" ", "")+"_IPT", finalIPTRate);
		
		TestUtil.WriteDataToXl(code+"_"+event, "Premium Summary",colName, "PS_"+sectionName.replaceAll(" ", "")+"_GT", finalGrossTax, data_map);
		TestUtil.WriteDataToXl(code+"_"+event, "Premium Summary",colName, "PS_"+sectionName.replaceAll(" ", "")+"_IPT", finalIPTRate, data_map);
		
		//finalNetPremiumTax = common.roundedOff(Double.toString((Double.parseDouble((String)common.NB_excel_data_map.get("PS_"+sectionName.replaceAll(" ", "")+"_NP")) * Double.parseDouble((String)common.NB_excel_data_map.get("PS_"+sectionName.replaceAll(" ", "")+"_IPT"))) / 100.0 ));
		
		//common.totalNetPremiumTax = common.totalNetPremiumTax + Double.parseDouble(finalNetPremiumTax);
		//TestUtil.WriteDataToXl(code+"_"+event, "Premium Summary",colName, "PS_"+sectionName.replaceAll(" ", "")+"_NPIPT", finalNetPremiumTax, common.NB_excel_data_map);
		
		grossTaxValues_Map.put(sectionName, Double.parseDouble(finalGrossTax));
		
		if(verification(grossPremium,finalGrossPremium,sectionName,"Gross Premium") && 
				verification(grossTax,finalGrossTax,sectionName,"Gross Tax") 
				/*&& verification(iptRate,finalIPTRate,sectionName,"IPT Rate")*/){
			TestUtil.reportStatus("[<b>  "+sectionName+"  </b>]  cover --- Verified Gross Premium is :  <b>[ "+finalGrossPremium+" ]</b> , IPT Rate is :  <b>[ "+finalIPTRate+" ]</b> , Gross Tax is :  <b>[ "+finalGrossTax+" ]</b> ", "PASS", false);
			return 0;
		}else{
			return 1;
		}
	}
public static int verifyGrossTaxCalculationMTA(String sectionName,int j,String code , String event){
		
		
		String grossPremium =  common.roundedOff(taxTable_tBody.findElement(By.xpath("tr["+(j+1)+"]/td[2]")).getText());
		String iptRate =  taxTable_tBody.findElement(By.xpath("tr["+(j+1)+"]/td[4]")).getText();
		String grossTax =  common.roundedOff(taxTable_tBody.findElement(By.xpath("tr["+(j+1)+"]/td[5]")).getText());
		String colName = (String)common.MTA_excel_data_map.get("Automation Key");
		if(sectionName.contains("Excess of Loss")){
			sectionName = "Property Excess of Loss";
		}
		String trimmedSectionName = sectionName.replaceAll(" ", "");
		
		String finalGrossPremium = common.roundedOff((String)common.GrosspremSmryData.get("PS_"+trimmedSectionName+"_GP"));
		String finalGrossTax,finalIPTRate,finalNetPremiumTax = null;
		if(inputarraylistMTA.size()!=0){
			finalGrossTax = common.roundedOff(Double.toString(unAdjustedTotalTaxMTA +  adjustedTotalTaxMTA));
			finalIPTRate = Double.toString(((Double.parseDouble(finalGrossTax) /Double.parseDouble(finalGrossPremium)) * 100.0 ));
		}else{
			finalGrossTax = common.roundedOff(Double.toString((Double.parseDouble((String)common.GrosspremSmryData.get("PS_"+trimmedSectionName+"_GP")) * ((Double.parseDouble((String)common.MTA_excel_data_map.get("PS_IPTRate")) / 100.0)))));
			finalIPTRate = (String)common.MTA_excel_data_map.get("PS_IPTRate");
		}
		
		common.totalGrossTaxMTA = common.totalGrossTaxMTA + Double.parseDouble(finalGrossTax);
		common.totalGrossPremiumMTA = common.totalGrossPremiumMTA + Double.parseDouble(finalGrossPremium);
		
		
		TestUtil.WriteDataToXl(code+"_"+event, "Premium Summary",colName, "PS_"+sectionName.replaceAll(" ", "")+"_GT", finalGrossTax, common.MTA_excel_data_map);
		TestUtil.WriteDataToXl(code+"_"+event, "Premium Summary",colName, "PS_"+sectionName.replaceAll(" ", "")+"_IPT", finalIPTRate, common.MTA_excel_data_map);
		
		finalNetPremiumTax = common.roundedOff(Double.toString((Double.parseDouble((String)common.MTA_excel_data_map.get("PS_"+sectionName.replaceAll(" ", "")+"_NP")) * Double.parseDouble((String)common.MTA_excel_data_map.get("PS_"+sectionName.replaceAll(" ", "")+"_IPT"))) / 100.0 ));
		
		common.totalNetPremiumTaxMTA = common.totalNetPremiumTaxMTA + Double.parseDouble(finalNetPremiumTax);
		TestUtil.WriteDataToXl(code+"_"+event, "Premium Summary",colName, "PS_"+sectionName.replaceAll(" ", "")+"_NPIPT", finalNetPremiumTax, common.MTA_excel_data_map);
		
		grossTaxValues_Map.put(sectionName, Double.parseDouble(finalGrossTax));
		
		if(verification(grossPremium,finalGrossPremium,sectionName,"Gross Premium") && 
				verification(grossTax,finalGrossTax,sectionName,"Gross Tax") 
				/*&& verification(iptRate,finalIPTRate,sectionName,"IPT Rate")*/){
			TestUtil.reportStatus("[<b>  "+sectionName+"  </b>]  cover --- Verified Gross Premium is :  <b>[ "+finalGrossPremium+" ]</b> , IPT Rate is :  <b>[ "+finalIPTRate+" ]</b> , Gross Tax is :  <b>[ "+finalGrossTax+" ]</b> ", "PASS", false);
			return 0;
		}else{
			return 1;
		}
	}
	
	public static boolean verification(String actualValue,String expectedValue,String sectionName,String description){
		
		if(description.equalsIgnoreCase("Gross Tax") || (description.equalsIgnoreCase("Gross Premium"))){
			double actVal = Double.parseDouble(actualValue);
			double expVal = Double.parseDouble(expectedValue);
			double diffrence = actVal - expVal;
			
			if(diffrence<=0.05 && diffrence>=-0.05){
				return true;
			}else{
				TestUtil.reportStatus("Mistmatch in "+description+" for [<b>  "+sectionName+"  </b>]  cover ---  Expected "+description+" is :  <b>[ "+expectedValue+" ]</b> and Actual "+description+" on Stingray application is : <b>[ "+actualValue+" ]</b>", "Fail", false);
				return false;
			}
		}else{
			if(actualValue.equalsIgnoreCase(expectedValue)){
				return true;
			}else{
				TestUtil.reportStatus("Mistmatch in "+description+" for [<b>  "+sectionName+"  </b>]  cover ---  Expected "+description+" is :  <b>[ "+expectedValue+" ]</b> and Actual "+description+" on Stingray application is : <b>[ "+actualValue+" ]</b>", "Fail", false);
				return false;
			}
		}
		
		
	}
	
	
	//Rounded off function.
       public String roundedOff(String number) {
           
    	   if(number.contains(".")){
    		   String replacedString = number.replace(".", ",");
               String[] stringArray = replacedString.split(",");
               if(stringArray[1].length()==2){
                     if(String.valueOf(stringArray[1]).contains("0")){
                            double pasredNumber = Double.parseDouble(number);
                            String pasredNumber_rf = f.format(pasredNumber);
                            return pasredNumber_rf;
                     }
                     else{
                    	 	if(stringArray[0].length()==1){
                    	 		double pasredNumber = Double.parseDouble(number);
                                String pasredNumber_rf = f.format(pasredNumber);
                                return pasredNumber_rf;
                    	 	}else{
                    	 		double pasredNumber = Double.parseDouble(number);
                                return Double.toString(pasredNumber);
                    	 	}
                     }
               }else if(stringArray[1].length()==3){
                     char c = stringArray[1].charAt(stringArray[1].length()-1);
                     if(c=='5'){
                            double formatedNumber = Double.parseDouble(number) + 0.005;
                     String roundedNumber = f.format(formatedNumber);
                     return roundedNumber;
                     }else{
                            String roundedNumber = f.format(Double.parseDouble(number));
                     return roundedNumber;
                     }
               }else{
                   String formatedNumber = f.format(Double.parseDouble(number));
                   return formatedNumber;
               }
    	   }
    	   else{
    		   String formatedNumber = f.format(Double.parseDouble(number));
               return formatedNumber;
    	   }
     }
       
   /**
   	 * This method validates post code pattern for given post code .
   	 * 
   	*/
       public boolean validatePostCode(String postCode){
    	   
    	   boolean result=true;
    	   try{
    		   //ME16 0CD
    		   result = Pattern.matches("[a-zA-Z]{2}[0-9]{2} [0-9]{1}[a-zA-Z]{2}", postCode);
    	   }catch(Throwable t){
    		   System.out.println("Error while validating Post Code"+t.getMessage());
    		   result=false;
    	   }   
    	   
    	   return result;
       }
	
	
     public boolean transactionSummary(String fileName,String testName,String event,String code){
   		Boolean retvalue = true;  
   		try{
   			Map<Object,Object> data_map = null;
			
   			switch (common.currentRunningFlow) {
   			case "NB":
				data_map = common.NB_excel_data_map;
				break;
			case "MTA":
				data_map = common.MTA_excel_data_map;
				break;
			case "Renewal":
				data_map = common.Renewal_excel_data_map;
				break;
			case "Requote":
				data_map = common.Requote_excel_data_map;
				break;
			case "Rewind":
				data_map = common.Rewind_excel_data_map;
				break;
			case "CAN":
 				data_map = common.NB_excel_data_map;
 				break;
			}
   			customAssert.assertTrue(common.funcMenuSelection("Navigate", "Transaction Summary"), "Navigation problem to Transaction Summary page .");
   			
   			Assert.assertEquals(k.getText("Page_Header"),"Transaction Summary", "Not on Transaction Summary Page.");
   			String part1= "//*[@id='table0']/tbody";
   			String covername = null,exit = "";
   			int td=0;
   			WebElement table = driver.findElement(By.xpath(part1));
   			List<WebElement> list = table.findElements(By.tagName("tr"));
   			outer:
   			for(int i=1;i<list.size();i++){
   				String trasacSummaryType = driver.findElement(By.xpath(part1+"/tr["+i+"]/td[1]")).getText();
   				double Total =0.00;
   				String ExpecteDueDate = "";
   				if(common.currentRunningFlow.equalsIgnoreCase("Requote")){
   					trasacSummaryType="ReQuote Summary";
   				}
   				switch (trasacSummaryType) {
   				case "New Business" : 
   					
   					TestUtil.reportStatus("Verification Started on Transaction Summary page "+trasacSummaryType+" . ", "PASS", false);
   					
   					String ActualDueDate = driver.findElement(By.xpath(part1+"/tr["+i+"]/td[4]")).getText();
   					
   					if(data_map.get("PS_PaymentWarrantyRules").equals("Yes")){
   					ExpecteDueDate = data_map.get("PS_PaymentWarrantyDueDate").toString();	
   					}else{
   					ExpecteDueDate = common.getLastDayOfMonth((String)common.NB_excel_data_map.get("QuoteDate"), 1);
   					}
   					
   					if(ActualDueDate.equalsIgnoreCase(ExpecteDueDate)){
      					 String tMsg="Actual Due Date: <b> [  "+ActualDueDate+"  ] </b>  has been matched with Expected Due Date: <b> [  "+ExpecteDueDate;
      					 TestUtil.reportStatus(tMsg, "Pass", false);
      					}
      					else{
      	   					 String tMsg="Actual Due Date: <b> [  "+ActualDueDate+"  ] </b>  does not matche with Expected Due Date: <b> [  "+ExpecteDueDate;
      	   					 TestUtil.reportStatus(tMsg, "Fail", false);
      					}
   					String ActualTransationDate = driver.findElement(By.xpath(part1+"/tr["+i+"]/td[3]")).getText();
   					String ExpecteTransactionDate = (String)common.NB_excel_data_map.get("QuoteDate");
   					if(ActualTransationDate.equalsIgnoreCase(ExpecteTransactionDate)){
      					 String tMsg="Actual Transaction Date: <b> [  "+ActualTransationDate+"  ] </b> has been matched with Expected Transaction Date: <b> [  "+ExpecteTransactionDate+"  ] </b> ";
      					 TestUtil.reportStatus(tMsg, "Pass", false);
      					}
      					else{
      	   					 String tMsg="Actual Transaction Date:<b> [  "+ActualTransationDate+"  ] </b>  does not matche with Expected Transaction Date: <b> [  "+ExpecteTransactionDate+"  ] </b> ";
      	   					 TestUtil.reportStatus(tMsg, "Fail", false);
      					}
   					
   					
   					for(int j=i;!exit.equalsIgnoreCase("Total");j++){
   						String transactSumVal = driver.findElement(By.xpath(part1+"/tr["+j+"]/td[1]")).getText();
   						exit = driver.findElement(By.xpath(part1+"/tr["+j+"]/td[2]")).getText();
   						if(exit.equalsIgnoreCase("Total")){
   	   						i=j;
   	   						String actualTotal = driver.findElement(By.xpath(part1+"/tr["+j+"]/td[4]")).getText();  
   	   						compareValues(Double.parseDouble(actualTotal), Double.parseDouble(common.roundedOff(Double.toString(Total))), "Transaction Summary Total");
   	   						customAssert.assertTrue(WriteDataToXl(event+"_NB", "Transaction Summary", (String)common.NB_excel_data_map.get("Automation Key"), "TS_TransactionSummaryTotal", actualTotal,common.NB_excel_data_map),"Error while writing Transaction Summary data to excel .");

   	   						break outer;
   	   						}
   						if(transactSumVal.isEmpty()){
   							covername= driver.findElement(By.xpath(part1+"/tr["+j+"]/td[6]")).getText();
   							td=8;
   						}else{ 
   							covername= driver.findElement(By.xpath(part1+"/tr["+j+"]/td[9]")).getText();
   							td=11;
   						}
   						if(covername.equalsIgnoreCase("Public & Products Liability")){
   							double PublicAndProductsLiability= calculatepublicAndProductsLiabilityTS(code, data_map, trasacSummaryType,j,td);	
   							Total = Total + PublicAndProductsLiability;
   						}
   						else if(covername.equalsIgnoreCase("Employers Liability")){
   							double EmployersLiability = calculateEmployersLiabilityTS(code,data_map,trasacSummaryType,j,td);
   							Total = Total + EmployersLiability;
   						}
   						else if(covername.equalsIgnoreCase("Annual Contract Works")){
   							double AnnualContractWorks = calculateAnnualContractWorksTS(code,data_map, trasacSummaryType,j,td);
   							Total = Total + AnnualContractWorks;
   						}
   						else if(covername.equalsIgnoreCase("Single Project Contract Works")){
   							double SingleProject = calculateSingleProjectContractWorksTS(code,data_map,trasacSummaryType,j,td);	
   							Total = Total + SingleProject;
   						}
   						else if(covername.equalsIgnoreCase("Own Plant")){
   							double OwnPlant = calculateOwnPlantTS(code,data_map, trasacSummaryType,j,td);
   							Total = Total + OwnPlant;
   						}
   						else if(covername.equalsIgnoreCase("Hired In Plant")){
   							double HireInPlants = calculateHiredInPlantTS(code,data_map, trasacSummaryType,j,td);	
   							Total = Total + HireInPlants;
   						}
   						else if(covername.equalsIgnoreCase("Combined Liability")){
   							double HireInPlants = calculateCombinedLiabilityTS(code,data_map, trasacSummaryType,j,td);	
   							Total = Total + HireInPlants;
   						}
   						else if(covername.equalsIgnoreCase("Third Party Motor Liability")){
   							double HireInPlants = calculateThirdPartyMotorLiabilityTS(code,data_map, trasacSummaryType,j,td);	
   							Total = Total + HireInPlants;
   						}
   						else if(covername.equalsIgnoreCase("Hire Cover Plus")){
   							double HireCoverPlus = calculateHireCoverPlusTS(code,data_map, trasacSummaryType,j,td);	
   							Total = Total + HireCoverPlus;
   						}
   						else if(covername.equalsIgnoreCase("JCT 6.5.1")){
   							double JCT651 = calculateJCT651TS(code,data_map,trasacSummaryType,j,td);	
   							Total = Total + JCT651;
   						}
   						else if(covername.equalsIgnoreCase("Terrorism")){
   							double Terrorism = calculateTerrorismTS(code,data_map,trasacSummaryType,j,td);	
   							Total = Total + Terrorism;
   						}
   						else if(covername.equalsIgnoreCase("Property Owners Liability")){
   							double PropertyOwnersLiability = calculatePropertyOwnersLiabilityTS(code,data_map,trasacSummaryType,j,td);	
   							Total = Total + PropertyOwnersLiability;
   						}
   						else if(covername.equalsIgnoreCase("Legal Expenses")){
   							double LegalExpenses = calculateLegalExpensesTS(code,data_map,trasacSummaryType,j,td);	
   							Total = Total + LegalExpenses;
   						}
   						else if(covername.isEmpty()){
   							
   							//CNA Insurance Co. Ltd
   							String recipient = driver.findElement(By.xpath(part1+"/tr["+j+"]/td[6]")).getText();
   							if(recipient.contains("CNA Insurance Co. Ltd") || recipient.contains("QBE Insurance (Europe) Limited")){
   								Total = Total + calculateCombinedLiabilityTS(code,data_map,trasacSummaryType,j,td);
   							}else if(recipient.contains("Markel International Insurance Co. Ltd")){
   								Total = Total + calculateLegalExpensesTS(code,data_map,trasacSummaryType,j,td);
   							}else{
   								double general = calculateBrokeageAmountTS(code,data_map,trasacSummaryType,j,td);
   								Total = Total + general;
   							}
   						}
   					}
   					break;
   				case "Amended Endorsement" : //MTA Rewind
   					
   					TestUtil.reportStatus("Verification Started on Transaction Summary page "+trasacSummaryType+"  . ", "Info", false);
   					for(int j=i;!exit.equalsIgnoreCase("Total");j++){
   						String transactSumVal = driver.findElement(By.xpath(part1+"/tr["+j+"]/td[1]")).getText();
   						exit = driver.findElement(By.xpath(part1+"/tr["+j+"]/td[2]")).getText();
   						if(exit.equalsIgnoreCase("Total")){
   	   						i=j;
   	   						String actualTotal = driver.findElement(By.xpath(part1+"/tr["+j+"]/td[4]")).getText();  
   	   						CommonFunction.compareValues(Double.parseDouble(actualTotal), Double.parseDouble(common.roundedOff(Double.toString(Total))), "Transaction Summary Total");
   	   						customAssert.assertTrue(WriteDataToXl(event+"_MTA", "Transaction Summary", (String)common.MTA_excel_data_map.get("Automation Key"), "TS_TransactionSummaryTotal", actualTotal,common.MTA_excel_data_map),"Error while writing Transaction Summary data to excel .");

   	   						break outer;
   	   						}
   						
   						if(transactSumVal.equalsIgnoreCase("")){
   							covername= driver.findElement(By.xpath(part1+"/tr["+j+"]/td[6]")).getText();
   	   						td=8;
   						}else{
   							covername= driver.findElement(By.xpath(part1+"/tr["+j+"]/td[9]")).getText();
   	   						td=11;
   						}
   						if(covername.equalsIgnoreCase("Public & Products Liability")){
   							double PublicAndProductsLiability= calculatepublicAndProductsLiabilityTS(code, data_map, trasacSummaryType,j,td);	
   							Total = Total + PublicAndProductsLiability;
   						}
   						else if(covername.equalsIgnoreCase("Employers Liability")){
   							double EmployersLiability = calculateEmployersLiabilityTS(code,data_map,trasacSummaryType,j,td);
   							Total = Total + EmployersLiability;
   						}
   						else if(covername.equalsIgnoreCase("Annual Contract Works")){
   							double AnnualContractWorks = calculateAnnualContractWorksTS(code,data_map, trasacSummaryType,j,td);
   							Total = Total + AnnualContractWorks;
   						}
   						else if(covername.equalsIgnoreCase("Single Project Contract Works")){
   							double SingleProject = calculateSingleProjectContractWorksTS(code,data_map,trasacSummaryType,j,td);	
   							Total = Total + SingleProject;
   						}
   						else if(covername.equalsIgnoreCase("Own Plant")){
   							double OwnPlant = calculateOwnPlantTS(code,data_map, trasacSummaryType,j,td);
   							Total = Total + OwnPlant;
   						}
   						else if(covername.equalsIgnoreCase("Hired In Plant")){
   							double HireInPlants = calculateHiredInPlantTS(code,data_map, trasacSummaryType,j,td);	
   							Total = Total + HireInPlants;
   						}
   						else if(covername.equalsIgnoreCase("Combined Liability")){
   							double HireInPlants = calculateCombinedLiabilityTS(code,data_map, trasacSummaryType,j,td);	
   							Total = Total + HireInPlants;
   						}
   						else if(covername.equalsIgnoreCase("Third Party Motor Liability")){
   							double HireInPlants = calculateThirdPartyMotorLiabilityTS(code,data_map, trasacSummaryType,j,td);	
   							Total = Total + HireInPlants;
   						}
   						else if(covername.equalsIgnoreCase("Hire Cover Plus")){
   							double HireCoverPlus = calculateHireCoverPlusTS(code,data_map, trasacSummaryType,j,td);	
   							Total = Total + HireCoverPlus;
   						}
   						else if(covername.equalsIgnoreCase("JCT 6.5.1")){
   							double JCT651 = calculateJCT651TS(code,data_map,trasacSummaryType,j,td);	
   							Total = Total + JCT651;
   						}
   						else if(covername.equalsIgnoreCase("Terrorism")){
   							double Terrorism = calculateTerrorismTS(code,data_map,trasacSummaryType,j,td);	
   							Total = Total + Terrorism;
   						}
   						else if(covername.equalsIgnoreCase("Property Owners Liability")){
   							double PropertyOwnersLiability = calculatePropertyOwnersLiabilityTS(code,data_map,trasacSummaryType,j,td);	
   							Total = Total + PropertyOwnersLiability;
   						}
   						else if(covername.equalsIgnoreCase("Legal Expenses")){
   							double LegalExpenses = calculateLegalExpensesTS(code,data_map,trasacSummaryType,j,td);	
   							Total = Total + LegalExpenses;
   						}
   						else if(covername.isEmpty()){
   							
   					/*		//CNA Insurance Co. Ltd
   							String recipient = "";
   							
   							if(common_COB.MTARewindFlow.equalsIgnoreCase("Yes")){
   								recipient = driver.findElement(By.xpath(part1+"/tr["+j+"]/td[3]")).getText();
   							}else{
   								recipient = driver.findElement(By.xpath(part1+"/tr["+j+"]/td[6]")).getText();
   							}
   							
   							if(recipient.contains("CNA Insurance Co. Ltd") || recipient.contains("QBE Insurance (Europe) Limited")){
   								
   								if(TestBase.product.contains("COB")&& common_COB.MTARewindFlow.equalsIgnoreCase("Yes")){
   									String s_Section =  driver.findElement(By.xpath(part1+"/tr["+j+"]/td[6]")).getText();
   									String s_Type =  driver.findElement(By.xpath(part1+"/tr["+j+"]/td[7]")).getText();
   									
   									if(s_Section.length()<1 && s_Type.contains("PREMIUM") ){
   										// Calculate premiumAmount for removed covers :
   										double general = calculateMiunsPremium(code,data_map,trasacSummaryType,j,td);
		   								Total = Total + general;
   									}else{   										
		   								double general = calculateBrokeageAmountTS(code,data_map,trasacSummaryType,j,td);
		   								Total = Total + general;
   		   							}
   								}else{
   									
	   								if(data_map.get("CD_CombinedLiability").equals("Yes"))
	   									Total = Total + calculateCombinedLiabilityTS(code,data_map,trasacSummaryType,j,td);
	   								else if(data_map.get("CD_ThirdPartyMotorLiability").equals("Yes"))
										Total = Total + calculateThirdPartyMotorLiabilityTS(code,data_map,trasacSummaryType,j,td);
	   								else if(data_map.get("CD_Public&ProductsLiability").equals("Yes"))
										Total = Total + calculatepublicAndProductsLiabilityTS(code,data_map,trasacSummaryType,j,td);
	   								else if(data_map.get("CD_EmployersLiability").equals("Yes"))
										Total = Total + calculateEmployersLiabilityTS(code,data_map,trasacSummaryType,j,td);
	   								else if(data_map.get("CD_JCT6.5.1").equals("Yes"))
										Total = Total + calculateJCT651TS(code,data_map,trasacSummaryType,j,td);
		   							else if(recipient.contains("Markel International Insurance Co. Ltd")){
		   								Total = Total + calculateLegalExpensesTS(code,data_map,trasacSummaryType,j,td);
		   							}else{
		   								double general = calculateBrokeageAmountTS(code,data_map,trasacSummaryType,j,td);
		   								Total = Total + general;
		   							}
	   							}
	   						}else{
	   							double general = calculateBrokeageAmountTS(code,data_map,trasacSummaryType,j,td);
   								Total = Total + general;
	   						}*/
   						
   						//CNA Insurance Co. Ltd
	   							String recipient = driver.findElement(By.xpath(part1+"/tr["+j+"]/td[6]")).getText();
	   							if(recipient.contains("CNA Insurance Co. Ltd") || recipient.contains("QBE Insurance (Europe) Limited")){
	   								Total = Total + calculateCombinedLiabilityTS(code,data_map,trasacSummaryType,j,td);
	   							}else if(recipient.contains("Markel International Insurance Co. Ltd")){
	   								Total = Total + calculateLegalExpensesTS(code,data_map,trasacSummaryType,j,td);
	   							}else{
	   								double general = calculateBrokeageAmountTS(code,data_map,trasacSummaryType,j,td);
	   								Total = Total + general;
	   							}
   						
   						}
   					}
   					break;
   						
   				case "Endorsement" : 
   					
   					TestUtil.reportStatus("Verification Started on Transaction Summary page "+trasacSummaryType+" . ", "PASS", false);
   					ActualDueDate = driver.findElement(By.xpath(part1+"/tr["+i+"]/td[4]")).getText();
   					ExpecteDueDate = common.getLastDayOfMonth((String)common.MTA_excel_data_map.get("MTA_EffectiveDate"), 1);
   					
   					if(ActualDueDate.equalsIgnoreCase(ExpecteDueDate)){
      					 String tMsg="Actual Due Date : <b>[  "+ActualDueDate+"  ]</b> has been matched with Expected Due Date : <b>[  "+ExpecteDueDate+"  ]</b>";
      					 TestUtil.reportStatus(tMsg, "Pass", false);
      					}
      					else{
      	   					 String tMsg="Actual Due Date : <b>[  "+ActualDueDate+"  ]</b> does not matche with Expected Due Date : <b>[   "+ExpecteDueDate+"  ]</b>";
      	   					 TestUtil.reportStatus(tMsg, "Fail", false);
      					}
   					ActualTransationDate = driver.findElement(By.xpath(part1+"/tr["+i+"]/td[3]")).getText();
   					if(TestBase.businessEvent.equals("Renewal")){
   						ExpecteTransactionDate = (String)common.Renewal_excel_data_map.get("QuoteDate");
   					}else{
   						ExpecteTransactionDate = (String)common.NB_excel_data_map.get("QuoteDate");
   					}
   					if(ActualTransationDate.equalsIgnoreCase(ExpecteTransactionDate)){
      					 String tMsg="Actual Transaction Date : <b>[  "+ActualTransationDate+"  ]</b> has been matched with Expected Transaction Date : <b>[  "+ExpecteTransactionDate+"  ]</b>";
      					 TestUtil.reportStatus(tMsg, "Pass", false);
      					}
      					else{
      	   					 String tMsg="Actual Transaction Date : <b>[  "+ActualTransationDate+"  ]</b> does not matche with Expected Transaction Date : <b>[  "+ExpecteTransactionDate+"  ]</b>";
      	   					 TestUtil.reportStatus(tMsg, "Fail", false);
      					}
   					
   					if(TestBase.product.equalsIgnoreCase("COB")||TestBase.product.equalsIgnoreCase("XOC")||TestBase.product.equalsIgnoreCase("XOQ")){
   						for(int j=i;!exit.equalsIgnoreCase("Total");j++){
   	   						String transactSumVal = driver.findElement(By.xpath(part1+"/tr["+j+"]/td[1]")).getText();
   	   						exit = driver.findElement(By.xpath(part1+"/tr["+j+"]/td[2]")).getText();
   	   						if(exit.equalsIgnoreCase("Total")){
   	   	   						i=j;
   	   	   						String actualTotal = driver.findElement(By.xpath(part1+"/tr["+j+"]/td[4]")).getText();  
   	   	   						compareValues(Double.parseDouble(actualTotal), Double.parseDouble(common.roundedOff(Double.toString(Total))), "Transaction Summary Total");
   	   	   						WriteDataToXl(event+"_MTA", "Transaction Summary", (String)common.MTA_excel_data_map.get("Automation Key"), "TS_TransactionSummaryTotal", actualTotal,common.MTA_excel_data_map);

   	   	   						PL_FP = false;
   	   	   						EL_FP = false;
   	   	   						AW_FP = false;
   	   	   						SP_FP = false;
   	   	   						OP_FP = false;
   	   	   						HIP_FP = false;
   	   	   						JCT_FP = false;
   	   	   						TER_FP = false;
   	   	   						POL_FP = false;
   	   	   						LE_FP = false;
   	   	   						
   	   	   						break outer;
   	   	   						}
   	   						if(transactSumVal.isEmpty()){
   	   							covername= driver.findElement(By.xpath(part1+"/tr["+j+"]/td[6]")).getText();
   	   							td=8;
   	   						}else{ 
   	   							covername= driver.findElement(By.xpath(part1+"/tr["+j+"]/td[9]")).getText();
   	   							td=11;
   	   						}
   	   						if(covername.equalsIgnoreCase("Public & Products Liability")){
   	   							double PublicAndProductsLiability= calculatepublicAndProductsLiabilityTS(code, data_map, trasacSummaryType,j,td);	
   	   							Total = Total + PublicAndProductsLiability;
   	   							PL_FP = true;
   	   						}
   	   						else if(covername.equalsIgnoreCase("Employers Liability")){
   	   							double EmployersLiability = calculateEmployersLiabilityTS(code,data_map,trasacSummaryType,j,td);
   	   							Total = Total + EmployersLiability;
   	   							EL_FP = true;
   	   						}
   	   						else if(covername.equalsIgnoreCase("Annual Contract Works")){
   	   							double AnnualContractWorks = calculateAnnualContractWorksTS(code,data_map, trasacSummaryType,j,td);
   	   							Total = Total + AnnualContractWorks;
   	   							AW_FP = true;
   	   						}
   	   						else if(covername.equalsIgnoreCase("Single Project Contract Works")){
   	   							double SingleProject = calculateSingleProjectContractWorksTS(code,data_map,trasacSummaryType,j,td);	
   	   							Total = Total + SingleProject;
   	   							SP_FP = true;
   	   						}
   	   						else if(covername.equalsIgnoreCase("Own Plant")){
   	   							double OwnPlant = calculateOwnPlantTS(code,data_map, trasacSummaryType,j,td);
   	   							Total = Total + OwnPlant;
   	   							OP_FP = true;
   	   						}
   	   						else if(covername.equalsIgnoreCase("Hired In Plant")){
   	   							double HireInPlants = calculateHiredInPlantTS(code,data_map, trasacSummaryType,j,td);	
   	   							Total = Total + HireInPlants;
   	   							HIP_FP = true;
   	   						}
   	   						else if(covername.equalsIgnoreCase("Combined Liability")){
   	   							double HireInPlants = calculateCombinedLiabilityTS(code,data_map, trasacSummaryType,j,td);	
   	   							Total = Total + HireInPlants;
   	   						}
   	   						else if(covername.equalsIgnoreCase("Third Party Motor Liability")){
   	   							double HireInPlants = calculateThirdPartyMotorLiabilityTS(code,data_map, trasacSummaryType,j,td);	
   	   							Total = Total + HireInPlants;
   	   						}
   	   						else if(covername.equalsIgnoreCase("Hire Cover Plus")){
   	   							double HireCoverPlus = calculateHireCoverPlusTS(code,data_map, trasacSummaryType,j,td);	
   	   							Total = Total + HireCoverPlus;
   	   							HCP_FP = true;
   	   						}
   	   						else if(covername.equalsIgnoreCase("JCT 6.5.1")){
   	   							double JCT651 = calculateJCT651TS(code,data_map,trasacSummaryType,j,td);	
   	   							Total = Total + JCT651;
   	   							JCT_FP = true;
   	   						}
   	   						else if(covername.equalsIgnoreCase("Terrorism")){
   	   							double Terrorism = calculateTerrorismTS(code,data_map,trasacSummaryType,j,td);	
   	   							Total = Total + Terrorism;
   	   							TER_FP = true;
   	   						}
   	   						else if(covername.equalsIgnoreCase("Property Owners Liability")){
   	   							double PropertyOwnersLiability = calculatePropertyOwnersLiabilityTS(code,data_map,trasacSummaryType,j,td);	
   	   							Total = Total + PropertyOwnersLiability;
   	   							POL_FP = true;
   	   						}
   	   						else if(covername.equalsIgnoreCase("Legal Expenses")){
   	   							double LegalExpenses = calculateLegalExpensesTS(code,data_map,trasacSummaryType,j,td);	
   	   							Total = Total + LegalExpenses;
   	   							LE_FP = true;
   	   						}
   	   						else if(covername.isEmpty()){
   	   							
   	   							//CNA Insurance Co. Ltd
   	   							String recipient = driver.findElement(By.xpath(part1+"/tr["+j+"]/td[6]")).getText();
   	   							if(recipient.contains("CNA Insurance Co. Ltd") || recipient.contains("QBE Insurance (Europe) Limited")){
   	   								Total = Total + calculateCombinedLiabilityTS(code,data_map,trasacSummaryType,j,td);
   	   							}else if(recipient.contains("Markel International Insurance Co. Ltd")){
   	   								Total = Total + calculateLegalExpensesTS(code,data_map,trasacSummaryType,j,td);
   	   							}else{
   	   								double general = calculateBrokeageAmountTS(code,data_map,trasacSummaryType,j,td);
   	   								Total = Total + general;
   	   							}
   	   						}
   						}
   					}else if(TestBase.product.equalsIgnoreCase("COA")){
   						
   						
   						
   						for(int j=i;!exit.equalsIgnoreCase("Total");j++){
   	   						String transactSumVal = driver.findElement(By.xpath(part1+"/tr["+j+"]/td[1]")).getText();
   	   						exit = driver.findElement(By.xpath(part1+"/tr["+j+"]/td[2]")).getText();
   	   						if(exit.equalsIgnoreCase("Total")){
   	   	   						i=j;
   	   	   						String actualTotal = driver.findElement(By.xpath(part1+"/tr["+j+"]/td[4]")).getText();  
   	   	   						compareValues(Double.parseDouble(actualTotal), Double.parseDouble(common.roundedOff(Double.toString(Total))), "Transaction Summary Total");
   	   	   						customAssert.assertTrue(WriteDataToXl(event+"_NB", "Transaction Summary", (String)common.NB_excel_data_map.get("Automation Key"), "TS_TransactionSummaryTotal", actualTotal,common.NB_excel_data_map),"Error while writing Transaction Summary data to excel .");

   	   	   						PL_FP = false;
   	   	   						EL_FP = false;
   	   	   						AW_FP = false;
   	   	   						SP_FP = false;
   	   	   						OP_FP = false;
   	   	   						HIP_FP = false;
   	   	   						JCT_FP = false;
   	   	   						TER_FP = false;
   	   	   						POL_FP = false;
   	   	   						LE_FP = false;
   	   	   						
   	   	   						
   	   	   						break outer;
   	   	   						}
   	   						if(transactSumVal.isEmpty()){
   	   							covername= driver.findElement(By.xpath(part1+"/tr["+j+"]/td[6]")).getText();
   	   							td=8;
   	   						}else{ 
   	   							covername= driver.findElement(By.xpath(part1+"/tr["+j+"]/td[9]")).getText();
   	   							td=11;
   	   						}
   	   						if(covername.equalsIgnoreCase("Public & Products Liability")){
   	   							double PublicAndProductsLiability= calculatepublicAndProductsLiabilityTS(code, data_map, trasacSummaryType,j,td);	
   	   							Total = Total + PublicAndProductsLiability;
   	   							PL_FP = true;
   	   						}
   	   						else if(covername.equalsIgnoreCase("Employers Liability")){
   	   							double EmployersLiability = calculateEmployersLiabilityTS(code,data_map,trasacSummaryType,j,td);
   	   							Total = Total + EmployersLiability;
   	   							EL_FP = true;
   	   						}
   	   						else if(covername.equalsIgnoreCase("Annual Contract Works")){
   	   							double AnnualContractWorks = calculateAnnualContractWorksTS(code,data_map, trasacSummaryType,j,td);
   	   							Total = Total + AnnualContractWorks;
   	   							AW_FP = true;
   	   						}
   	   						else if(covername.equalsIgnoreCase("Single Project Contract Works")){
   	   							double SingleProject = calculateSingleProjectContractWorksTS(code,data_map,trasacSummaryType,j,td);	
   	   							Total = Total + SingleProject;
   	   							SP_FP = true;
   	   						}
   	   						else if(covername.equalsIgnoreCase("Own Plant")){
   	   							double OwnPlant = calculateOwnPlantTS(code,data_map, trasacSummaryType,j,td);
   	   							Total = Total + OwnPlant;
   	   							OP_FP = true;
   	   						}
   	   						else if(covername.equalsIgnoreCase("Hired In Plant")){
   	   							double HireInPlants = calculateHiredInPlantTS(code,data_map, trasacSummaryType,j,td);	
   	   							Total = Total + HireInPlants;
   	   							HIP_FP = true;
   	   						}
   	   						else if(covername.equalsIgnoreCase("Combined Liability")){
   	   							double HireInPlants = calculateCombinedLiabilityTS(code,data_map, trasacSummaryType,j,td);	
   	   							Total = Total + HireInPlants;
   	   						}
   	   						else if(covername.equalsIgnoreCase("Third Party Motor Liability")){
   	   							double HireInPlants = calculateThirdPartyMotorLiabilityTS(code,data_map, trasacSummaryType,j,td);	
   	   							Total = Total + HireInPlants;
   	   						}
   	   						else if(covername.equalsIgnoreCase("Hire Cover Plus")){
   	   							double HireCoverPlus = calculateHireCoverPlusTS(code,data_map, trasacSummaryType,j,td);	
   	   							Total = Total + HireCoverPlus;
   	   						}
   	   						else if(covername.equalsIgnoreCase("JCT 6.5.1")){
   	   							double JCT651 = calculateJCT651TS(code,data_map,trasacSummaryType,j,td);	
   	   							Total = Total + JCT651;
   	   							JCT_FP = true;
   	   						}
   	   						else if(covername.equalsIgnoreCase("Terrorism")){
   	   							double Terrorism = calculateTerrorismTS(code,data_map,trasacSummaryType,j,td);	
   	   							Total = Total + Terrorism;
   	   							TER_FP = true;
   	   						}
   	   						else if(covername.equalsIgnoreCase("Property Owners Liability")){
   	   							double PropertyOwnersLiability = calculatePropertyOwnersLiabilityTS(code,data_map,trasacSummaryType,j,td);	
   	   							Total = Total + PropertyOwnersLiability;
   	   							POL_FP = true;
   	   						}
   	   						else if(covername.equalsIgnoreCase("Legal Expenses")){
   	   							double LegalExpenses = calculateLegalExpensesTS(code,data_map,trasacSummaryType,j,td);	
   	   							Total = Total + LegalExpenses;
   	   							LE_FP = true;
   	   						}
   	   						else if(covername.isEmpty()){
   	   							
   	   							//CNA Insurance Co. Ltd
   	   							String recipient = driver.findElement(By.xpath(part1+"/tr["+j+"]/td[6]")).getText();
   	   							if(recipient.contains("CNA Insurance Co. Ltd") || recipient.contains("QBE Insurance (Europe) Limited")){
   	   								if(data_map.get("CD_CombinedLiability").equals("Yes"))
   	   									Total = Total + calculateCombinedLiabilityTS(code,data_map,trasacSummaryType,j,td);
   	   								else if(data_map.get("CD_ThirdPartyMotorLiability").equals("Yes"))
   										Total = Total + calculateThirdPartyMotorLiabilityTS(code,data_map,trasacSummaryType,j,td);
   	   								else if(data_map.get("CD_Public&ProductsLiability").equals("Yes"))
   										Total = Total + calculatepublicAndProductsLiabilityTS(code,data_map,trasacSummaryType,j,td);
   	   								else if(data_map.get("CD_EmployersLiability").equals("Yes"))
   										Total = Total + calculateEmployersLiabilityTS(code,data_map,trasacSummaryType,j,td);
   	   								else if(data_map.get("CD_JCT6.5.1").equals("Yes"))
   										Total = Total + calculateJCT651TS(code,data_map,trasacSummaryType,j,td);
   	   							}else if(recipient.contains("Markel International Insurance Co. Ltd")){
   	   								Total = Total + calculateLegalExpensesTS(code,data_map,trasacSummaryType,j,td);
   	   							}else{
   	   								double general = calculateBrokeageAmountTS(code,data_map,trasacSummaryType,j,td);
   	   								Total = Total + general;
   	   							}
   	   						}
   						}
   					}
   					break;
   				case "ReQuote Summary": // For ReQuote Scenario
   				case "Amended New Business" : //For Rewind Scenario 
   					
   					TestUtil.reportStatus("Verification Started on Transaction Summary page "+trasacSummaryType+" . ", "PASS", false);
   					
   					ActualDueDate = driver.findElement(By.xpath(part1+"/tr["+i+"]/td[4]")).getText();
   					
   					ExpecteDueDate = common.getLastDayOfMonth((String)common.NB_excel_data_map.get("QuoteDate"), 1);
   					if(ActualDueDate.equalsIgnoreCase(ExpecteDueDate)){
      					 String tMsg="Actual Due Date: <b> [  "+ActualDueDate+"  ] </b>  has been matched with Expected Due Date: <b> [  "+ExpecteDueDate;
      					 TestUtil.reportStatus(tMsg, "Pass", false);
      					}
      					else{
      	   					 String tMsg="Actual Due Date: <b> [  "+ActualDueDate+"  ] </b>  does not matche with Expected Due Date: <b> [  "+ExpecteDueDate;
      	   					 TestUtil.reportStatus(tMsg, "Fail", false);
      					}
   					ActualTransationDate = driver.findElement(By.xpath(part1+"/tr["+i+"]/td[3]")).getText();
   					ExpecteTransactionDate = (String)common.NB_excel_data_map.get("QuoteDate");
   					if(ActualTransationDate.equalsIgnoreCase(ExpecteTransactionDate)){
      					 String tMsg="Actual Transaction Date: <b> [  "+ActualTransationDate+"  ] </b> has been matched with Expected Transaction Date: <b> [  "+ExpecteTransactionDate+"  ] </b> ";
      					 TestUtil.reportStatus(tMsg, "Pass", false);
      					}
      					else{
      	   					 String tMsg="Actual Transaction Date:<b> [  "+ActualTransationDate+"  ] </b>  does not matche with Expected Transaction Date: <b> [  "+ExpecteTransactionDate+"  ] </b> ";
      	   					 TestUtil.reportStatus(tMsg, "Fail", false);
      					}
   					
   					for(int j=i;!exit.equalsIgnoreCase("Total");j++){
   						String transactSumVal = driver.findElement(By.xpath(part1+"/tr["+j+"]/td[1]")).getText();
   						exit = driver.findElement(By.xpath(part1+"/tr["+j+"]/td[2]")).getText();
   						if(exit.equalsIgnoreCase("Total")){
   	   						i=j;
   	   						String actualTotal = driver.findElement(By.xpath(part1+"/tr["+j+"]/td[4]")).getText();  
   	   						compareValues(Double.parseDouble(actualTotal), Double.parseDouble(common.roundedOff(Double.toString(Total))), "Transaction Summary Total");
   	   						customAssert.assertTrue(WriteDataToXl(event+"_Rewind", "Transaction Summary", (String)data_map.get("Automation Key"), "TS_TransactionSummaryTotal", actualTotal,data_map),"Error while writing Transaction Summary data to excel .");

   	   						break outer;
   	   					}
   						if(transactSumVal.isEmpty()){
   							covername= driver.findElement(By.xpath(part1+"/tr["+j+"]/td[6]")).getText();
   							td=8;
   						}else{ 
   							covername= driver.findElement(By.xpath(part1+"/tr["+j+"]/td[9]")).getText();
   							td=11;
   						}
   						if(covername.equalsIgnoreCase("Public & Products Liability")){
   							double PublicAndProductsLiability= calculatepublicAndProductsLiabilityTS(code, data_map, trasacSummaryType,j,td);	
   							Total = Total + PublicAndProductsLiability;
   						}
   						else if(covername.equalsIgnoreCase("Employers Liability")){
   							double EmployersLiability = calculateEmployersLiabilityTS(code,data_map,trasacSummaryType,j,td);
   							Total = Total + EmployersLiability;
   						}
   						else if(covername.equalsIgnoreCase("Annual Contract Works")){
   							double AnnualContractWorks = calculateAnnualContractWorksTS(code,data_map, trasacSummaryType,j,td);
   							Total = Total + AnnualContractWorks;
   						}
   						else if(covername.equalsIgnoreCase("Single Project Contract Works")){
   							double SingleProject = calculateSingleProjectContractWorksTS(code,data_map,trasacSummaryType,j,td);	
   							Total = Total + SingleProject;
   						}
   						else if(covername.equalsIgnoreCase("Own Plant")){
   							double OwnPlant = calculateOwnPlantTS(code,data_map, trasacSummaryType,j,td);
   							Total = Total + OwnPlant;
   						}
   						else if(covername.equalsIgnoreCase("Hired In Plant")){
   							double HireInPlants = calculateHiredInPlantTS(code,data_map, trasacSummaryType,j,td);	
   							Total = Total + HireInPlants;
   						}
   						else if(covername.equalsIgnoreCase("Combined Liability")){
   							double HireInPlants = calculateCombinedLiabilityTS(code,data_map, trasacSummaryType,j,td);	
   							Total = Total + HireInPlants;
   						}
   						else if(covername.equalsIgnoreCase("Third Party Motor Liability")){
   							double HireInPlants = calculateThirdPartyMotorLiabilityTS(code,data_map, trasacSummaryType,j,td);	
   							Total = Total + HireInPlants;
   						}
   						else if(covername.equalsIgnoreCase("Hire Cover Plus")){
   							double HireCoverPlus = calculateHireCoverPlusTS(code,data_map, trasacSummaryType,j,td);	
   							Total = Total + HireCoverPlus;
   						}
   						else if(covername.equalsIgnoreCase("JCT 6.5.1")){
   							double JCT651 = calculateJCT651TS(code,data_map,trasacSummaryType,j,td);	
   							Total = Total + JCT651;
   						}
   						else if(covername.equalsIgnoreCase("Terrorism")){
   							double Terrorism = calculateTerrorismTS(code,data_map,trasacSummaryType,j,td);	
   							Total = Total + Terrorism;
   						}
   						else if(covername.equalsIgnoreCase("Property Owners Liability")){
   							double PropertyOwnersLiability = calculatePropertyOwnersLiabilityTS(code,data_map,trasacSummaryType,j,td);	
   							Total = Total + PropertyOwnersLiability;
   						}
   						else if(covername.equalsIgnoreCase("Legal Expenses")){
   							double LegalExpenses = calculateLegalExpensesTS(code,data_map,trasacSummaryType,j,td);	
   							Total = Total + LegalExpenses;
   						}
   						else if(covername.isEmpty()){
   							
   							//CNA Insurance Co. Ltd
   							String recipient = driver.findElement(By.xpath(part1+"/tr["+j+"]/td[6]")).getText();
   							if(recipient.contains("CNA Insurance Co. Ltd") || recipient.contains("QBE Insurance (Europe) Limited")){
   								
   								if(TestBase.product.contains("XOC") || TestBase.product.contains("XOQ")){
   									if(data_map.get("CD_CombinedLiability").equals("Yes"))
   	   									Total = Total + calculateCombinedLiabilityTS(code,data_map,trasacSummaryType,j,td);
   	   								else if(data_map.get("CD_ThirdPartyMotorLiability").equals("Yes"))
   										Total = Total + calculateThirdPartyMotorLiabilityTS(code,data_map,trasacSummaryType,j,td);
   	   								else if(data_map.get("CD_Public&ProductsLiability").equals("Yes"))
   										Total = Total + calculatepublicAndProductsLiabilityTS(code,data_map,trasacSummaryType,j,td);
   	   								else if(data_map.get("CD_EmployersLiability").equals("Yes"))
   										Total = Total + calculateEmployersLiabilityTS(code,data_map,trasacSummaryType,j,td);
   	   								else if(data_map.get("CD_JCT6.5.1").equals("Yes"))
   										Total = Total + calculateJCT651TS(code,data_map,trasacSummaryType,j,td);
   								}else{
   									if(data_map.get("CD_Add_CombinedLiability").equals("Yes"))
   	   									Total = Total + calculateCombinedLiabilityTS(code,data_map,trasacSummaryType,j,td);
   	   								else if(data_map.get("CD_Add_ThirdPartyMotorLiability").equals("Yes"))
   										Total = Total + calculateThirdPartyMotorLiabilityTS(code,data_map,trasacSummaryType,j,td);
   	   								else if(data_map.get("CD_Add_Public&ProductsLiability").equals("Yes"))
   										Total = Total + calculatepublicAndProductsLiabilityTS(code,data_map,trasacSummaryType,j,td);
   	   								else if(data_map.get("CD_Add_EmployersLiability").equals("Yes"))
   										Total = Total + calculateEmployersLiabilityTS(code,data_map,trasacSummaryType,j,td);
   	   								else if(data_map.get("CD_Add_JCT6.5.1").equals("Yes"))
   										Total = Total + calculateJCT651TS(code,data_map,trasacSummaryType,j,td);
   								}
   								
   							}else if(recipient.contains("Markel International Insurance Co. Ltd")){
   								Total = Total + calculateLegalExpensesTS(code,data_map,trasacSummaryType,j,td);
   							}else{
   								double general = calculateBrokeageAmountTS(code,data_map,trasacSummaryType,j,td);	
   								Total = Total + general;
   							}
   						}
   						
   					}
   					break;
   				case "Amended Renewal" : 
   				case "Renewal" : 
   					ActualDueDate = driver.findElement(By.xpath(part1+"/tr["+i+"]/td[4]")).getText();
   					
   					ExpecteDueDate = common.getLastDayOfMonth((String)common.Renewal_excel_data_map.get("PS_PolicyStartDate"), 1);
   					if(ActualDueDate.equalsIgnoreCase(ExpecteDueDate)){
      					 String tMsg="Actual Due Date: <b> [  "+ActualDueDate+"  ] </b>  has been matched with Expected Due Date: <b> [  "+ExpecteDueDate;
      					 TestUtil.reportStatus(tMsg, "Pass", false);
      					}
      					else{
      	   					 String tMsg="Actual Due Date: <b> [  "+ActualDueDate+"  ] </b>  does not matche with Expected Due Date: <b> [  "+ExpecteDueDate;
      	   					 TestUtil.reportStatus(tMsg, "Fail", false);
      					}
   					ActualTransationDate = driver.findElement(By.xpath(part1+"/tr["+i+"]/td[3]")).getText();
   					ExpecteTransactionDate = (String)common.Renewal_excel_data_map.get("QuoteDate");
   					if(ActualTransationDate.equalsIgnoreCase(ExpecteTransactionDate)){
      					 String tMsg="Actual Transaction Date: <b> [  "+ActualTransationDate+"  ] </b> has been matched with Expected Transaction Date: <b> [  "+ExpecteTransactionDate+"  ] </b> ";
      					 TestUtil.reportStatus(tMsg, "Pass", false);
      					}
      					else{
      	   					 String tMsg="Actual Transaction Date:<b> [  "+ActualTransationDate+"  ] </b>  does not matche with Expected Transaction Date: <b> [  "+ExpecteTransactionDate+"  ] </b> ";
      	   					 TestUtil.reportStatus(tMsg, "Fail", false);
      					}
   					TestUtil.reportStatus("Verification Started on Transaction Summary page "+trasacSummaryType+" . ", "PASS", false);
   					for(int j=i;!exit.equalsIgnoreCase("Total");j++){
   						String transactSumVal = driver.findElement(By.xpath(part1+"/tr["+j+"]/td[1]")).getText();
   						policy_duration_Trans = Integer.parseInt((String)common.Renewal_excel_data_map.get("PS_Duration"));
   						exit = driver.findElement(By.xpath(part1+"/tr["+j+"]/td[2]")).getText();
   						if(exit.equalsIgnoreCase("Total")){
   	   						i=j;
   	   						String actualTotal = driver.findElement(By.xpath(part1+"/tr["+j+"]/td[4]")).getText();  
   	   						compareValues(Double.parseDouble(actualTotal), Double.parseDouble(common.roundedOff(Double.toString(Total))), "Transaction Summary Total");
   	   						customAssert.assertTrue(WriteDataToXl(event+"_Renewal", "Transaction Summary", (String)common.Renewal_excel_data_map.get("Automation Key"), "TS_TransactionSummaryTotal", actualTotal,common.Renewal_excel_data_map),"Error while writing Transaction Summary data to excel .");

   	   						break outer;
   	   						}
   						if(transactSumVal.isEmpty()){
   							covername= driver.findElement(By.xpath(part1+"/tr["+j+"]/td[6]")).getText();
   							td=8;
   						}else{ 
   							covername= driver.findElement(By.xpath(part1+"/tr["+j+"]/td[9]")).getText();
   							td=11;
   						}
   						if(covername.equalsIgnoreCase("Public & Products Liability")){
   							double PublicAndProductsLiability= calculatepublicAndProductsLiabilityTS(code, data_map, trasacSummaryType,j,td);	
   							Total = Total + PublicAndProductsLiability;
   						}
   						else if(covername.equalsIgnoreCase("Employers Liability")){
   							double EmployersLiability = calculateEmployersLiabilityTS(code,data_map,trasacSummaryType,j,td);
   							Total = Total + EmployersLiability;
   						}
   						else if(covername.equalsIgnoreCase("Annual Contract Works")){
   							double AnnualContractWorks = calculateAnnualContractWorksTS(code,data_map, trasacSummaryType,j,td);
   							Total = Total + AnnualContractWorks;
   						}
   						else if(covername.equalsIgnoreCase("Single Project Contract Works")){
   							double SingleProject = calculateSingleProjectContractWorksTS(code,data_map,trasacSummaryType,j,td);	
   							Total = Total + SingleProject;
   						}
   						else if(covername.equalsIgnoreCase("Own Plant")){
   							double OwnPlant = calculateOwnPlantTS(code,data_map, trasacSummaryType,j,td);
   							Total = Total + OwnPlant;
   						}
   						else if(covername.equalsIgnoreCase("Hired In Plant")){
   							double HireInPlants = calculateHiredInPlantTS(code,data_map, trasacSummaryType,j,td);	
   							Total = Total + HireInPlants;
   						}
   						else if(covername.equalsIgnoreCase("Combined Liability")){
   							double HireInPlants = calculateCombinedLiabilityTS(code,data_map, trasacSummaryType,j,td);	
   							Total = Total + HireInPlants;
   						}
   						else if(covername.equalsIgnoreCase("Third Party Motor Liability")){
   							double HireInPlants = calculateThirdPartyMotorLiabilityTS(code,data_map, trasacSummaryType,j,td);	
   							Total = Total + HireInPlants;
   						}
   						else if(covername.equalsIgnoreCase("Hire Cover Plus")){
   							double HireCoverPlus = calculateHireCoverPlusTS(code,data_map, trasacSummaryType,j,td);	
   							Total = Total + HireCoverPlus;
   						}
   						else if(covername.equalsIgnoreCase("JCT 6.5.1")){
   							double JCT651 = calculateJCT651TS(code,data_map,trasacSummaryType,j,td);	
   							Total = Total + JCT651;
   						}
   						else if(covername.equalsIgnoreCase("Terrorism")){
   							double Terrorism = calculateTerrorismTS(code,data_map,trasacSummaryType,j,td);	
   							Total = Total + Terrorism;
   						}
   						else if(covername.equalsIgnoreCase("Property Owners Liability")){
   							double PropertyOwnersLiability = calculatePropertyOwnersLiabilityTS(code,data_map,trasacSummaryType,j,td);	
   							Total = Total + PropertyOwnersLiability;
   						}
   						else if(covername.equalsIgnoreCase("Legal Expenses")){
   							double LegalExpenses = calculateLegalExpensesTS(code,data_map,trasacSummaryType,j,td);	
   							Total = Total + LegalExpenses;
   						}
   						else if(covername.isEmpty()){
   							
   							String recipient = driver.findElement(By.xpath(part1+"/tr["+j+"]/td[6]")).getText();
   							if(recipient.contains("CNA Insurance Co. Ltd") || recipient.contains("QBE Insurance (Europe) Limited")){
   								Total = Total + calculateCombinedLiabilityTS(code,data_map,trasacSummaryType,j,td);
   							}else if(recipient.contains("Markel International Insurance Co. Ltd")){
   								Total = Total + calculateLegalExpensesTS(code,data_map,trasacSummaryType,j,td);
   							}else{
   								double general = calculateBrokeageAmountTS(code,data_map,trasacSummaryType,j,td);
   								Total = Total + general;
   							}
   						}
   					}
   					break;		
   				case "Cancel" : 
   					
   					ActualDueDate = driver.findElement(By.xpath(part1+"/tr["+i+"]/td[4]")).getText();
   					
   					ExpecteDueDate = common.getLastDayOfMonth((String)common.NB_excel_data_map.get("Cancellation_date"), 1);
   					if(ActualDueDate.equalsIgnoreCase(ExpecteDueDate)){
      					 String tMsg="Actual Due Date: <b> [  "+ActualDueDate+"  ] </b>  has been matched with Expected Due Date: <b> [  "+ExpecteDueDate;
      					 TestUtil.reportStatus(tMsg, "Pass", false);
      					}
      					else{
      	   					 String tMsg="Actual Due Date: <b> [  "+ActualDueDate+"  ] </b>  does not matche with Expected Due Date: <b> [  "+ExpecteDueDate;
      	   					 TestUtil.reportStatus(tMsg, "Fail", false);
      					}
   					ActualTransationDate = driver.findElement(By.xpath(part1+"/tr["+i+"]/td[3]")).getText();
   					ExpecteTransactionDate = (String)common.NB_excel_data_map.get("QuoteDate");
   					if(ActualTransationDate.equalsIgnoreCase(ExpecteTransactionDate)){
      					 String tMsg="Actual Transaction Date: <b> [  "+ActualTransationDate+"  ] </b> has been matched with Expected Transaction Date: <b> [  "+ExpecteTransactionDate+"  ] </b> ";
      					 TestUtil.reportStatus(tMsg, "Pass", false);
      					}
      					else{
      	   					 String tMsg="Actual Transaction Date:<b> [  "+ActualTransationDate+"  ] </b>  does not matche with Expected Transaction Date: <b> [  "+ExpecteTransactionDate+"  ] </b> ";
      	   					 TestUtil.reportStatus(tMsg, "Fail", false);
      					}
   					
   					TestUtil.reportStatus("Verification Started on Transaction Summary page "+trasacSummaryType+" . ", "PASS", false);
   					for(int j=i;!exit.equalsIgnoreCase("Total");j++){
   						String transactSumVal = driver.findElement(By.xpath(part1+"/tr["+j+"]/td[1]")).getText();
   						exit = driver.findElement(By.xpath(part1+"/tr["+j+"]/td[2]")).getText();
   						if(exit.equalsIgnoreCase("Total")){
   	   						i=j;
   	   						String actualTotal = driver.findElement(By.xpath(part1+"/tr["+j+"]/td[4]")).getText();  
   	   						compareValues(Double.parseDouble(actualTotal), Double.parseDouble(common.roundedOff(Double.toString(Total))), "Transaction Summary Total");
   	   						
   	   						customAssert.assertTrue(WriteDataToXl(event+"_CAN", "Transaction Summary", (String)common.CAN_excel_data_map.get("Automation Key"), "TS_TransactionSummaryTotal", actualTotal,common.CAN_excel_data_map),"Error while writing Transaction Summary data to excel .");

   	   						break outer;
   	   						}
   						if(transactSumVal.isEmpty()){
   							covername= driver.findElement(By.xpath(part1+"/tr["+j+"]/td[6]")).getText();
   							td=8;
   						}else{ 
   							covername= driver.findElement(By.xpath(part1+"/tr["+j+"]/td[9]")).getText();
   							td=11;
   						}
   						if(covername.equalsIgnoreCase("Public & Products Liability")){
   							double PublicAndProductsLiability= calculatepublicAndProductsLiabilityTS(code, data_map, trasacSummaryType,j,td);	
   							Total = Total + PublicAndProductsLiability;
   						}
   						else if(covername.equalsIgnoreCase("Employers Liability")){
   							double EmployersLiability = calculateEmployersLiabilityTS(code,data_map,trasacSummaryType,j,td);
   							Total = Total + EmployersLiability;
   						}
   						else if(covername.equalsIgnoreCase("Annual Contract Works")){
   							double AnnualContractWorks = calculateAnnualContractWorksTS(code,data_map, trasacSummaryType,j,td);
   							Total = Total + AnnualContractWorks;
   						}
   						else if(covername.equalsIgnoreCase("Single Project Contract Works")){
   							double SingleProject = calculateSingleProjectContractWorksTS(code,data_map,trasacSummaryType,j,td);	
   							Total = Total + SingleProject;
   						}
   						else if(covername.equalsIgnoreCase("Own Plant")){
   							double OwnPlant = calculateOwnPlantTS(code,data_map, trasacSummaryType,j,td);
   							Total = Total + OwnPlant;
   						}
   						else if(covername.equalsIgnoreCase("Hired In Plant")){
   							double HireInPlants = calculateHiredInPlantTS(code,data_map, trasacSummaryType,j,td);	
   							Total = Total + HireInPlants;
   						}
   						else if(covername.equalsIgnoreCase("Combined Liability")){
   							double HireInPlants = calculateCombinedLiabilityTS(code,data_map, trasacSummaryType,j,td);	
   							Total = Total + HireInPlants;
   						}
   						else if(covername.equalsIgnoreCase("Third Party Motor Liability")){
   							double HireInPlants = calculateThirdPartyMotorLiabilityTS(code,data_map, trasacSummaryType,j,td);	
   							Total = Total + HireInPlants;
   						}
   						else if(covername.equalsIgnoreCase("Hire Cover Plus")){
   							double HireCoverPlus = calculateHireCoverPlusTS(code,data_map, trasacSummaryType,j,td);	
   							Total = Total + HireCoverPlus;
   						}
   						else if(covername.equalsIgnoreCase("JCT 6.5.1")){
   							double JCT651 = calculateJCT651TS(code,data_map,trasacSummaryType,j,td);	
   							Total = Total + JCT651;
   						}
   						else if(covername.equalsIgnoreCase("Terrorism")){
   							double Terrorism = calculateTerrorismTS(code,data_map,trasacSummaryType,j,td);	
   							Total = Total + Terrorism;
   						}
   						else if(covername.equalsIgnoreCase("Property Owners Liability")){
   							double PropertyOwnersLiability = calculatePropertyOwnersLiabilityTS(code,data_map,trasacSummaryType,j,td);	
   							Total = Total + PropertyOwnersLiability;
   						}
   						else if(covername.equalsIgnoreCase("Legal Expenses")){
   							double LegalExpenses = calculateLegalExpensesTS(code,data_map,trasacSummaryType,j,td);	
   							Total = Total + LegalExpenses;
   						}
   						else if(covername.isEmpty()){
   							
   						//CNA Insurance Co. Ltd
	   							String recipient = driver.findElement(By.xpath(part1+"/tr["+j+"]/td[6]")).getText();
	   							if(recipient.contains("CNA Insurance Co. Ltd") || recipient.contains("QBE Insurance (Europe) Limited")){
	   								Total = Total + calculateCombinedLiabilityTS(code,data_map,trasacSummaryType,j,td);
	   							}else if(recipient.contains("Markel International Insurance Co. Ltd")){
	   								Total = Total + calculateLegalExpensesTS(code,data_map,trasacSummaryType,j,td);
	   							}else{
	   								double general = calculateBrokeageAmountTS(code,data_map,trasacSummaryType,j,td);
	   								Total = Total + general;
	   							}
   						}
   					}
   					break;
   				}
   					
   			}
   		}catch(Throwable t) {
   			String methodName = new Object(){}.getClass().getEnclosingMethod().getName();
   			TestUtil.reportFunctionFailed("Failed in "+methodName+" function");     k.reportErr("Failed in "+methodName+" function", t);
   			Assert.fail("Failed in Transaction Summary \n", t);
   			return false;
   		}
   		
   		TestUtil.reportStatus("Verification Completed successful on Transaction Summary page . ", "Info", false);
   		
   		return retvalue;

   	}
     public double calculatepublicAndProductsLiabilityTS(String code, Map<Object, Object> data_map ,String event ,int j,int td){
    		try{
    			String pubProPremium = null;
    			String pubProIPT = null;
    			if(common.currentRunningFlow.equals("MTA") && TestBase.businessEvent.equalsIgnoreCase("MTA") || 
    					common.currentRunningFlow.equals("Rewind") && TestBase.businessEvent.equalsIgnoreCase("MTA")	){
    				
    				try{
    					if(common_COB.MTARewindFlow.equalsIgnoreCase("Yes")){
    						pubProPremium = Double.toString(common_VELA.transaction_Details_Premium_Values.get("Public & Products Liability").get("Net Net Premium"));
        					pubProIPT = Double.toString(common_VELA.transaction_Details_Premium_Values.get("Public & Products Liability").get("Insurance Tax"));
    					}else{
    						if(common_VELA.PL_FP){
    							
    							if(TestBase.product.contains("COA")){
    								pubProPremium = Double.toString(common_VELA.transaction_Details_Premium_Values.get("Public & Products Liability_FP").get("Net Net Premium"));
                					pubProIPT = Double.toString(common_VELA.transaction_Details_Premium_Values.get("Public & Products Liability_FP").get("Insurance Tax"));
    							}else{
    								pubProPremium = Double.toString(common_VELA.transaction_Details_Premium_Values.get("Public & Products Liability_FP").get("Net Net Premium"));
                					pubProIPT = Double.toString(common_VELA.transaction_Details_Premium_Values.get("Public & Products Liability_FP").get("Insurance Tax"));
    							}    							
            					common_VELA.PL_FP = false;
    						}else{
    							pubProPremium = Double.toString(common_VELA.transaction_Details_Premium_Values.get("Public & Products Liability").get("Net Net Premium"));
            					pubProIPT = Double.toString(common_VELA.transaction_Details_Premium_Values.get("Public & Products Liability").get("Insurance Tax"));
    						}
    						
    					}
    					
    				}catch(NullPointerException npe){
    					pubProPremium = "0.0";
    					pubProIPT = "0.0";
    				}
    			}
    			else if(common.currentRunningFlow.equals("CAN")){
    				String productName = TestBase.product;
    				try{
    				
    				/*switch(productName){
    				case "COB":
    				
    				*/	pubProPremium = "-"+Double.toString(common_COB.CAN_COB_ReturnP_Values_Map.get("Public & Products Liability").get("Net Net Premium"));
    					pubProIPT = "-"+Double.toString(common_COB.CAN_COB_ReturnP_Values_Map.get("Public & Products Liability").get("Insurance Tax"));
    				//	break;
    				//case "COA":
    				/*	pubProPremium = Double.toString(common_COA.CAN_COA_ReturnP_Values_Map.get("Public & Products Liability").get("Net Net Premium"));
    					pubProIPT = Double.toString(common_COA.CAN_COA_ReturnP_Values_Map.get("Public & Products Liability").get("Insurance Tax"));
    					//break;
    					
    				//case "XOC":
    					pubProPremium = Double.toString(common_XOC.CAN_XOC_ReturnP_Values_Map.get("Public & Products Liability").get("Net Net Premium"));
    					pubProIPT = Double.toString(common_XOC.CAN_XOC_ReturnP_Values_Map.get("Public & Products Liability").get("Insurance Tax"));
    				//	break;
    					*/
    				//}	
    				}catch(NullPointerException npe){
    					pubProPremium = "0.0";
    					pubProIPT = "0.0";
    				}
    				
    				
    				
    			}
    			else if(common.currentRunningFlow.equals("NB") || common.currentRunningFlow.equals("Rewind") || common.currentRunningFlow.equals("Requote")){
					if(!((String)data_map.get("PS_Duration")).equalsIgnoreCase("365")){
						double pubProPremiumTransactionMap = transaction_Premium_Values.get("Public & Products Liability").get("Net Net Premium");
						pubProPremium = Double.toString(pubProPremiumTransactionMap);
						double pubProIPTTransactionMap = transaction_Premium_Values.get("Public & Products Liability").get("Insurance Tax");
						pubProIPT = Double.toString(pubProIPTTransactionMap);
					}else{
						pubProPremium = (String)data_map.get("PS_Public&ProductsLiability_NetNetPremium");
		    			pubProIPT = (String)data_map.get("PS_Public&ProductsLiability_GT");
					}
					
	    			 
				}
    			else if(common.currentRunningFlow.equals("Renewal")){
					if(!((String)data_map.get("PS_Duration")).equalsIgnoreCase("365")){
						double pubProPremiumTransactionMap = transaction_Premium_Values.get("Public & Products Liability").get("Net Net Premium");
						pubProPremium = Double.toString(pubProPremiumTransactionMap);
						double pubProIPTTransactionMap = transaction_Premium_Values.get("Public & Products Liability").get("Insurance Tax");
						pubProIPT = Double.toString(pubProIPTTransactionMap);
					}else{
						pubProPremium = (String)data_map.get("PS_Public&ProductsLiability_NetNetPremium");
		    			pubProIPT = (String)data_map.get("PS_Public&ProductsLiability_GT");
					}
					
	    			 
				}
				
				
    			String part1= "//*[@id='table0']/tbody";
    			int td_count = 0;
    			if(common_COB.MTARewindFlow.equalsIgnoreCase("Yes")){
    				td_count = 11;
				}else{
					td_count = td;
				}
    			
    			String actualpubProPremium = driver.findElement(By.xpath(part1+"/tr["+j+"]/td["+td_count+"]")).getText();
    			String actualpubProIPT = driver.findElement(By.xpath(part1+"/tr["+j+"]/td["+(td_count+1)+"]")).getText();
    			String actualPubProDue = driver.findElement(By.xpath(part1+"/tr["+j+"]/td["+(td_count+2)+"]")).getText();
    			
    		
    			compareValues(Math.abs(Double.parseDouble(pubProPremium)), Math.abs(Double.parseDouble(actualpubProPremium)), "Public & Products Liability Amount");
    			compareValues(Math.abs(Double.parseDouble(pubProIPT)), Math.abs(Double.parseDouble(actualpubProIPT)), "Public & Products Liability IPT");
    			double pubproDue = Double.parseDouble(pubProPremium)+ Double.parseDouble(pubProIPT);
    			String pubproDueamt= common.roundedOff(Double.toString(pubproDue)) ;
    			compareValues(Math.abs(Double.parseDouble(pubproDueamt)), Math.abs(Double.parseDouble(actualPubProDue)), "Public & Products Liability Due ");
    			return pubproDue;

    		}catch(Throwable t) {
    			String methodName = new Object(){}.getClass().getEnclosingMethod().getName();
    			TestUtil.reportFunctionFailed("Failed in "+methodName+" function");     k.reportErr("Failed in "+methodName+" function", t);
    			Assert.fail("Failed in Calculate Public & Products Liability ammount. \n", t);
    			return 0;
    		}
    	}
   	public double calculateEmployersLiabilityTS(String fileName,Map<Object, Object> data_map,String code ,int j,int td){
		try{
			
			String EmpLiabiltyPremium = null;
			String EmpLiabiltyIPT = null;
			if(common.currentRunningFlow.equals("MTA") && TestBase.businessEvent.equalsIgnoreCase("MTA") || 
					common.currentRunningFlow.equals("Rewind") && TestBase.businessEvent.equalsIgnoreCase("MTA")	){
				
				try{
					if(common_VELA.EL_FP){
						EmpLiabiltyPremium = Double.toString(common_VELA.transaction_Details_Premium_Values.get("Employers Liability_FP").get("Net Net Premium"));
						EmpLiabiltyIPT = Double.toString(common_VELA.transaction_Details_Premium_Values.get("Employers Liability_FP").get("Insurance Tax"));
    					common_VELA.EL_FP = false;
					}else{
						EmpLiabiltyPremium = Double.toString(common_VELA.transaction_Details_Premium_Values.get("Employers Liability").get("Net Net Premium"));
						EmpLiabiltyIPT = Double.toString(common_VELA.transaction_Details_Premium_Values.get("Employers Liability").get("Insurance Tax"));
					}
					
				}catch(NullPointerException npe){
					EmpLiabiltyPremium = "0.0";
					EmpLiabiltyIPT = "0.0";
				}
			}
			else if(common.currentRunningFlow.equals("CAN")){
								
				String productName = TestBase.product;
				try{
				
				/*switch(productName){
				case "COB":*/
				
					EmpLiabiltyPremium = "-"+Double.toString(common_COB.CAN_COB_ReturnP_Values_Map.get("Employers Liability").get("Net Net Premium"));
					EmpLiabiltyIPT = "-"+Double.toString(common_COB.CAN_COB_ReturnP_Values_Map.get("Employers Liability").get("Insurance Tax"));
					/*break;
				case "COA":
					EmpLiabiltyPremium = Double.toString(common_COA.CAN_COA_ReturnP_Values_Map.get("Employers Liability").get("Net Net Premium"));
					EmpLiabiltyIPT = Double.toString(common_COA.CAN_COA_ReturnP_Values_Map.get("Employers Liability").get("Insurance Tax"));
					break;
					
				case "XOC":
					EmpLiabiltyPremium = Double.toString(common_XOC.CAN_XOC_ReturnP_Values_Map.get("Employers Liability").get("Net Net Premium"));
					EmpLiabiltyIPT = Double.toString(common_XOC.CAN_XOC_ReturnP_Values_Map.get("Employers Liability").get("Insurance Tax"));
					break;
					
					}	*/
				}catch(NullPointerException npe){
					EmpLiabiltyPremium = "0.0";
					EmpLiabiltyIPT = "0.0";
				}
			}
			else if(common.currentRunningFlow.equals("NB") || common.currentRunningFlow.equals("Rewind") || common.currentRunningFlow.equals("Requote")){
				if(!((String)data_map.get("PS_Duration")).equalsIgnoreCase("365")){
					double EmpLiabiltyPremiumTransactionMap = transaction_Premium_Values.get("Employers Liability").get("Net Net Premium");
					EmpLiabiltyPremium = Double.toString(EmpLiabiltyPremiumTransactionMap);
					double EmpLiabiltyIPTTransactionMap = transaction_Premium_Values.get("Employers Liability").get("Insurance Tax");
					EmpLiabiltyIPT = Double.toString(EmpLiabiltyIPTTransactionMap);
				}else{
					EmpLiabiltyPremium = (String)data_map.get("PS_EmployersLiability_NetNetPremium");
					EmpLiabiltyIPT = (String)data_map.get("PS_EmployersLiability_GT");
				}
			}	
			else if(common.currentRunningFlow.equals("Renewal")){
				if(!((String)data_map.get("PS_Duration")).equalsIgnoreCase("365")){
					double EmpLiabiltyPremiumTransactionMap = transaction_Premium_Values.get("Employers Liability").get("Net Net Premium");
					EmpLiabiltyPremium = Double.toString(EmpLiabiltyPremiumTransactionMap);
					double EmpLiabiltyIPTTransactionMap = transaction_Premium_Values.get("Employers Liability").get("Insurance Tax");
					EmpLiabiltyIPT = Double.toString(EmpLiabiltyIPTTransactionMap);
				}else{
					EmpLiabiltyPremium = (String)data_map.get("PS_EmployersLiability_NetNetPremium");
					EmpLiabiltyIPT = (String)data_map.get("PS_EmployersLiability_GT");
				}
			}
   			String part1= "//*[@id='table0']/tbody";
			String actualEmpLiabiltyPremium = driver.findElement(By.xpath(part1+"/tr["+j+"]/td["+td+"]")).getText();
			String actualEmpLiabiltyIPT = driver.findElement(By.xpath(part1+"/tr["+j+"]/td["+(td+1)+"]")).getText();
			String actualEmpLiabiltyDue = driver.findElement(By.xpath(part1+"/tr["+j+"]/td["+(td+2)+"]")).getText();
			compareValues(Math.abs(Double.parseDouble(EmpLiabiltyPremium)), Math.abs(Double.parseDouble(actualEmpLiabiltyPremium)), "Employers Liability Amount");
			compareValues(Math.abs(Double.parseDouble(EmpLiabiltyIPT)), Math.abs(Double.parseDouble(actualEmpLiabiltyIPT)), "Employers Liability IPT");
			double EmpLiabiltyDue = Double.parseDouble(EmpLiabiltyPremium)+ Double.parseDouble(EmpLiabiltyIPT);
			String EmpLiabiltyDueamt= common.roundedOff(Double.toString(EmpLiabiltyDue)) ;
			compareValues(Math.abs(Double.parseDouble(EmpLiabiltyDueamt)), Math.abs(Double.parseDouble(actualEmpLiabiltyDue)), "Employers Liability Due ");
			return EmpLiabiltyDue;
		
		}catch(Throwable t) {
			String methodName = new Object(){}.getClass().getEnclosingMethod().getName();
			TestUtil.reportFunctionFailed("Failed in "+methodName+" function");    
			k.reportErr("Failed in "+methodName+" function", t);
			Assert.fail("Failed in Calculate Employers Liability ammount.  \n", t);
			return 0;
		}

	}
   
	public double calculateAnnualContractWorksTS(String fileName,Map<Object, Object> data_map ,String code ,int j,int td){
		try{
			String AnnualContractPremium = null;
			String AnnualContractIPT = null;
			if(common.currentRunningFlow.equals("MTA") && TestBase.businessEvent.equalsIgnoreCase("MTA") || 
					common.currentRunningFlow.equals("Rewind") && TestBase.businessEvent.equalsIgnoreCase("MTA")	){
				
				try{
					if(common_VELA.AW_FP){
						AnnualContractPremium = Double.toString(common_VELA.transaction_Details_Premium_Values.get("Annual Works_FP").get("Net Net Premium"));
						AnnualContractIPT = Double.toString(common_VELA.transaction_Details_Premium_Values.get("Annual Works_FP").get("Insurance Tax"));
    					common_VELA.AW_FP = false;
					}else{
						if(TestBase.product.contains("COA")){
							AnnualContractPremium = Double.toString(common_VELA.transaction_Details_Premium_Values.get("Annual Works").get("Net Net Premium"));
							AnnualContractIPT = Double.toString(common_VELA.transaction_Details_Premium_Values.get("Annual Works").get("Insurance Tax"));
						}else{
							AnnualContractPremium = Double.toString(common_VELA.transaction_Details_Premium_Values.get("Annual Works").get("Net Net Premium"));
							AnnualContractIPT = Double.toString(common_VELA.transaction_Details_Premium_Values.get("Annual Works").get("Insurance Tax"));
						}
					}
					
				}catch(NullPointerException npe){
					AnnualContractPremium = "0.0";
					AnnualContractIPT = "0.0";
				}
			}
			else if(common.currentRunningFlow.equals("CAN")){
				
				String productName = TestBase.product;
				try{
					/*switch(productName){
						case "COB":*/
						
							AnnualContractPremium = "-"+Double.toString(common_COB.CAN_COB_ReturnP_Values_Map.get("Annual Works").get("Net Net Premium"));
							AnnualContractIPT = "-"+Double.toString(common_COB.CAN_COB_ReturnP_Values_Map.get("Annual Works").get("Insurance Tax"));
							/*break;
						case "COA":
							AnnualContractPremium = Double.toString(common_COA.CAN_COA_ReturnP_Values_Map.get("Annual Works").get("Net Net Premium"));
							AnnualContractIPT = Double.toString(common_COA.CAN_COA_ReturnP_Values_Map.get("Annual Works").get("Insurance Tax"));
							break;
							
					}*/
				}
				
				catch(NullPointerException npe){
					AnnualContractPremium = "0.0";
					AnnualContractIPT = "0.0";
				}
			}
            else if(common.currentRunningFlow.equals("NB") || common.currentRunningFlow.equals("Rewind")|| common.currentRunningFlow.equals("Requote")){
					
				if(!((String)data_map.get("PS_Duration")).equalsIgnoreCase("365")){
					double AnnualContractPremiumTransactionMap = transaction_Premium_Values.get("Annual Works").get("Net Net Premium");
					AnnualContractPremium = Double.toString(AnnualContractPremiumTransactionMap);
					double AnnualContractIPTTransactionMap = transaction_Premium_Values.get("Annual Works").get("Insurance Tax");
					AnnualContractIPT = Double.toString(AnnualContractIPTTransactionMap);
				}else{
					AnnualContractPremium = (String)data_map.get("PS_AnnualWorks_NetNetPremium");
					AnnualContractIPT = (String)data_map.get("PS_AnnualWorks_GT");
				}
				
					
			}
			else if(common.currentRunningFlow.equals("Renewal")){
				
				if(!((String)data_map.get("PS_Duration")).equalsIgnoreCase("365")){
					double AnnualContractPremiumTransactionMap = transaction_Premium_Values.get("Annual Works").get("Net Net Premium");
					AnnualContractPremium = Double.toString(AnnualContractPremiumTransactionMap);
					double AnnualContractIPTTransactionMap = transaction_Premium_Values.get("Annual Works").get("Insurance Tax");
					AnnualContractIPT = Double.toString(AnnualContractIPTTransactionMap);
				}else{
					AnnualContractPremium = (String)data_map.get("PS_AnnualWorks_NetNetPremium");
					AnnualContractIPT = (String)data_map.get("PS_AnnualWorks_GT");
				}
				
					
			}
			String part1= "//*[@id='table0']/tbody";
			String actualAnnualContractPremium = driver.findElement(By.xpath(part1+"/tr["+j+"]/td["+td+"]")).getText();
			String actualAnnualContractIPT = driver.findElement(By.xpath(part1+"/tr["+j+"]/td["+(td+1)+"]")).getText();
			String actualAnnualContractDue = driver.findElement(By.xpath(part1+"/tr["+j+"]/td["+(td+2)+"]")).getText();
			compareValues(Math.abs(Double.parseDouble(AnnualContractPremium)), Math.abs(Double.parseDouble(actualAnnualContractPremium)), "Annual Contract Works Amount");
			compareValues(Math.abs(Double.parseDouble(AnnualContractIPT)), Math.abs(Double.parseDouble(actualAnnualContractIPT)), "Annual Contract Works IPT");
			double AnnualContractDue = Double.parseDouble(AnnualContractPremium)+ Double.parseDouble(AnnualContractIPT);
			String AnnualContractDueamt= common.roundedOff(Double.toString(AnnualContractDue)) ;
			compareValues(Math.abs(Double.parseDouble(AnnualContractDueamt)), Math.abs(Double.parseDouble(actualAnnualContractDue)), "Annual Contract Works Due ");
			return AnnualContractDue;
		
		}catch(Throwable t) {
			String methodName = new Object(){}.getClass().getEnclosingMethod().getName();
			TestUtil.reportFunctionFailed("Failed in "+methodName+" function");    
			k.reportErr("Failed in "+methodName+" function", t);
			Assert.fail("Failed in Calculate Annual Contract Works ammount.  \n", t);
			return 0;
		}

	}
	public double calculateSingleProjectContractWorksTS(String fileName,Map<Object, Object> data_map ,String code ,int j,int td){
		try{
			String SingleProjectPremium = null;
			String SingleProjectIPT = null;
			if(common.currentRunningFlow.equals("MTA") && TestBase.businessEvent.equalsIgnoreCase("MTA") || 
					common.currentRunningFlow.equals("Rewind") && TestBase.businessEvent.equalsIgnoreCase("MTA")	){
				
				try{
					if(common_VELA.SP_FP){
						SingleProjectPremium = Double.toString(common_VELA.transaction_Details_Premium_Values.get("Single Project_FP").get("Net Net Premium"));
						SingleProjectIPT = Double.toString(common_VELA.transaction_Details_Premium_Values.get("Single Project_FP").get("Insurance Tax"));
    					common_VELA.SP_FP = false;
					}else{
						SingleProjectPremium = Double.toString(common_VELA.transaction_Details_Premium_Values.get("Single Project").get("Net Net Premium"));
						SingleProjectIPT = Double.toString(common_VELA.transaction_Details_Premium_Values.get("Single Project").get("Insurance Tax"));
					}
					
				}catch(NullPointerException npe){
					SingleProjectPremium = "0.0";
					SingleProjectIPT = "0.0";
				}
			}
			else if(common.currentRunningFlow.equals("CAN")){
				
				String productName = TestBase.product;
				try{
					/*switch(productName){
						case "COB":
						*/
							SingleProjectPremium = "-"+Double.toString(common_COB.CAN_COB_ReturnP_Values_Map.get("Single Project").get("Net Net Premium"));
							SingleProjectIPT = "-"+Double.toString(common_COB.CAN_COB_ReturnP_Values_Map.get("Single Project").get("Insurance Tax"));
							/*break;
						case "COA":
							SingleProjectPremium = Double.toString(common_COA.CAN_COA_ReturnP_Values_Map.get("Single Project").get("Net Net Premium"));
							SingleProjectIPT = Double.toString(common_COA.CAN_COA_ReturnP_Values_Map.get("Single Project").get("Insurance Tax"));
							break;
							
					}*/
				}
				
				catch(NullPointerException npe){
					SingleProjectPremium = "0.0";
					SingleProjectIPT = "0.0";
				}
			}
            else if(common.currentRunningFlow.equals("NB") || common.currentRunningFlow.equals("Rewind") || common.currentRunningFlow.equals("Requote")){
					
				if(!((String)data_map.get("PS_Duration")).equalsIgnoreCase("365")){
					double SingleProjectPremiumTransactionMap = transaction_Premium_Values.get("Single Project").get("Net Net Premium");
					SingleProjectPremium = Double.toString(SingleProjectPremiumTransactionMap);
					double SingleProjectIPTTransactionMap = transaction_Premium_Values.get("Single Project").get("Insurance Tax");
					SingleProjectIPT = Double.toString(SingleProjectIPTTransactionMap);
				}else{
					SingleProjectPremium = (String)data_map.get("PS_SingleProject_NetNetPremium");
					SingleProjectIPT = (String)data_map.get("PS_SingleProject_GT");
				}
				
				
					
			}
			else if(common.currentRunningFlow.equals("Renewal")){
				
				if(!((String)data_map.get("PS_Duration")).equalsIgnoreCase("365")){
					double SingleProjectPremiumTransactionMap = transaction_Premium_Values.get("Single Project").get("Net Net Premium");
					SingleProjectPremium = Double.toString(SingleProjectPremiumTransactionMap);
					double SingleProjectIPTTransactionMap = transaction_Premium_Values.get("Single Project").get("Insurance Tax");
					SingleProjectIPT = Double.toString(SingleProjectIPTTransactionMap);
				}else{
					SingleProjectPremium = (String)data_map.get("PS_SingleProject_NetNetPremium");
					SingleProjectIPT = (String)data_map.get("PS_SingleProject_GT");
				}
				
				
					
			}
			String part1= "//*[@id='table0']/tbody";
			String actualAnnualContractPremium = driver.findElement(By.xpath(part1+"/tr["+j+"]/td["+td+"]")).getText();
			String actualAnnualContractIPT = driver.findElement(By.xpath(part1+"/tr["+j+"]/td["+(td+1)+"]")).getText();
			String actualAnnualContractDue = driver.findElement(By.xpath(part1+"/tr["+j+"]/td["+(td+2)+"]")).getText();
			compareValues(Math.abs(Double.parseDouble(SingleProjectPremium)), Math.abs(Double.parseDouble(actualAnnualContractPremium)), "Single Project Contract Works Amount");
			compareValues(Math.abs(Double.parseDouble(SingleProjectIPT)), Math.abs(Double.parseDouble(actualAnnualContractIPT)), "Single Project Contract Works IPT");
			double AnnualContractDue = Double.parseDouble(SingleProjectPremium)+ Double.parseDouble(SingleProjectIPT);
			String AnnualContractDueamt= common.roundedOff(Double.toString(AnnualContractDue)) ;
			compareValues(Math.abs(Double.parseDouble(AnnualContractDueamt)), Math.abs(Double.parseDouble(actualAnnualContractDue)), "Annual Contract Works Due ");
			return AnnualContractDue;
		
		}catch(Throwable t) {
			String methodName = new Object(){}.getClass().getEnclosingMethod().getName();
			TestUtil.reportFunctionFailed("Failed in "+methodName+" function");    
			k.reportErr("Failed in "+methodName+" function", t);
			Assert.fail("Failed in Calculate Singel Project Contract Works ammount.  \n", t);
			return 0;
		}

	}
   
	public double calculateOwnPlantTS(String fileName,Map<Object, Object> data_map,String code ,int j,int td){
		try{
			String OwnPlantPremium = null;
			String OwnPlantIPT = null;
			if(common.currentRunningFlow.equals("MTA") && TestBase.businessEvent.equalsIgnoreCase("MTA") || 
					common.currentRunningFlow.equals("Rewind") && TestBase.businessEvent.equalsIgnoreCase("MTA")	){
				
				try{
					if(common_VELA.OP_FP){
						OwnPlantPremium = Double.toString(common_VELA.transaction_Details_Premium_Values.get("Own Plant_FP").get("Net Net Premium"));
						OwnPlantIPT = Double.toString(common_VELA.transaction_Details_Premium_Values.get("Own Plant_FP").get("Insurance Tax"));
    					common_VELA.OP_FP = false;
					}else{
						OwnPlantPremium = Double.toString(common_VELA.transaction_Details_Premium_Values.get("Own Plant").get("Net Net Premium"));
						OwnPlantIPT = Double.toString(common_VELA.transaction_Details_Premium_Values.get("Own Plant").get("Insurance Tax"));
					}
					
				}catch(NullPointerException npe){
					OwnPlantPremium = "0.0";
					OwnPlantIPT = "0.0";
				}
			}
			else if(common.currentRunningFlow.equals("CAN")){
				
				String productName = TestBase.product;
				try{
					/*switch(productName){
						case "COB":*/
						
							OwnPlantPremium = "-"+Double.toString(common_COB.CAN_COB_ReturnP_Values_Map.get("Own Plant").get("Net Net Premium"));
							OwnPlantIPT = "-"+Double.toString(common_COB.CAN_COB_ReturnP_Values_Map.get("Own Plant").get("Insurance Tax"));
							/*break;
						case "COA":
							OwnPlantPremium = Double.toString(common_COA.CAN_COA_ReturnP_Values_Map.get("Own Plant").get("Net Net Premium"));
							OwnPlantIPT = Double.toString(common_COA.CAN_COA_ReturnP_Values_Map.get("Own Plant").get("Insurance Tax"));
							break;
							
					}*/
				}
				
				catch(NullPointerException npe){
					OwnPlantPremium = "0.0";
					OwnPlantIPT = "0.0";
				}
			}
            else if(common.currentRunningFlow.equals("NB") || common.currentRunningFlow.equals("Rewind")|| common.currentRunningFlow.equals("Requote")){
					
				if(!((String)data_map.get("PS_Duration")).equalsIgnoreCase("365")){
					double OwnPlantPremiumTransactionMap = transaction_Premium_Values.get("Own Plant").get("Net Net Premium");
					OwnPlantPremium = Double.toString(OwnPlantPremiumTransactionMap);
					double OwnPlantIPTTransactionMap = transaction_Premium_Values.get("Own Plant").get("Insurance Tax");
					OwnPlantIPT = Double.toString(OwnPlantIPTTransactionMap);
				}else{
					OwnPlantPremium = (String)data_map.get("PS_OwnPlant_NetNetPremium");
					OwnPlantIPT = (String)data_map.get("PS_OwnPlant_GT");
				}
				
				
					
			}
			else if(common.currentRunningFlow.equals("Renewal")){
				
				if(!((String)data_map.get("PS_Duration")).equalsIgnoreCase("365")){
					double OwnPlantPremiumTransactionMap = transaction_Premium_Values.get("Own Plant").get("Net Net Premium");
					OwnPlantPremium = Double.toString(OwnPlantPremiumTransactionMap);
					double OwnPlantIPTTransactionMap = transaction_Premium_Values.get("Own Plant").get("Insurance Tax");
					OwnPlantIPT = Double.toString(OwnPlantIPTTransactionMap);
				}else{
					OwnPlantPremium = (String)data_map.get("PS_OwnPlant_NetNetPremium");
					OwnPlantIPT = (String)data_map.get("PS_OwnPlant_GT");
				}
				
				
					
			}
			String part1= "//*[@id='table0']/tbody";
			String actualOwnPlantPremium = driver.findElement(By.xpath(part1+"/tr["+j+"]/td["+td+"]")).getText();
			String actualOwnPlantIPT = driver.findElement(By.xpath(part1+"/tr["+j+"]/td["+(td+1)+"]")).getText();
			String actualOwnPlantDue = driver.findElement(By.xpath(part1+"/tr["+j+"]/td["+(td+2)+"]")).getText();
			compareValues(Math.abs(Double.parseDouble(OwnPlantPremium)), Math.abs(Double.parseDouble(actualOwnPlantPremium)), "Own Plant Amount");
			compareValues(Math.abs(Double.parseDouble(OwnPlantIPT)), Math.abs(Double.parseDouble(actualOwnPlantIPT)), "Own Plant IPT");
			double OwnPlantDue = Double.parseDouble(OwnPlantPremium)+ Double.parseDouble(OwnPlantIPT);
			String OwnPlantDueamt= common.roundedOff(Double.toString(OwnPlantDue)) ;
			compareValues(Math.abs(Double.parseDouble(OwnPlantDueamt)), Math.abs(Double.parseDouble(actualOwnPlantDue)), "Own Plant Due ");
			return OwnPlantDue;
		
		}catch(Throwable t) {
			String methodName = new Object(){}.getClass().getEnclosingMethod().getName();
			TestUtil.reportFunctionFailed("Failed in "+methodName+" function");    
			k.reportErr("Failed in "+methodName+" function", t);
			Assert.fail("Failed in Calculate Own Plant ammount.  \n", t);
			return 0;
		}

	}
	public double calculateHiredInPlantTS(String fileName,Map<Object, Object> data_map,String code ,int j,int td){
		try{
			String HIPPremium = null;
			String HIPIPT = null;
			if(common.currentRunningFlow.equals("MTA") && TestBase.businessEvent.equalsIgnoreCase("MTA") || 
					common.currentRunningFlow.equals("Rewind") && TestBase.businessEvent.equalsIgnoreCase("MTA")	){
				
				try{
					
					if(common_COB.MTARewindFlow.equalsIgnoreCase("Yes")){
						HIPPremium = Double.toString(common_VELA.transaction_Details_Premium_Values.get("Hired In Plant").get("Net Net Premium"));
						HIPIPT = Double.toString(common_VELA.transaction_Details_Premium_Values.get("Hired In Plant").get("Insurance Tax"));
					}else{
						if(common_VELA.HIP_FP){
							HIPPremium = Double.toString(common_VELA.transaction_Details_Premium_Values.get("Hired In Plant_FP").get("Net Net Premium"));
							HIPIPT = Double.toString(common_VELA.transaction_Details_Premium_Values.get("Hired In Plant_FP").get("Insurance Tax"));
	    					common_VELA.HIP_FP = false;
						}else{
							HIPPremium = Double.toString(common_VELA.transaction_Details_Premium_Values.get("Hired In Plant").get("Net Net Premium"));
							HIPIPT = Double.toString(common_VELA.transaction_Details_Premium_Values.get("Hired In Plant").get("Insurance Tax"));
						}
						
					}
					
				}catch(NullPointerException npe){
					HIPPremium = "0.0";
					HIPIPT = "0.0";
				}
			}
			else if(common.currentRunningFlow.equals("CAN")){
				
				
				String productName = TestBase.product;
				try{
					/*switch(productName){
						case "COB":*/
						
							HIPPremium = "-"+Double.toString(common_COB.CAN_COB_ReturnP_Values_Map.get("Hired In Plant").get("Net Net Premium"));
							HIPIPT = "-"+Double.toString(common_COB.CAN_COB_ReturnP_Values_Map.get("Hired In Plant").get("Insurance Tax"));
							/*break;
						case "COA":
							HIPPremium = Double.toString(common_COA.CAN_COA_ReturnP_Values_Map.get("Hired In Plant").get("Net Net Premium"));
							HIPIPT = Double.toString(common_COA.CAN_COA_ReturnP_Values_Map.get("Hired In Plant").get("Insurance Tax"));
							break;
							
					}*/
				}
				
				catch(NullPointerException npe){
					HIPPremium = "0.0";
					HIPIPT = "0.0";
				}
			}
            else if(common.currentRunningFlow.equals("NB") || common.currentRunningFlow.equals("Rewind") || common.currentRunningFlow.equals("Requote")){
					
				if(!((String)data_map.get("PS_Duration")).equalsIgnoreCase("365")){
					double HIPPremiumTransactionMap = transaction_Premium_Values.get("Hired In Plant").get("Net Net Premium");
					HIPPremium = Double.toString(HIPPremiumTransactionMap);
					double HIPIPTTransactionMap = transaction_Premium_Values.get("Hired In Plant").get("Insurance Tax");
					HIPIPT = Double.toString(HIPIPTTransactionMap);
				}else{
					HIPPremium = (String)data_map.get("PS_HiredInPlant_NetNetPremium");
					HIPIPT = (String)data_map.get("PS_HiredInPlant_GT");
				}
				
				
				
					
			}
			else if(common.currentRunningFlow.equals("Renewal")){
				
				if(!((String)data_map.get("PS_Duration")).equalsIgnoreCase("365")){
					double HIPPremiumTransactionMap = transaction_Premium_Values.get("Hired In Plant").get("Net Net Premium");
					HIPPremium = Double.toString(HIPPremiumTransactionMap);
					double HIPIPTTransactionMap = transaction_Premium_Values.get("Hired In Plant").get("Insurance Tax");
					HIPIPT = Double.toString(HIPIPTTransactionMap);
				}else{
					HIPPremium = (String)data_map.get("PS_HiredInPlant_NetNetPremium");
					HIPIPT = (String)data_map.get("PS_HiredInPlant_GT");
				}
				
				
				
					
			}
			String part1= "//*[@id='table0']/tbody";
			String actualHIP= driver.findElement(By.xpath(part1+"/tr["+j+"]/td["+td+"]")).getText();
			String actualHIPIPT = driver.findElement(By.xpath(part1+"/tr["+j+"]/td["+(td+1)+"]")).getText();
			String actualHIPDue = driver.findElement(By.xpath(part1+"/tr["+j+"]/td["+(td+2)+"]")).getText();
			compareValues(Math.abs(Double.parseDouble(HIPPremium)), Math.abs(Double.parseDouble(actualHIP)), "Hired In Plant Amount ");
			compareValues(Math.abs(Double.parseDouble(actualHIPIPT)), Math.abs(Double.parseDouble(HIPIPT)), "Hired In Plant IPT ");
			double HIPDue = Double.parseDouble(HIPPremium)+ Double.parseDouble(HIPIPT);	
			compareValues(Math.abs(Double.parseDouble(actualHIPDue)), Math.abs(Double.parseDouble(common.roundedOff(Double.toString(HIPDue)))), "Hired In Plant Due Amount ");
			return Double.parseDouble(common.roundedOff(Double.toString(HIPDue)));	

		}catch(Throwable t) {
			String methodName = new Object(){}.getClass().getEnclosingMethod().getName();
			TestUtil.reportFunctionFailed("Failed in "+methodName+" function");     
			k.reportErr("Failed in "+methodName+" function", t);
			Assert.fail("Failed in Hired In Plant Summary \n", t);
			return 0;
		}
	}
	public double calculateHireCoverPlusTS(String fileName,Map<Object, Object> data_map,String code ,int j,int td){
		try{
			String HCPPremium = null;
			String HCPIPT = null;
			if(common.currentRunningFlow.equals("MTA") && TestBase.businessEvent.equalsIgnoreCase("MTA") || 
					common.currentRunningFlow.equals("Rewind") && TestBase.businessEvent.equalsIgnoreCase("MTA")	){
				
				try{
					
					if(common_COB.MTARewindFlow.equalsIgnoreCase("Yes")){
						HCPPremium = Double.toString(common_VELA.transaction_Details_Premium_Values.get("Hire Cover Plus").get("Net Net Premium"));
						HCPIPT = Double.toString(common_VELA.transaction_Details_Premium_Values.get("Hire Cover Plus").get("Insurance Tax"));
					}else{
						HCPPremium = Double.toString(common_VELA.transaction_Details_Premium_Values.get("Hire Cover Plus").get("Net Net Premium"));
						HCPIPT = Double.toString(common_VELA.transaction_Details_Premium_Values.get("Hire Cover Plus").get("Insurance Tax"));
					}
					
				}catch(NullPointerException npe){
					HCPPremium = "0.0";
					HCPIPT = "0.0";
				}
			}
			else if(common.currentRunningFlow.equals("CAN")){
				
				String productName = TestBase.product;
				try{
					/*switch(productName){
						case "COB":*/
						
							HCPPremium = "-"+Double.toString(common_COB.CAN_COB_ReturnP_Values_Map.get("Hire Cover Plus").get("Net Net Premium"));
							HCPIPT = "-"+Double.toString(common_COB.CAN_COB_ReturnP_Values_Map.get("Hire Cover Plus").get("Insurance Tax"));
						/*	break;
						case "COA":
							HCPPremium = Double.toString(common_COA.CAN_COA_ReturnP_Values_Map.get("Hire Cover Plus").get("Net Net Premium"));
							HCPIPT = Double.toString(common_COA.CAN_COA_ReturnP_Values_Map.get("Hire Cover Plus").get("Insurance Tax"));
							break;
							
					}*/
				}
				
				catch(NullPointerException npe){
					HCPPremium = "0.0";
					HCPIPT = "0.0";
				}
			}
            else if(common.currentRunningFlow.equals("NB") || common.currentRunningFlow.equals("Rewind") || common.currentRunningFlow.equals("Requote")){
				
				if(!((String)data_map.get("PS_Duration")).equalsIgnoreCase("365")){
					double HCPPremiumTransactionMap = transaction_Premium_Values.get("Hired In Plant").get("Net Net Premium");
					HCPPremium = Double.toString(HCPPremiumTransactionMap);
					double HCPIPTTransactionMap = transaction_Premium_Values.get("Hired In Plant").get("Insurance Tax");
					HCPIPT = Double.toString(HCPIPTTransactionMap);
				}else{
					HCPPremium = (String)data_map.get("PS_HireCoverPlus_NetNetPremium");
					HCPIPT = (String)data_map.get("PS_HireCoverPlus_GT");
				}
				
					
			}
			else if(common.currentRunningFlow.equals("Renewal")){
				
				if(!((String)data_map.get("PS_Duration")).equalsIgnoreCase("365")){
					double HCPPremiumTransactionMap = transaction_Premium_Values.get("Hired In Plant").get("Net Net Premium");
					HCPPremium = Double.toString(HCPPremiumTransactionMap);
					double HCPIPTTransactionMap = transaction_Premium_Values.get("Hired In Plant").get("Insurance Tax");
					HCPIPT = Double.toString(HCPIPTTransactionMap);
				}else{
					HCPPremium = (String)data_map.get("PS_HireCoverPlus_NetNetPremium");
					HCPIPT = (String)data_map.get("PS_HireCoverPlus_GT");
				}
				
					
			}
			String part1= "//*[@id='table0']/tbody";
			String actualHCP= driver.findElement(By.xpath(part1+"/tr["+j+"]/td["+td+"]")).getText();
			String actualHCPIPT = driver.findElement(By.xpath(part1+"/tr["+j+"]/td["+(td+1)+"]")).getText();
			String actualHCPDue = driver.findElement(By.xpath(part1+"/tr["+j+"]/td["+(td+2)+"]")).getText();
			compareValues(Math.abs(Double.parseDouble(HCPPremium)), Math.abs(Double.parseDouble(actualHCP)), "Hire Cover Plus Amount ");
			compareValues(Math.abs(Double.parseDouble(actualHCPIPT)), Math.abs(Double.parseDouble(HCPIPT)), "Hire Cover Plus IPT ");
			double HCPDue = Double.parseDouble(HCPPremium)+ Double.parseDouble(HCPIPT);	
			compareValues( Math.abs(Double.parseDouble(actualHCPDue)), Math.abs(Double.parseDouble(common.roundedOff(Double.toString(HCPDue)))), "Hire Cover Plus Due Amount ");
			return Double.parseDouble(common.roundedOff(Double.toString(HCPDue)));	

		}catch(Throwable t) {
			String methodName = new Object(){}.getClass().getEnclosingMethod().getName();
			TestUtil.reportFunctionFailed("Failed in "+methodName+" function");     
			k.reportErr("Failed in "+methodName+" function", t);
			Assert.fail("Failed in Hire Cover Plus Transaction Summary \n", t);
			return 0;
		}
	}
	
	
	public double calculateLegalExpensesTS(String fileName,Map<Object, Object> data_map,String code ,int j,int td){
		try{
			String LegalExpensesPremium = null;
			String LegalExpensesIPT = null;
			if(common.currentRunningFlow.equals("MTA") && TestBase.businessEvent.equalsIgnoreCase("MTA") || 
					common.currentRunningFlow.equals("Rewind") && TestBase.businessEvent.equalsIgnoreCase("MTA")	){
				
				try{
					
					if(common_COB.MTARewindFlow.equalsIgnoreCase("Yes")){
						LegalExpensesPremium = Double.toString(common_VELA.transaction_Details_Premium_Values.get("Legal Expenses").get("Net Net Premium"));
						LegalExpensesIPT = Double.toString(common_VELA.transaction_Details_Premium_Values.get("Legal Expenses").get("Insurance Tax"));
					}else{
						if(common_VELA.LE_FP){
							LegalExpensesPremium = Double.toString(common_VELA.transaction_Details_Premium_Values.get("Abbey Legal Expenses_FP").get("Net Net Premium"));
							LegalExpensesIPT = Double.toString(common_VELA.transaction_Details_Premium_Values.get("Abbey Legal Expenses_FP").get("Insurance Tax"));
	    					common_VELA.LE_FP = false;
						}else{
							LegalExpensesPremium = Double.toString(common_VELA.transaction_Details_Premium_Values.get("Abbey Legal Expenses").get("Net Net Premium"));
							LegalExpensesIPT = Double.toString(common_VELA.transaction_Details_Premium_Values.get("Abbey Legal Expenses").get("Insurance Tax"));
						}
						
					}
					
				}catch(NullPointerException npe){
					LegalExpensesPremium = "0.0";
					LegalExpensesIPT = "0.0";
				}
			}
			else if(common.currentRunningFlow.equals("CAN")){
				
				
				String productName = TestBase.product;
				try{
					/*switch(productName){
						case "COB":*/
						
							LegalExpensesPremium = "-"+Double.toString(common_COB.CAN_COB_ReturnP_Values_Map.get("Abbey Legal Expenses").get("Net Net Premium"));
							LegalExpensesIPT = "-"+Double.toString(common_COB.CAN_COB_ReturnP_Values_Map.get("Abbey Legal Expenses").get("Insurance Tax"));
							/*break;
						case "COA":
							LegalExpensesPremium = Double.toString(common_COA.CAN_COA_ReturnP_Values_Map.get("Abbey Legal Expenses").get("Net Net Premium"));
							LegalExpensesIPT = Double.toString(common_COA.CAN_COA_ReturnP_Values_Map.get("Abbey Legal Expenses").get("Insurance Tax"));
							break;
							
					}*/
				}
				
				catch(NullPointerException npe){
					LegalExpensesPremium = "0.0";
					LegalExpensesIPT = "0.0";
				}
			}
            else if(common.currentRunningFlow.equals("NB") || common.currentRunningFlow.equals("Rewind") || common.currentRunningFlow.equals("Requote")){
					
				if(!((String)data_map.get("PS_Duration")).equalsIgnoreCase("365")){
					double LegalExpensesPremiumTransactionMap = 0.0;
					double LegalExpensesIPTTransactionMap = 0.0;
					try{
						LegalExpensesPremiumTransactionMap = transaction_Premium_Values.get("Abbey Legal Expenses").get("Net Net Premium");
					}catch(Throwable t){
						LegalExpensesPremiumTransactionMap = transaction_Premium_Values.get("Legal Expenses").get("Net Net Premium");
					}
					LegalExpensesPremium = Double.toString(LegalExpensesPremiumTransactionMap);
					try{
						LegalExpensesIPTTransactionMap = transaction_Premium_Values.get("Abbey Legal Expenses").get("Insurance Tax");
					}catch(Throwable t1){
						LegalExpensesIPTTransactionMap = transaction_Premium_Values.get("Legal Expenses").get("Insurance Tax");
					}
					LegalExpensesIPT = Double.toString(LegalExpensesIPTTransactionMap);
				
				}else{
					LegalExpensesPremium = (String)data_map.get("PS_LegalExpenses_NetNetPremium");
					LegalExpensesIPT = (String)data_map.get("PS_LegalExpenses_GT");
				}
				
				
					
			}
			else if(common.currentRunningFlow.equals("Renewal")){
				
				if(!((String)data_map.get("PS_Duration")).equalsIgnoreCase("365")){
					double LegalExpensesPremiumTransactionMap = 0.0;
					double LegalExpensesIPTTransactionMap = 0.0;
					try{
						LegalExpensesPremiumTransactionMap = transaction_Premium_Values.get("Abbey Legal Expenses").get("Net Net Premium");
					}catch(Throwable t){
						LegalExpensesPremiumTransactionMap = transaction_Premium_Values.get("Legal Expenses").get("Net Net Premium");
					}
					LegalExpensesPremium = Double.toString(LegalExpensesPremiumTransactionMap);
					try{
						LegalExpensesIPTTransactionMap = transaction_Premium_Values.get("Abbey Legal Expenses").get("Insurance Tax");
					}catch(Throwable t1){
						LegalExpensesIPTTransactionMap = transaction_Premium_Values.get("Legal Expenses").get("Insurance Tax");
					}
					LegalExpensesIPT = Double.toString(LegalExpensesIPTTransactionMap);
				
				}else{
					LegalExpensesPremium = (String)data_map.get("PS_LegalExpenses_NetNetPremium");
					LegalExpensesIPT = (String)data_map.get("PS_LegalExpenses_GT");
				}
				
				
					
			}
			else if(common.currentRunningFlow.equals("Rewind")){
				
				if(!((String)data_map.get("PS_Duration")).equalsIgnoreCase("365")){
					double LegalExpensesPremiumTransactionMap = 0.0;
					double LegalExpensesIPTTransactionMap = 0.0;
					try{
						LegalExpensesPremiumTransactionMap = transaction_Premium_Values.get("Abbey Legal Expenses").get("Net Net Premium");
					}catch(Throwable t){
						LegalExpensesPremiumTransactionMap = transaction_Premium_Values.get("Legal Expenses").get("Net Net Premium");
					}
					LegalExpensesPremium = Double.toString(LegalExpensesPremiumTransactionMap);
					try{
						LegalExpensesIPTTransactionMap = transaction_Premium_Values.get("Abbey Legal Expenses").get("Insurance Tax");
					}catch(Throwable t1){
						LegalExpensesIPTTransactionMap = transaction_Premium_Values.get("Legal Expenses").get("Insurance Tax");
					}
					LegalExpensesIPT = Double.toString(LegalExpensesIPTTransactionMap);
				
				}else{
					LegalExpensesPremium = (String)data_map.get("PS_LegalExpenses_NetNetPremium");
					LegalExpensesIPT = (String)data_map.get("PS_LegalExpenses_GT");
				}
				
				
					
			}
			String part1= "//*[@id='table0']/tbody";
			String actualLegalExpensesPremium = driver.findElement(By.xpath(part1+"/tr["+j+"]/td["+td+"]")).getText();
			String actualLegalExpensesIPT = driver.findElement(By.xpath(part1+"/tr["+j+"]/td["+(td+1)+"]")).getText();
			String actualLegalExpensesDue = driver.findElement(By.xpath(part1+"/tr["+j+"]/td["+(td+2)+"]")).getText();
			compareValues(Math.abs(Double.parseDouble(LegalExpensesPremium)), Math.abs(Double.parseDouble(actualLegalExpensesPremium)), "Legal Expenses Amount");
			compareValues(Math.abs(Double.parseDouble(LegalExpensesIPT)), Math.abs(Double.parseDouble(actualLegalExpensesIPT)), "Legal Expenses IPT");
			double LegalExpensesDue = Double.parseDouble(LegalExpensesPremium)+ Double.parseDouble(LegalExpensesIPT);
			String LegalExpensesDueamt= common.roundedOff(Double.toString(LegalExpensesDue)) ;
			compareValues(Math.abs(Double.parseDouble(LegalExpensesDueamt)), Math.abs(Double.parseDouble(actualLegalExpensesDue)), "LegalExpenses Due ");
			return LegalExpensesDue;
		
		}catch(Throwable t) {
			String methodName = new Object(){}.getClass().getEnclosingMethod().getName();
			TestUtil.reportFunctionFailed("Failed in "+methodName+" function");    
			k.reportErr("Failed in "+methodName+" function", t);
			Assert.fail("Failed in Calculate Legal Expenses ammount.  \n", t);
			return 0;
		}

	}
	
	
	
	public double calculateJCT651TS(String fileName,Map<Object, Object> data_map,String code ,int j,int td){
		try{
			String JCTPremium = null;
			String JCTIPT = null;
			if(common.currentRunningFlow.equals("MTA") && TestBase.businessEvent.equalsIgnoreCase("MTA") || 
					common.currentRunningFlow.equals("Rewind") && TestBase.businessEvent.equalsIgnoreCase("MTA")	){
				
				try{
					
					if(common_COB.MTARewindFlow.equalsIgnoreCase("Yes")){
						JCTPremium = Double.toString(common_VELA.transaction_Details_Premium_Values.get("JCT 6.5.1").get("Net Net Premium"));
						JCTIPT = Double.toString(common_VELA.transaction_Details_Premium_Values.get("JCT 6.5.1").get("Insurance Tax"));
					}else{
						if(common_VELA.JCT_FP){
							JCTPremium = Double.toString(common_VELA.transaction_Details_Premium_Values.get("JCT 6.5.1_FP").get("Net Net Premium"));
							JCTIPT = Double.toString(common_VELA.transaction_Details_Premium_Values.get("JCT 6.5.1_FP").get("Insurance Tax"));
	    					common_VELA.JCT_FP = false;
						}else{
							if(TestBase.product.contains("COA")){
								JCTPremium = Double.toString(common_VELA.transaction_Details_Premium_Values.get("JCT 6.5.1").get("Net Net Premium"));
								JCTIPT = Double.toString(common_VELA.transaction_Details_Premium_Values.get("JCT 6.5.1").get("Insurance Tax"));
							}else{
								JCTPremium = Double.toString(common_VELA.transaction_Details_Premium_Values.get("JCT 6.5.1").get("Net Net Premium"));
								JCTIPT = Double.toString(common_VELA.transaction_Details_Premium_Values.get("JCT 6.5.1").get("Insurance Tax"));
							}
						}
						
					}
					
				}catch(NullPointerException npe){
					JCTPremium = "0.0";
					JCTIPT = "0.0";
				}
			}
			else if(common.currentRunningFlow.equals("CAN")){
				
				
				String productName = TestBase.product;
				try{
					/*switch(productName){
						case "COB":*/
						
							JCTPremium = "-"+Double.toString(common_COB.CAN_COB_ReturnP_Values_Map.get("JCT 6.5.1").get("Net Net Premium"));
							JCTIPT = "-"+Double.toString(common_COB.CAN_COB_ReturnP_Values_Map.get("JCT 6.5.1").get("Insurance Tax"));
							/*break;
						case "COA":
							JCTPremium = Double.toString(common_COA.CAN_COA_ReturnP_Values_Map.get("JCT 6.5.1").get("Net Net Premium"));
							JCTIPT = Double.toString(common_COA.CAN_COA_ReturnP_Values_Map.get("JCT 6.5.1").get("Insurance Tax"));
							break;
						case "XOC":
						     JCTPremium = Double.toString(common_XOC.CAN_XOC_ReturnP_Values_Map.get("JCT 6.5.1").get("Net Net Premium"));
						     JCTIPT = Double.toString(common_XOC.CAN_XOC_ReturnP_Values_Map.get("JCT 6.5.1").get("Insurance Tax"));
						     break;
							
							
					}*/
				}
				catch(NullPointerException npe){
					JCTPremium = "0.0";
					JCTIPT = "0.0";
				}
			}
            else if(common.currentRunningFlow.equals("NB") || common.currentRunningFlow.equals("Rewind")|| common.currentRunningFlow.equals("Requote")){
					
				if(!((String)data_map.get("PS_Duration")).equalsIgnoreCase("365")){
					double JCTPremiumTransactionMap = transaction_Premium_Values.get("JCT 6.5.1").get("Net Net Premium");
					JCTPremium = Double.toString(JCTPremiumTransactionMap);
					double JCTIPTTransactionMap = transaction_Premium_Values.get("JCT 6.5.1").get("Insurance Tax");
					JCTIPT = Double.toString(JCTIPTTransactionMap);
				}else{
					JCTPremium = (String)data_map.get("PS_JCT6.5.1_NetNetPremium");
					JCTIPT = (String)data_map.get("PS_JCT6.5.1_GT");
				}
				
				
					
			}
			else if(common.currentRunningFlow.equals("Renewal")){
				
				if(!((String)data_map.get("PS_Duration")).equalsIgnoreCase("365")){
					double JCTPremiumTransactionMap = transaction_Premium_Values.get("JCT 6.5.1").get("Net Net Premium");
					JCTPremium = Double.toString(JCTPremiumTransactionMap);
					double JCTIPTTransactionMap = transaction_Premium_Values.get("JCT 6.5.1").get("Insurance Tax");
					JCTIPT = Double.toString(JCTIPTTransactionMap);
				}else{
					JCTPremium = (String)data_map.get("PS_JCT6.5.1_NetNetPremium");
					JCTIPT = (String)data_map.get("PS_JCT6.5.1_GT");
				}
				
				
					
			}
			else if(common.currentRunningFlow.equals("Rewind")){
				
				if(!((String)data_map.get("PS_Duration")).equalsIgnoreCase("365")){
					double JCTPremiumTransactionMap = transaction_Premium_Values.get("JCT 6.5.1").get("Net Net Premium");
					JCTPremium = Double.toString(JCTPremiumTransactionMap);
					double JCTIPTTransactionMap = transaction_Premium_Values.get("JCT 6.5.1").get("Insurance Tax");
					JCTIPT = Double.toString(JCTIPTTransactionMap);
				}else{
					JCTPremium = (String)data_map.get("PS_JCT6.5.1_NetNetPremium");
					JCTIPT = (String)data_map.get("PS_JCT6.5.1_GT");
				}
				
				
					
			}
			String part1= "//*[@id='table0']/tbody";
			String actualJCTPremium = driver.findElement(By.xpath(part1+"/tr["+j+"]/td["+td+"]")).getText();
			String actualJCTIPT = driver.findElement(By.xpath(part1+"/tr["+j+"]/td["+(td+1)+"]")).getText();
			String actualJCTDue = driver.findElement(By.xpath(part1+"/tr["+j+"]/td["+(td+2)+"]")).getText();
			compareValues(Math.abs(Double.parseDouble(JCTPremium)), Math.abs(Double.parseDouble(actualJCTPremium)), "JCT 6.5.1 Amount");
			compareValues(Math.abs(Double.parseDouble(JCTIPT)), Math.abs(Double.parseDouble(actualJCTIPT)), "JCT 6.5.1 IPT");
			double JCTDue = Double.parseDouble(JCTPremium)+ Double.parseDouble(JCTIPT);
			String JCTDueamt= common.roundedOff(Double.toString(JCTDue)) ;
			compareValues(Math.abs(Double.parseDouble(JCTDueamt)), Math.abs(Double.parseDouble(actualJCTDue)), "JCT 6.5.1 Due ");
			return JCTDue;
		
		}catch(Throwable t) {
			String methodName = new Object(){}.getClass().getEnclosingMethod().getName();
			TestUtil.reportFunctionFailed("Failed in "+methodName+" function");    
			k.reportErr("Failed in "+methodName+" function", t);
			Assert.fail("Failed in Calculate JCT 6.5.1 ammount.  \n", t);
			return 0;
		}

	}
	public double calculatePropertyOwnersLiabilityTS(String fileName,Map<Object, Object> data_map,String code ,int j,int td){
		try{
			String POLPremium = null;
			String POLIPT = null;
			if(common.currentRunningFlow.equals("MTA") && TestBase.businessEvent.equalsIgnoreCase("MTA") || 
					common.currentRunningFlow.equals("Rewind") && TestBase.businessEvent.equalsIgnoreCase("MTA")	){
				
				try{
					if(common_VELA.POL_FP){
						POLPremium = Double.toString(common_VELA.transaction_Details_Premium_Values.get("Property Owners Liability_FP").get("Net Net Premium"));
						POLIPT = Double.toString(common_VELA.transaction_Details_Premium_Values.get("Property Owners Liability_FP").get("Insurance Tax"));
    					common_VELA.POL_FP = false;
					}else{
						if(TestBase.product.contains("COA")){
							POLPremium = Double.toString(common_VELA.transaction_Details_Premium_Values.get("Property Owners Liability").get("Net Net Premium"));
							POLIPT = Double.toString(common_VELA.transaction_Details_Premium_Values.get("Property Owners Liability").get("Insurance Tax"));
						}else{
							POLPremium = Double.toString(common_VELA.transaction_Details_Premium_Values.get("Property Owners Liability").get("Net Net Premium"));
							POLIPT = Double.toString(common_VELA.transaction_Details_Premium_Values.get("Property Owners Liability").get("Insurance Tax"));
						}
					}
					
				}catch(NullPointerException npe){
					POLPremium = "0.0";
					POLIPT = "0.0";
				}
			}
			else  if(common.currentRunningFlow.equals("CAN")){
				
				String productName = common.product;
				try{
					/*switch(productName){
						case "COB":*/
						
							POLPremium = "-"+Double.toString(common_COB.CAN_COB_ReturnP_Values_Map.get("Property Owners Liability").get("Net Net Premium"));
							POLIPT = "-"+Double.toString(common_COB.CAN_COB_ReturnP_Values_Map.get("Property Owners Liability").get("Insurance Tax"));
							
							/*break;
						case "COA":
							POLPremium = Double.toString(common_COA.CAN_COA_ReturnP_Values_Map.get("Property Owners Liability").get("Net Net Premium"));
							POLIPT = Double.toString(common_COA.CAN_COA_ReturnP_Values_Map.get("Property Owners Liability").get("Insurance Tax"));
							break;
							
					}*/
				}
				catch(NullPointerException npe){
					POLPremium = "0.0";
					POLIPT = "0.0";
				}
			}
            else if(common.currentRunningFlow.equals("NB") || common.currentRunningFlow.equals("Rewind")|| common.currentRunningFlow.equals("Requote")){
					
				if(!((String)data_map.get("PS_Duration")).equalsIgnoreCase("365")){
					double POLPremiumTransactionMap = transaction_Premium_Values.get("Property Owners Liability").get("Net Net Premium");
					POLPremium = Double.toString(POLPremiumTransactionMap);
					double POLIPTTransactionMap = transaction_Premium_Values.get("Property Owners Liability").get("Insurance Tax");
					POLIPT = Double.toString(POLIPTTransactionMap);
				}else{
					POLPremium = (String)data_map.get("PS_PropertyOwnersLiability_NetNetPremium");
					POLIPT = (String)data_map.get("PS_PropertyOwnersLiability_GT");
				}
				
				
					
			}
			else if(common.currentRunningFlow.equals("Renewal")){
				
				if(!((String)data_map.get("PS_Duration")).equalsIgnoreCase("365")){
					double POLPremiumTransactionMap = transaction_Premium_Values.get("Property Owners Liability").get("Net Net Premium");
					POLPremium = Double.toString(POLPremiumTransactionMap);
					double POLIPTTransactionMap = transaction_Premium_Values.get("Property Owners Liability").get("Insurance Tax");
					POLIPT = Double.toString(POLIPTTransactionMap);
				}else{
					POLPremium = (String)data_map.get("PS_PropertyOwnersLiability_NetNetPremium");
					POLIPT = (String)data_map.get("PS_PropertyOwnersLiability_GT");
				}
				
				
					
			}
			String part1= "//*[@id='table0']/tbody";
			String actualPOLPremium = driver.findElement(By.xpath(part1+"/tr["+j+"]/td["+td+"]")).getText();
			String actualPOLIPT = driver.findElement(By.xpath(part1+"/tr["+j+"]/td["+(td+1)+"]")).getText();
			String actualPOLDue = driver.findElement(By.xpath(part1+"/tr["+j+"]/td["+(td+2)+"]")).getText();
			compareValues(Math.abs(Double.parseDouble(POLPremium)), Math.abs(Double.parseDouble(actualPOLPremium)), "Property Owners Liability Amount");
			compareValues(Math.abs(Double.parseDouble(POLIPT)), Math.abs(Double.parseDouble(actualPOLIPT)), "Property Owners Liability IPT");
			double POLDue = Double.parseDouble(POLPremium)+ Double.parseDouble(POLIPT);
			String POLDueamt= common.roundedOff(Double.toString(POLDue)) ;
			compareValues(Math.abs(Double.parseDouble(POLDueamt)), Math.abs(Double.parseDouble(actualPOLDue)), "Property Owners Liability Due ");
			return POLDue;
		}catch(Throwable t) {
			String methodName = new Object(){}.getClass().getEnclosingMethod().getName();
			TestUtil.reportFunctionFailed("Failed in "+methodName+" function");    
			k.reportErr("Failed in "+methodName+" function", t);
			Assert.fail("Failed in Calculate Property Owners Liability ammount.  \n", t);
			return 0;
		}

	}
	public double calculateTerrorismTS(String fileName,Map<Object, Object> data_map,String code ,int j,int td){
		try{
			String TerrorismPremium = null;
			String TerrorismIPT = null;
			if(common.currentRunningFlow.equals("MTA") && TestBase.businessEvent.equalsIgnoreCase("MTA") || 
					common.currentRunningFlow.equals("Rewind") && TestBase.businessEvent.equalsIgnoreCase("MTA")	){
				
				try{
					if(common_VELA.TER_FP){
						TerrorismPremium = Double.toString(common_VELA.transaction_Details_Premium_Values.get("Terrorism_FP").get("Net Net Premium"));
						TerrorismIPT = Double.toString(common_VELA.transaction_Details_Premium_Values.get("Terrorism_FP").get("Insurance Tax"));
    					common_VELA.TER_FP = false;
					}else{
						TerrorismPremium = Double.toString(common_VELA.transaction_Details_Premium_Values.get("Terrorism").get("Net Net Premium"));
						TerrorismIPT = Double.toString(common_VELA.transaction_Details_Premium_Values.get("Terrorism").get("Insurance Tax"));
					}
					
				}catch(NullPointerException npe){
					TerrorismPremium = "0.0";
					TerrorismIPT = "0.0";
				}
			}
			else if(common.currentRunningFlow.equals("CAN")){
				String productName = TestBase.product;
				try{
					/*switch(productName){
						case "COB":
						*/
							TerrorismPremium = "-"+Double.toString(common_COB.CAN_COB_ReturnP_Values_Map.get("Terrorism").get("Net Net Premium"));
							TerrorismIPT = "-"+Double.toString(common_COB.CAN_COB_ReturnP_Values_Map.get("Terrorism").get("Insurance Tax"));
							/*break;
						case "COA":
							TerrorismPremium = Double.toString(common_COA.CAN_COA_ReturnP_Values_Map.get("Terrorism").get("Net Net Premium"));
							TerrorismIPT = Double.toString(common_COA.CAN_COA_ReturnP_Values_Map.get("Terrorism").get("Insurance Tax"));
							break;
							
					}*/
				}
				catch(NullPointerException npe){
					TerrorismPremium = "0.0";
					TerrorismIPT = "0.0";
				}
			}
            else if(common.currentRunningFlow.equals("NB") || common.currentRunningFlow.equals("Rewind") || common.currentRunningFlow.equals("Requote")){
					
				if(!((String)data_map.get("PS_Duration")).equalsIgnoreCase("365")){
					double TerrorismPremiumTransactionMap = transaction_Premium_Values.get("Terrorism").get("Net Net Premium");
					TerrorismPremium = Double.toString(TerrorismPremiumTransactionMap);
					double TerrorismIPTTransactionMap = transaction_Premium_Values.get("Terrorism").get("Insurance Tax");
					TerrorismIPT = Double.toString(TerrorismIPTTransactionMap);
				}else{
					TerrorismPremium = (String)data_map.get("PS_Terrorism_NetNetPremium");
					TerrorismIPT = (String)data_map.get("PS_Terrorism_GT");
				}
				
				
					
			}
			else if(common.currentRunningFlow.equals("Renewal")){
				
				if(!((String)data_map.get("PS_Duration")).equalsIgnoreCase("365")){
					double TerrorismPremiumTransactionMap = transaction_Premium_Values.get("Terrorism").get("Net Net Premium");
					TerrorismPremium = Double.toString(TerrorismPremiumTransactionMap);
					double TerrorismIPTTransactionMap = transaction_Premium_Values.get("Terrorism").get("Insurance Tax");
					TerrorismIPT = Double.toString(TerrorismIPTTransactionMap);
				}else{
					TerrorismPremium = (String)data_map.get("PS_Terrorism_NetNetPremium");
					TerrorismIPT = (String)data_map.get("PS_Terrorism_GT");
				}
				
				
					
			}
			else if(common.currentRunningFlow.equals("Rewind")){
				
				if(!((String)data_map.get("PS_Duration")).equalsIgnoreCase("365")){
					double TerrorismPremiumTransactionMap = transaction_Premium_Values.get("Terrorism").get("Net Net Premium");
					TerrorismPremium = Double.toString(TerrorismPremiumTransactionMap);
					double TerrorismIPTTransactionMap = transaction_Premium_Values.get("Terrorism").get("Insurance Tax");
					TerrorismIPT = Double.toString(TerrorismIPTTransactionMap);
				}else{
					TerrorismPremium = (String)data_map.get("PS_Terrorism_NetNetPremium");
					TerrorismIPT = (String)data_map.get("PS_Terrorism_GT");
				}
				
				
					
			}
			String part1= "//*[@id='table0']/tbody";
			String actualTerrorismPremium = driver.findElement(By.xpath(part1+"/tr["+j+"]/td["+td+"]")).getText();
			String actualTerrorismIPT = driver.findElement(By.xpath(part1+"/tr["+j+"]/td["+(td+1)+"]")).getText();
			String actualTerrorismDue = driver.findElement(By.xpath(part1+"/tr["+j+"]/td["+(td+2)+"]")).getText();
			compareValues(Math.abs(Double.parseDouble(TerrorismPremium)), Math.abs(Double.parseDouble(actualTerrorismPremium)), "Terrorism Amount");
			compareValues(Math.abs(Double.parseDouble(TerrorismIPT)), Math.abs(Double.parseDouble(actualTerrorismIPT)), "Terrorism IPT");
			double TerrorismDue = Double.parseDouble(TerrorismPremium)+ Double.parseDouble(TerrorismIPT);
			String TerrorismDueamt= common.roundedOff(Double.toString(TerrorismDue)) ;
			compareValues(Math.abs(Double.parseDouble(TerrorismDueamt)), Math.abs(Double.parseDouble(actualTerrorismDue)), "Terrorism Due ");
			return TerrorismDue;
		}catch(Throwable t) {
			String methodName = new Object(){}.getClass().getEnclosingMethod().getName();
			TestUtil.reportFunctionFailed("Failed in "+methodName+" function");    
			k.reportErr("Failed in "+methodName+" function", t);
			Assert.fail("Failed in Calculate Terrorism ammount.  \n", t);
			return 0;
		}

	}
	public double calculateGeneralPremium(String grossPremium, String brokeCommision){
		try{
			double commRSARate = 36 - Double.parseDouble(brokeCommision) - 0.25;
			double commAIGRate = 38 - Double.parseDouble(brokeCommision) - 0.25;
			double mateialDamageRSA = Double.parseDouble(grossPremium) * 0.55 * (commRSARate/100);
			double mateialDamageAJG = Double.parseDouble(grossPremium) * 0.25 * (commAIGRate/100);
			double mateialDamageAIG = Double.parseDouble(grossPremium) * 0.2 * (commAIGRate/100);
			
			return(mateialDamageRSA + mateialDamageAJG + mateialDamageAIG);
			
		}catch(Throwable t) {
			String methodName = new Object(){}.getClass().getEnclosingMethod().getName();
			TestUtil.reportFunctionFailed("Failed in "+methodName+" function");     k.reportErr("Failed in "+methodName+" function", t);
			Assert.fail("Failed in Calculate General preimum for genral covers \n", t);
			return 0;
		}
	}
	
	
	
	/**
	 * 
	 * 
	 * 
	 * @param recipient
	 * @param account
	 * @param j
	 * @param td
	 * @return
	 */
	
	
	/**
	 * 
	 * END of Calculation of General function for transaction summary.
	 * 
	 * 
	 */
	
	public double calculateBrokeageAmountTS(String code, Map<Object, Object> data_map, String trasacSummaryType,int j,int td){
		double PublicProductsLiabilityPC = 0.00, EmployersLiabiliyPC=0.00, AnnualWorksPC=0.00, OwnPlantPC=0.00, generalPremium;
		double HiredInPlantPC =0.00, JCTPC=0.00, terrorismPC=0.00, PropertyOwnersLiabilityPC=0.00, LegalExpensesPC=0.00;
		double SingleProjectPC=0.00, HireCoverPlusPC=0.00, ThirdPartyMotorLiabilityPC=0.00, CombinedLiabilityPC=0.00;
		
		String minusSign = "-";
		String part1= "//*[@id='table0']/tbody";
		try{
			String type = driver.findElement(By.xpath(part1+"/tr["+j+"]/td[7]")).getText();
			String brokerageAccount= driver.findElement(By.xpath(part1+"/tr["+j+"]/td["+td+"]")).getText();
			if(type.equalsIgnoreCase("FEE")){
				if(common.product.equals("COB")||common.product.equals("COA")||common.product.equals("XOC")||common.product.equals("XOQ")||common.product.equals("LEA")){
					String recipient = driver.findElement(By.xpath(part1+"/tr["+j+"]/td[3]")).getText();
					if(recipient.equalsIgnoreCase("PENFEE")){
						 TestUtil.reportStatus("Expected Recipient PEN FEE verified with Actual Recipient "+recipient, "Pass", false);
					}else{
						 TestUtil.reportStatus("Expected Recipient PEN FEE does not match with Actual Recipient "+recipient, "Fail", false);
					}
				}
				generalPremium	=Double.parseDouble((String)data_map.get("PS_TotalAdminFee"));
			}else if(type.equalsIgnoreCase("T001")){
				if(!((String)data_map.get("PS_Duration")).equalsIgnoreCase("365")){
					generalPremium = transaction_Premium_Values.get("Totals").get("Net Net Premium");
				}else{
					generalPremium = Double.parseDouble((String)data_map.get("PS_NetNetPemiumTotal"));
				}
			}else if(type.equalsIgnoreCase("MGA_COM") && TestBase.product.equalsIgnoreCase("LEA")){
				if(!((String)data_map.get("PS_Duration")).equalsIgnoreCase("365")){
					generalPremium = transaction_Premium_Values.get("Totals").get("Broker Commission");
				}else{
					generalPremium = Double.parseDouble((String)data_map.get("PS_BrokerCommissionTotal"));
				}
				//generalPremium	=Double.parseDouble((String)data_map.get("PS_BrokerCommissionTotal"));
			}
			else if(type.equalsIgnoreCase("BROKER_COM")){
				generalPremium	=Double.parseDouble((String)data_map.get("PS_BrokerCommissionTotal"));
			}else if(type.equalsIgnoreCase("MGA_COM") && TestBase.product.equalsIgnoreCase("COB") && (common.currentRunningFlow.equalsIgnoreCase("MTA") || (TestBase.businessEvent.equalsIgnoreCase("MTA") && common.currentRunningFlow.equalsIgnoreCase("Rewind")))){
				generalPremium	= common_VELA.transaction_Details_Premium_Values.get("Totals").get("Pen Comm");
			}else if(type.equalsIgnoreCase("MGA_COM") && TestBase.product.equalsIgnoreCase("COA") && (common.currentRunningFlow.equalsIgnoreCase("MTA") || (TestBase.businessEvent.equalsIgnoreCase("MTA") && common.currentRunningFlow.equalsIgnoreCase("Rewind")))){
				generalPremium	= common_VELA.transaction_Details_Premium_Values.get("Totals").get("Pen Comm");
			}else if(type.equalsIgnoreCase("MGA_COM") && TestBase.product.equalsIgnoreCase("XOQ") && (common.currentRunningFlow.equalsIgnoreCase("MTA") || (TestBase.businessEvent.equalsIgnoreCase("MTA") && common.currentRunningFlow.equalsIgnoreCase("Rewind")))){
				generalPremium	= common_VELA.transaction_Details_Premium_Values.get("Totals").get("Pen Comm");
			}else if(type.equalsIgnoreCase("MGA_COM") && TestBase.product.equalsIgnoreCase("XOC") && (common.currentRunningFlow.equalsIgnoreCase("MTA") || (TestBase.businessEvent.equalsIgnoreCase("MTA") && common.currentRunningFlow.equalsIgnoreCase("Rewind")))){
				generalPremium	= common_VELA.transaction_Details_Premium_Values.get("Totals").get("Pen Comm");
			}else{
			
			if((String)data_map.get("CD_Public&ProductsLiability")!= null && ((String)data_map.get("CD_Public&ProductsLiability")).equals("Yes"))
			{		
				if(common.currentRunningFlow.contains("CAN")){
					PublicProductsLiabilityPC = Double.parseDouble(minusSign.concat(Double.toString(common_COB.CAN_COB_ReturnP_Values_Map.get("Public & Products Liability").get("Pen Comm"))));
				}else{
					if(!((String)data_map.get("PS_Duration")).equalsIgnoreCase("365")){
						PublicProductsLiabilityPC = transaction_Premium_Values.get("Public & Products Liability").get("Pen Comm");
					}else{
						PublicProductsLiabilityPC = Double.parseDouble((String)data_map.get("PS_Public&ProductsLiability_PenComm"));
					}
				}
			}
			if((String)data_map.get("CD_EmployersLiability")!= null && ((String)data_map.get("CD_EmployersLiability")).equals("Yes"))
			{					 
				if(common.currentRunningFlow.contains("CAN")){
					EmployersLiabiliyPC = Double.parseDouble(minusSign.concat(Double.toString(common_COB.CAN_COB_ReturnP_Values_Map.get("Employers Liability").get("Pen Comm"))));
				}else{
					if(!((String)data_map.get("PS_Duration")).equalsIgnoreCase("365")){
						EmployersLiabiliyPC = transaction_Premium_Values.get("Employers Liability").get("Pen Comm");
					}else{
						EmployersLiabiliyPC = Double.parseDouble((String)data_map.get("PS_EmployersLiability_PenComm"));
					}
				}
											
			}
			if((String)data_map.get("CD_AnnualWorks")!= null && ((String)data_map.get("CD_AnnualWorks")).equals("Yes"))
			{					
				if(TestBase.product.contains("COB")){
					if(common.currentRunningFlow.contains("CAN")){
						AnnualWorksPC = Double.parseDouble(minusSign.concat(Double.toString(common_COB.CAN_COB_ReturnP_Values_Map.get("Annual Works").get("Pen Comm"))));
					}else{
						if(!((String)data_map.get("PS_Duration")).equalsIgnoreCase("365")){
							AnnualWorksPC = transaction_Premium_Values.get("Annual Works").get("Pen Comm");
						}else{
							AnnualWorksPC = Double.parseDouble((String)data_map.get("PS_AnnualWorks_PenComm"));
						}
					}
					
				}else if(TestBase.product.contains("COA")){
			    	if(common.currentRunningFlow.contains("CAN")){
			    		AnnualWorksPC = Double.parseDouble(minusSign.concat(Double.toString(common_COB.CAN_COB_ReturnP_Values_Map.get("Annual Works").get("Pen Comm"))));
					}else{
						if(!((String)data_map.get("PS_Duration")).equalsIgnoreCase("365")){
							AnnualWorksPC = transaction_Premium_Values.get("Annual Works").get("Pen Comm");
						}else{
							AnnualWorksPC = Double.parseDouble((String)data_map.get("PS_AnnualWorks_PenComm"));
						}
					}
				}else if(!((String)data_map.get("PS_Duration")).equalsIgnoreCase("365")){
					AnnualWorksPC = transaction_Premium_Values.get("Annual Works").get("Pen Comm");
				}else{
					AnnualWorksPC = Double.parseDouble((String)data_map.get("PS_AnnualWorks_PenComm"));
				}
				
												
			}
			if((String)data_map.get("CD_OwnPlant")!= null && ((String)data_map.get("CD_OwnPlant")).equals("Yes"))
			{					
				if(TestBase.product.contains("COB")){
					if(common.currentRunningFlow.contains("CAN")){
						OwnPlantPC = Double.parseDouble(minusSign.concat(Double.toString(common_COB.CAN_COB_ReturnP_Values_Map.get("Own Plant").get("Pen Comm"))));
					}else{
						if(!((String)data_map.get("PS_Duration")).equalsIgnoreCase("365")){
							OwnPlantPC = transaction_Premium_Values.get("Own Plant").get("Pen Comm");
						}else{
							OwnPlantPC = Double.parseDouble((String)data_map.get("PS_OwnPlant_PenComm"));
						}
					}
				}else if(TestBase.product.contains("COA")){
			    	if(common.currentRunningFlow.contains("CAN")){
			    		OwnPlantPC = Double.parseDouble(minusSign.concat(Double.toString(common_COB.CAN_COB_ReturnP_Values_Map.get("Own Plant").get("Pen Comm"))));
					}else{
						if(!((String)data_map.get("PS_Duration")).equalsIgnoreCase("365")){
							OwnPlantPC = transaction_Premium_Values.get("Own Plant").get("Pen Comm");
						}else{
							OwnPlantPC = Double.parseDouble((String)data_map.get("PS_OwnPlant_PenComm"));
						}
					}
				}else if(!((String)data_map.get("PS_Duration")).equalsIgnoreCase("365")){
					OwnPlantPC = transaction_Premium_Values.get("Own Plant").get("Pen Comm");
				}else{
					OwnPlantPC = Double.parseDouble((String)data_map.get("PS_OwnPlant_PenComm"));
				} 
				
																	
			}
			if((String)data_map.get("CD_SingleProject")!= null && ((String)data_map.get("CD_SingleProject")).equals("Yes"))
			{
				if(TestBase.product.contains("COB")){
					if(common.currentRunningFlow.contains("CAN")){
						SingleProjectPC = Double.parseDouble(minusSign.concat(Double.toString(common_COB.CAN_COB_ReturnP_Values_Map.get("Single Project").get("Pen Comm"))));
					}else{
						SingleProjectPC = Double.parseDouble((String)data_map.get("PS_SingleProject_PenComm"));
						if(!((String)data_map.get("PS_Duration")).equalsIgnoreCase("365")){
							SingleProjectPC = transaction_Premium_Values.get("Single Project").get("Pen Comm");
						}else{
							SingleProjectPC = Double.parseDouble((String)data_map.get("PS_SingleProject_PenComm"));
						}
					}
				}else if(TestBase.product.contains("COA")){
			    	if(common.currentRunningFlow.contains("CAN")){
			    		SingleProjectPC = Double.parseDouble(minusSign.concat(Double.toString(common_COB.CAN_COB_ReturnP_Values_Map.get("Single Project").get("Pen Comm"))));
					}else{
						if(!((String)data_map.get("PS_Duration")).equalsIgnoreCase("365")){
							SingleProjectPC = transaction_Premium_Values.get("Single Project").get("Pen Comm");
						}else{
							SingleProjectPC = Double.parseDouble((String)data_map.get("PS_SingleProject_PenComm"));
						}
					}
				}else if(!((String)data_map.get("PS_Duration")).equalsIgnoreCase("365")){
					SingleProjectPC = transaction_Premium_Values.get("Single Project").get("Pen Comm");
				}else{
					SingleProjectPC = Double.parseDouble((String)data_map.get("PS_SingleProject_PenComm"));
				}
				

															
			}	
			if((String)data_map.get("CD_HiredInPlant")!= null && ((String)data_map.get("CD_HiredInPlant")).equals("Yes"))
			{					
				if(TestBase.product.contains("COB")){
					if(common.currentRunningFlow.contains("CAN")){
						HiredInPlantPC = Double.parseDouble(minusSign.concat(Double.toString(common_COB.CAN_COB_ReturnP_Values_Map.get("Hired In Plant").get("Pen Comm"))));
					}else{
						HiredInPlantPC = Double.parseDouble((String)data_map.get("PS_HiredInPlant_PenComm"));
						if(!((String)data_map.get("PS_Duration")).equalsIgnoreCase("365")){
							HiredInPlantPC = transaction_Premium_Values.get("Hired In Plant").get("Pen Comm");
						}else{
							HiredInPlantPC = Double.parseDouble((String)data_map.get("PS_HiredInPlant_PenComm"));
						}
					}
				}else if(TestBase.product.contains("COA")){
			    	if(common.currentRunningFlow.contains("CAN")){
			    		HiredInPlantPC = Double.parseDouble(minusSign.concat(Double.toString(common_COB.CAN_COB_ReturnP_Values_Map.get("Hired In Plant").get("Pen Comm"))));
					}else{
						if(!((String)data_map.get("PS_Duration")).equalsIgnoreCase("365")){
							HiredInPlantPC = transaction_Premium_Values.get("Hired In Plant").get("Pen Comm");
						}else{
							HiredInPlantPC = Double.parseDouble((String)data_map.get("PS_HiredInPlant_PenComm"));
						}
					}
				}else if(!((String)data_map.get("PS_Duration")).equalsIgnoreCase("365")){
					HiredInPlantPC = transaction_Premium_Values.get("Hired In Plant").get("Pen Comm");
				}else{
					HiredInPlantPC = Double.parseDouble((String)data_map.get("PS_HiredInPlant_PenComm"));
				}
				
				
																	
			}
			String agency_Name = driver.findElement(By.xpath("html/body/div[3]/form/table/tbody/tr[2]/td[2]")).getText();
			if(agency_Name.equals("M722")){
			if((String)data_map.get("CD_HireCoverPlus")!= null && ((String)data_map.get("CD_HireCoverPlus")).equals("Yes"))
			{
				if(TestBase.product.contains("COB")){
					if(common.currentRunningFlow.contains("CAN")){
						HireCoverPlusPC = Double.parseDouble(minusSign.concat(Double.toString(common_COB.CAN_COB_ReturnP_Values_Map.get("Hire Cover Plus").get("Pen Comm"))));
					}else{
						HireCoverPlusPC = Double.parseDouble((String)data_map.get("PS_HireCoverPlus_PenComm"));
						if(!((String)data_map.get("PS_Duration")).equalsIgnoreCase("365")){
							HireCoverPlusPC = transaction_Premium_Values.get("Hire Cover Plus").get("Pen Comm");
						}else{
							HireCoverPlusPC = Double.parseDouble((String)data_map.get("PS_HireCoverPlus_PenComm"));
						}
					}
				}else if(TestBase.product.contains("COA")){
			    	if(common.currentRunningFlow.contains("CAN")){
			    		HireCoverPlusPC = Double.parseDouble(minusSign.concat(Double.toString(common_COB.CAN_COB_ReturnP_Values_Map.get("Hire Cover Plus").get("Pen Comm"))));
					}else{
						if(!((String)data_map.get("PS_Duration")).equalsIgnoreCase("365")){
							HireCoverPlusPC = transaction_Premium_Values.get("Hire Cover Plus").get("Pen Comm");
						}else{
							HireCoverPlusPC = Double.parseDouble((String)data_map.get("PS_HireCoverPlus_PenComm"));
						}
					}
			    }
				else if(!((String)data_map.get("PS_Duration")).equalsIgnoreCase("365")){
					HireCoverPlusPC = transaction_Premium_Values.get("Hire Cover Plus").get("Pen Comm");
				}else{
					HireCoverPlusPC = Double.parseDouble((String)data_map.get("PS_HireCoverPlus_PenComm"));
				}
				
												
			}}
			if((String)data_map.get("CD_JCT6.5.1")!= null && ((String)data_map.get("CD_JCT6.5.1")).equals("Yes"))
			{
				
				if(common.currentRunningFlow.contains("CAN")){
					JCTPC = Double.parseDouble(minusSign.concat(Double.toString(common_COB.CAN_COB_ReturnP_Values_Map.get("JCT 6.5.1").get("Pen Comm"))));
				}else{
					if(!((String)data_map.get("PS_Duration")).equalsIgnoreCase("365")){
						JCTPC = transaction_Premium_Values.get("JCT 6.5.1").get("Pen Comm");
					}else{
						JCTPC = Double.parseDouble((String)data_map.get("PS_JCT6.5.1_PenComm"));
					}
				} 
				
												
			}
			if((String)data_map.get("CD_Terrorism")!= null && ((String)data_map.get("CD_Terrorism")).equals("Yes"))
			{
				if(TestBase.product.contains("COB")){
					if(common.currentRunningFlow.contains("CAN")){
						terrorismPC = Double.parseDouble(minusSign.concat(Double.toString(common_COB.CAN_COB_ReturnP_Values_Map.get("Terrorism").get("Pen Comm"))));
					}else{
						if(!((String)data_map.get("PS_Duration")).equalsIgnoreCase("365")){
							terrorismPC = transaction_Premium_Values.get("Terrorism").get("Pen Comm");
						}else{
							terrorismPC = Double.parseDouble((String)data_map.get("PS_Terrorism_PenComm"));
						}
					}
				}else if(TestBase.product.contains("COA")){
			    	if(common.currentRunningFlow.contains("CAN")){
			    		terrorismPC = Double.parseDouble(minusSign.concat(Double.toString(common_COB.CAN_COB_ReturnP_Values_Map.get("Terrorism").get("Pen Comm"))));
					}else{
						if(!((String)data_map.get("PS_Duration")).equalsIgnoreCase("365")){
							terrorismPC = transaction_Premium_Values.get("Terrorism").get("Pen Comm");
						}else{
							terrorismPC = Double.parseDouble((String)data_map.get("PS_Terrorism_PenComm"));
						}
					}
			    }
				else if(!((String)data_map.get("PS_Duration")).equalsIgnoreCase("365")){
					terrorismPC = transaction_Premium_Values.get("Terrorism").get("Pen Comm");
				}else{
					terrorismPC = Double.parseDouble((String)data_map.get("PS_Terrorism_PenComm"));
				}  
				
																		
			}
			if((String)data_map.get("CD_PropertyOwnersLiability")!= null && ((String)data_map.get("CD_PropertyOwnersLiability")).equals("Yes"))
			{
				if(TestBase.product.contains("COB")){
					if(common.currentRunningFlow.contains("CAN")){
						PropertyOwnersLiabilityPC = Double.parseDouble(minusSign.concat(Double.toString(common_COB.CAN_COB_ReturnP_Values_Map.get("Property Owners Liability").get("Pen Comm"))));
					}else{
						if(!((String)data_map.get("PS_Duration")).equalsIgnoreCase("365")){
							PropertyOwnersLiabilityPC = transaction_Premium_Values.get("Property Owners Liability").get("Pen Comm");
						}else{
							PropertyOwnersLiabilityPC = Double.parseDouble((String)data_map.get("PS_PropertyOwnersLiability_PenComm"));
						}
					}
				}else if(TestBase.product.contains("COA")){
			    	if(common.currentRunningFlow.contains("CAN")){
			    		PropertyOwnersLiabilityPC = Double.parseDouble(minusSign.concat(Double.toString(common_COB.CAN_COB_ReturnP_Values_Map.get("Property Owners Liability").get("Pen Comm"))));
					}else{
						if(!((String)data_map.get("PS_Duration")).equalsIgnoreCase("365")){
							PropertyOwnersLiabilityPC = transaction_Premium_Values.get("Property Owners Liability").get("Pen Comm");
						}else{
							PropertyOwnersLiabilityPC = Double.parseDouble((String)data_map.get("PS_PropertyOwnersLiability_PenComm"));
						}
					}
			    }
				else if(!((String)data_map.get("PS_Duration")).equalsIgnoreCase("365")){
					PropertyOwnersLiabilityPC = transaction_Premium_Values.get("Property Owners Liability").get("Pen Comm");
				}else{
					PropertyOwnersLiabilityPC = Double.parseDouble((String)data_map.get("PS_PropertyOwnersLiability_PenComm"));
				}  
				
																		
			}
			if((String)data_map.get("CD_LegalExpenses")!= null && ((String)data_map.get("CD_LegalExpenses")).equals("Yes"))
			{
				if(TestBase.product.contains("COB")){
					if(common.currentRunningFlow.contains("CAN")){
						LegalExpensesPC = Double.parseDouble(minusSign.concat(Double.toString(common_COB.CAN_COB_ReturnP_Values_Map.get("Abbey Legal Expenses").get("Pen Comm"))));
					}else{
						if(!((String)data_map.get("PS_Duration")).equalsIgnoreCase("365")){
							LegalExpensesPC = transaction_Premium_Values.get("Abbey Legal Expenses").get("Pen Comm");
						}else{
							LegalExpensesPC = Double.parseDouble((String)data_map.get("PS_LegalExpenses_PenComm"));
						}
					}
				}else if(TestBase.product.contains("COA")){
			    	if(common.currentRunningFlow.contains("CAN")){
			    		LegalExpensesPC = Double.parseDouble(minusSign.concat(Double.toString(common_COB.CAN_COB_ReturnP_Values_Map.get("Abbey Legal Expenses").get("Pen Comm"))));
					}else{
						if(!((String)data_map.get("PS_Duration")).equalsIgnoreCase("365")){
							LegalExpensesPC = transaction_Premium_Values.get("Abbey Legal Expenses").get("Pen Comm");
						}else{
							LegalExpensesPC = Double.parseDouble((String)data_map.get("PS_LegalExpenses_PenComm"));
						}
					}
			    }else if(!((String)data_map.get("PS_Duration")).equalsIgnoreCase("365")){
					LegalExpensesPC = transaction_Premium_Values.get("Abbey Legal Expenses").get("Pen Comm");
				}else{
					LegalExpensesPC = Double.parseDouble((String)data_map.get("PS_LegalExpenses_PenComm"));
				}  
				
															
			}	
			if((String)data_map.get("CD_ThirdPartyMotorLiability")!= null && ((String)data_map.get("CD_ThirdPartyMotorLiability")).equals("Yes"))
			{
				if(TestBase.product.contains("XOC") || TestBase.product.contains("XOQ")){
					if(common.currentRunningFlow.contains("CAN")){
						ThirdPartyMotorLiabilityPC = Double.parseDouble(minusSign.concat(Double.toString(common_COB.CAN_COB_ReturnP_Values_Map.get("Third Party Motor Liability").get("Pen Comm"))));
					}else{
						if(!((String)data_map.get("PS_Duration")).equalsIgnoreCase("365")){
							ThirdPartyMotorLiabilityPC = transaction_Premium_Values.get("Totals").get("Pen Comm");
						}else{
							ThirdPartyMotorLiabilityPC = Double.parseDouble((String)data_map.get("PS_ThirdPartyMotorLiability_PenComm"));
						}
						
					
					}
				
				}else if(!((String)data_map.get("PS_Duration")).equalsIgnoreCase("365")){
					ThirdPartyMotorLiabilityPC = transaction_Premium_Values.get("Third Party Motor Liability").get("Pen Comm");
				}else{
					ThirdPartyMotorLiabilityPC = Double.parseDouble((String)data_map.get("PS_ThirdPartyMotorLiability_PenComm"));
				} 
				
															
			}	
			if((String)data_map.get("CD_CombinedLiability")!= null && ((String)data_map.get("CD_CombinedLiability")).equals("Yes"))
			{
				
				if(TestBase.product.contains("XOC") || TestBase.product.contains("XOQ")){
					if(common.currentRunningFlow.contains("CAN")){
						CombinedLiabilityPC = Double.parseDouble(minusSign.concat(Double.toString(common_COB.CAN_COB_ReturnP_Values_Map.get("Combined Liability").get("Pen Comm"))));
					}else{
						if(!((String)data_map.get("PS_Duration")).equalsIgnoreCase("365")){
							CombinedLiabilityPC = transaction_Premium_Values.get("Totals").get("Pen Comm");
						}else{
							CombinedLiabilityPC = Double.parseDouble((String)data_map.get("PS_CombinedLiability_PenComm"));
						}
						
					}
				
				}else if(!((String)data_map.get("PS_Duration")).equalsIgnoreCase("365")){
					CombinedLiabilityPC = transaction_Premium_Values.get("Combined Liability").get("Pen Comm");
				}else{
					CombinedLiabilityPC = Double.parseDouble((String)data_map.get("PS_CombinedLiability_PenComm"));
				}											
			}	
			generalPremium= PublicProductsLiabilityPC + EmployersLiabiliyPC + AnnualWorksPC + OwnPlantPC + HiredInPlantPC 
					+ JCTPC + terrorismPC + PropertyOwnersLiabilityPC + LegalExpensesPC + SingleProjectPC + HireCoverPlusPC + CombinedLiabilityPC
					+ ThirdPartyMotorLiabilityPC;
			}
				
			String generalammount = decim.format(generalPremium);
		
			if(common.currentRunningFlow.equalsIgnoreCase("CAN")){
				
				if(TestBase.product.equalsIgnoreCase("XOC") || TestBase.product.equalsIgnoreCase("XOQ")
						 || TestBase.product.equalsIgnoreCase("COA") || TestBase.product.equalsIgnoreCase("COB")){
					compareValues(Double.parseDouble(generalammount), Double.parseDouble(brokerageAccount), "General Brokerage Amount ");
				}
				
			}else{
				compareValues(Math.abs(Double.parseDouble(generalammount)), Math.abs(Double.parseDouble(brokerageAccount)), "General Brokerage Amount ");
			}
			
			if(TestBase.product.equals("XOC")||TestBase.product.equals("XOQ")){
				return Double.parseDouble(generalammount);
			}else{
			return Double.parseDouble(generalammount);
			}
		}catch(Throwable t) {
			String methodName = new Object(){}.getClass().getEnclosingMethod().getName();
			TestUtil.reportFunctionFailed("Failed in "+methodName+" function");     k.reportErr("Failed in "+methodName+" function", t);
			Assert.fail("Failed in Calculate Brokerage ammout. \n", t);
			return 0;
		}
}

	
	
	public double calculateMiunsPremium(String code, Map<Object, Object> data_map, String trasacSummaryType,int j,int td){
		double minusPremium = 0.00, PL_Premium = 0.00, EL_Premium = 0.00, AW_Premium = 0.00, SP_Premium = 0.00, OP_Premium = 0.00, HIP_Premium = 0.00;
		double  HCP_Premium = 0.00, JCT_Premium = 0.00, Ter_Premium = 0.00, POL_Premium = 0.00, LE_Premium = 0.00;
		try{
			String sVal = null, sValue = null, sCover = null;
			
			sVal = (String)common.NB_excel_data_map.get("CD_Public&ProductsLiability");			
			sValue = (String)common.MTA_excel_data_map.get("CD_Public&ProductsLiability");
			
			if(sVal.contains("Yes") ||sValue.contains("Yes") )
			{	
				sCover = (String)common.MTA_excel_data_map.get("CD_Add_Public&ProductsLiability");
			
				if(sCover.contains("No")){
					PL_Premium = common_VELA.transaction_Details_Premium_Values.get("Public&ProductsLiability").get("Net Net Premium");
				}else{
					PL_Premium = 0.00;
				}
			}
			
			sVal = (String)common.NB_excel_data_map.get("CD_EmployersLiability");			
			sValue = (String)common.MTA_excel_data_map.get("CD_EmployersLiability");
			
			if(sVal.contains("Yes") ||sValue.contains("Yes") )
			{		
				sCover = (String)common.MTA_excel_data_map.get("CD_Add_EmployersLiability");
			
				if(sCover.contains("No")){
					EL_Premium = common_VELA.transaction_Details_Premium_Values.get("EmployersLiability").get("Net Net Premium");
				}else{
					EL_Premium = 0.00;
				}
			}
			
			sVal = (String)common.NB_excel_data_map.get("CD_AnnualWorks");			
			sValue = (String)common.MTA_excel_data_map.get("CD_AnnualWorks");
			
			if(sVal.contains("Yes") ||sValue.contains("Yes") )
			{		
				sCover = (String)common.MTA_excel_data_map.get("CD_Add_AnnualWorks");
				
				if(sCover.contains("No")){
					AW_Premium = common_VELA.transaction_Details_Premium_Values.get("AnnualWorks").get("Net Net Premium");
				}else{
					AW_Premium = 0.00;
				}
			}
			
			sVal = (String)common.NB_excel_data_map.get("CD_OwnPlant");			
			sValue = (String)common.MTA_excel_data_map.get("CD_OwnPlant");
			
			if(sVal.contains("Yes") ||sValue.contains("Yes"))
			{	
				sCover = (String)common.MTA_excel_data_map.get("CD_Add_OwnPlant");	
			
				if(sCover.contains("No")){
					OP_Premium = common_VELA.transaction_Details_Premium_Values.get("OwnPlant").get("Net Net Premium");
				}else{
					OP_Premium = 0.00;
				}
			}
			
			sVal = (String)common.NB_excel_data_map.get("CD_SingleProject");			
			sValue = (String)common.MTA_excel_data_map.get("CD_SingleProject");
			
			if(sVal.contains("Yes") ||sValue.contains("Yes"))
			{	
				sCover = (String)common.MTA_excel_data_map.get("CD_Add_SingleProject");	
				
				if(sCover.contains("No")){
					SP_Premium = common_VELA.transaction_Details_Premium_Values.get("SingleProject").get("Net Net Premium");
				}else{
					SP_Premium = 0.00;
				}
			}
			
			sVal = (String)common.NB_excel_data_map.get("CD_HiredInPlant");			
			sValue = (String)common.MTA_excel_data_map.get("CD_HiredInPlant");
			
			if(sVal.contains("Yes") ||sValue.contains("Yes"))
			{	
				sCover = (String)common.MTA_excel_data_map.get("CD_Add_HiredInPlant");	
				
				if(sCover.contains("No")){
					HIP_Premium = common_VELA.transaction_Details_Premium_Values.get("HiredInPlant").get("Net Net Premium");
				}else{
					HIP_Premium = 0.00;
				}
			}
			
			sVal = (String)common.NB_excel_data_map.get("CD_HireCoverPlus");			
			sValue = (String)common.MTA_excel_data_map.get("CD_HireCoverPlus");
			
			if(sVal.contains("Yes") ||sValue.contains("Yes"))
			{	
				sCover = (String)common.MTA_excel_data_map.get("CD_Add_HireCoverPlus");	
				
				if(sCover.contains("No")){
					HCP_Premium = common_VELA.transaction_Details_Premium_Values.get("HireCoverPlus").get("Net Net Premium");
				}else{
					HCP_Premium = 0.00;
				}
			}
			
			sVal = (String)common.NB_excel_data_map.get("CD_JCT6.5.1");			
			sValue = (String)common.MTA_excel_data_map.get("CD_JCT6.5.1");
			
			if(sVal.contains("Yes") ||sValue.contains("Yes"))
			{	
				sCover = (String)common.MTA_excel_data_map.get("CD_Add_JCT6.5.1");	
				
				if(sCover.contains("No")){
					JCT_Premium = common_VELA.transaction_Details_Premium_Values.get("JCT6.5.1").get("Net Net Premium");
				}else{
					JCT_Premium = 0.00;
				}
			}
			
			sVal = (String)common.NB_excel_data_map.get("CD_Terrorism");			
			sValue = (String)common.MTA_excel_data_map.get("CD_Terrorism");
			
			if(sVal.contains("Yes") ||sValue.contains("Yes"))
			{	
				sCover = (String)common.MTA_excel_data_map.get("CD_Add_Terrorism");	
				
				if(sCover.contains("No")){
					Ter_Premium = common_VELA.transaction_Details_Premium_Values.get("Terrorism").get("Net Net Premium");
				}else{
					Ter_Premium = 0.00;
				}
			}
			
			sVal = (String)common.NB_excel_data_map.get("CD_PropertyOwnersLiability");			
			sValue = (String)common.MTA_excel_data_map.get("CD_PropertyOwnersLiability");
			
			if(sVal.contains("Yes") ||sValue.contains("Yes"))
			{	
				sCover = (String)common.MTA_excel_data_map.get("CD_Add_PropertyOwnersLiability");	
				
				if(sCover.contains("No")){
					POL_Premium = common_VELA.transaction_Details_Premium_Values.get("PropertyOwnersLiability").get("Net Net Premium");
				}else{
					POL_Premium = 0.00;
				}
			}
			
			sVal = (String)common.NB_excel_data_map.get("CD_LegalExpenses");			
			sValue = (String)common.MTA_excel_data_map.get("CD_LegalExpenses");
			
			if(sVal.contains("Yes") ||sValue.contains("Yes"))
			{	
				sCover = (String)common.MTA_excel_data_map.get("CD_Add_LegalExpenses");
				
				if(sCover.contains("No")){
					LE_Premium = common_VELA.transaction_Details_Premium_Values.get("LegalExpenses").get("Net Net Premium");
				}else{
					LE_Premium = 0.00;
				}
			}
			
			minusPremium = PL_Premium + EL_Premium + AW_Premium + SP_Premium + OP_Premium + HIP_Premium +
			               HCP_Premium + JCT_Premium + Ter_Premium + POL_Premium + LE_Premium ;
			
			return minusPremium;
		}catch(Throwable t) {
			String methodName = new Object(){}.getClass().getEnclosingMethod().getName();
			TestUtil.reportFunctionFailed("Failed in "+methodName+" function");     k.reportErr("Failed in "+methodName+" function", t);
			Assert.fail("Failed in Calculate Brokerage ammout. \n", t);
			return 0;
		}
}

	
	
	////////// -----------------------------------------------------------------------//////
	////////// -----------------------------------------------------------------------//////
	////////// ---OLD CommonFunction Methods Refactored According to New Framework----//////
	////////// -----------------------------------------------------------------------//////
	////////// -----------------------------------------------------------------------//////
	/**
	 * This method is to check if client is already exist or not.
	 */

	public boolean checkClient(Map<Object, Object> data_map, String code, String event) {

		try {
			if (data_map.get("CC_CreateClient").equals("Yes")) {
				customAssert.assertTrue(common.createClient(data_map, code, event), "Unable to Create Client.");
			} else {
				customAssert.assertTrue(common.searchClient(data_map, code, event), "Unable to Search Client with given data . ");
			}

			return true;

		} catch (Throwable t) {
			String methodName = new Object() {
			}.getClass().getEnclosingMethod().getName();
			TestUtil.reportFunctionFailed("Failed in " + methodName + " function");
			k.reportErr("Failed in " + methodName + " function", t);
			Assert.fail("Unable to Check client .  \n", t);
			return false;
		}

	}

	/**
	 * This method is to search client if already exist
	 */

	public boolean searchClient(Map<Object, Object> map_data, String code, String event) {
		boolean retvalue = true;
		try {
			
			customAssert.assertTrue(k.Click("client_menu"), "Client Menu option does not exist.");
			String client_Search_Pref = (String)map_data.get("NB_SearchClientBy");
			switch(client_Search_Pref){
			
				case "Client Name" :
					customAssert.assertTrue(k.Input("CCF_NB_ClientName", (String) map_data.get("NB_ClientName")),"Unable to enter Client Id.");
					reportStatus("Searching with "+client_Search_Pref+" =  <b>"+(String) map_data.get("NB_ClientName")+"</b> in search page ", "Info", true);
					break;
				case "Client Number" :
					customAssert.assertTrue(k.Input("CCF_NB_ClientId", (String) map_data.get("NB_ClientId")),"Unable to enter Client Id.");
					reportStatus("Searching with "+client_Search_Pref+" =  <b>"+(String) map_data.get("NB_ClientId")+"</b> in search page ", "Info", true);
					break;
				case "Company Registration" :
					customAssert.assertTrue(k.Input("CCF_NB_CompanyReg", (String) map_data.get("NB_CompanyReg")),"Unable to enter Client Id.");
					reportStatus("Searching with "+client_Search_Pref+" =  <b>"+(String) map_data.get("NB_ClientId")+"</b> in search page ", "Info", true);
					break;
				case "Legacy Client Number" :
					customAssert.assertTrue(k.Input("CCF_NB_LegacyClientNo", (String) map_data.get("NB_LegacyClientNo")),"Unable to enter Client Id.");
					reportStatus("Searching with "+client_Search_Pref+" =  <b>"+(String) map_data.get("NB_ClientId")+"</b> in search page ", "Info", true);
					break;
				case "Client Post Code" :
					customAssert.assertTrue(k.Input("CCF_NB_LegacyClientNo", (String) map_data.get("NB_LegacyClientNo")),"Unable to enter Client Id.");
					reportStatus("Searching with "+client_Search_Pref+" =  <b>"+(String) map_data.get("NB_ClientId")+"</b> in search page ", "Info", true);
					break;
				default:
					System.out.println("**** Given Client Search Preference is not valid ****");
					reportStatus("Given Client Search Preference is not valid ", "Info", false);
					break;
				
			}
			
			customAssert.assertTrue(k.Click("search_btn"), "Unable to click on search button.");

			boolean displayed = driver.findElement(By.xpath(".//*[@id='table0']/tbody/tr[1]/td[2]/a")).isDisplayed();
       		
       		if(!displayed){
       			reportStatus("Client Search Criterion doesn't return any values .", "Info", true);
       			retvalue=false;
       		}else{
       			reportStatus("Client Search result displayed correctly.", "Info", true);
       			customAssert.assertTrue(k.Click("client_name"), "Unable to click on Client Name.");
       		}
			

			return retvalue;

		} catch (Throwable t) {
			String methodName = new Object() {
			}.getClass().getEnclosingMethod().getName();
			TestUtil.reportFunctionFailed("Failed in " + methodName + " function");
			k.reportErr("Failed in " + methodName + " function", t);
			Assert.fail("Unable to Search client .  \n", t);
			return false;
		}
	}

	/**
	 * This method create the Client from Client details
	 */

	public boolean createClient(Map<Object, Object> map_data, String code, String event) {

		boolean retvalue = true;
		String testName = (String) map_data.get("Automation Key");
		try {

			String timeStamp = new SimpleDateFormat("ddMMyyyyHHmmss", Locale.US).format(new Date());
			// System.out.println(timeStamp);
			customAssert.assertTrue(k.Click("client_menu"), "Client Menu option does not exist.");
			customAssert.assertTrue(k.Click("client_add"), "Add Client button does not exist.");
			customAssert.assertTrue(k.Input("CCF_CC_CompanyName", "Auto_C_" + timeStamp),	"Unable to enter value in CompanyName field ");
			customAssert.assertTrue(!k.getAttributeIsEmpty("CCF_CC_CompanyName", "value"),"Company Name Field Should Contain Valid Value on Client Details  .");
			customAssert.assertTrue(k.Input("CCF_CC_TradingName", (String)map_data.get("CC_TradingName")),	"Unable to enter value in Trading Name field .");
			customAssert.assertTrue(k.Input("CCF_Address_CC_Address", (String) map_data.get("CC_Address")),"Unable to enter value in Address field. ");
			customAssert.assertTrue(!k.getAttributeIsEmpty("CCF_Address_CC_Address", "value"),"Address Field Should Contain Valid Value on Client Details .");
			customAssert.assertTrue(k.Input("CCF_Address_CC_line2", (String) map_data.get("CC_line2")),"Unable to enter value in Address field line 2 . ");
			customAssert.assertTrue(k.Input("CCF_Address_CC_line3", (String) map_data.get("CC_line3")),"Unable to enter value in Address field line 3 . ");
			customAssert.assertTrue(k.Input("CCF_Address_CC_Town", (String) map_data.get("CC_Town")),"Unable to enter value in Town field . ");
			customAssert.assertTrue(k.Input("CCF_Address_CC_County", (String) map_data.get("CC_County")),"Unable to enter value in County  . ");
			customAssert.assertTrue(k.Input("CCF_Address_CC_Postcode", (String) map_data.get("CC_Postcode")),"Unable to enter value in PostCode field .");
			customAssert.assertTrue(!k.getAttributeIsEmpty("CCF_Address_CC_Postcode", "value"),"Postcode Field Should Contain Valid Value on Client Details .");
			customAssert.assertTrue(common.validatePostCode((String)map_data.get("CC_Postcode")),"Post Code is not in Correct format .");
			customAssert.assertTrue(k.DropDownType("CCF_Address_CC_Country", (String) map_data.get("CC_Country")),"Unable to select Country name from dropdown .");
			TestUtil.reportStatus("Client creation page with all data.", "Info", true);

			customAssert.assertTrue(k.Click("save_btn"), "Save button does not exist.");

			String client_name = k.getText("client_name_value");

			WriteDataToXl(code + "_" + event, "NB", testName, "NB_ClientName", client_name, map_data);

			reportStatus("Client <b>" + client_name + " </b> created successfully.", "Info", true);

			return retvalue;

		} catch (Throwable t) {
			String methodName = new Object() {
			}.getClass().getEnclosingMethod().getName();
			TestUtil.reportFunctionFailed("Failed in " + methodName + " function");
			k.reportErr("Failed in " + methodName + " function", t);
			Assert.fail("Unable to create Client \n", t);
			return false;
		}
	}

	public boolean createNewQuote(Map<Object, Object> map_data, String code, String event) {

		Boolean retvalue = true;
		df = new SimpleDateFormat("dd/MM/yyyy");
		String testName = (String) map_data.get("Automation Key");
		
		String quote_Start_Date = null,inception_date=null,deadline_date=null;
		String quote_End_Date = null;
		java.util.Date s_date=null,e_date=null;
		try{
	
		if(((String)map_data.get("QC_isDefaultQuoteDates")).equals("No")){
			quote_Start_Date = (String)map_data.get("QC_InceptionDate");
			quote_End_Date = (String)map_data.get("QC_DeadlineDate");
			try {
				s_date = df.parse(quote_Start_Date);
				e_date = df.parse(quote_End_Date);
			} catch (ParseException e) {
				System.out.println("Error while parsing quote dates . "+e);
			}
		
			inception_date = common.daysIncrementWithOutFormation(df.format(s_date), 0);
			deadline_date = common.daysIncrementWithOutFormation(df.format(e_date), 0);
		}else{
			inception_date = common.daysIncrementWithOutFormation(df.format(currentDate), 0);
			deadline_date = common.daysIncrementWithOutFormation(df.format(currentDate), 0);
			WriteDataToXl(code + "_" + event, "QuoteCreation", testName, "QC_InceptionDate", inception_date, map_data);
			WriteDataToXl(code + "_" + event, "QuoteCreation", testName, "QC_DeadlineDate", deadline_date, map_data);
		}
		}catch(NullPointerException npe){
			inception_date = common.daysIncrementWithOutFormation(df.format(currentDate), 0);
			deadline_date = common.daysIncrementWithOutFormation(df.format(currentDate), 0);
			WriteDataToXl(code + "_" + event, "QuoteCreation", testName, "QC_InceptionDate", inception_date, map_data);
			WriteDataToXl(code + "_" + event, "QuoteCreation", testName, "QC_DeadlineDate", deadline_date, map_data);
		}
		
		String cname_timeStamp = new SimpleDateFormat("ddMMyyyyHHmmss", Locale.US).format(new Date());

		try {
			
			if (map_data.get("CC_CreateClient").equals("Yes")) {
				
				customAssert.assertTrue(k.Click("new_quote"), "Unable to click on New quote link");
				customAssert.assertTrue(k.Click("inception_date"), "Unable to enter inception date.");
				customAssert.assertTrue(k.Input("inception_date", inception_date),"Unable to Enter inception date.");
				customAssert.assertTrue(k.Click("calander_btn"), "Unable to click on done button in calander.");
				customAssert.assertTrue(!k.getAttributeIsEmpty("inception_date", "value"),"inception_date Field Should Contain Valid Value on New Quote page .");
				customAssert.assertTrue(k.Click("deadline_date"), "Unable to enter deadline date.");
				customAssert.assertTrue(k.Input("deadline_date", deadline_date),"Unable to Enter deadline date.");
				customAssert.assertTrue(k.Click("calander_btn"), "Unable to click on done button in calander.");
				customAssert.assertTrue(!k.getAttributeIsEmpty("deadline_date", "value"),"deadline_date Field Should Contain Valid Value on New Quote page .");
				customAssert.assertTrue(k.Input("premium", Keys.chord(Keys.CONTROL, "a")),"Unable to select Premium field . ");
				customAssert.assertTrue(k.Input("premium", (String) map_data.get("QC_TargetPemium")),"Unable to enter Target Premium .");
				customAssert.assertTrue(k.DropDownSelection("product_dropdown", CommonFunction_VELA.product),
						"Unable to select Product_Name from dropdown .");
				k.WaitUntilClickable("agency_dropdown", 30);
				if (driver.findElement(By.xpath("//*[contains(@name,'agency')]")).isEnabled()) {
					if (Environment.contains("EVO")) {
						customAssert.assertTrue(k.DropDownType("agency_dropdown", "Broker One"),
								"Unable to select Agency name from dropdown.");
					} else {
						k.DropDownSelectionByIndex("agency_dropdown", 1);
					}

					String AgencyName = k.GetDropDownSelectedValue("agency_dropdown");
					WriteDataToXl(code + "_" + event, "QuoteCreation", testName, "QC_AgencyName", AgencyName, map_data);
					
					k.WaitUntilClickable("broker_dropdown", 30);
					
					if (driver.findElement(By.xpath("//*[contains(@name,'broker')]")).isEnabled()) {
						if (Environment.contains("EVO")) {
							Assert.assertTrue(k.DropDownSelection("broker_dropdown", (String) map_data.get("Broker_Name")),
									"Unable to select Broker name from dropdown.");
						} else {
							k.DropDownSelectionByIndex("broker_dropdown", 1);
						}
						k.waitTwoSeconds();
						String BrokerName = k.GetDropDownSelectedValue("broker_dropdown");
						WriteDataToXl(code + "_" + event, "QuoteCreation", testName, "QC_BrokerName", BrokerName, map_data);
				
						TestUtil.reportStatus("Verifying all the entered value to create a new quote", "Info", true);
						customAssert.assertTrue(k.Click("create_btn"), "Unable to Click on Create button.");
						TestUtil.reportStatus("New quote has been created successfully.", "Info", true);
					} else {
						k.Click("quote_back_btn");
						customAssert.assertTrue(createNewQuote(map_data, code, event),
								"Create new quote function is having issue(S)");
					}
				} else {
					k.Click("quote_back_btn");
					customAssert.assertTrue(createNewQuote(map_data, code, event),
							"Create new quote function is having issue(S)");
				}

			} else {

				customAssert.assertTrue(k.Click("edit_btn"), "Unable to click on Edit button.");
				k.waitTwoSeconds();
				customAssert.assertTrue(k.Input("CCF_CC_CompanyName", Keys.chord(Keys.CONTROL, "a")),"Unable to select Company name field");
				String client_name = "Auto_C_" + cname_timeStamp;
				customAssert.assertTrue(k.Input("CCF_CC_CompanyName", client_name), "Unable to enter value in CompanyName field ");
				customAssert.assertTrue(!k.getAttributeIsEmpty("CCF_CC_CompanyName", "value"),"Company Name Field Should Contain Valid Value on Client Details  .");
				customAssert.assertTrue(k.Input("CCF_CC_TradingName", Keys.chord(Keys.CONTROL, "a")),"Unable to select Company name field");
				customAssert.assertTrue(k.Input("CCF_CC_TradingName", (String)map_data.get("CC_TradingName")),	"Unable to enter value in Trading Name field .");
				customAssert.assertTrue(k.Input("CCF_Address_CC_Address", Keys.chord(Keys.CONTROL, "a")),"Unable to select Address field");
				customAssert.assertTrue(k.Input("CCF_Address_CC_Address", (String) map_data.get("CC_Address")),"Unable to enter value in Address field. ");
				customAssert.assertTrue(!k.getAttributeIsEmpty("CCF_Address_CC_Address", "value"),"Address Field Should Contain Valid Value on Client Details .");
				customAssert.assertTrue(k.Input("CCF_Address_CC_line2", Keys.chord(Keys.CONTROL, "a")),"Unable to select Line 2 field");
				customAssert.assertTrue(k.Input("CCF_Address_CC_line2", (String) map_data.get("CC_line2")),"Unable to enter value in Address field line 2 . ");
				customAssert.assertTrue(k.Input("CCF_Address_CC_line3", Keys.chord(Keys.CONTROL, "a")),"Unable to select Line 3 field");
				customAssert.assertTrue(k.Input("CCF_Address_CC_line3", (String) map_data.get("CC_line3")),"Unable to enter value in Address field line 3 . ");
				customAssert.assertTrue(k.Input("CCF_Address_CC_Town", Keys.chord(Keys.CONTROL, "a")),"Unable to select Town field");
				customAssert.assertTrue(k.Input("CCF_Address_CC_Town", (String) map_data.get("CC_Town")),"Unable to enter value in Town field . ");
				customAssert.assertTrue(k.Input("CCF_Address_CC_County", Keys.chord(Keys.CONTROL, "a")),"Unable to select County field");
				customAssert.assertTrue(k.Input("CCF_Address_CC_County", (String) map_data.get("CC_County")),"Unable to enter value in County  . ");
				customAssert.assertTrue(k.Input("CCF_Address_CC_Postcode", Keys.chord(Keys.CONTROL, "a")),"Unable to select Post Code field");
				customAssert.assertTrue(k.Input("CCF_Address_CC_Postcode", (String) map_data.get("CC_Postcode")),"Unable to enter value in PostCode field .");
				customAssert.assertTrue(!k.getAttributeIsEmpty("CCF_Address_CC_Postcode", "value"),"Postcode Field Should Contain Valid Value on Client Details .");
				customAssert.assertTrue(common.validatePostCode((String)map_data.get("CC_Postcode")),"Post Code is not in Correct format .");
				customAssert.assertTrue(k.DropDownType("CCF_Address_CC_Country", (String) map_data.get("CC_Country")),"Unable to select Country name from dropdown .");

				WriteDataToXl(code + "_" + event, "NB", testName, "NB_ClientName", client_name, map_data);
				
				customAssert.assertTrue(k.Click("save_btn"), "Unable to click on Save button.");
				customAssert.assertTrue(k.Click("new_quote"), "Unable to click on New quote link");
		
				customAssert.assertTrue(k.Click("inception_date"), "Unable to enter inception date.");
				customAssert.assertTrue(k.Input("inception_date", inception_date),"Unable to Enter inception date.");
				customAssert.assertTrue(k.Click("calander_btn"), "Unable to click on done button in calander.");
				customAssert.assertTrue(k.Click("deadline_date"), "Unable to enter deadline date.");
				customAssert.assertTrue(k.Input("deadline_date", deadline_date),"Unable to Enter deadline date.");
				customAssert.assertTrue(k.Click("calander_btn"), "Unable to click on done button in calander.");
				customAssert.assertTrue(k.Input("premium", Keys.chord(Keys.CONTROL, "a")),"Unable to select Premium field . ");
				customAssert.assertTrue(k.Input("premium", (String) map_data.get("QC_TargetPemium")),"Unable to enter Target Premium .");
				customAssert.assertTrue(k.DropDownSelection("product_dropdown", CommonFunction_VELA.product),
						"Unable to select Product_Name from dropdown.");
				k.WaitUntilClickable("agency_dropdown", 30);
				if (driver.findElement(By.xpath("//*[contains(@name,'agency')]")).isEnabled()) {
					if (Environment.contains("EVO")) {
						Assert.assertTrue(k.DropDownType("agency_dropdown", "Broker One"),
								"Unable to select Agency name from dropdown.");
					} else {
						k.DropDownSelectionByIndex("agency_dropdown", 1);
					}
					String AgencyName = k.GetDropDownSelectedValue("agency_dropdown");

					WriteDataToXl(code + "_" + event, "QuoteCreation", testName, "QC_AgencyName", AgencyName, map_data);
				
					k.WaitUntilClickable("broker_dropdown", 30);
					if (driver.findElement(By.xpath("//*[contains(@name,'broker')]")).isEnabled()) {
						if (Environment.contains("EVO")) {
							Assert.assertTrue(k.DropDownSelection("broker_dropdown", (String) map_data.get("Broker_Name")),
									"Unable to select Broker name from dropdown.");
						} else {
							k.DropDownSelectionByIndex("broker_dropdown", 1);
						}
						String BrokerName = k.GetDropDownSelectedValue("broker_dropdown");

						WriteDataToXl(code + "_" + event, "QuoteCreation", testName, "QC_BrokerName", BrokerName, map_data);
						
						TestUtil.reportStatus("Verifying all the entered value to create a new quote", "Info", true);
						customAssert.assertTrue(k.Click("create_btn"), "Unable to Click on Create button.");
						TestUtil.reportStatus("New quote has been created successfully.", "Info", true);
					} else {
						k.Click("quote_back_btn");
						Assert.assertTrue(createNewQuote(map_data, code, event),"Create new quote function is having issue(S)");
					}
				} else {
					k.Click("quote_back_btn");
					Assert.assertTrue(createNewQuote(map_data, code, event),"Create new quote function is having issue(S)");
				}

			}

			return retvalue;

		} catch (Throwable t) {
			String methodName = new Object() {
			}.getClass().getEnclosingMethod().getName();
			TestUtil.reportFunctionFailed("Failed in " + methodName + " function");
			k.reportErr("Failed in " + methodName + " function", t);
			Assert.fail("Unable to click on create - > new quote \n", t);
			return false;
		}
	}

	/**
   	 * This method verify quote number and then selects the same to proceed further.
   	 */
   	  
   	       public boolean selectLatestQuote(Map<Object, Object> map_data, String code, String event){
   		    	boolean retvalue = true;
   		    	String testName = (String) map_data.get("Automation Key");
   			try{
   				
   				WebElement table = Keywords.getObject("table");
   				List<WebElement> list_row = table.findElements(By.tagName("tr"));
   				int total_row = list_row.size();
   				
   				for(int l=1;l<=total_row;l++){
   					driver.findElement(By.xpath("html/body")).sendKeys(Keys.PAGE_DOWN);
   					String client_name_val = driver.findElement(By.xpath("//*[@id='table0']/tbody/tr["+l+"]/td[2]")).getText();
   					String client_name = k.getText("client_name_value");
   						if(client_name.equalsIgnoreCase(client_name_val)){
   							String QuoteNumber = driver.findElement(By.xpath("//*[@id='table0']/tbody/tr["+l+"]/td[1]/a")).getText();
   							WriteDataToXl(code + "_" + event, "NB", testName, "NB_QuoteNumber", QuoteNumber, map_data);
   							driver.findElement(By.xpath("//*[@id='table0']/tbody/tr["+l+"]/td[1]/a")).click();
   						    TestUtil.reportStatus("Created Quote <b>"+QuoteNumber+ "</b> has been Selected for Policy Creation .", "Info", true);
   							}
   				}
   				if(((String)common.NB_excel_data_map.get("Automation Key")).contains("SPI")){
   					customAssert.assertTrue(common.funcPageNavigation("Policy General", ""),"Unable to Navigate to Policy General After selection of quote .");
   				}else if(((String)common.NB_excel_data_map.get("Automation Key")).contains("XOE")){
   					customAssert.assertTrue(common.funcPageNavigation("General", ""),"Unable to Navigate to General After selection of quote .");
   				}else{
   					customAssert.assertTrue(common.funcPageNavigation("Policy Details", ""),"Unable to Navigate to Policy Details After selection of quote .");
   				}
   				customAssert.assertTrue(selectClientId(map_data,code,event,testName),"Unable to capture / Write client ID .");
   					
   			 } catch(Throwable t) {
              	  String methodName = new Object(){}.getClass().getEnclosingMethod().getName();
                    TestUtil.reportFunctionFailed("Failed in "+methodName+" function");
                    k.reportErr("Failed in "+methodName+" function", t);
                    Assert.fail("Unable to select the Created Quote .  \n", t);
                    return false;
             }
			return retvalue;
   	       }
   	       
   	       	/**
		      * This method is to select Client Id and same will be written in excel file.  
		      */
		       
		       public boolean selectClientId(Map<Object, Object> map_data,String code, String event,String testName){
		    	   boolean retvalue = true;
		    	   try{
		     		   String client_id = k.getText("client_id_selection");
		    		   WriteDataToXl(code + "_" + event, "NB", testName, "NB_ClientId", client_id, map_data);
		    		   TestUtil.reportStatus("Client Id has been selected successfully.", "Info", false);
		    		   
		              } catch(Throwable t) {
		            	  String methodName = new Object(){}.getClass().getEnclosingMethod().getName();
		                  TestUtil.reportFunctionFailed("Failed in "+methodName+" function");
		                  k.reportErr("Failed in "+methodName+" function", t);
		                  Assert.fail("Failed to capture / Write client ID\n", t);
		                  return false;
		           }
		    	   return retvalue;
    	       }
			       
		       public boolean funcPageNavigation(String HeaderName,String btnName){
		           boolean retValue = true;
		           
		           if (!(HeaderName=="")){
		                 String strHeader= k.getText("Page_Header");
		                  if(strHeader.contentEquals(HeaderName)==false){
		                 	 TestUtil.reportStatus("Expected page <b>" +HeaderName+"</b> was unable to load, Actual Page displayed is -<b>"+strHeader+"</b>","fail",true);
		             	     return false;
		                  }else {
		                         TestUtil.reportStatus("Expected page <b>" +HeaderName+"</b> is successfully loaded","info",true);
		                        
		                  }
		           }
		          
		           if (!(btnName=="")){
		                 if(btnName.equalsIgnoreCase("Next")){
		                         TestUtil.reportStatus("Clicked on Next Button","info",false);
		                         k.Click("nextBtn");
		                         
		                                      
		                  }else if(btnName.equalsIgnoreCase("Back")){
		                         TestUtil.reportStatus("Clicked on Back Button","info",false);
		                         k.Click("backBtn");
		                  }else if(btnName.equalsIgnoreCase("Quote")){
		                         TestUtil.reportStatus("Clicked on Quote Button", "info", false);
		                         k.Click("quoteBtn");
		                         }
		                  else if(btnName.equalsIgnoreCase("Proceed")){
		                      TestUtil.reportStatus("Clicked on Proceed Button", "info", false);
		                      k.Click("proceedBtn");
		                      }
		                  else if(btnName.equalsIgnoreCase("Go On Cover")){
		                      TestUtil.reportStatus("Clicked on 'Go On Cover' Button", "info", false);
		                      k.Click("goOnCoverBtn");
		                  }
		                  //Draft Documents
		                  else if(btnName.equalsIgnoreCase("Draft Documents")){
		                      TestUtil.reportStatus("Clicked on 'Go On Cover' Button", "info", false);
		                      k.Click("draftDocBtn");
		                  }
		                 //Save Button
		                  else if(btnName.equalsIgnoreCase("Save")){
		                      TestUtil.reportStatus("Clicked on 'Save' Button", "info", false);
		                      k.Click("saveBtn");
		                  }
		                  else if(btnName.equalsIgnoreCase("Set to Quoted")){
		                      TestUtil.reportStatus("Clicked on 'Set to Quoted' Button", "info", false);
		                      k.Click("setToQuoteBtn");
		                  }
		 				 else if(btnName.equalsIgnoreCase("Assign Underwriter")){
		                      TestUtil.reportStatus("Clicked on 'Assign Underwriter' Button", "info", false);
		                      k.Click("assignUWBtn");
		                  }
		 				 else if(btnName.equalsIgnoreCase("Add Property")){
		                      TestUtil.reportStatus("Clicked on 'Add Property' Button", "info", false);
		                      k.Click("IP_AddProp");
		                  }
		 				 else if(btnName.equalsIgnoreCase("Create Endorsement")){
		                      TestUtil.reportStatus("Clicked on 'Create Endorsement' Button", "info", false);
		                      k.Click("createEndor");
		                  }
		 				 else if(btnName.equalsIgnoreCase("Submit Endorsement")){
		                      TestUtil.reportStatus("Clicked on 'Submit Endorsement' Button", "info", false);
		                      k.Click("submitEndorbtn");
		                  }
		 				 else if(btnName.equalsIgnoreCase("Decline")){
		                      TestUtil.reportStatus("Clicked on 'Decline' Button", "info", false);
		                      k.Click("CPA_decline_btn");
		                  }
		 				 else if(btnName.equalsIgnoreCase("Send to Underwriter")){
		                      TestUtil.reportStatus("Clicked on 'Decline' Button", "info", false);
		                      k.Click("sendUWbtn");
		                  }else if(btnName.equalsIgnoreCase("NTU")){
		                      TestUtil.reportStatus("Clicked on 'Decline' Button", "info", false);
		                      k.Click("CPA_NTU_reneawl_btn");
		                  }else if(btnName.equalsIgnoreCase("Documents")){
		                      TestUtil.reportStatus("Clicked on 'Documents' Button", "info", false);
		                      k.Click("docs_btn");
		                  }else if(btnName.equalsIgnoreCase("Accept Material Facts")){
		                      TestUtil.reportStatus("Clicked on 'Documents' Button", "info", false);
		                      k.Click("accept_material_facts_btn");
		                  
		                  }else if(btnName.equalsIgnoreCase("Put Endorsement On Cover")){
		               TestUtil.reportStatus("Clicked on 'Put Endorsement On Cover' Button", "info", false);
		               k.Click("ccd_endorsementONCover");
		                  }
		 			 else if(btnName.equalsIgnoreCase("Rewind")){
		               TestUtil.reportStatus("Clicked on 'Rewind' Button", "info", false);
		               k.Click("ccd_rwndBtn");
		           }
		 			 else if(btnName.equalsIgnoreCase("Rewind Endorsement")){
		               TestUtil.reportStatus("Clicked on 'Rewind Endorsement' Button", "info", false);
		               k.Click("ccd_rwndEndorsementBtn");
		           }
		 			 else if(btnName.equalsIgnoreCase("Put Rewind On Cover")){
		               TestUtil.reportStatus("Clicked on 'Put Rewind On Cover' Button", "info", false);
		               k.Click("ccd_rwndOnCoverBtn");
		           }

		           else {
		                  TestUtil.reportStatus("Unable to parse Button"+btnName+" name on page " +HeaderName,"fail",true);
		                  return false;
		           }
		    }
				return retValue;
		       }
		       
		     //Menu and submenu selection : 
	       public boolean funcMenuSelection(String menuName,String subMenuName) throws AWTException{
		       	   Boolean retvalue = true;
		       	   
		       	   java.util.List<WebElement> list = driver.findElements(By.xpath("//*[@id='nb-menu']/ul/li"));
		       	   String first_part = "//a[contains(text(),'";
		       	   String second_part = "')]";
		       	   String menuxpath = first_part+subMenuName+second_part;
		       	   
		       	   for(int i=0;i<list.size();i++){
		       	          String name = list.get(i).getText();
		       	          
		       	          if(subMenuName==""){
		       	                 if(name.equalsIgnoreCase(menuName)){
		       	                       list.get(i).click();
		       	                       //list = driver.findElements(By.xpath("//*[@id='nb-menu']/ul/li"));
		       	                       TestUtil.reportStatus("Clicked on [<b>  "+menuName+" </b>]  button.", "Info", false);
		       	                       break;
		       	                 }
		       	          }else{
		       	                 if(name.equalsIgnoreCase(menuName)){
		       	                	   
		       	                	   Actions builder=new Actions(driver);
		       	               		   Point coordinate=list.get(i).getLocation();
		       	               		   Robot robot=new Robot();
		       	               		   builder.moveToElement(list.get(i), 5,5).build().perform();
		       	               		   builder.moveByOffset(1, 1).build().perform();
		       	               		   robot.mouseMove(coordinate.getX()+8,coordinate.getY()+60);
		       	               		   
		       	                	   list.get(i).click();
		       	                       k.waitTwoSeconds();
		       	                       WebDriverWait wait = new WebDriverWait(driver, 50); 
		       	                       WebElement menuItem = wait.until(ExpectedConditions.presenceOfElementLocated(By.xpath(menuxpath)));  // until this submenu is found
		       	                       if(menuItem.isDisplayed()){
		       	                      	 //identify menu option from the resulting menu display and click
		       	                      	 WebElement menuOption = driver.findElement(By.xpath(menuxpath)); 
		       	                      	 menuOption.click(); 
		       	                      	 robot.mouseMove(500, 500);
		       	                      	 break;
		       	                       }else{
		       	                    	   funcMenuSelection(menuName,subMenuName);
		       	                       }
		       	                        	list = driver.findElements(By.xpath("//*[@id='nb-menu']/ul/li"));
		       	                 }
		       	          }
		       	          
		       	   }
		       	   return retvalue;

		       }

	public String daysIncrementWithOutFormation(String date, int days) {

		final String OLD_FORMAT = "dd/MM/yyyy";
		final String NEW_FORMAT = "dd/MMMM/yyyy";
		// August 12, 2010
		// String oldDateString = "09/01/2016";
		SimpleDateFormat sdf = new SimpleDateFormat(OLD_FORMAT);
		Date d = null;
		try {
			d = sdf.parse(date);
		} catch (ParseException e) {
			e.printStackTrace();
		}
		Calendar c1 = Calendar.getInstance();
		c1.setTime(d);
		sdf.applyPattern(OLD_FORMAT);
		// System.out.println("Original Date is : " + sdf.format(c1.getTime()));
		c1.add(Calendar.DATE, days);
		// System.out.println("New date is : " + sdf.format(c1.getTime()));

		return sdf.format(c1.getTime());
	}
	
	public Date addDays(Date date, int days)
    {
        Calendar cal = Calendar.getInstance();
        cal.setTime(date);
        cal.add(Calendar.DATE, days);
        return cal.getTime();
    }
	
	/**
	 * This method selects the specified covers from cover Page
	 */
	public boolean selectCover(String coverNameWithLocator,Map<Object, Object> map_data){
		 
		 boolean result=true;
		 String c_locator = null;
		 String coverName = null;
		 String agency_Name = null;
		try{
				coverName = coverNameWithLocator.split("__")[0];	
				c_locator = coverNameWithLocator.split("__")[1];
				
				if(coverName.equalsIgnoreCase("HireCoverPlus")){
					agency_Name = driver.findElement(By.xpath("html/body/div[3]/form/table/tbody/tr[2]/td[2]")).getText();
					if(!agency_Name.equals("M722")){
						TestUtil.reportStatus("Cover: <b>"+coverName+"</b> is not selected as Agency Selected Is Not 'Arthur J. Gallagher (UK) Ltd' ", "Info", false);
						return true;
					}
				}
				
				switch (CommonFunction.product) {
				case "XOC":
					k.waitTwoSeconds();
					if (!driver.findElement(By.xpath("//*[contains(@name,'"+c_locator+"')]")).isSelected()){
						k.scrollInViewByXpath("//*[contains(@name,'"+c_locator+"')]");
						driver.findElement(By.xpath("//*[contains(@name,'"+c_locator+"')]")).click();        
						TestUtil.reportStatus("Cover: <b>"+coverName+"</b> is selected ", "Info", false);
					}else{
						TestUtil.reportStatus("Cover: <b>"+coverName+"</b> is checked by default.", "Info", false);
					}
					break;
				case "XOQ":
					k.waitTwoSeconds();
					if (!driver.findElement(By.xpath("//*[contains(@name,'"+c_locator+"')]")).isSelected()){
						k.scrollInViewByXpath("//*[contains(@name,'"+c_locator+"')]");
						driver.findElement(By.xpath("//*[contains(@name,'"+c_locator+"')]")).click();        
						TestUtil.reportStatus("Cover: <b>"+coverName+"</b> is selected ", "Info", false);
					}else{
						TestUtil.reportStatus("Cover: <b>"+coverName+"</b> is checked by default.", "Info", false);
					}
					break;
				case "POF":
					k.waitTwoSeconds();
					if (!driver.findElement(By.xpath("//*[contains(@name,'"+c_locator+"')]")).isSelected()){
						k.scrollInViewByXpath("//*[contains(@name,'"+c_locator+"')]");
						driver.findElement(By.xpath("//*[contains(@name,'"+c_locator+"')]")).click();        
						TestUtil.reportStatus("Cover: <b>"+coverName+"</b> is selected ", "Info", false);
					}else{
						TestUtil.reportStatus("Cover: <b>"+coverName+"</b> is checked by default.", "Info", false);
					}
					break;
				default:
					k.waitTwoSeconds();
					if (!driver.findElement(By.xpath("//*[contains(@name,'"+c_locator+"_selected')]")).isSelected()){
						k.scrollInViewByXpath("//*[contains(@name,'"+c_locator+"_selected')]");
						driver.findElement(By.xpath("//*[contains(@name,'"+c_locator+"_selected')]")).click();        
						TestUtil.reportStatus("Cover: <b>"+coverName+"</b> is selected ", "Info", false);
					}else{
						TestUtil.reportStatus("Cover: <b>"+coverName+"</b> is checked by default.", "Info", false);
					}
					break;
				}
		 
		}catch(Throwable t){
			
			System.out.println("Error while selecting Cover - "+t.getMessage());
			result=false;
		}
		return result;
	 }
	
	 
	 public boolean deSelectCovers(String coverNameWithLocator,Map<Object, Object> map_data){
		 boolean result=true;
		 String c_locator = null;
		 String coverName = null;
		 try{
				coverName = coverNameWithLocator.split("__")[0];	
				c_locator = coverNameWithLocator.split("__")[1];
				if(c_locator.equals("md")){
					if (driver.findElement(By.xpath("//*[contains(@name,'"+c_locator+"')]")).isSelected()){
						driver.findElement(By.xpath("//*[contains(@name,'"+c_locator+"')]")).click();  
						k.waitTwoSeconds();
			           	Assert.assertTrue(k.AcceptPopup(), "Unable to locate popup box.");
						TestUtil.reportStatus("Cover  <b>"+coverName+"</b> is Unchecked ", "Info", false);
					}else{
						TestUtil.reportStatus("Cover: <b>"+coverName+"</b> is already not selected.", "Info", false);
					}
				}else if(c_locator.equals("comb_liab") || c_locator.equals("xoc_pl") || c_locator.equals("xoc_el") || c_locator.equals("xoc_jct_6_5_1") || c_locator.equals("xoc_third_party_motor")){
					if (driver.findElement(By.xpath("//*[contains(@name,'"+c_locator+"')]")).isSelected()){
						driver.findElement(By.xpath("//*[contains(@name,'"+c_locator+"')]")).click();  
						k.waitTwoSeconds();
			           	Assert.assertTrue(k.AcceptPopup(), "Unable to locate popup box.");
						TestUtil.reportStatus("Cover  <b>"+coverName+"</b> is Unchecked ", "Info", false);
					}else{
						TestUtil.reportStatus("Cover: <b>"+coverName+"</b> is already not selected.", "Info", false);
					}
				}else if(c_locator.equals("PEL")){
					
				}else if(coverName.equalsIgnoreCase("HireCoverPlus")){
					String agency_Name = driver.findElement(By.xpath("html/body/div[3]/form/table/tbody/tr[2]/td[2]")).getText();
					if(!agency_Name.equals("M722")){
						TestUtil.reportStatus("Cover: <b>"+coverName+"</b> is not selected as Agency Selected Is Not 'Arthur J. Gallagher (UK) Ltd' ", "Info", false);
					}else{
						if (driver.findElement(By.xpath("//*[contains(@name,'"+c_locator+"_selected')]")).isSelected()){
							JavascriptExecutor j_exe = (JavascriptExecutor) driver;
							j_exe.executeScript("arguments[0].scrollIntoView(true);", driver.findElement(By.xpath("//*[contains(@name,'"+c_locator+"_selected')]")));
							driver.findElement(By.xpath("//*[contains(@name,'"+c_locator+"_selected')]")).click();        
							k.waitTwoSeconds();
				           	Assert.assertTrue(k.AcceptPopup(), "Unable to locate popup box.");
							TestUtil.reportStatus("Cover  <b>"+coverName+"</b> is Unchecked ", "Info", false);
						}else{
							TestUtil.reportStatus("Cover: <b>"+coverName+"</b> is already not selected.", "Info", false);
						}
					}
				}
				else{
					if (driver.findElement(By.xpath("//*[contains(@name,'"+c_locator+"_selected')]")).isSelected()){
						JavascriptExecutor j_exe = (JavascriptExecutor) driver;
						j_exe.executeScript("arguments[0].scrollIntoView(true);", driver.findElement(By.xpath("//*[contains(@name,'"+c_locator+"_selected')]")));
						driver.findElement(By.xpath("//*[contains(@name,'"+c_locator+"_selected')]")).click();        
						k.waitTwoSeconds();
			           	Assert.assertTrue(k.AcceptPopup(), "Unable to locate popup box.");
						TestUtil.reportStatus("Cover  <b>"+coverName+"</b> is Unchecked ", "Info", false);
					}else{
						TestUtil.reportStatus("Cover: <b>"+coverName+"</b> is already not selected.", "Info", false);
					}
				}
			                        
				return result;
		           
		    } catch(Throwable t) {
		    	return false;
		}
	} 
	 
	 	/** 
		 * 
		 * Rewind Flow Covers Check and Uncheck.
		 * 
		 * 
		 */
		
	public boolean funcRewindCoversCheck(Map<Object, Object> map_data){
			//CoversDetails_data_list.clear();
		    boolean retvalue = true;
		    CoversDetails_data_list = new ArrayList<>();
		    try {
		    	if(CommonFunction_VELA.product.equalsIgnoreCase("XOE")){
		    		customAssert.assertTrue(common.funcPageNavigation("Additional Covers", ""),"Cover page is having issue(S)");
		    	}else{
		    		customAssert.assertTrue(common.funcPageNavigation("Covers", ""),"Cover page is having issue(S)");
		    	}
		 	 
		     String all_cover = ObjectMap.properties.getProperty(CommonFunction_VELA.product+"_CD_AllCovers");
		 	 String[] split_all_covers = all_cover.split(",");
		 	 for(String coverWithLocator : split_all_covers){
		 		 String coverWithoutLocator = coverWithLocator.split("_")[0];
		 		 try{
		 			 if(((String)map_data.get("CD_Add_"+coverWithoutLocator)).equals("Yes")){
			 			CoversDetails_data_list.add(coverWithoutLocator);
			 			customAssert.assertTrue(selectCover(coverWithLocator,map_data), "Select covers function is having issue(S) . ");
			 		}else if(((String)map_data.get("CD_Add_"+coverWithoutLocator)).equals("No")){
			 			customAssert.assertTrue(deSelectCovers(coverWithLocator,map_data), "Select covers function is having issue(S) . ");
			 		}
		 		 }catch(Throwable tt){
		 			 System.out.println("Error while selecting Cover - "+coverWithoutLocator);
		 			 break;
		 			}
		 		}
		 	 
		 	  customAssert.assertTrue(k.Click("CCF_Btn_Save"), "Unable to click on Save Button on Covers Screen .");
		      TestUtil.reportStatus("All specified covers are selected successfully  .", "Info", true);
		      return retvalue;
		           
		    } catch(Throwable t) {
		    	return false;
		 }
	}
	public boolean funcRequoteCoversCheck(Map<Object, Object> map_data){
		CoversDetails_data_list.clear();
	    boolean retvalue = true;
	    CoversDetails_data_list = new ArrayList<>();
	    try {
	    	if(CommonFunction_VELA.product.equalsIgnoreCase("XOE")){
	    		customAssert.assertTrue(common.funcPageNavigation("Additional Covers", ""),"Cover page is having issue(S)");
	    	}else{
	    		customAssert.assertTrue(common.funcPageNavigation("Covers", ""),"Cover page is having issue(S)");
	    	}
	 	 
	     String all_cover = ObjectMap.properties.getProperty(CommonFunction_VELA.product+"_CD_AllCovers");
	 	 String[] split_all_covers = all_cover.split(",");
	 	 for(String coverWithLocator : split_all_covers){
	 		 String coverWithoutLocator = coverWithLocator.split("_")[0];
	 		 try{
	 			 if(((String)map_data.get("CD_Add_"+coverWithoutLocator)).equals("Yes")){
		 			CoversDetails_data_list.add(coverWithoutLocator);
		 			customAssert.assertTrue(selectCover(coverWithLocator,map_data), "Select covers function is having issue(S) . ");
		 		}else if(((String)map_data.get("CD_Add_"+coverWithoutLocator)).equals("No")){
		 			customAssert.assertTrue(deSelectCovers(coverWithLocator,map_data), "Select covers function is having issue(S) . ");
		 		}
	 		 }catch(Throwable tt){
	 			 System.out.println("Error while selecting Cover - "+coverWithoutLocator);
	 			 break;
	 			}
	 		}
	 	 
	 	  customAssert.assertTrue(k.Click("CCF_Btn_Save"), "Unable to click on Save Button on Covers Screen .");
	      TestUtil.reportStatus("All specified covers are selected successfully  .", "Info", true);
	      return retvalue;
	           
	    } catch(Throwable t) {
	    	return false;
	 }
}

	public boolean funcRewindCoversUnCheck(Map<Object, Object> map_data){
		
	    boolean retvalue = true;
	    CoversDetails_data_list = new ArrayList<>();
	    try {
	    	if(CommonFunction_VELA.product.equalsIgnoreCase("XOE")){
	    		customAssert.assertTrue(common.funcPageNavigation("Additional Covers", ""),"Cover page is having issue(S)");
	    	}else{
	    		customAssert.assertTrue(common.funcPageNavigation("Covers", ""),"Cover page is having issue(S)");
	    	}
	 	 
	     String all_cover = ObjectMap.properties.getProperty(CommonFunction_VELA.product+"_CD_AllCovers");
	 	 String[] split_all_covers = all_cover.split(",");
	 	 for(String coverWithLocator : split_all_covers){
	 		 String coverWithoutLocator = coverWithLocator.split("_")[0];
	 		 try{if(((String)map_data.get("CD_Remove_"+coverWithoutLocator)).equals("Yes")){
		 			CoversDetails_data_list.add(coverWithoutLocator);
		 			customAssert.assertTrue(deSelectCovers(coverWithLocator,map_data), "Select covers function is having issue(S) . ");
		 		}else{
		 			continue;
		 		}
	 		 }catch(Throwable tt){
	 			 System.out.println("Error while unchecking Cover - "+coverWithoutLocator);
	 			 break;
	 			}
	 		}
	 	 
	 	  customAssert.assertTrue(k.Click("CCF_Btn_Save"), "Unable to click on Save Button on Covers Screen .");
	      TestUtil.reportStatus("All specified covers are selected successfully  .", "Info", true);
	      
	      return retvalue;
	           
	    } catch(Throwable t) {
	    	return false;
	 }
	}
	 
	/**
	 * This method selects the specified covers from cover Page
	 */
	    
	public boolean funcCovers(Map<Object, Object> map_data){
		
		boolean retvalue = true;
		String coverWithoutLocator = null;
		int count = 0;
		common_VELA.CoversDetails_data_list = new ArrayList<>();
	    try {
		     customAssert.assertTrue(common.funcPageNavigation("Covers", ""),"Cover page is having issue(S)");
		 	 k.pressDownKeyonPage();
		 	 String all_cover = ObjectMap.properties.getProperty(CommonFunction.product+"_CD_AllCovers");
		 	 String[] split_all_covers = all_cover.split(",");
		 	 for(String coverWithLocator : split_all_covers){
		 		 if(TestBase.product.contains("CTB")){
		 			coverWithoutLocator = coverWithLocator.split("_")[0];
		 		 }else{
		 			coverWithoutLocator = coverWithLocator.split("__")[0];
		 		 }
		 		
		 		 try{
		 			if(((String)map_data.get("CD_"+coverWithoutLocator)).equals("Yes")){
			 			if(!(coverWithoutLocator.equalsIgnoreCase("ProductsLiability") || 
			 					coverWithoutLocator.equalsIgnoreCase("PollutionLiability(suddenandunforeseen)") || 
			 					coverWithoutLocator.equalsIgnoreCase("Computer") || 
			 					coverWithoutLocator.equalsIgnoreCase("DeteriorationofStock"))){
			 				
			 				
			 				common_VELA.CoversDetails_data_list.add(coverWithoutLocator);
			 				
			 			}
			 			
			 			customAssert.assertTrue(selectCover(coverWithLocator,map_data), "Select covers function is having issue(S) . ");
			 		}else{
			 			customAssert.assertTrue(deSelectCovers(coverWithLocator,map_data), "Select covers function is having issue(S) . ");
			 		}
		 		 }catch(Throwable tt){
		 			 System.out.println("Error while selecting Cover - "+coverWithoutLocator);
		 			 break;
		 			}
		 		}
		 	 	
		 	  customAssert.assertTrue(k.Click("CCF_Btn_Save"), "Unable to click on Save Button on Covers Screen .");
		 	  
		 	  switch (CommonFunction.product) {
		 	  case "XOC":
		 	  case "XOQ":
				if(k.isDisplayedField("XOC_CoversErrorBlog")){
					common_VELA.CoversDetails_data_list.clear();
					for(String coverWithLocator : split_all_covers){
						 if(TestBase.product.contains("CTB")){
					 			coverWithoutLocator = coverWithLocator.split("_")[0];
					 		 }else{
					 			coverWithoutLocator = coverWithLocator.split("__")[0];
					 		 }
				 		 try{
				 		if(((String)map_data.get("CD_"+coverWithoutLocator)).equals("Yes") && count==0){
				 			common_VELA.CoversDetails_data_list.add(coverWithoutLocator);
				 			customAssert.assertTrue(selectCover(coverWithLocator,map_data), "Select covers function is having issue(S) . ");
				 			count++;
				 		}else if(((String)map_data.get("CD_"+coverWithoutLocator)).equals("Yes") && count!=0){
				 			customAssert.assertTrue(WriteDataToXl(CommonFunction.product+"_"+CommonFunction.businessEvent, "CoverDetails", (String)map_data.get("Automation Key"), "CD_"+coverWithoutLocator, "No",common.NB_excel_data_map),"Error while writing data to excel for field >CoverDetails<");
				 			//map_data.put("CD_"+coverWithoutLocator,"No");
				 			TestUtil.reportStatus("Application is allowing only single cover to be selected at a time hence unchecked Cover : <b> [  "+coverWithoutLocator+"  ] </b>", "Info", false);
				 		}
				 		else{
				 			continue;
				 		}
				 		 }catch(Throwable tt){
				 			 System.out.println("Error while selecting Cover - "+coverWithoutLocator);
				 			 break;
				 			}
				 		}
				}
				break;
		 	 
		 	  default:
				break;
		 	  }
		 	  
		      TestUtil.reportStatus("All specified covers are selected successfully  .", "Info", true);
		      return retvalue;
	           
	    } catch(Throwable t) {
	      String methodName = new Object(){}.getClass().getEnclosingMethod().getName();
	        TestUtil.reportFunctionFailed("Failed in "+methodName+" function");     
	        k.reportErr("Failed in "+methodName+" function", t);
	        Assert.fail("Unable to select specified covers . ", t);
	        return false;
	 }
	    }
	
	/**
	 * This method selects the specified Perils from Specified Perils Page
	 */
	 public boolean selectPerils(String perilNameWithLocator,Map<Object, Object> map_data){
		 
		 boolean result=true;
		 String p_locator = null;
		 String perilName = null;
		try{
				perilName = perilNameWithLocator.split("_")[0];	
				
				 if(perilName.contains("Malicious") || perilName.contains("AccidentalEscapeOfWater") ||  perilName.contains("PhysicalDamage")){
				 
					 p_locator = perilNameWithLocator.split("_")[1] + "_"+perilNameWithLocator.split("_")[2];
				 }else{
					 p_locator = perilNameWithLocator.split("_")[1];
				 }
				
				//k.waitTwoSeconds();
				if(perilName.equals("RCCSLOW") || perilName.contains("AttemptedTheft") || perilName.contains("FuelOil")){
					
					if (!driver.findElement(By.name(p_locator+"_selected_pcc")).isSelected()){
						driver.findElement(By.name(p_locator+"_selected_pcc")).click();        
						TestUtil.reportStatus("Peril: <b>"+perilName+"</b> is selected ", "Info", false);
					}else{
						TestUtil.reportStatus("Peril: <b>"+perilName+"</b> is checked by default.", "Info", false);
					}
				
				}else{
				
					if (!driver.findElement(By.name(p_locator+"_selected")).isSelected()){
						driver.findElement(By.name(p_locator+"_selected")).click();        
						TestUtil.reportStatus("Peril: <b>"+perilName+"</b> is selected ", "Info", false);
					}else{
						TestUtil.reportStatus("Peril: <b>"+perilName+"</b> is checked by default.", "Info", false);
					}
				}
		 
		}catch(Throwable t){
			
			System.out.println("Error while selecting Peril - "+t.getMessage());
			result=false;
		}
		return result;
	 }
	 
	 /**
		 * This method de-selects the specified Perils from Specified Perils Page
		 */
		 public boolean deSelectPerils(String perilNameWithLocator,Map<Object, Object> map_data){
			 
			 boolean result=true;
			 String p_locator = null;
			 String perilName = null;
			try{
					perilName = perilNameWithLocator.split("_")[0];	
					
					 if(perilName.contains("Malicious") || perilName.contains("AccidentalEscapeOfWater") ||  perilName.contains("PhysicalDamage")){
						 
						 p_locator = perilNameWithLocator.split("_")[1] + "_"+perilNameWithLocator.split("_")[2];
					 }else{
						 p_locator = perilNameWithLocator.split("_")[1];
					 }
					//k.waitTwoSeconds();
					 if(perilName.equals("RCCSLOW") || perilName.contains("AttemptedTheft") || perilName.contains("FuelOil")){
					
						if (driver.findElement(By.name(p_locator+"_selected_pcc")).isSelected()){
							driver.findElement(By.name(p_locator+"_selected_pcc")).click();        
							TestUtil.reportStatus("Peril: <b>"+perilName+"</b> is de-selected ", "Info", false);
						}else{
							TestUtil.reportStatus("Peril: <b>"+perilName+"</b> is un-checked by default.", "Info", false);
						}
					 }else{
						 if (driver.findElement(By.name(p_locator+"_selected")).isSelected()){
								driver.findElement(By.name(p_locator+"_selected")).click();        
								TestUtil.reportStatus("Peril: <b>"+perilName+"</b> is de-selected ", "Info", false);
							}else{
								TestUtil.reportStatus("Peril: <b>"+perilName+"</b> is un-checked by default.", "Info", false);
							}
					 }
					 
			 
			 
			}catch(Throwable t){
				
				System.out.println("Error while selecting Peril - "+t.getMessage());
				result=false;
			}
			return result;
		 }
	
	/**
	 * This method selects the specified perils from Specified Perils Page
	 */
	    
	public boolean funcSpecifiedPerils(Map<Object, Object> map_data){
		
	    boolean retvalue = true;
	    String perilWithoutLocator=null;
	  
	    try {
	    customAssert.assertTrue(common.funcPageNavigation("Specified Perils", ""),"Specified Perils page is having issue(S)");
	 	 k.pressDownKeyonPage();
	  	 String all_peril = ObjectMap.properties.getProperty(CommonFunction_VELA.product+"_SP_AllPerils");
	 	 String[] split_all_perils = all_peril.split(",");
	 	 for(String perilWithLocator : split_all_perils){
	 		 
	 		perilWithoutLocator = perilWithLocator.split("_")[0];
	 		
	 		try{
	 			if(((String)map_data.get("SP_"+perilWithoutLocator)).equals("Yes")){
	 				customAssert.assertTrue(selectPerils(perilWithLocator,map_data), "Select perils function is having issue(S) . ");
	 			}else{
	 				customAssert.assertTrue(deSelectPerils(perilWithLocator,map_data), "DeSelect perils function is having issue(S) . ");
	 				//continue;
	 			}
	 		 }catch(Throwable tt){
	 			 System.out.println("Error while selecting Peril - "+perilWithoutLocator);
	 			 break;
	 			}
	 		}
	 	 
	 	  customAssert.assertTrue(k.Click("CCF_Btn_Save"), "Unable to click on Save Button on Covers Screen .");
	      TestUtil.reportStatus("All specified Perils are selected successfully  .", "Info", true);
	      return retvalue;
	           
	    } catch(Throwable t) {
	      String methodName = new Object(){}.getClass().getEnclosingMethod().getName();
	        TestUtil.reportFunctionFailed("Failed in "+methodName+" function");     
	        k.reportErr("Failed in "+methodName+" function", t);
	        Assert.fail("Unable to select specified perils . ", t);
	        return false;
	 }
   }
	
	
	public static boolean PremiumSummarytableCalculation(Hashtable<String,String> tabledata,String section ){
		//MaterialDamage_nipt, MaterialDamage_gprem, MaterialDamage_nprem, MaterialDamage_gipt, MaterialDamage_comm,MaterialDamage_comr
		try{ 	
		if(section.equals("Total")){ return true;}
			DecimalFormat f = new DecimalFormat("00.00");
			String secName = section.replaceAll(" ", "");
			String cSection = null;
			double grossPrem = Double.parseDouble(tabledata.get("PS_"+secName+"_GP"));
			double commisn   = Double.parseDouble(tabledata.get("PS_"+secName+"_GC")); 
			double commRate  = Double.parseDouble(tabledata.get("PS_"+secName+"_CR"));
			double netPrem 	 = Double.parseDouble(tabledata.get("PS_"+secName+"_NP"));
			double grossIPT  = Double.parseDouble(tabledata.get("PS_"+secName+"_GT"));
			double netIPT    = Double.parseDouble(tabledata.get("PS_"+secName+"_NPIPT"));
			
			
			if(secName.contains("Frozen")){
				cSection = "FrozenFoods";
			}else if(secName.contains("Licence")){
				cSection = "LossOfLicence";
			}else if(secName.contains("Total")){
				cSection = "Total";
			}else{
				cSection = secName.replaceAll(" ", "");
			}
			
			double IPT =  Double.parseDouble(TestUtil.getStringfromMap("PS_"+cSection+"_IPT",""));
			TestUtil.reportStatus("Calculation for cover <b> "+section+"</b> as per IPT rate :"+IPT+" %", "Info", false);
			//System.out.println("\nCalculation Cover Name :"+section);// Added to the reporting & Logfile }
			//TestUtil.reportStatus("\nCalculation for Cover : <b>"+section, "Info", true);
			double denominator = (1.00-(commRate/100));
			double calcltdComm = (netPrem/denominator)*(commRate/100);
			//System.out.println("calculated Gross Commission :"+f.format(calcltdComm));// Added to the reporting & Logfile }
			TestUtil.reportStatus("Calculated Gross Commission :<b>"+f.format(calcltdComm), "Info", false);
			double calcltdGprem = calcltdComm + netPrem;
			//System.out.println("Calculated Gross Premium :"+f.format(calcltdGprem));// Added to the reporting & Logfile }
			TestUtil.reportStatus("Calculated Gross Premium :<b>"+f.format(calcltdGprem), "Info", false);
			double calcltdGIPT = calcltdGprem *(IPT/100);
			//System.out.println("Calculated Gross IPT :"+f.format(calcltdGIPT));// Added to the reporting & Logfile }
			TestUtil.reportStatus("Calculated Gross IPT :<b>"+f.format(calcltdGIPT), "Info", false);
			double calcltdNIPT = netPrem*(IPT/100);
			//System.out.println("Calculated Net IPT :"+f.format(calcltdNIPT));// Added to the reporting & Logfile }
			TestUtil.reportStatus("Calculated Net IPT :<b>"+f.format(calcltdNIPT), "Info", false);	
			customAssert.assertTrue(compareValues(calcltdGprem,grossPrem,"Gross Premium "),"Mismatched Gross Premium Values");
			customAssert.assertTrue(compareValues(calcltdComm,commisn,"Gross Commission "),"Mismatched Gross Commission Values");
			customAssert.assertTrue(compareValues(calcltdGIPT,grossIPT,"Gross IPT value "),"Mismatched Gross IPT Values");
			customAssert.assertTrue(compareValues(calcltdNIPT,netIPT,"Net IPT Values "),"Mimatched Net IPT Values");
			return true;
		}catch(Throwable t){
			return false;
		}
		}
	@SuppressWarnings("finally")
	public static boolean compareValues(double ExpectedValue, double ActualValue, String val) throws Exception{
		String eMsg="";
		boolean iret =true;
		try{
		
		 DecimalFormat f = new DecimalFormat("00.00");
		 String df1 = f.format(ExpectedValue);
		 String df2 = f.format(ActualValue);
		 double diffrence = Double.parseDouble(df1) - Double.parseDouble(df2);
		 if(df1.equalsIgnoreCase(df2)){
			 String tMsg="Values have been matched for <b>"+val+"</b> Expected:<b>"+df1+" </b> with Actual value :<b>"+df2;
			 TestUtil.reportStatus(tMsg, "Pass", false);
		 }
		 else if(diffrence<=0.05 && diffrence>=-0.05){
			 if(diffrence==0.0){
				 String tMsg="Values have been matched for <b> "+val+"</b> Expected:<b> "+df1.replaceAll("-", "")+" </b> with Actual value :<b> "+df2.replaceAll("-", "")+" </p>";
				 TestUtil.reportStatus(tMsg, "Pass", false);
			 }else{
			 String tMsg="<p style='color:blue'>Values have been matched for <b>"+val+"</b> Expected:<b>"+df1+" </b> with Actual value :<b> "+df2+" </p>";
			 TestUtil.reportStatus(tMsg, "Pass", false);}	 
		 }
		 else{  
			 eMsg="Values have not been matched for <b>"+val+"</b> Expected:<b>"+df1+"</b> with Actual value :<b>"+df2; 
			 TestUtil.reportStatus(eMsg, "Fail", true);
			 throw new Exception(eMsg);
		 }
		 }catch(Throwable t){
			iret = false;
			ErrorUtil.addVerificationFailure(t);
		 }
		finally{
			return iret;
		}	 
	 }
	 
	 /**
	     * This method logouts from Stingray Application
	   */
	     
	     public boolean StingrayLogout(){
	            Boolean retvalue = true;
	            try {
	                 
	                   Assert.assertTrue(k.Click("Logout_Button"),"Unable to click Logout Button");
	                   TestUtil.reportStatus("User : "+loginUserName+" has been Logout.", "Info", true);
	                   return retvalue;
	                   
	            } catch(Throwable t) {
	          	  String methodName = new Object(){}.getClass().getEnclosingMethod().getName();
	                TestUtil.reportFunctionFailed("Failed in "+methodName+" function");     k.reportErr("Failed in "+methodName+" function", t);
	                Assert.fail("Unable to click on Logout Button \n", t);
	                return false;
	         }
	            }

	     public boolean funcStatusHandling(Map<Object, Object> map_data , String code , String event){
				
			 boolean ret_value = true;
			 String p_Status = null;
			 String quoteDate = null;
			 String quoteNumber = null;
			 String policyNumber = null;
			 
			 if(TestBase.businessEvent.equals("NB")){
			 	p_Status = (String)map_data.get("NB_Status");
			 }else if(TestBase.businessEvent.equals("MTA")){
				 if(common.currentRunningFlow.equals("NB")){
					 p_Status = (String)common.NB_excel_data_map.get("NB_Status");
				 }else{
					 p_Status = (String)common.MTA_excel_data_map.get("MTA_Status");
				 }
			 }else if(TestBase.businessEvent.equals("Rewind")){
				 if(common.currentRunningFlow.equals("NB")){
					 p_Status = (String)common.NB_excel_data_map.get("NB_Status");
				 }else{
					 p_Status = (String)common.Rewind_excel_data_map.get("Rewind_Status");
				 }
			 }else if(TestBase.businessEvent.equals("Requote")){
				 if(common.currentRunningFlow.equals("NB")){
					 p_Status = (String)common.NB_excel_data_map.get("NB_Status");
				 }else{
					 p_Status = (String)common.Requote_excel_data_map.get("Requote_Status");
				 }
			 }else if(TestBase.businessEvent.equals("CAN")){
				 if(common.currentRunningFlow.equals("NB")){
					 p_Status = (String)common.NB_excel_data_map.get("NB_Status");
				 }else{
					 p_Status = (String)common.CAN_excel_data_map.get("CAN_Status");
				 }
			 }else if(TestBase.businessEvent.equals("Renewal")){
					 	p_Status = (String)map_data.get("Renewal_Status");
				 }
				try{
					
					switch (p_Status) {
					case "Submitted":
						customAssert.assertTrue(common.funcVerifyPolicyStatus(common.NB_excel_data_map,code,event,(String)map_data.get("NB_Status")), "Verify Policy Status (Submitted) function is having issue(S) . ");
						TestUtil.reportStatus("Current Flow is restricted to <b>[  "+(String)map_data.get("NB_Status")+"  ]</b> status. ", "Info", true);
						
						break;
					case "Quoted":
						customAssert.assertTrue(common.funcVerifyPolicyStatus(common.NB_excel_data_map,code,event,"Submitted"), "Verify Policy Status (Submitted) function is having issue(S) . ");
						//This will store quote number.
						quoteNumber = k.getText("Quote_Number");
						common.NB_excel_data_map.put(common.currentRunningFlow+"_QuoteNumber", quoteNumber);
						/////////////////////////////////////////////////////////////
						Assert.assertTrue(common_VELA.funcQuoteCheck(common.NB_excel_data_map));
						//This will get UK date after putting policy on Quoted status.
						quoteDate = common.getUKDate();
						common.NB_excel_data_map.put("QuoteDate", quoteDate);
						/////////////////////////////////////////////////////////////
						customAssert.assertTrue(common.funcSearchPolicy(common.NB_excel_data_map), "Policy Search function is having issue(S) . ");
						customAssert.assertTrue(common.funcVerifyPolicyStatus(common.NB_excel_data_map,code,event,(String)map_data.get("NB_Status")), "Verify Policy Status (Quoted) function is having issue(S) . ");
						if(!CommonFunction_VELA.product.equalsIgnoreCase("XOE")){
							customAssert.assertTrue(funcPDFdocumentVerification("Draft Documents"), "Verify Policy Status (On Cover) function is having issue(S) . ");
						}
						TestUtil.reportStatus("Current Flow is restricted to <b>[  "+(String)map_data.get("NB_Status")+"  ]</b> status. ", "Info", true);
						break;
					case "On Cover":
						customAssert.assertTrue(common.funcVerifyPolicyStatus(common.NB_excel_data_map,code,event,"Submitted"), "Verify Policy Status (Submitted) function is having issue(S) . ");
						//This will store quote number.
						quoteNumber = k.getText("Quote_Number");
						common.NB_excel_data_map.put(common.currentRunningFlow+"_QuoteNumber", quoteNumber);
						/////////////////////////////////////////////////////////////
						Assert.assertTrue(common_VELA.funcQuoteCheck(common.NB_excel_data_map));
						//This will get UK date after putting policy on Quoted status.
						quoteDate = common.getUKDate();
						common.NB_excel_data_map.put("QuoteDate", quoteDate);
						/////////////////////////////////////////////////////////////
						customAssert.assertTrue(common.funcSearchPolicy(common.NB_excel_data_map), "Policy Search function is having issue(S) . ");
						customAssert.assertTrue(common.funcVerifyPolicyStatus(common.NB_excel_data_map,code,event,"Quoted"), "Verify Policy Status (Quoted) function is having issue(S) . ");
						if(!CommonFunction_VELA.product.equalsIgnoreCase("XOE")){
							customAssert.assertTrue(funcPDFdocumentVerification("Draft Documents"), "Verify Policy Status (On Cover) function is having issue(S) . ");
						}
						customAssert.assertTrue(common.funcGoOnCover(common.NB_excel_data_map), "Go On Cover function is having issue(S) . ");
						customAssert.assertTrue(common.funcSearchPolicy(common.NB_excel_data_map), "Policy Search function is having issue(S) . ");
						if(TestBase.product.equals("SPI")){
							customAssert.assertTrue(common.funcVerifyPolicyStatus(common.NB_excel_data_map,code,event,"On Cover (Unconfirmed)"), "Verify Policy Status (On Cover (Unconfirmed)) function is having issue(S) . ");
							customAssert.assertTrue(common_SPI.func_Confirm_Policy(), "Error while changing SPI policy Status from Unconfirmed to Confirmed . ");
							customAssert.assertTrue(common.funcVerifyPolicyStatus(common.NB_excel_data_map,code,event,(String)map_data.get("NB_Status")), "Verify Policy Status (On Cover) function is having issue(S) . ");
						}else{
							customAssert.assertTrue(common.funcVerifyPolicyStatus(common.NB_excel_data_map,code,event,(String)map_data.get("NB_Status")), "Verify Policy Status (On Cover) function is having issue(S) . ");
						}
						if(!CommonFunction_VELA.product.equalsIgnoreCase("XOE")){
							customAssert.assertTrue(funcPDFdocumentVerification("Documents"), "Verify Policy Status (On Cover) function is having issue(S) . ");
						}
						customAssert.assertTrue(common_VELA.transactionSummary((String)common.NB_excel_data_map.get("Automation Key"), "", code, event), "Transaction Summary function is having issue(S) . ");
						TestUtil.reportStatus("Current Flow is restricted to <b>[  "+(String)map_data.get("NB_Status")+"  ]</b> status. ", "Info", true);
						break;
					case "Declined":
						customAssert.assertTrue(common.funcVerifyPolicyStatus(common.NB_excel_data_map,code,event,"Submitted"), "Verify Policy Status (Submitted) function is having issue(S) . ");
						Assert.assertTrue(common.funcDecline(common.NB_excel_data_map));
						customAssert.assertTrue(common.funcSearchPolicy(common.NB_excel_data_map), "Policy Search function is having issue(S) . ");
						customAssert.assertTrue(common.funcVerifyPolicyStatus(common.NB_excel_data_map,code,event,"Declined"), "Verify Policy Status (Declined) function is having issue(S) . ");
						//funcVerifyDeclineNTUstatus
						customAssert.assertTrue(common.funcVerifyDeclineNTUstatus(common.NB_excel_data_map), "Verify Policy Status (Decline Page) function is having issue(S) . ");
						break;
						
					case "NTU":
						//Not Taken Up
						customAssert.assertTrue(common.funcVerifyPolicyStatus(common.NB_excel_data_map,code,event,"Submitted"), "Verify Policy Status (Submitted) function is having issue(S) . ");
						//This will store quote number.
						quoteNumber = k.getText("Quote_Number");
						common.NB_excel_data_map.put(common.currentRunningFlow+"_QuoteNumber", quoteNumber);
						/////////////////////////////////////////////////////////////
						Assert.assertTrue(common_VELA.funcQuoteCheck(common.NB_excel_data_map));
						//This will get UK date after putting policy on Quoted status.
						quoteDate = common.getUKDate();
						common.NB_excel_data_map.put("QuoteDate", quoteDate);
						/////////////////////////////////////////////////////////////
						customAssert.assertTrue(common.funcSearchPolicy(common.NB_excel_data_map), "Policy Search function is having issue(S) . ");
						customAssert.assertTrue(common.funcVerifyPolicyStatus(common.NB_excel_data_map,code,event,"Quoted"), "Verify Policy Status (Quoted) function is having issue(S) . ");
						if(!CommonFunction_VELA.product.equalsIgnoreCase("XOE")){
							customAssert.assertTrue(funcPDFdocumentVerification("Draft Documents"), "Verify Policy Status (On Cover) function is having issue(S) . ");
						}
						Assert.assertTrue(common.funcNTU(common.NB_excel_data_map));
						
						customAssert.assertTrue(common.funcSearchPolicy(common.NB_excel_data_map), "Policy Search function is having issue(S) . ");
						customAssert.assertTrue(common.funcVerifyPolicyStatus(common.NB_excel_data_map,code,event,"Not Taken Up"), "Verify Policy Status (NTU) function is having issue(S) . ");
						customAssert.assertTrue(common.funcVerifyNTUstatus(common.NB_excel_data_map), "Verify Policy Status (NTU Page) function is having issue(S) . ");
						TestUtil.reportStatus("Current Flow is restricted to <b>[  "+(String)map_data.get("NB_Status")+"  ]</b> status. ", "Info", true);
						break;
						
					case "Indicate":
						customAssert.assertTrue(common.funcVerifyPolicyStatus(common.NB_excel_data_map,code,event,"Submitted"), "Verify Policy Status (Submitted) function is having issue(S) . ");
						// Indicate
						customAssert.assertTrue(funcButtonSelection("Indicate"),"Unable to click on Indicate button on premium summary page");
						customAssert.assertTrue(common.funcSearchPolicy(common.NB_excel_data_map), "Policy Search function is having issue(S) . ");
						customAssert.assertTrue(common.funcVerifyPolicyStatus(common.NB_excel_data_map,code,event,"Indicated"), "Verify Policy Status (Indicated) function is having issue(S) . ");
						// Indication Accept
						customAssert.assertTrue(funcButtonSelection("Indication Accept"),"Unable to click on Indication Accept button on premium summary page");
						customAssert.assertTrue(common.funcSearchPolicy(common.NB_excel_data_map), "Policy Search function is having issue(S) . ");
						customAssert.assertTrue(common.funcVerifyPolicyStatus(common.NB_excel_data_map,code,event,"Indication Accepted"), "Verify Policy Status (Indication Accepted) function is having issue(S) . ");
						//This will store quote number.
						quoteNumber = k.getText("Quote_Number");
						common.NB_excel_data_map.put(common.currentRunningFlow+"_QuoteNumber", quoteNumber);
						/////////////////////////////////////////////////////////////
						//Quote Creation
						Assert.assertTrue(common_VELA.funcQuoteCheck(common.NB_excel_data_map));
						//This will get UK date after putting policy on Quoted status.
						quoteDate = common.getUKDate();
						common.NB_excel_data_map.put("QuoteDate", quoteDate);
						/////////////////////////////////////////////////////////////
						customAssert.assertTrue(common.funcSearchPolicy(common.NB_excel_data_map), "Policy Search function is having issue(S) . ");
						customAssert.assertTrue(common.funcVerifyPolicyStatus(common.NB_excel_data_map,code,event,"Quoted"), "Verify Policy Status (Quoted) function is having issue(S) . ");
						if(!CommonFunction_VELA.product.equalsIgnoreCase("XOE")){
							customAssert.assertTrue(funcPDFdocumentVerification("Draft Documents"), "Verify Policy Status (On Cover) function is having issue(S) . ");
						}
						customAssert.assertTrue(common.funcGoOnCover(common.NB_excel_data_map), "Go On Cover function is having issue(S) . ");
						customAssert.assertTrue(common.funcSearchPolicy(common.NB_excel_data_map), "Policy Search function is having issue(S) . ");
						if(TestBase.product.equals("SPI")){
							customAssert.assertTrue(common.funcVerifyPolicyStatus(common.NB_excel_data_map,code,event,"On Cover (Unconfirmed)"), "Verify Policy Status (On Cover (Unconfirmed)) function is having issue(S) . ");
							customAssert.assertTrue(common_SPI.func_Confirm_Policy(), "Error while changing SPI policy Status from Unconfirmed to Confirmed . ");
							customAssert.assertTrue(common.funcVerifyPolicyStatus(common.NB_excel_data_map,code,event,"On Cover"), "Verify Policy Status (On Cover) function is having issue(S) . ");
						}else{
							customAssert.assertTrue(common.funcVerifyPolicyStatus(common.NB_excel_data_map,code,event,"On Cover"), "Verify Policy Status (On Cover) function is having issue(S) . ");
						}	if(!CommonFunction_VELA.product.equalsIgnoreCase("XOE")){
							customAssert.assertTrue(funcPDFdocumentVerification("Documents"), "Verify Policy Status (On Cover) function is having issue(S) . ");
						}
						customAssert.assertTrue(common_VELA.transactionSummary((String)common.NB_excel_data_map.get("Automation Key"), "", code, event), "Transaction Summary function is having issue(S) . ");
						TestUtil.reportStatus("Policy has been created with mentioned Status :<b>[ Submitted->Indicate->Indication Accepted->Quoted->On Cover ]</b>", "Info", true);
						
						break;
					case "Requote":
						customAssert.assertTrue(common.funcVerifyPolicyStatus(common.Requote_excel_data_map,code,event,"Submitted"), "Verify Policy Status (Submitted) function is having issue(S) . ");
						//This will store quote number.
						quoteNumber = k.getText("Quote_Number");
						common.NB_excel_data_map.put(common.currentRunningFlow+"_QuoteNumber", quoteNumber);
						/////////////////////////////////////////////////////////////
						Assert.assertTrue(common_VELA.funcQuoteCheck(common.Requote_excel_data_map));
						//This will get UK date after putting policy on Quoted status.
						quoteDate = common.getUKDate();
						common.Requote_excel_data_map.put("QuoteDate", quoteDate);
						/////////////////////////////////////////////////////////////
						customAssert.assertTrue(common.funcSearchPolicy(common.NB_excel_data_map), "Policy Search function is having issue(S) . ");
						customAssert.assertTrue(common.funcVerifyPolicyStatus(common.Requote_excel_data_map,code,event,"Quoted"), "Verify Policy Status (Quoted) function is having issue(S) . ");
						//customAssert.assertTrue(funcPDFdocumentVerification("Draft Documents"), "Verify Policy Status (On Cover) function is having issue(S) . ");
						customAssert.assertTrue(common.funcGoOnCover(common.Requote_excel_data_map), "Go On Cover function is having issue(S) . ");
						customAssert.assertTrue(common.funcSearchPolicy(common.NB_excel_data_map), "Policy Search function is having issue(S) . ");
						customAssert.assertTrue(common.funcVerifyPolicyStatus(common.Requote_excel_data_map,code,event,"On Cover"), "Verify Policy Status (On Cover) function is having issue(S) . ");
						//customAssert.assertTrue(funcPDFdocumentVerification("Documents"), "Verify Policy Status (On Cover) function is having issue(S) . ");
						customAssert.assertTrue(common_VELA.transactionSummary((String)common.Requote_excel_data_map.get("Automation Key"), "", code, event), "Transaction Summary function is having issue(S) . ");
						TestUtil.reportStatus("Current Flow is restricted to <b>[  "+(String)map_data.get("Requote_Status")+"  ]</b> status. ", "Info", true);
						
						
						
						
						
						break;
					case "Rewind":
						customAssert.assertTrue(common.funcVerifyPolicyStatus(common.Rewind_excel_data_map,code,event,"Submitted (Rewind)"), "Verify Policy Status (Submitted) function is having issue(S) . ");
						customAssert.assertTrue(common.funcButtonSelection("Put Rewind On Cover"));
						customAssert.assertTrue(common.funcSearchPolicy(common.NB_excel_data_map), "Policy Search function is having issue(S) . ");
						customAssert.assertTrue(common.funcVerifyPolicyStatus(common.Rewind_excel_data_map,CommonFunction.product,CommonFunction.businessEvent,"On Cover"), "Verify Policy Status (Submitted (Rewind)) function is having issue(S) . ");
						customAssert.assertTrue(funcPDFdocumentVerification("Documents"), "Document verification function is having issue(S) . ");
						customAssert.assertTrue(common_VELA.transactionSummary((String)common.NB_excel_data_map.get("Automation Key"), "", CommonFunction_VELA.product,CommonFunction_VELA.businessEvent), "Transaction Summary function is having issue(S) after Rewind  . ");
						
						TestUtil.reportStatus("Current Flow is restricted to <b>[  "+(String)map_data.get("Rewind_Status")+"  ]</b> status. ", "Info", true);
						break;
					case "Cancelled":
						customAssert.assertTrue(common.funcSearchPolicy(common.NB_excel_data_map), "Policy Search function is having issue(S) . ");
						customAssert.assertTrue(common.funcVerifyPolicyStatus(common.CAN_excel_data_map,code,event,"Cancelled"), "Verify Policy Status (Cancelled) function is having issue(S) . ");
						customAssert.assertTrue(common_VELA.transactionSummary((String)common.CAN_excel_data_map.get("Automation Key"), "", code, event), "Transaction Summary function is having issue(S) . ");
						TestUtil.reportStatus("Current Flow is restricted to <b>[  "+(String)common.CAN_excel_data_map.get("CAN_Status")+"  ]</b> status. ", "Info", true);
						break;
						
					case "Endorsement Submitted":
						customAssert.assertTrue(common.funcVerifyPolicyStatus(common.NB_excel_data_map,code,event,"Endorsement Submitted"), "Verify Policy Status (Endorsement Submitted) function is having issue(S) . ");
						if(TestBase.product.equals("SPI")){
							customAssert.assertTrue(common.funcButtonSelection("Assign Underwriter"),"Unable to Click on Assign Underwriter button . ");
							customAssert.assertTrue(common_SPI.funcAssignPolicyToUW(), "Error while assigning Policy to Underwriter.");
						}
						
						TestUtil.reportStatus("Current Flow is restricted to <b>[  "+(String)map_data.get("MTA_Status")+"  ]</b> status. ", "Info", true);
						break;
						
					case "Endorsement Quoted":
						customAssert.assertTrue(common.funcVerifyPolicyStatus(common.NB_excel_data_map,code,event,"Endorsement Submitted"), "Verify Policy Status (Endorsement Submitted) function is having issue(S) . ");
						//This will store quote number.
						quoteNumber = k.getText("Quote_Number");
						common.MTA_excel_data_map.put(common.currentRunningFlow+"_QuoteNumber", quoteNumber);
						/////////////////////////////////////////////////////////////
						if(TestBase.product.equals("SPI")|| TestBase.product.equals("COB")||TestBase.product.equals("CCF")){
							customAssert.assertTrue(common.funcButtonSelection("Assign Underwriter"),"Unable to Click on Assign Underwriter button . ");
							customAssert.assertTrue(common_SPI.funcAssignPolicyToUW(), "Error while assigning Policy to Underwriter.");
						}
						Assert.assertTrue(common.funcQuoteCheck(common.NB_excel_data_map));
						//This will get UK date after putting policy on Quoted status.
						quoteDate = common.getUKDate();
						common.NB_excel_data_map.put("QuoteDate", quoteDate);
						/////////////////////////////////////////////////////////////
						customAssert.assertTrue(common.funcSearchPolicy(common.NB_excel_data_map), "Policy Search function is having issue(S) . ");
						customAssert.assertTrue(common.funcVerifyPolicyStatus(common.NB_excel_data_map,code,event,"Endorsement Quoted"), "Verify Policy Status (Endorsement Quoted) function is having issue(S) . ");
						if(!CommonFunction_VELA.product.equalsIgnoreCase("XOE")){
							customAssert.assertTrue(funcPDFdocumentVerification("Draft Documents"), "Verify Policy Status (Endorsement Quoted) function is having issue(S) . ");
						}
						
						TestUtil.reportStatus("Current Flow is restricted to <b>[  "+(String)map_data.get("MTA_Status")+"  ]</b> status. ", "Info", true);
						break;
						
					case "Endorsement On Cover":
						customAssert.assertTrue(common.funcVerifyPolicyStatus(common.NB_excel_data_map,code,event,"Endorsement Submitted"), "Verify Policy Status (Endorsement Submitted) function is having issue(S) . ");
						//This will store quote number.
						quoteNumber = k.getText("Quote_Number");
						common.MTA_excel_data_map.put(common.currentRunningFlow+"_QuoteNumber", quoteNumber);
						/////////////////////////////////////////////////////////////
						if(TestBase.product.equals("SPI")||TestBase.product.equals("CCF") || TestBase.product.equals("COB")|| TestBase.product.equals("COA")
								|| TestBase.product.equals("XOC")||TestBase.product.equals("XOQ")){
							customAssert.assertTrue(common.funcButtonSelection("Assign Underwriter"),"Unable to Click on Assign Underwriter button . ");
							customAssert.assertTrue(common_SPI.funcAssignPolicyToUW(), "Error while assigning Policy to Underwriter.");
						}
						Assert.assertTrue(common.funcQuoteCheck(common.NB_excel_data_map));
						//This will get UK date after putting policy on Quoted status.
						quoteDate = common.getUKDate();
						common.MTA_excel_data_map.put("QuoteDate", quoteDate);
						/////////////////////////////////////////////////////////////
						customAssert.assertTrue(common.funcSearchPolicy(common.NB_excel_data_map), "Policy Search function is having issue(S) . ");
						customAssert.assertTrue(common.funcVerifyPolicyStatus(common.NB_excel_data_map,code,event,"Endorsement Quoted"), "Verify Policy Status (Endorsement Quoted) function is having issue(S) . ");
						if(!CommonFunction_VELA.product.equalsIgnoreCase("XOE")){
							customAssert.assertTrue(funcPDFdocumentVerification("Draft Documents"), "Error in PDF Verification (Draft Documents) function is having issue(S) . ");
						}
						customAssert.assertTrue(common.funcGoOnCover_Endorsement(common.NB_excel_data_map), "GoOnCover_Endorsement function is having issue(S) . ");
						customAssert.assertTrue(common.funcSearchPolicy(common.NB_excel_data_map), "Policy Search function is having issue(S) . ");
						if(TestBase.product.equals("SPI")){
							customAssert.assertTrue(common.funcVerifyPolicyStatus(common.NB_excel_data_map,code,event,"Endorsement On Cover (Unconfirmed)"), "Verify Policy Status (Endorsement On Cover  (Unconfirmed)) function is having issue(S) . ");
							customAssert.assertTrue(common_SPI.func_Confirm_Policy(), "Error while changing SPI policy Status from Unconfirmed to Confirmed . ");
							customAssert.assertTrue(common.funcVerifyPolicyStatus(common.NB_excel_data_map,code,event,(String)map_data.get("MTA_Status")), "Verify Policy Status (Endorsement On Cover) function is having issue(S) . ");
						}else{
							customAssert.assertTrue(common.funcVerifyPolicyStatus(common.NB_excel_data_map,code,event,(String)map_data.get("MTA_Status")), "Verify Policy Status (Endorsement On Cover) function is having issue(S) . ");
						}
						if(!CommonFunction_VELA.product.equalsIgnoreCase("XOE")){
							customAssert.assertTrue(funcPDFdocumentVerification("Documents"), "Error in PDF Verification (Documents)(Endorsement On Cover) function is having issue(S) . ");
						}
						customAssert.assertTrue(common_VELA.transactionSummary((String)common.MTA_excel_data_map.get("Automation Key"), "", code, event), "MTA Transaction Summary function is having issue(S) . ");
						TestUtil.reportStatus("Current Flow is restricted to <b>[  "+(String)map_data.get("MTA_Status")+"  ]</b> status. ", "Info", true);
						break;
						
					case "Endorsement Declined":
						customAssert.assertTrue(common.funcVerifyPolicyStatus(common.NB_excel_data_map,code,event,"Endorsement Submitted"), "Verify Policy Status (Endorsement Submitted) function is having issue(S) . ");
						//This will store quote number.
						quoteNumber = k.getText("Quote_Number");
						common.MTA_excel_data_map.put(common.currentRunningFlow+"_QuoteNumber", quoteNumber);
						/////////////////////////////////////////////////////////////
						if(TestBase.product.equals("SPI") || TestBase.product.equals("COB")|| TestBase.product.equals("COA") || TestBase.product.equals("XOC")|| TestBase.product.equals("XOQ")){
							customAssert.assertTrue(common.funcButtonSelection("Assign Underwriter"),"Unable to Click on Assign Underwriter button . ");
							customAssert.assertTrue(common_SPI.funcAssignPolicyToUW(), "Error while assigning Policy to Underwriter.");
						}
						Assert.assertTrue(common.funcDecline(common.NB_excel_data_map));
						customAssert.assertTrue(common.funcSearchPolicy(common.NB_excel_data_map), "Policy Search function is having issue(S) . ");
						customAssert.assertTrue(common.funcVerifyPolicyStatus(common.NB_excel_data_map,code,event,"On Cover"), "Verify Policy Status (On Cover) function is having issue(S) . ");
						//funcVerifyDeclineNTUstatus
						//customAssert.assertTrue(common.funcVerifyDeclineNTUstatus(common.NB_excel_data_map), "Verify Policy Status (Decline Page) function is having issue(S) . ");
					
						TestUtil.reportStatus("Current Flow is restricted to <b>[  "+(String)map_data.get("MTA_Status")+"  ]</b> status. ", "Info", true);
						break;
						
					case "Endorsement NTU":
						customAssert.assertTrue(common.funcVerifyPolicyStatus(common.NB_excel_data_map,code,event,"Endorsement Submitted"), "Verify Policy Status (Endorsement Submitted) function is having issue(S) . ");
						//This will store quote number.
						quoteNumber = k.getText("Quote_Number");
						common.MTA_excel_data_map.put(common.currentRunningFlow+"_QuoteNumber", quoteNumber);
						/////////////////////////////////////////////////////////////
						if(TestBase.product.equals("SPI") || TestBase.product.equals("COB") || TestBase.product.equals("CCF")|| TestBase.product.equals("COA")||TestBase.product.equals("XOQ")||TestBase.product.equals("XOC")){
							customAssert.assertTrue(common.funcButtonSelection("Assign Underwriter"),"Unable to Click on Assign Underwriter button . ");
							customAssert.assertTrue(common_SPI.funcAssignPolicyToUW(), "Error while assigning Policy to Underwriter.");
						}
						Assert.assertTrue(common.funcQuoteCheck(common.NB_excel_data_map));
						//This will get UK date after putting policy on Quoted status.
						quoteDate = common.getUKDate();
						common.NB_excel_data_map.put("QuoteDate", quoteDate);
						/////////////////////////////////////////////////////////////
						customAssert.assertTrue(common.funcSearchPolicy(common.NB_excel_data_map), "Policy Search function is having issue(S) . ");
						customAssert.assertTrue(common.funcVerifyPolicyStatus(common.NB_excel_data_map,code,event,"Endorsement Quoted"), "Verify Policy Status (Endorsement Quoted) function is having issue(S) . ");
						if(!CommonFunction_VELA.product.equalsIgnoreCase("XOE")){
							customAssert.assertTrue(funcPDFdocumentVerification("Draft Documents"), "Error in PDF Verification (Draft Documents) function is having issue(S) . ");
						}
						Assert.assertTrue(common.funcNTU(common.NB_excel_data_map));
						
						customAssert.assertTrue(common.funcSearchPolicy(common.NB_excel_data_map), "Policy Search function is having issue(S) . ");
						customAssert.assertTrue(common.funcVerifyPolicyStatus(common.NB_excel_data_map,code,event,"On Cover"), "Verify Policy Status (On Cover) function is having issue(S) . ");
						//customAssert.assertTrue(common.funcVerifyNTUstatus(common.NB_excel_data_map), "Verify Policy Status (NTU Page) function is having issue(S) . ");
								TestUtil.reportStatus("Current Flow is restricted to <b>[  "+(String)map_data.get("MTA_Status")+"  ]</b> status. ", "Info", true);
						break;
						
					case "Endorsement Rewind":
						customAssert.assertTrue(common.funcVerifyPolicyStatus(common.NB_excel_data_map,code,event,"Endorsement Submitted"), "Verify Policy Status (Endorsement Submitted) function is having issue(S) . ");
						//This will store quote number.
						quoteNumber = k.getText("Quote_Number");
						common.MTA_excel_data_map.put(common.currentRunningFlow+"_QuoteNumber", quoteNumber);
						/////////////////////////////////////////////////////////////
						if(TestBase.product.equals("SPI")||TestBase.product.equals("CCF") || TestBase.product.equals("COB")|| TestBase.product.equals("COA")
								|| TestBase.product.equals("XOC")||TestBase.product.equals("XOQ")){
							customAssert.assertTrue(common.funcButtonSelection("Assign Underwriter"),"Unable to Click on Assign Underwriter button . ");
							customAssert.assertTrue(common_SPI.funcAssignPolicyToUW(), "Error while assigning Policy to Underwriter.");
						}
						Assert.assertTrue(common.funcQuoteCheck(common.NB_excel_data_map));
						//This will get UK date after putting policy on Quoted status.
						quoteDate = common.getUKDate();
						common.NB_excel_data_map.put("QuoteDate", quoteDate);
						/////////////////////////////////////////////////////////////
						customAssert.assertTrue(common.funcSearchPolicy(common.NB_excel_data_map), "Policy Search function is having issue(S) . ");
						customAssert.assertTrue(common.funcVerifyPolicyStatus(common.NB_excel_data_map,code,event,"Endorsement Quoted"), "Verify Policy Status (Endorsement Quoted) function is having issue(S) . ");
						if(!CommonFunction_VELA.product.equalsIgnoreCase("XOE")){
							customAssert.assertTrue(funcPDFdocumentVerification("Draft Documents"), "Error in PDF Verification (Draft Documents) function is having issue(S) . ");
						}
						customAssert.assertTrue(common.funcGoOnCover_Endorsement(common.NB_excel_data_map), "GoOnCover_Endorsement function is having issue(S) . ");
						customAssert.assertTrue(common.funcSearchPolicy(common.NB_excel_data_map), "Policy Search function is having issue(S) . ");
						if(TestBase.product.equals("SPI")){
							customAssert.assertTrue(common.funcVerifyPolicyStatus(common.NB_excel_data_map,code,event,"Endorsement On Cover (Unconfirmed)"), "Verify Policy Status (Endorsement On Cover  (Unconfirmed)) function is having issue(S) . ");
							customAssert.assertTrue(common_SPI.func_Confirm_Policy(), "Error while changing SPI policy Status from Unconfirmed to Confirmed . ");
							customAssert.assertTrue(common.funcVerifyPolicyStatus(common.NB_excel_data_map,code,event,(String)map_data.get("MTA_Status")), "Verify Policy Status (Endorsement On Cover) function is having issue(S) . ");
						}else{
							customAssert.assertTrue(common.funcVerifyPolicyStatus(common.NB_excel_data_map,code,event,"Endorsement On Cover"), "Verify Policy Status (Endorsement On Cover) function is having issue(S) . ");
						}
						if(!CommonFunction_VELA.product.equalsIgnoreCase("XOE")){
							customAssert.assertTrue(funcPDFdocumentVerification("Documents"), "Error in PDF Verification (Documents)(Endorsement On Cover) function is having issue(S) . ");
						}
						customAssert.assertTrue(common_VELA.transactionSummary((String)common.MTA_excel_data_map.get("Automation Key"), "", code, event), "MTA Transaction Summary function is having issue(S) . ");
						
       						if(TestBase.product.equalsIgnoreCase("COA")){
							common.Rewind_excel_data_map = new HashMap<>();
							common.Rewind_Structure_of_InnerPagesMaps = new HashMap<>();
							Events_Suite_TC_Xls = new XLS_Reader(workDir + "\\src\\com\\selenium\\database\\xls", "COA_Rewind.xlsx");
							common.Rewind_excel_data_map = TestUtil.getTestDataSetMap_Column(Events_Suite_TC_Xls, "COA_Rewind_01");
							common.Rewind_Structure_of_InnerPagesMaps = testUtil.populateInnerPagesDataStructures(common.Rewind_excel_data_map,
									Events_Suite_TC_Xls);
						
							common_COA.RewindFlow(code, "Rewind");
						}else if(TestBase.product.equalsIgnoreCase("COB")){
						
							common.Rewind_excel_data_map = new HashMap<>();
							common.Rewind_Structure_of_InnerPagesMaps = new HashMap<>();
							Events_Suite_TC_Xls = new XLS_Reader(workDir + "\\src\\com\\selenium\\database\\xls", "COB_Rewind.xlsx");
							common.Rewind_excel_data_map = TestUtil.getTestDataSetMap_Column(Events_Suite_TC_Xls, "COB_Rewind_02");
							common.Rewind_Structure_of_InnerPagesMaps = testUtil.populateInnerPagesDataStructures(common.Rewind_excel_data_map,
									Events_Suite_TC_Xls);
						
							common_COB.RewindFlow(code, "Rewind");
						}else if(TestBase.product.equalsIgnoreCase("XOC")){
						
							common.Rewind_excel_data_map = new HashMap<>();
							common.Rewind_Structure_of_InnerPagesMaps = new HashMap<>();
							Events_Suite_TC_Xls = new XLS_Reader(workDir + "\\src\\com\\selenium\\database\\xls", "XOC_Rewind.xlsx");
							common.Rewind_excel_data_map = TestUtil.getTestDataSetMap_Column(Events_Suite_TC_Xls, "XOC_Rewind_02");
							common.Rewind_Structure_of_InnerPagesMaps = testUtil.populateInnerPagesDataStructures(common.Rewind_excel_data_map,
									Events_Suite_TC_Xls);
						
							common_XOC.RewindFlow(code, "Rewind");
						}
						else if(TestBase.product.equalsIgnoreCase("XOQ")){
							
							common.Rewind_excel_data_map = new HashMap<>();
							common.Rewind_Structure_of_InnerPagesMaps = new HashMap<>();
							Events_Suite_TC_Xls = new XLS_Reader(workDir + "\\src\\com\\selenium\\database\\xls", "XOQ_Rewind.xlsx");
							common.Rewind_excel_data_map = TestUtil.getTestDataSetMap_Column(Events_Suite_TC_Xls, "XOQ_Rewind_02");
							common.Rewind_Structure_of_InnerPagesMaps = testUtil.populateInnerPagesDataStructures(common.Rewind_excel_data_map,
									Events_Suite_TC_Xls);
						
							common_XOQ.RewindFlow(code, "Rewind");
						}
						customAssert.assertTrue(common.funcMenuSelection("Policies", ""));
						customAssert.assertTrue(common.funcSearchPolicy(common.NB_excel_data_map), "Policy Search function is having issue(S) . ");
						customAssert.assertTrue(common.funcVerifyPolicyStatus(common.NB_excel_data_map,code,event,"Endorsement Submitted (Rewind)"), "Verify Policy Status (Endorsement Submitted (Rewind)) function is having issue(S) . ");
						customAssert.assertTrue(common.funcMenuSelection("Navigate", "Premium Summary"), "Navigation problem to Premium Summary page .");
						//This will store quote number.
						quoteNumber = k.getText("Quote_Number");
						common.Rewind_excel_data_map.put(common.currentRunningFlow+"_QuoteNumber", quoteNumber);
						/////////////////////////////////////////////////////////////
						//This will store quote number.
						policyNumber = k.getText("Header_Policy_Number");
						common.Rewind_excel_data_map.put(common.currentRunningFlow+"_PolicyNumber", policyNumber);
						/////////////////////////////////////////////////////////////
						customAssert.assertTrue(common.funcButtonSelection("Put Rewind On Cover"));
						customAssert.assertTrue(common.funcSearchPolicy(common.NB_excel_data_map), "Policy Search function is having issue(S) . ");
						customAssert.assertTrue(common.funcVerifyPolicyStatus(common.NB_excel_data_map,code,event,"Endorsement On Cover"), "Verify Policy Status (Endorsement On Cover) function is having issue(S) . ");
						customAssert.assertTrue(common_VELA.funcPDFdocumentVerification("Documents"), "Document verification function is having issue(S) . ");
						customAssert.assertTrue(common_VELA.transactionSummary((String)common.MTA_excel_data_map.get("Automation Key"), "", CommonFunction_VELA.product,CommonFunction_VELA.businessEvent), "Transaction Summary function is having issue(S) after Rewind  . ");
						
						TestUtil.reportStatus("Current Flow is restricted to <b>[  "+(String)map_data.get("MTA_Status")+"  ]</b> status. ", "Info", true);
						
						break;
						
					case "Endorsement Discard":
						customAssert.assertTrue(common.funcVerifyPolicyStatus(common.NB_excel_data_map,code,event,"Endorsement Submitted"), "Verify Policy Status (Endorsement Submitted) function is having issue(S) . ");
						//This will store quote number.
						quoteNumber = k.getText("Quote_Number");
						common.MTA_excel_data_map.put(common.currentRunningFlow+"_QuoteNumber", quoteNumber);
						/////////////////////////////////////////////////////////////
						if(TestBase.product.equals("SPI") || TestBase.product.equals("CCF")){
							customAssert.assertTrue(common.funcButtonSelection("Assign Underwriter"),"Unable to Click on Assign Underwriter button . ");
							customAssert.assertTrue(common_SPI.funcAssignPolicyToUW(), "Error while assigning Policy to Underwriter.");
						}
						
						Assert.assertTrue(common.funcDiscardMTA(common.MTA_excel_data_map));
						
						customAssert.assertTrue(common.funcSearchPolicy(common.NB_excel_data_map), "Policy Search function is having issue(S) . ");
						customAssert.assertTrue(common.funcVerifyPolicyStatus(common.NB_excel_data_map,code,event,"On Cover"), "Verify Policy Status (On Cover) function is having issue(S) . ");
					
						
						TestUtil.reportStatus("Current Flow is restricted to <b>[  "+(String)map_data.get("MTA_Status")+"  ]</b> status. ", "Info", true);
						break;
					case "Reinstate":
						customAssert.assertTrue(common.funcSearchPolicy(common.NB_excel_data_map), "Policy Search function is having issue(S) . ");
						customAssert.assertTrue(common.funcVerifyPolicyStatus(common.CAN_excel_data_map,code,event,"Cancelled"), "Verify Policy Status (Cancelled) function is having issue(S) . ");
						customAssert.assertTrue(common_VELA.transactionSummary((String)common.CAN_excel_data_map.get("Automation Key"), "", code, event), "Transaction Summary function is having issue(S) . ");
						// Reinstate Function
						customAssert.assertTrue(common.ReinstatePolicy(common.NB_excel_data_map));
						// Cancellation CODE will appear over here...
						
						TestUtil.reportStatus("Current Flow is for <b> 'Reinstate' the Cancelled policy", "Info", true);
						break;
					case "Renewal On Cover":
						customAssert.assertTrue(common.funcVerifyPolicyStatus_Renewal(common.Renewal_excel_data_map,code,event,"Renewal Submitted"), "Verify Policy Status (Submitted) function is having issue(S) . ");
						Assert.assertTrue(common_VELA.funcQuoteCheck(common.Renewal_excel_data_map));
						//This will get UK date after putting policy on Quoted status.
						quoteDate = common.getUKDate();
						common.Renewal_excel_data_map.put("QuoteDate", quoteDate);
						/////////////////////////////////////////////////////////////
						customAssert.assertTrue(common.funcSearchPolicy_Renewal(common.Renewal_excel_data_map), "Policy Search function is having issue(S) . ");
						customAssert.assertTrue(common.funcVerifyPolicyStatus_Renewal(common.Renewal_excel_data_map,code,event,"Renewal Quoted"), "Verify Policy Status (Quoted) function is having issue(S) . ");
						customAssert.assertTrue(funcPDFdocumentVerification("Draft Documents"), "Verify Policy Status (On Cover) function is having issue(S) . ");
						customAssert.assertTrue(common.funcGoOnCover(common.Renewal_excel_data_map), "Go On Cover function is having issue(S) . ");
						customAssert.assertTrue(common.funcSearchPolicy_Renewal(common.Renewal_excel_data_map), "Policy Search function is having issue(S) . ");
						customAssert.assertTrue(common.funcVerifyPolicyStatus_Renewal(common.Renewal_excel_data_map,code,event,"Renewal On Cover"), "Verify Policy Status (On Cover) function is having issue(S) . ");
						customAssert.assertTrue(funcPDFdocumentVerification("Documents"), "Verify Policy Status (On Cover) function is having issue(S) . ");
						customAssert.assertTrue(common_VELA.transactionSummary((String)common.Renewal_excel_data_map.get("Automation Key"), "", code, event), "Transaction Summary function is having issue(S) . ");
						TestUtil.reportStatus("Current Flow is restricted to <b>[  "+(String)map_data.get("Renewal_Status")+"  ]</b> status. ", "Info", true);
						break;
					case "Renewal NTU":
						//Not Taken Up
						customAssert.assertTrue(common.funcVerifyPolicyStatus_Renewal(common.Renewal_excel_data_map,code,event,"Renewal Submitted"), "Verify Policy Status (Submitted) function is having issue(S) . ");
						Assert.assertTrue(common_VELA.funcQuoteCheck(common.Renewal_excel_data_map));
						//This will get UK date after putting policy on Quoted status.
						quoteDate = common.getUKDate();
						common.Renewal_excel_data_map.put("QuoteDate", quoteDate);
						/////////////////////////////////////////////////////////////
						customAssert.assertTrue(common.funcSearchPolicy_Renewal(common.Renewal_excel_data_map), "Policy Search function is having issue(S) . ");
						customAssert.assertTrue(common.funcVerifyPolicyStatus_Renewal(common.Renewal_excel_data_map,code,event,"Renewal Quoted"), "Verify Policy Status (Quoted) function is having issue(S) . ");
						customAssert.assertTrue(funcPDFdocumentVerification("Draft Documents"), "Verify Policy Status (On Cover) function is having issue(S) . ");
						Assert.assertTrue(common.funcNTU(common.Renewal_excel_data_map));
						customAssert.assertTrue(common.funcSearchPolicy_Renewal(common.Renewal_excel_data_map), "Policy Search function is having issue(S) . ");
						customAssert.assertTrue(common.funcVerifyPolicyStatus_Renewal(common.Renewal_excel_data_map,code,event,"Renewal NTU"), "Verify Policy Status (NTU) function is having issue(S) . ");
						customAssert.assertTrue(common.funcVerifyNTUstatus(common.Renewal_excel_data_map), "Verify Policy Status (NTU Page) function is having issue(S) . ");
						TestUtil.reportStatus("Current Flow is restricted to <b>[  "+(String)map_data.get("Renewal_Status")+"  ]</b> status. ", "Info", true);
						break;
					case "Renewal Declined":
						customAssert.assertTrue(common.funcVerifyPolicyStatus_Renewal(common.Renewal_excel_data_map,code,event,"Renewal Submitted"), "Verify Policy Status (Submitted) function is having issue(S) . ");
						Assert.assertTrue(common.funcDecline(common.Renewal_excel_data_map));
						customAssert.assertTrue(common.funcSearchPolicy_Renewal(common.Renewal_excel_data_map), "Policy Search function is having issue(S) . ");
						customAssert.assertTrue(common.funcVerifyPolicyStatus_Renewal(common.Renewal_excel_data_map,code,event,"Renewal Declined"), "Verify Policy Status (Declined) function is having issue(S) . ");
						//funcVerifyDeclineNTUstatus
						customAssert.assertTrue(common.funcVerifyDeclineNTUstatus(common.Renewal_excel_data_map), "Verify Policy Status (Decline Page) function is having issue(S) . ");
						break;
					case "Renewal Rewind":
						customAssert.assertTrue(common.funcVerifyPolicyStatus_Renewal(common.Renewal_excel_data_map,code,event,"Renewal Submitted"), "Verify Policy Status (Submitted) function is having issue(S) . ");
						Assert.assertTrue(common_VELA.funcQuoteCheck(common.Renewal_excel_data_map));
						//This will get UK date after putting policy on Quoted status.
						quoteDate = common.getUKDate();
						common.Renewal_excel_data_map.put("QuoteDate", quoteDate);
						/////////////////////////////////////////////////////////////
						customAssert.assertTrue(common.funcSearchPolicy_Renewal(common.Renewal_excel_data_map), "Policy Search function is having issue(S) . ");
						customAssert.assertTrue(common.funcVerifyPolicyStatus_Renewal(common.Renewal_excel_data_map,code,event,"Renewal Quoted"), "Verify Policy Status (Quoted) function is having issue(S) . ");
						customAssert.assertTrue(funcPDFdocumentVerification("Draft Documents"), "Verify Policy Status (On Cover) function is having issue(S) . ");
						customAssert.assertTrue(common.funcGoOnCover(common.Renewal_excel_data_map), "Go On Cover function is having issue(S) . ");
						customAssert.assertTrue(common.funcSearchPolicy_Renewal(common.Renewal_excel_data_map), "Policy Search function is having issue(S) . ");
						customAssert.assertTrue(common.funcVerifyPolicyStatus_Renewal(common.Renewal_excel_data_map,code,event,"Renewal On Cover"), "Verify Policy Status (On Cover) function is having issue(S) . ");
						customAssert.assertTrue(funcPDFdocumentVerification("Documents"), "Verify Policy Status (On Cover) function is having issue(S) . ");
						customAssert.assertTrue(common_VELA.transactionSummary((String)common.Renewal_excel_data_map.get("Automation Key"), "", code, event), "Transaction Summary function is having issue(S) . ");
					
						
						if(TestBase.product.equalsIgnoreCase("XOC")){
							common.Rewind_excel_data_map = new HashMap<>();
							common.Rewind_Structure_of_InnerPagesMaps = new HashMap<>();
							Events_Suite_TC_Xls = new XLS_Reader(workDir + "\\src\\com\\selenium\\database\\xls", "XOC_Rewind.xlsx");
							common.Rewind_excel_data_map = TestUtil.getTestDataSetMap_Column(Events_Suite_TC_Xls, "XOC_Rewind_03");
							common.Rewind_Structure_of_InnerPagesMaps = testUtil.populateInnerPagesDataStructures(common.Rewind_excel_data_map,
									Events_Suite_TC_Xls);
							
							common_XOC.RenewalRewindFlow(code, "Rewind");
						}else if(TestBase.product.equalsIgnoreCase("XOQ")){
							common.Rewind_excel_data_map = new HashMap<>();
							common.Rewind_Structure_of_InnerPagesMaps = new HashMap<>();
							Events_Suite_TC_Xls = new XLS_Reader(workDir + "\\src\\com\\selenium\\database\\xls", "XOQ_Rewind.xlsx");
							common.Rewind_excel_data_map = TestUtil.getTestDataSetMap_Column(Events_Suite_TC_Xls, "XOQ_Rewind_01");
							common.Rewind_Structure_of_InnerPagesMaps = testUtil.populateInnerPagesDataStructures(common.Rewind_excel_data_map,
									Events_Suite_TC_Xls);
							
							common_XOQ.RenewalRewindFlow(code, "Rewind");
						}else if(TestBase.product.equalsIgnoreCase("COA")){
							common.Rewind_excel_data_map = new HashMap<>();
							common.Rewind_Structure_of_InnerPagesMaps = new HashMap<>();
							Events_Suite_TC_Xls = new XLS_Reader(workDir + "\\src\\com\\selenium\\database\\xls", "COA_Rewind.xlsx");
							common.Rewind_excel_data_map = TestUtil.getTestDataSetMap_Column(Events_Suite_TC_Xls, "COA_Rewind_01");
							common.Rewind_Structure_of_InnerPagesMaps = testUtil.populateInnerPagesDataStructures(common.Rewind_excel_data_map,
									Events_Suite_TC_Xls);
							
							common_COA.RenewalRewindFlow(code, "Rewind");
						}
						
						customAssert.assertTrue(common.funcMenuSelection("Policies", ""));
						customAssert.assertTrue(common.funcSearchPolicy_Renewal(common.Renewal_excel_data_map), "Policy Search function is having issue(S) . ");
						customAssert.assertTrue(common.funcVerifyPolicyStatus_Renewal(common.Rewind_excel_data_map,code,event,"Renewal Submitted (Rewind)"), "Verify Policy Status (Submitted (Rewind)) function is having issue(S) . ");
						customAssert.assertTrue(common.funcMenuSelection("Navigate","Premium Summary"),"Issue while Navigating to Premium Summary screen . ");
						//This will store quote number.
						quoteNumber = k.getText("Quote_Number");
						common.Rewind_excel_data_map.put(common.currentRunningFlow+"_QuoteNumber", quoteNumber);
						/////////////////////////////////////////////////////////////
						//This will store quote number.
						policyNumber = k.getText("Header_Policy_Number");
						common.Rewind_excel_data_map.put(common.currentRunningFlow+"_PolicyNumber", policyNumber);
						/////////////////////////////////////////////////////////////
						
						customAssert.assertTrue(common.funcButtonSelection("Put Rewind On Cover"));
						customAssert.assertTrue(common.funcSearchPolicy_Renewal(common.Renewal_excel_data_map), "Policy Search function is having issue(S) . ");
						customAssert.assertTrue(common.funcVerifyPolicyStatus_Renewal(common.Rewind_excel_data_map,CommonFunction.product,CommonFunction.businessEvent,"Renewal On Cover"), "Verify Policy Status (Submitted (Rewind)) function is having issue(S) . ");
						customAssert.assertTrue(funcPDFdocumentVerification("Documents"), "Document verification function is having issue(S) . ");
						customAssert.assertTrue(common_VELA.transactionSummary((String)common.Renewal_excel_data_map.get("Automation Key"), "", code, event), "Transaction Summary function is having issue(S) . ");
						
						TestUtil.reportStatus("Current Flow is restricted to <b>[  "+(String)map_data.get("Renewal_Status")+"  ]</b> status. ", "Info", true);
						break;
					case "Renewal Endorsment On Cover":
						customAssert.assertTrue(common.funcVerifyPolicyStatus_Renewal(common.Renewal_excel_data_map,code,event,"Renewal Submitted"), "Verify Policy Status (Submitted) function is having issue(S) . ");
						Assert.assertTrue(common_VELA.funcQuoteCheck(common.Renewal_excel_data_map));
						//This will get UK date after putting policy on Quoted status.
						quoteDate = common.getUKDate();
						common.Renewal_excel_data_map.put("QuoteDate", quoteDate);
						/////////////////////////////////////////////////////////////
						customAssert.assertTrue(common.funcSearchPolicy_Renewal(common.Renewal_excel_data_map), "Policy Search function is having issue(S) . ");
						customAssert.assertTrue(common.funcVerifyPolicyStatus_Renewal(common.Renewal_excel_data_map,code,event,"Renewal Quoted"), "Verify Policy Status (Quoted) function is having issue(S) . ");
						customAssert.assertTrue(funcPDFdocumentVerification("Draft Documents"), "Verify Policy Status (On Cover) function is having issue(S) . ");
						customAssert.assertTrue(common.funcGoOnCover(common.Renewal_excel_data_map), "Go On Cover function is having issue(S) . ");
						customAssert.assertTrue(common.funcSearchPolicy_Renewal(common.Renewal_excel_data_map), "Policy Search function is having issue(S) . ");
						customAssert.assertTrue(common.funcVerifyPolicyStatus_Renewal(common.Renewal_excel_data_map,code,event,"Renewal On Cover"), "Verify Policy Status (On Cover) function is having issue(S) . ");
						//customAssert.assertTrue(funcPDFdocumentVerification("Documents"), "Verify Policy Status (On Cover) function is having issue(S) . ");
						customAssert.assertTrue(common_VELA.transactionSummary((String)common.Renewal_excel_data_map.get("Automation Key"), "", code, event), "Transaction Summary function is having issue(S) . ");
						common.transaction_Details_Premium_Values.clear();
						if(TestBase.product.equalsIgnoreCase("XOC")){
							common.MTA_excel_data_map = new HashMap<>();
							common.MTA_Structure_of_InnerPagesMaps = new HashMap<>();
							Events_Suite_TC_Xls = new XLS_Reader(workDir + "\\src\\com\\selenium\\database\\xls", "XOC_MTA.xlsx");
							common.MTA_excel_data_map = TestUtil.getTestDataSetMap_Column(Events_Suite_TC_Xls, "XOC_MTA_01");
							common.MTA_Structure_of_InnerPagesMaps = testUtil.populateInnerPagesDataStructures(common.MTA_excel_data_map,
									Events_Suite_TC_Xls);
							
							common_XOC.MTAFlow(code, "MTA");
							
						}else if(TestBase.product.equalsIgnoreCase("XOQ")){
							common.MTA_excel_data_map = new HashMap<>();
							common.MTA_Structure_of_InnerPagesMaps = new HashMap<>();
							Events_Suite_TC_Xls = new XLS_Reader(workDir + "\\src\\com\\selenium\\database\\xls", "XOQ_MTA.xlsx");
							common.MTA_excel_data_map = TestUtil.getTestDataSetMap_Column(Events_Suite_TC_Xls, "XOQ_MTA_01");
							common.MTA_Structure_of_InnerPagesMaps = testUtil.populateInnerPagesDataStructures(common.MTA_excel_data_map,
									Events_Suite_TC_Xls);
							
							common_XOQ.MTAFlow(code, "MTA");
							
						}else if(TestBase.product.equalsIgnoreCase("COA")){
							common.MTA_excel_data_map = new HashMap<>();
							common.MTA_Structure_of_InnerPagesMaps = new HashMap<>();
							Events_Suite_TC_Xls = new XLS_Reader(workDir + "\\src\\com\\selenium\\database\\xls", "COA_MTA.xlsx");
							common.MTA_excel_data_map = TestUtil.getTestDataSetMap_Column(Events_Suite_TC_Xls, "COA_MTA_01");
							common.MTA_Structure_of_InnerPagesMaps = testUtil.populateInnerPagesDataStructures(common.MTA_excel_data_map,
									Events_Suite_TC_Xls);
							
							common_COA.MTAFlow(code, "MTA");
							
						}						
						customAssert.assertTrue(common.funcVerifyPolicyStatus_Renewal(common.Renewal_excel_data_map,code,event,"Endorsement Submitted"), "Verify Policy Status (Endorsement Submitted) function is having issue(S) . ");
						customAssert.assertTrue(common.funcButtonSelection("Assign Underwriter"),"Unable to Click on Assign Underwriter button . ");
						customAssert.assertTrue(common_SPI.funcAssignPolicyToUW(), "Error while assigning Policy to Underwriter.");
					
						Assert.assertTrue(common_VELA.funcQuoteCheck(common.Renewal_excel_data_map));
						//This will get UK date after putting policy on Quoted status.
						quoteDate = common.getUKDate();
						common.MTA_excel_data_map.put("QuoteDate", quoteDate);
						/////////////////////////////////////////////////////////////
						customAssert.assertTrue(common.funcSearchPolicy_Renewal(common.Renewal_excel_data_map), "Policy Search function is having issue(S) . ");
						customAssert.assertTrue(common.funcVerifyPolicyStatus_Renewal(common.Renewal_excel_data_map,code,event,"Endorsement Quoted"), "Verify Policy Status (Endorsement Quoted) function is having issue(S) . ");
						//This will store quote number.
						quoteNumber = k.getText("Quote_Number");
						common.MTA_excel_data_map.put(common.currentRunningFlow+"_QuoteNumber", quoteNumber);
						/////////////////////////////////////////////////////////////
						//This will store quote number.
						policyNumber = k.getText("Header_Policy_Number");
						common.MTA_excel_data_map.put(common.currentRunningFlow+"_PolicyNumber", policyNumber);
						/////////////////////////////////////////////////////////////
						
						customAssert.assertTrue(funcPDFdocumentVerification("Draft Documents"), "Error in PDF Verification (Draft Documents) function is having issue(S) . ");
						
						customAssert.assertTrue(common.funcGoOnCover_Endorsement(common.Renewal_excel_data_map), "GoOnCover_Endorsement function is having issue(S) . ");
						customAssert.assertTrue(common.funcSearchPolicy_Renewal(common.Renewal_excel_data_map), "Policy Search function is having issue(S) . ");
						customAssert.assertTrue(common.funcVerifyPolicyStatus_Renewal(common.Renewal_excel_data_map,code,event,"Endorsement On Cover"), "Verify Policy Status (Endorsement On Cover) function is having issue(S) . ");
						
						customAssert.assertTrue(funcPDFdocumentVerification("Documents"), "Error in PDF Verification (Documents)(Endorsement On Cover) function is having issue(S) . ");
						customAssert.assertTrue(common_VELA.transactionSummary((String)common.Renewal_excel_data_map.get("Automation Key"), "", code, event), "Transaction Summary function is having issue(S) . ");
						
						TestUtil.reportStatus("Current Flow is restricted to <b>[  "+(String)map_data.get("Renewal_Status")+"  ]</b> status. ", "Info", true);
						
						break;
					default:
						break;
					}
				}catch(Throwable t){
					ret_value = false;
					quoteStatus = "";
				}
				
				return ret_value;
			}
	 
	     public boolean funcQuoteCheck(Map<Object, Object> map_data){
				
			 boolean retvalue = true;
			 int counter = 0;
				try {     
					
					customAssert.assertTrue(k.Click("Quote_btn"),"Unable to click on Quote button.");
					
					switch (CommonFunction_VELA.product) {
					
					case "COA":
					case "COB":
						customAssert.assertTrue(common.funcPageNavigation("Quote Check",""), "Quote Check page does not open . ");
						//customAssert.assertTrue(func_Verify_Referral_Rules(), "Error while verifying referral rules on Quote check screen . ");
						
						
						break;
						
					case "LEA":
						customAssert.assertTrue(common.funcPageNavigation("Quote Check",""), "Quote Check page does not open . ");
						//customAssert.assertTrue(func_Verify_Referral_Rules(), "Error while verifying referral rules on Quote check screen . ");
						//customAssert.assertTrue(func_Verify_Validation_Rules(), "Error while verifying referral validations on Quote check screen . ");
						
					case "POF":
						customAssert.assertTrue(common.funcPageNavigation("Quote Check",""), "Quote Check page does not open . ");
						customAssert.assertTrue(common_Zennor.func_Verify_Referral_Rules(), "Error while verifying referral rules on Quote check screen . ");
							
						
						break;
				
						
					default:
						break;
					}
					
					if(TestBase.product.equalsIgnoreCase("CCD")){
						//customAssert.assertTrue(common_HHAZ.func_Verify_Referral_Rules(),"Error while Verifying Referral Rules . ");
					}
					
					if(counter==0){
						if(CommonFunction_VELA.product.equalsIgnoreCase("XOE")){
							
							String pageHeader = driver.findElement(By.xpath("html/body/div[3]/form/div/p")).getText();
							
							if(!pageHeader.equalsIgnoreCase("Search Policies")){
								if(((String)map_data.get("CD_Terrorism")).equalsIgnoreCase("Yes")){
									customAssert.assertTrue(k.Click("XOE_IgnoreButon"),"Unable to click on Ignore button.");
								}
							}
							
						}else{
							if(k.isDisplayedWithoutError("Quote_proceed_btn"))
								customAssert.assertTrue(k.Click("Quote_proceed_btn"),"Unable to click on Proceed button.");
						}
						TestUtil.reportStatus("Quote Check details filled successfully . ", "Info", true);
						return retvalue;
					}else{
						return false;
					}
					
				} catch(Throwable t) {
					return false;
				}
			}
	 
	 /**
		 * 
	   	 * This method is for to Search Policy and select that searched Policy .
	  	 */
		public boolean funcSearchPolicy(Map<Object, Object> map_data)
		{
			boolean ret_value = true;
			String cl_name = (String)map_data.get("NB_ClientName");
			try{
				customAssert.assertTrue(k.getText("searchPoliciesPage_Header").equalsIgnoreCase("Search Policies"), "Search policies Page is not loaded . ");
				customAssert.assertTrue(k.Click("comm_clear"),"Unable to Clear Search Policies Filter Data .");
				customAssert.assertTrue(k.Input("Policy_Number_txtBox", (String)map_data.get("NB_QuoteNumber")), "Unable to enter policy number.");
				customAssert.assertTrue(k.Click("comm_search"), "Unable to click on search button.");
				customAssert.assertTrue(k.getText("Policy_Client_Name").contains(cl_name),"Policy Client Name issue after searching policy . ");
				//customAssert.assertTrue(cl_name.equalsIgnoreCase(k.getText("Policy_Client_Name")),"Policy Client Name issue after searching policy . ");
				TestUtil.reportStatus("Policy: "+(String)map_data.get("NB_QuoteNumber")+" successfully searched . ", "Info", true);
				
				k.pressDownKeyonPage();
				customAssert.assertTrue(k.Click("Policy_Client_Name"), "Unable to click on client name . ");
			}catch(Throwable t)
			{
				String methodName = new Object(){}.getClass().getEnclosingMethod().getName();
	            TestUtil.reportFunctionFailed("Failed in "+methodName+" function");     
	            k.reportErr("Failed in "+methodName+" function", t);
	            ret_value = false;;
			}
			
			return ret_value;
		}
		
		public boolean funcVerifyPolicyStatus(Map<Object, Object> map_data,String code,String event,String exp_Policy_Status)
		{
			boolean ret_value = true;
			String policy_status_actual=null;
			String testName = (String)map_data.get("Automation Key");
			try{
				
				policy_status_actual = k.getText("Policy_status_header");
				customAssert.assertEquals(policy_status_actual, exp_Policy_Status,"Mismatch in Policy Status - Expected: <b>"+exp_Policy_Status+"</b> Actual: <b>"+policy_status_actual+"</b> on Premium Summary Page . ");
				if(common.currentRunningFlow.equals("NB"))
					customAssert.assertTrue(WriteDataToXl(code+"_"+event, "NB", testName, "NB_CurrentPolicyStatus", exp_Policy_Status,common.NB_excel_data_map),"Error while writing data to excel for field >NB_CurrentPolicyStatus<");
				else if(common.currentRunningFlow.equals("MTA")){
					testName = (String)common.MTA_excel_data_map.get("Automation Key");
					customAssert.assertTrue(WriteDataToXl(code+"_"+common.currentRunningFlow, "MTA", testName, "MTA_CurrentPolicyStatus", exp_Policy_Status,common.MTA_excel_data_map),"Error while writing data to excel for field >MTA_CurrentPolicyStatus<");
				}
				if(exp_Policy_Status.equals("On Cover")){
					String policy_number = k.getText("Header_Policy_Number");
					if(common.currentRunningFlow.equals("MTA")){
						customAssert.assertTrue(WriteDataToXl(code+"_"+event, "MTA", testName, "MTA_PolicyNumber", policy_number,common.MTA_excel_data_map),"Error while writing data to excel for field >MTA_PolicyNumber<");
					}else if(common.currentRunningFlow.equals("NB")){
						customAssert.assertTrue(WriteDataToXl(code+"_"+event, "NB", testName, "NB_PolicyNumber", policy_number,common.NB_excel_data_map),"Error while writing data to excel for field >NB_PolicyNumber<");
					}
					TestUtil.reportStatus("Policy Number :  <b>"+policy_number+"</b> created successfully . ", "Info", true);
				}
				if(exp_Policy_Status.equals("Endorsement On Cover")){
					String policy_number = k.getText("Header_Policy_Number");
					customAssert.assertTrue(WriteDataToXl(code+"_"+common.currentRunningFlow, "MTA", testName, "MTA_PolicyNumber", policy_number,common.MTA_excel_data_map),"Error while writing data to excel for field >MTA_PolicyNumber<");
					TestUtil.reportStatus("Policy Number :  <b>"+policy_number+"</b> created successfully . ", "Info", true);
				}
				TestUtil.reportStatus("Verified Policy Status as <b>"+exp_Policy_Status+"</b> successfully . ", "Info", true);
				}catch(Throwable t){
				String methodName = new Object(){}.getClass().getEnclosingMethod().getName();
	            TestUtil.reportFunctionFailed("Failed in "+methodName+" function");     
	            k.reportErr("Failed in "+methodName+" function", t);
	            ret_value = false;;
				}
			
			return ret_value;
		}

		public boolean funcGoOnCover(Map<Object, Object> map_data){
			
			 boolean retvalue = true;
				try {   
					customAssert.assertTrue(common.funcPageNavigation("Premium Summary", ""), "Navigation problem to Premium Summary page .");
					customAssert.assertTrue(funcButtonSelection("Go On Cover"), "Unable to click on Go on cover button .");
					customAssert.assertTrue(k.Click("On_cover_accept"), "Unable to Click Go On Cover button on Go On Cover page .");
					return retvalue;

				} catch(Throwable t) {
					String methodName = new Object(){}.getClass().getEnclosingMethod().getName();
					TestUtil.reportFunctionFailed("Failed in "+methodName+" function");
					k.reportErr("Failed in "+methodName+" function", t);
					Assert.fail("Unable to enter details in Go On Cover", t);
					return false;
				}
			}
		

		public boolean funcButtonSelection(String buttonName){
			
			boolean retvalue = true;
			try{
			java.util.List<WebElement> list = driver.findElements(By.xpath("html/body/div[3]/form/div/div[1]/div/a"));
				for(int i=0;i<list.size();i++){
					String name = list.get(i).getText();
					if(name.equalsIgnoreCase(buttonName)){
						list.get(i).click();
						/*if(name.equalsIgnoreCase("Go On Cover")){
							k.waitTwoSeconds();
							customAssert.assertTrue(k.AcceptPopup(), "Unable to accept Go On Cover Pop up .");
						}*/
						break;
						//list = driver.findElements(By.xpath("html/body/div[3]/form/div/div[1]/div/a"));
					}
					
				}
				TestUtil.reportStatus("Clicked on [<b>  "+buttonName+" </b>]  button.", "Info", false);	
			}catch(Throwable t){
				return false;
			}
				return retvalue;
		}
		
public boolean funcPremiumSummaryTable(String code,String event,Map<Object, Object> map_data) throws Exception{
			
			String testName = (String)map_data.get("Automation Key");
			WebDriverWait wait;
			wait = new WebDriverWait(driver, 5);
			Hashtable<String,String> coverlist = new Hashtable<String,String>();
			Hashtable<String,String> premSmryData = new Hashtable<String,String>();
			Hashtable<String,String> transSmryData = new Hashtable<String,String>();
			Hashtable<String,String> cHash = new Hashtable<String,String>();
			boolean transPremFlag =false;
			String[] prem_col = {"gprem","comr","comm","nprem","gipt","nipt"};
			String[] prem_header = {"GrossPremium","CommissionRate","Commission","NetPremium","GrossIPT","NetIPT"};
			//System.out.println(prem_col(0));
			if(CommonFunction_VELA.product.equalsIgnoreCase("POB")|| CommonFunction_VELA.product.equalsIgnoreCase("POC")){
				coverlist.put("Material Damage","md8");
				coverlist.put("Loss Of Rental Income","bi3");
				coverlist.put("Property Owners Liability","pl3");
				coverlist.put("Terrorism","tr3");
			}else if(CommonFunction_VELA.product.equalsIgnoreCase("XOE")){
				coverlist.put("Property Excess of Loss","xo1");
				coverlist.put("Terrorism","tr2");
			}else{
				coverlist.put("Material Damage","md7");
				coverlist.put("Business Interruption","bi2");
				coverlist.put("Terrorism","tr2");
			}
			coverlist.put("Employers Liability","el3");
			coverlist.put("Public Liability","pl2");
			coverlist.put("Products Liability","pr1");
			coverlist.put("Specified All Risks","sar");
			coverlist.put("Contractors All Risks","car");
			coverlist.put("Computers and Electronic Risks","it");
			coverlist.put("Money","mn2");
			coverlist.put("Goods In Transit","gt2");
			coverlist.put("Marine Cargo","mar");
			coverlist.put("Cyber and Data Security","cyb");
			if(code.equalsIgnoreCase("CTA")){
				coverlist.put("Directors and Officers","do_pct");
			}else{
				coverlist.put("Directors and Officers","do2");
				}
			coverlist.put("Frozen Foods","ff2");
			coverlist.put("Loss of Licence","ll2");
			coverlist.put("Fidelity Guarantee","fg");
			coverlist.put("Legal Expenses","lg2");
			coverlist.put("Total","tot");
			
			cHash.put("gprem","GP");
			cHash.put("comr","CR");
			cHash.put("comm","GC");
			cHash.put("nprem","NP");
			cHash.put("gipt","GT");
			cHash.put("nipt","NPIPT");
			cHash.put("com","GC");
			
			if (driver.findElement(By.xpath("//*[@id='main']/form/p")).getText().contains("Premium Summary")==false){
				Assert.fail("Premium summary Page couldn't displayed");
			}
			String stDate = null;
			String endDate =null;
			try{
				k.ImplicitWaitOff();
				stDate = driver.findElement(By.xpath("//*[@name='start_date']")).getAttribute("value");
			}catch(Exception e){
				stDate = driver.findElement(By.xpath("//*[@id='start_date']")).getText() ;//getAttribute("value");
			}
			try{
				k.ImplicitWaitOff();
				endDate = driver.findElement(By.xpath("//*[@name='end_date']")).getAttribute("value");
			}catch(Exception e){
				 endDate = driver.findElement(By.xpath("//*[@id='end_date']")).getText() ;//.getAttribute("value");
			}
			String duration = driver.findElement(By.xpath("//*[@id='duration']")).getText();
			//System.out.println("Policy Start Date " + stDate );
			TestUtil.reportStatus("Policy Start Date " + stDate, "Info", false);
			//System.out.println("Policy End Date " + endDate );
			TestUtil.reportStatus("Policy End Date " + endDate, "Info", false);
			//System.out.println("Policy Duration "+duration);
			TestUtil.reportStatus("Policy Duration "+duration, "Info", false);
			
			List<WebElement> col=driver.findElements(By.xpath("html/body/div[3]/form/div/table[2]/tbody/tr[1]/td"));
			//System.out.println(col.size());
			int cCount = col.size();
			
			List<WebElement> row = driver.findElements(By.xpath("html/body/div[3]/form/div/table[2]/tbody/tr"));
			//System.out.println(row.size());
			int rcount = row.size();
			String Status = driver.findElement(By.xpath("//*[@id='headbox']/tbody/tr[1]/td[6]")).getText();
			//System.out.println("Policy Status - "+ Status); 
			TestUtil.reportStatus("Current Policy Status - "+ Status, "Info", false);
			String tXpath;
			String keyName;
			String CellValue;
			switch(Status){
			
			case "Submitted":  		// Submitted State
				//System.out.println("Covers Found -:"+ (rcount-1));
				customAssert.assertTrue(PremiumSummaryDataTraverse(rcount,coverlist,cHash,code,event,true),"Failed in Premium Summary Calculation");
				customAssert.assertTrue(common.insuranceTaxAdjustmentHandling(code,event),"Insurance tax adjustment is having issue(S).");
				TestUtil.reportStatus("Premium Summary data verification after Insurance Tax Adjustment", "Info", true);
				if(((String)map_data.get("PS_DefaultStartEndDate")).equalsIgnoreCase("No") && ((String)map_data.get("PS_Duration"))!="365"){
					TransactionPremiumTable(rcount,coverlist,cHash,code,event,true);
				}
				customAssert.assertTrue(PremiumSummaryDataTraverse(rcount,coverlist,cHash,code,event,false),"Failed in Premium Summary Calculation after Insurance adjustment");
				
				break;
			case "Submitted (Rewind)":  		
				customAssert.assertTrue(PremiumSummaryDataTraverse(rcount,coverlist,cHash,code,event,true),"Failed in Premium Summary Calculation");
				//if(!(flowName.equalsIgnoreCase("RewindRemoveCover"))){
				customAssert.assertTrue(common.insuranceTaxAdjustmentHandling(code,event),"Insurance tax adjustment is having issue(S).");
				//}
				TestUtil.reportStatus("Premium Summary data verification after Insurance Tax Adjustment", "Info", true);
				customAssert.assertTrue(PremiumSummaryDataTraverse(rcount,coverlist,cHash,code,event,false),"Failed in Premium Summary Calculation after Insurance adjustment");
				
				break;	
			case "Renewal Pending": 
				
				//customAssert.assertTrue(funcGetPremiums(rcount,coverlist,cHash,code,event,true),"Failed in Premium Summary Calculation");
				/*customAssert.assertTrue(common.insuranceTaxAdjustmentHandling(code,event),"Insurance tax adjustment is having issue(S).");
				TestUtil.reportStatus("Premium Summary data verification after Insurance Tax Adjustment", "Info", true);
				customAssert.assertTrue(PremiumSummaryDataTraverse(rcount,coverlist,cHash,code,event,false),"Failed in Premium Summary Calculation after Insurance adjustment");
				*/
				break;	
			case "Renewal Submitted": 
				customAssert.assertTrue(PremiumSummaryDataTraverse(rcount,coverlist,cHash,code,event,true),"Failed in Premium Summary Calculation");
				customAssert.assertTrue(common.insuranceTaxAdjustmentHandling(code,event),"Insurance tax adjustment is having issue(S).");
				TestUtil.reportStatus("Premium Summary data verification after Insurance Tax Adjustment", "Info", true);
				customAssert.assertTrue(PremiumSummaryDataTraverse(rcount,coverlist,cHash,code,event,false),"Failed in Premium Summary Calculation after Insurance adjustment");
				break;
			case "Endorsement Submitted":  		
				customAssert.assertTrue(PremiumSummaryDataTraverseMTA(rcount,coverlist,cHash,code,event,true),"Failed in Premium Summary Calculation");
				//if(!(flowName.equalsIgnoreCase("RewindRemoveCover"))){
				customAssert.assertTrue(common.insuranceTaxAdjustmentHandling(code,event),"Insurance tax adjustment is having issue(S).");
				//}
				TestUtil.reportStatus("Premium Summary data verification after Insurance Tax Adjustment", "Info", true);
				customAssert.assertTrue(PremiumSummaryDataTraverseMTA(rcount,coverlist,cHash,code,event,false),"Failed in Premium Summary Calculation after Insurance adjustment");
				
				break;	
			case "Quoted":  //Quoted State
			
				//System.out.println("Covers Found -:"+ (rcount-1));
				TestUtil.reportStatus("Covers Found -:"+ (rcount-1), "info", true);
				tXpath = "//*[@class='matrix']/tbody/tr";
				for(int i =1;i<=rcount;i++){
					String sectionXpath = tXpath+"["+i+"]/td[1]";
					String sec_name = driver.findElement(By.xpath(sectionXpath)).getText();
					for(int j = 2; j<=cCount;j++){
						String ColumnValues = tXpath+"["+i+"]/td["+j+"]";
						//System.out.print(driver.findElement(By.xpath(ColumnValues)).getText()+"\t");
						CellValue = driver.findElement(By.xpath(ColumnValues)).getText().replaceAll(",","");;
						premSmryData.put("PS_"+sec_name.replaceAll(" ", "")+"_"+cHash.get(prem_col[j-2]), CellValue);
					}
					PremiumSummarytableCalculation(premSmryData,sec_name);
					
				}
				break;
			case  "On Cover" :  //On Cover State
				
				//System.out.println("Covers Found -:"+ (rcount-1));
				TestUtil.reportStatus("Covers Found -:"+ (rcount-1), "info", true);
				tXpath = "//*[@class='matrix']/tbody/tr";
				for(int i =1;i<=rcount;i++){
					String sectionXpath = tXpath+"["+i+"]/td[1]";
					String sec_name = driver.findElement(By.xpath(sectionXpath)).getText();
					//System.out.print(sec_name+"\t\t\t");
					//TestUtil.reportStatus(sec_name+"\t\t\t", "Info", false);
					for(int j = 2; j<=cCount;j++){
						String ColumnValues = tXpath+"["+i+"]/td["+j+"]";
						CellValue = driver.findElement(By.xpath(ColumnValues)).getText().replaceAll(",","");;
						//System.out.print(CellValue +  "\t");
						//TestUtil.reportStatus(CellValue +  "\t", "Info", false);
						premSmryData.put("PS_"+sec_name.replaceAll(" ", "")+"_"+cHash.get(prem_col[j-2]), CellValue);
						
						}
					PremiumSummarytableCalculation(premSmryData,sec_name);	
					
				}
				break;
			}
			
			
			double FinalPremium = 0.0 , Total_GrossPremium , Total_GrossTax , calcFinalPremium = 0.0;
			switch (common.currentRunningFlow) {
			case "NB":
				FinalPremium =Double.parseDouble(k.getTextByXpath("//*[@class='gttext']").replaceAll(",",""));
				Total_GrossPremium =Double.parseDouble(TestUtil.getStringfromMap("PS_Total_GP",""));// premSmryData.get("PS_Total_GP"));
				Total_GrossTax=Double.parseDouble(TestUtil.getStringfromMap("PS_Total_GT",""));// premSmryData.get("PS_Total_GT"));
				calcFinalPremium = Total_GrossPremium +Total_GrossTax;
				break;
			case "CAN":
				FinalPremium =Double.parseDouble(k.getTextByXpath("//*[@class='gttext']").replaceAll(",",""));
				Total_GrossPremium =Double.parseDouble(TestUtil.getStringfromMap("PS_Total_GP",""));// premSmryData.get("PS_Total_GP"));
				Total_GrossTax=Double.parseDouble(TestUtil.getStringfromMap("PS_Total_GT",""));// premSmryData.get("PS_Total_GT"));
				calcFinalPremium = Total_GrossPremium +Total_GrossTax;
				break;
			case "MTA":
				FinalPremium =Double.parseDouble(k.getTextByXpath("//*[@class='gttext']").replaceAll(",",""));
				Total_GrossPremium =Double.parseDouble(TestUtil.getStringfromMap("PS_Total_GP",CommonFunction_VELA.businessEvent));// premSmryData.get("PS_Total_GP"));
				Total_GrossTax=Double.parseDouble(TestUtil.getStringfromMap("PS_Total_GT",CommonFunction_VELA.businessEvent));// premSmryData.get("PS_Total_GT"));
				calcFinalPremium = Total_GrossPremium +Total_GrossTax;
				break;
			case "Renewal":
				FinalPremium =Double.parseDouble(k.getTextByXpath("//*[@class='gttext']").replaceAll(",",""));
				Total_GrossPremium =Double.parseDouble(TestUtil.getStringfromMap("PS_Total_GP",CommonFunction_VELA.businessEvent));// premSmryData.get("PS_Total_GP"));
				Total_GrossTax=Double.parseDouble(TestUtil.getStringfromMap("PS_Total_GT",CommonFunction_VELA.businessEvent));// premSmryData.get("PS_Total_GT"));
				calcFinalPremium = Total_GrossPremium +Total_GrossTax;
				break;
			
			default:
				break;
			}
			
			compareValues(calcFinalPremium,FinalPremium,"Policy Premium ");
			TestUtil.reportStatus("Final Policy Premium  :<b>"+calcFinalPremium, "Info", false);

			k.ImplicitWaitOn();
			return true;
			
		}
public static boolean PremiumSummaryDataTraverseMTA(int rcount, Hashtable<String,String> coverlist,Hashtable<String,String> cHash,String code, String event,boolean xlWrite){
	
	try{
		common.GrosspremSmryData.clear();
		String[] prem_col = {"gprem","comr","comm","nprem","gipt","nipt"};
		String sec_name_withoutSpace = null;
		String CellValue;
		String testName = (String)common.MTA_excel_data_map.get("Automation Key");
		Hashtable<String,String> premSmryData = new Hashtable<String,String>();
		
		TestUtil.reportStatus("Covers Found -:"+ (rcount-1), "info", true);
		String tXpath = "//*[@class='matrix']/tbody/tr";
		String Trax_table = "html/body/div[3]/form/div/table[2]/tbody/tr";
		List<WebElement> ls = driver.findElements(By.xpath(Trax_table));
		
		 for(int i =1;i<=rcount;i++){
			 String sectionXpath = tXpath+"["+i+"]/td[1]";
			 String sec_name = driver.findElement(By.xpath(sectionXpath)).getText();
			
			if(sec_name.contains("Frozen Food")){
				sec_name_withoutSpace = "FrozenFoods";
			}else if(sec_name.contains("Licence")){
				sec_name_withoutSpace = "LossOfLicence";
			}else if(sec_name.contains("Total")){
				sec_name = "Total";
				sec_name_withoutSpace = "Total";
			}else{
				sec_name_withoutSpace = sec_name.replaceAll(" ", "");
			}
			
			String policy_status_actual = k.getText("Policy_status_header");
			
			if(policy_status_actual.contains("Endorsement Submitted")){
				if(sec_name_withoutSpace.contains("Total")){
					if(sec_name_withoutSpace.contains("Total")==false && xlWrite==true )
						TestUtil.WriteDataToXl(code+"_"+event, "Premium Summary",(String)common.MTA_excel_data_map.get("Automation Key"), "PS_"+sec_name_withoutSpace+"_IPT", TestUtil.getStringfromMap("PS_IPTRate",""), common.MTA_excel_data_map);
						
						//System.out.print(sec_name+"\t\t\t");
						TestUtil.reportStatus("---------------"+sec_name+"-----------------","Info",false);
						for(int j=0;j<prem_col.length;j++){
							String xpathVal;
							xpathVal = "//*[@id='"+coverlist.get(sec_name)+"_"+prem_col[j]+"']";
							 String keyName = "PS_"+sec_name_withoutSpace+"_"+cHash.get(prem_col[j]);
							
							if(coverlist.get(sec_name).equals("tot") && prem_col[j].equals("comm")){
								xpathVal = "//*[@id='"+coverlist.get(sec_name)+"_com']";
								CellValue = driver.findElement(By.xpath(xpathVal)).getAttribute("value").replaceAll(",","");;
								customAssert.assertTrue(WriteDataToXl(code+"_"+event, "Premium Summary", testName, keyName, CellValue,common.MTA_excel_data_map),"Error while writing Premium Summary data to excel ."+keyName);
							}
							if(coverlist.get(sec_name).equals("tot") && prem_col[j].equals("comr")){
								System.out.print(" ___ \t ");
							}else if(prem_col[j].equals("comr") && (coverlist.get(sec_name).equals("tot"))==false){
								if(xlWrite){
									k.scrollInViewByXpath(xpathVal);
									driver.findElement(By.xpath(xpathVal)).click();
									driver.findElement(By.xpath(xpathVal)).sendKeys(Keys.chord(Keys.CONTROL, "a"),TestUtil.getStringfromMap("PS_"+sec_name_withoutSpace+"_CR",""));
									driver.findElement(By.xpath(xpathVal)).sendKeys(Keys.TAB);
								}
								CellValue = driver.findElement(By.xpath(xpathVal)).getAttribute("value").replaceAll(",","");;
								if(xlWrite){
									premSmryData.put("PS_"+sec_name_withoutSpace+"_"+cHash.get(prem_col[j]), CellValue);
									//customAssert.assertTrue(WriteDataToXl(code+"_"+event, "Premium Summary", testName, keyName, CellValue,common.NB_excel_data_map),"Error while writing Premium Summary data to excel ."+keyName);
								}else if(ls.size()==0) {
									compareValues(Double.parseDouble(TestUtil.getStringfromMap("PS_"+sec_name_withoutSpace+"_CR","")),Double.parseDouble(CellValue),cHash.get(prem_col[j]));
									premSmryData.put("PS_"+sec_name_withoutSpace+"_"+cHash.get(prem_col[j]), CellValue);
								}
								keyName = "PS_"+sec_name_withoutSpace+"_"+cHash.get(prem_col[j-1]);
								xpathVal = "//*[@id='"+coverlist.get(sec_name)+"_"+prem_col[j-1]+"']";
								CellValue = driver.findElement(By.xpath(xpathVal)).getAttribute("value").replaceAll(",","");;
								if(xlWrite){
									premSmryData.put("PS_"+sec_name_withoutSpace+"_"+cHash.get(prem_col[j-1]), CellValue);
									common.GrosspremSmryData.put("PS_"+sec_name_withoutSpace+"_"+cHash.get(prem_col[j-1]), CellValue);
									//customAssert.assertTrue(WriteDataToXl(code+"_"+event, "Premium Summary", testName, keyName, CellValue,common.NB_excel_data_map),"Error while writing Premium Summary data to excel ."+keyName);
								}	
							}else{
							    	CellValue = driver.findElement(By.xpath(xpathVal)).getAttribute("value").replaceAll(",","");
							    	if(xlWrite){
									premSmryData.put("PS_"+sec_name_withoutSpace+"_"+cHash.get(prem_col[j]), CellValue);
									//customAssert.assertTrue(WriteDataToXl(code+"_"+event, "Premium Summary", testName, keyName, CellValue,common.NB_excel_data_map),"Error while writing Premium Summary data to excel ."+keyName);
							    	}else if(ls.size()==0){
							    		
									compareValues(Double.parseDouble(TestUtil.getStringfromMap(keyName,"")),Double.parseDouble(CellValue),cHash.get(prem_col[j]));
									premSmryData.put("PS_"+sec_name_withoutSpace+"_"+cHash.get(prem_col[j]), CellValue);
							    	}
							    keyName=null;
							    }
						}
							//customAssert.assertTrue(WriteDataToXl(code+"_"+event, "Premium Summary", testName, "PS_Duration", customPolicyDuration,common.NB_excel_data_map),"Error while writing Policy Duration data to excel .");
						if(ls.size()==0){
							PremiumSummarytableCalculation(premSmryData,sec_name_withoutSpace);}
				}else{
					
					if(sec_name.contains("Liability")){
						sec_name_withoutSpace = "Liability";
					}
					if(sec_name.contains("Frozen")){
						sec_name_withoutSpace = "FrozenFood";
					}
					if(sec_name.contains("Licence")){
						sec_name_withoutSpace = "LossofLicence";
					}
					
					if((((String)common.MTA_excel_data_map.get("CD_Add_"+sec_name_withoutSpace)).equalsIgnoreCase("Yes") &&
							((String)common.NB_excel_data_map.get("CD_"+sec_name_withoutSpace)).equalsIgnoreCase("No"))){
						
						if(sec_name.contains("Employers")){
							sec_name_withoutSpace = "EmployersLiability";
						}
						if(sec_name.contains("Public")){
							sec_name_withoutSpace = "PublicLiability";
						}
						if(sec_name.contains("Product")){
							sec_name_withoutSpace = "ProductsLiability";
						}
						if(sec_name.contains("Owners")){
							sec_name_withoutSpace = "PropertyOwnersLiability";
						}
						if(sec_name.contains("Frozen")){
							sec_name_withoutSpace = "FrozenFoods";
						}
						if(sec_name.contains("Licence")){
							sec_name_withoutSpace = "LossOfLicence";
						}
						
						if(sec_name_withoutSpace.contains("Total")==false && xlWrite==true )
							TestUtil.WriteDataToXl(code+"_"+event, "Premium Summary",(String)common.MTA_excel_data_map.get("Automation Key"), "PS_"+sec_name_withoutSpace+"_IPT", TestUtil.getStringfromMap("PS_IPTRate",""), common.MTA_excel_data_map);
							
							//System.out.print(sec_name+"\t\t\t");
							TestUtil.reportStatus("---------------"+sec_name+"-----------------","Info",false);
							for(int j=0;j<prem_col.length;j++){
								String xpathVal;
								xpathVal = "//*[@id='"+coverlist.get(sec_name)+"_"+prem_col[j]+"']";
								 String keyName = "PS_"+sec_name_withoutSpace+"_"+cHash.get(prem_col[j]);
								
								if(coverlist.get(sec_name).equals("tot") && prem_col[j].equals("comm")){
									xpathVal = "//*[@id='"+coverlist.get(sec_name)+"_com']";
									CellValue = driver.findElement(By.xpath(xpathVal)).getAttribute("value").replaceAll(",","");;
									customAssert.assertTrue(WriteDataToXl(code+"_"+event, "Premium Summary", testName, keyName, CellValue,common.MTA_excel_data_map),"Error while writing Premium Summary data to excel ."+keyName);
								}
								if(coverlist.get(sec_name).equals("tot") && prem_col[j].equals("comr")){
									System.out.print(" ___ \t ");
								}else if(prem_col[j].equals("comr") && (coverlist.get(sec_name).equals("tot"))==false){
									if(xlWrite){
										k.scrollInViewByXpath(xpathVal);
										driver.findElement(By.xpath(xpathVal)).click();
										driver.findElement(By.xpath(xpathVal)).sendKeys(Keys.chord(Keys.CONTROL, "a"),TestUtil.getStringfromMap("PS_"+sec_name_withoutSpace+"_CR",""));
										driver.findElement(By.xpath(xpathVal)).sendKeys(Keys.TAB);
									}
									CellValue = driver.findElement(By.xpath(xpathVal)).getAttribute("value").replaceAll(",","");;
									if(xlWrite){
										premSmryData.put("PS_"+sec_name_withoutSpace+"_"+cHash.get(prem_col[j]), CellValue);
										//common.GrosspremSmryData.put("PS_"+sec_name_withoutSpace+"_"+cHash.get(prem_col[j-1]), CellValue);
										//customAssert.assertTrue(WriteDataToXl(code+"_"+event, "Premium Summary", testName, keyName, CellValue,common.NB_excel_data_map),"Error while writing Premium Summary data to excel ."+keyName);
									}else if(ls.size()==0) {
										compareValues(Double.parseDouble(TestUtil.getStringfromMap("PS_"+sec_name_withoutSpace+"_CR","")),Double.parseDouble(CellValue),cHash.get(prem_col[j]));
										premSmryData.put("PS_"+sec_name_withoutSpace+"_"+cHash.get(prem_col[j]), CellValue);
									}
									keyName = "PS_"+sec_name_withoutSpace+"_"+cHash.get(prem_col[j-1]);
									xpathVal = "//*[@id='"+coverlist.get(sec_name)+"_"+prem_col[j-1]+"']";
									CellValue = driver.findElement(By.xpath(xpathVal)).getAttribute("value").replaceAll(",","");;
									if(xlWrite){
										premSmryData.put("PS_"+sec_name_withoutSpace+"_"+cHash.get(prem_col[j-1]), CellValue);
										common.GrosspremSmryData.put("PS_"+sec_name_withoutSpace+"_"+cHash.get(prem_col[j-1]), CellValue);
										//customAssert.assertTrue(WriteDataToXl(code+"_"+event, "Premium Summary", testName, keyName, CellValue,common.NB_excel_data_map),"Error while writing Premium Summary data to excel ."+keyName);
									}	
								}else{
								    	CellValue = driver.findElement(By.xpath(xpathVal)).getAttribute("value").replaceAll(",","");
								    	if(xlWrite){
										premSmryData.put("PS_"+sec_name_withoutSpace+"_"+cHash.get(prem_col[j]), CellValue);
										//customAssert.assertTrue(WriteDataToXl(code+"_"+event, "Premium Summary", testName, keyName, CellValue,common.NB_excel_data_map),"Error while writing Premium Summary data to excel ."+keyName);
								    	}else if(ls.size()==0){
								    		
										compareValues(Double.parseDouble(TestUtil.getStringfromMap(keyName,"")),Double.parseDouble(CellValue),cHash.get(prem_col[j]));
										premSmryData.put("PS_"+sec_name_withoutSpace+"_"+cHash.get(prem_col[j]), CellValue);
								    	}
								    keyName=null;
								    }
							}
								//customAssert.assertTrue(WriteDataToXl(code+"_"+event, "Premium Summary", testName, "PS_Duration", customPolicyDuration,common.NB_excel_data_map),"Error while writing Policy Duration data to excel .");
							if(ls.size()==0){
								PremiumSummarytableCalculation(premSmryData,sec_name_withoutSpace);}
							
					}else if((((String)common.MTA_excel_data_map.get("CD_Add_"+sec_name_withoutSpace)).equalsIgnoreCase("No") &&
							((String)common.NB_excel_data_map.get("CD_"+sec_name_withoutSpace)).equalsIgnoreCase("Yes"))){
						
						if(sec_name.contains("Employers")){
							sec_name_withoutSpace = "EmployersLiability";
						}
						if(sec_name.contains("Public")){
							sec_name_withoutSpace = "PublicLiability";
						}
						if(sec_name.contains("Product")){
							sec_name_withoutSpace = "ProductsLiability";
						}
						if(sec_name.contains("Owners")){
							sec_name_withoutSpace = "PropertyOwnersLiability";
						}
						if(sec_name.contains("Frozen")){
							sec_name_withoutSpace = "FrozenFoods";
						}
						if(sec_name.contains("Licence")){
							sec_name_withoutSpace = "LossOfLicence";
						}
						
						if(sec_name_withoutSpace.contains("Total")==false && xlWrite==true )
							//TestUtil.WriteDataToXl(code+"_"+event, "Premium Summary",(String)common.NB_excel_data_map.get("Automation Key"), "PS_"+sec_name_withoutSpace+"_IPT", TestUtil.getStringfromMap("PS_IPTRate"), common.NB_excel_data_map);
							
							//System.out.print(sec_name+"\t\t\t");
							TestUtil.reportStatus("---------------"+sec_name+"-----------------","Info",false);
							for(int j=0;j<prem_col.length;j++){
								String xpathVal;
								xpathVal = "//*[@id='"+coverlist.get(sec_name)+"_"+prem_col[j]+"']";
								 String keyName = "PS_"+sec_name_withoutSpace+"_"+cHash.get(prem_col[j]);
								
								if(coverlist.get(sec_name).equals("tot") && prem_col[j].equals("comm")){
									xpathVal = "//*[@id='"+coverlist.get(sec_name)+"_com']";
									CellValue = driver.findElement(By.xpath(xpathVal)).getAttribute("value").replaceAll(",","");;
									customAssert.assertTrue(WriteDataToXl(code+"_"+event, "Premium Summary", testName, keyName, CellValue,common.NB_excel_data_map),"Error while writing Premium Summary data to excel ."+keyName);
								}
								if(coverlist.get(sec_name).equals("tot") && prem_col[j].equals("comr")){
									System.out.print(" ___ \t ");
								}else if(prem_col[j].equals("comr") && (coverlist.get(sec_name).equals("tot"))==false){
									if(xlWrite){
										k.scrollInViewByXpath(xpathVal);
										//driver.findElement(By.xpath(xpathVal)).click();
										//driver.findElement(By.xpath(xpathVal)).sendKeys(Keys.chord(Keys.CONTROL, "a"),TestUtil.getStringfromMap("PS_"+sec_name_withoutSpace+"_CR"));
										//driver.findElement(By.xpath(xpathVal)).sendKeys(Keys.TAB);
									}
									CellValue = driver.findElement(By.xpath(xpathVal)).getAttribute("value").replaceAll(",","");;
									if(xlWrite){
										premSmryData.put("PS_"+sec_name_withoutSpace+"_"+cHash.get(prem_col[j]), CellValue);
										//common.GrosspremSmryData.put("PS_"+sec_name_withoutSpace+"_"+cHash.get(prem_col[j-1]), CellValue);
										//customAssert.assertTrue(WriteDataToXl(code+"_"+event, "Premium Summary", testName, keyName, CellValue,common.NB_excel_data_map),"Error while writing Premium Summary data to excel ."+keyName);
									}else if(ls.size()==0) {
										compareValues(Double.parseDouble(TestUtil.getStringfromMap("PS_"+sec_name_withoutSpace+"_CR","")),Double.parseDouble(CellValue),cHash.get(prem_col[j]));
										premSmryData.put("PS_"+sec_name_withoutSpace+"_"+cHash.get(prem_col[j]), CellValue);
									}
									keyName = "PS_"+sec_name_withoutSpace+"_"+cHash.get(prem_col[j-1]);
									xpathVal = "//*[@id='"+coverlist.get(sec_name)+"_"+prem_col[j-1]+"']";
									CellValue = driver.findElement(By.xpath(xpathVal)).getAttribute("value").replaceAll(",","");;
									if(xlWrite){
										premSmryData.put("PS_"+sec_name_withoutSpace+"_"+cHash.get(prem_col[j-1]), CellValue);
										common.GrosspremSmryData.put("PS_"+sec_name_withoutSpace+"_"+cHash.get(prem_col[j-1]), CellValue);
										//customAssert.assertTrue(WriteDataToXl(code+"_"+event, "Premium Summary", testName, keyName, CellValue,common.NB_excel_data_map),"Error while writing Premium Summary data to excel ."+keyName);
									}	
								}else{
								    	CellValue = driver.findElement(By.xpath(xpathVal)).getAttribute("value").replaceAll(",","");
								    	if(xlWrite){
										premSmryData.put("PS_"+sec_name_withoutSpace+"_"+cHash.get(prem_col[j]), CellValue);
										//customAssert.assertTrue(WriteDataToXl(code+"_"+event, "Premium Summary", testName, keyName, CellValue,common.NB_excel_data_map),"Error while writing Premium Summary data to excel ."+keyName);
								    	}else if(ls.size()==0){
								    		
										compareValues(Double.parseDouble(TestUtil.getStringfromMap(keyName,"")),Double.parseDouble(CellValue),cHash.get(prem_col[j]));
										premSmryData.put("PS_"+sec_name_withoutSpace+"_"+cHash.get(prem_col[j]), CellValue);
								    	}
								    keyName=null;
								    }
							}
								//customAssert.assertTrue(WriteDataToXl(code+"_"+event, "Premium Summary", testName, "PS_Duration", customPolicyDuration,common.NB_excel_data_map),"Error while writing Policy Duration data to excel .");
							if(ls.size()==0){
								PremiumSummarytableCalculation(premSmryData,sec_name_withoutSpace);}
					}
					else if((((String)common.MTA_excel_data_map.get("CD_Add_"+sec_name_withoutSpace)).equalsIgnoreCase("Yes") &&
							((String)common.NB_excel_data_map.get("CD_"+sec_name_withoutSpace)).equalsIgnoreCase("Yes"))){
						
						if(sec_name.contains("Employers")){
							sec_name_withoutSpace = "EmployersLiability";
						}
						if(sec_name.contains("Public")){
							sec_name_withoutSpace = "PublicLiability";
						}
						if(sec_name.contains("Product")){
							sec_name_withoutSpace = "ProductsLiability";
						}
						if(sec_name.contains("Owners")){
							sec_name_withoutSpace = "PropertyOwnersLiability";
						}
						if(sec_name.contains("Frozen")){
							sec_name_withoutSpace = "FrozenFoods";
						}
						if(sec_name.contains("Licence")){
							sec_name_withoutSpace = "LossOfLicence";
						}
						
						if(sec_name_withoutSpace.contains("Total")==false && xlWrite==true )
							//TestUtil.WriteDataToXl(code+"_"+event, "Premium Summary",(String)common.NB_excel_data_map.get("Automation Key"), "PS_"+sec_name_withoutSpace+"_IPT", TestUtil.getStringfromMap("PS_IPTRate"), common.NB_excel_data_map);
							
							//System.out.print(sec_name+"\t\t\t");
							TestUtil.reportStatus("---------------"+sec_name+"-----------------","Info",false);
							for(int j=0;j<prem_col.length;j++){
								String xpathVal;
								xpathVal = "//*[@id='"+coverlist.get(sec_name)+"_"+prem_col[j]+"']";
								 String keyName = "PS_"+sec_name_withoutSpace+"_"+cHash.get(prem_col[j]);
								
								if(coverlist.get(sec_name).equals("tot") && prem_col[j].equals("comm")){
									xpathVal = "//*[@id='"+coverlist.get(sec_name)+"_com']";
									CellValue = driver.findElement(By.xpath(xpathVal)).getAttribute("value").replaceAll(",","");;
									customAssert.assertTrue(WriteDataToXl(code+"_"+event, "Premium Summary", testName, keyName, CellValue,common.MTA_excel_data_map),"Error while writing Premium Summary data to excel ."+keyName);
								}
								if(coverlist.get(sec_name).equals("tot") && prem_col[j].equals("comr")){
									System.out.print(" ___ \t ");
								}else if(prem_col[j].equals("comr") && (coverlist.get(sec_name).equals("tot"))==false){
									if(xlWrite){
										k.scrollInViewByXpath(xpathVal);
										//driver.findElement(By.xpath(xpathVal)).click();
										//driver.findElement(By.xpath(xpathVal)).sendKeys(Keys.chord(Keys.CONTROL, "a"),TestUtil.getStringfromMap("PS_"+sec_name_withoutSpace+"_CR"));
										//driver.findElement(By.xpath(xpathVal)).sendKeys(Keys.TAB);
									}
									CellValue = driver.findElement(By.xpath(xpathVal)).getAttribute("value").replaceAll(",","");;
									if(xlWrite){
										premSmryData.put("PS_"+sec_name_withoutSpace+"_"+cHash.get(prem_col[j]), CellValue);
										//common.GrosspremSmryData.put("PS_"+sec_name_withoutSpace+"_"+cHash.get(prem_col[j-1]), CellValue);
										//customAssert.assertTrue(WriteDataToXl(code+"_"+event, "Premium Summary", testName, keyName, CellValue,common.NB_excel_data_map),"Error while writing Premium Summary data to excel ."+keyName);
									}else if(ls.size()==0) {
										compareValues(Double.parseDouble(TestUtil.getStringfromMap("PS_"+sec_name_withoutSpace+"_CR","")),Double.parseDouble(CellValue),cHash.get(prem_col[j]));
										premSmryData.put("PS_"+sec_name_withoutSpace+"_"+cHash.get(prem_col[j]), CellValue);
									}
									keyName = "PS_"+sec_name_withoutSpace+"_"+cHash.get(prem_col[j-1]);
									xpathVal = "//*[@id='"+coverlist.get(sec_name)+"_"+prem_col[j-1]+"']";
									CellValue = driver.findElement(By.xpath(xpathVal)).getAttribute("value").replaceAll(",","");;
									if(xlWrite){
										premSmryData.put("PS_"+sec_name_withoutSpace+"_"+cHash.get(prem_col[j-1]), CellValue);
										common.GrosspremSmryData.put("PS_"+sec_name_withoutSpace+"_"+cHash.get(prem_col[j-1]), CellValue);
										//customAssert.assertTrue(WriteDataToXl(code+"_"+event, "Premium Summary", testName, keyName, CellValue,common.NB_excel_data_map),"Error while writing Premium Summary data to excel ."+keyName);
									}	
								}else{
								    	CellValue = driver.findElement(By.xpath(xpathVal)).getAttribute("value").replaceAll(",","");
								    	if(xlWrite){
										premSmryData.put("PS_"+sec_name_withoutSpace+"_"+cHash.get(prem_col[j]), CellValue);
										//customAssert.assertTrue(WriteDataToXl(code+"_"+event, "Premium Summary", testName, keyName, CellValue,common.NB_excel_data_map),"Error while writing Premium Summary data to excel ."+keyName);
								    	}else if(ls.size()==0){
								    		
										compareValues(Double.parseDouble(TestUtil.getStringfromMap(keyName,"")),Double.parseDouble(CellValue),cHash.get(prem_col[j]));
										premSmryData.put("PS_"+sec_name_withoutSpace+"_"+cHash.get(prem_col[j]), CellValue);
								    	}
								    keyName=null;
								    }
							}
								//customAssert.assertTrue(WriteDataToXl(code+"_"+event, "Premium Summary", testName, "PS_Duration", customPolicyDuration,common.NB_excel_data_map),"Error while writing Policy Duration data to excel .");
							if(ls.size()==0){
								PremiumSummarytableCalculation(premSmryData,sec_name_withoutSpace);}
					}
				}
				
			}else{
				if(sec_name_withoutSpace.contains("Total")==false && xlWrite==true )
					TestUtil.WriteDataToXl(code+"_"+event, "Premium Summary",(String)common.MTA_excel_data_map.get("Automation Key"), "PS_"+sec_name_withoutSpace+"_IPT", TestUtil.getStringfromMap("PS_IPTRate",""), common.MTA_excel_data_map);
					
					//System.out.print(sec_name+"\t\t\t");
					TestUtil.reportStatus("---------------"+sec_name+"-----------------","Info",false);
					for(int j=0;j<prem_col.length;j++){
						String xpathVal;
						xpathVal = "//*[@id='"+coverlist.get(sec_name)+"_"+prem_col[j]+"']";
						 String keyName = "PS_"+sec_name_withoutSpace+"_"+cHash.get(prem_col[j]);
						
						if(coverlist.get(sec_name).equals("tot") && prem_col[j].equals("comm")){
							xpathVal = "//*[@id='"+coverlist.get(sec_name)+"_com']";
							CellValue = driver.findElement(By.xpath(xpathVal)).getAttribute("value").replaceAll(",","");;
							customAssert.assertTrue(WriteDataToXl(code+"_"+event, "Premium Summary", testName, keyName, CellValue,common.MTA_excel_data_map),"Error while writing Premium Summary data to excel ."+keyName);
						}
						if(coverlist.get(sec_name).equals("tot") && prem_col[j].equals("comr")){
							System.out.print(" ___ \t ");
						}else if(prem_col[j].equals("comr") && (coverlist.get(sec_name).equals("tot"))==false){
							if(xlWrite){
								k.scrollInViewByXpath(xpathVal);
								driver.findElement(By.xpath(xpathVal)).click();
								driver.findElement(By.xpath(xpathVal)).sendKeys(Keys.chord(Keys.CONTROL, "a"),TestUtil.getStringfromMap("PS_"+sec_name_withoutSpace+"_CR",""));
								driver.findElement(By.xpath(xpathVal)).sendKeys(Keys.TAB);
							}
							CellValue = driver.findElement(By.xpath(xpathVal)).getAttribute("value").replaceAll(",","");;
							if(xlWrite){
								premSmryData.put("PS_"+sec_name_withoutSpace+"_"+cHash.get(prem_col[j]), CellValue);
								//customAssert.assertTrue(WriteDataToXl(code+"_"+event, "Premium Summary", testName, keyName, CellValue,common.NB_excel_data_map),"Error while writing Premium Summary data to excel ."+keyName);
							}else if(ls.size()==0) {
								compareValues(Double.parseDouble(TestUtil.getStringfromMap("PS_"+sec_name_withoutSpace+"_CR","")),Double.parseDouble(CellValue),cHash.get(prem_col[j]));
								premSmryData.put("PS_"+sec_name_withoutSpace+"_"+cHash.get(prem_col[j]), CellValue);
							}
							keyName = "PS_"+sec_name_withoutSpace+"_"+cHash.get(prem_col[j-1]);
							xpathVal = "//*[@id='"+coverlist.get(sec_name)+"_"+prem_col[j-1]+"']";
							CellValue = driver.findElement(By.xpath(xpathVal)).getAttribute("value").replaceAll(",","");;
							if(xlWrite){
								premSmryData.put("PS_"+sec_name_withoutSpace+"_"+cHash.get(prem_col[j-1]), CellValue);
								common.GrosspremSmryData.put("PS_"+sec_name_withoutSpace+"_"+cHash.get(prem_col[j-1]), CellValue);
								//customAssert.assertTrue(WriteDataToXl(code+"_"+event, "Premium Summary", testName, keyName, CellValue,common.NB_excel_data_map),"Error while writing Premium Summary data to excel ."+keyName);
							}	
						}else{
						    	CellValue = driver.findElement(By.xpath(xpathVal)).getAttribute("value").replaceAll(",","");
						    	if(xlWrite){
								premSmryData.put("PS_"+sec_name_withoutSpace+"_"+cHash.get(prem_col[j]), CellValue);
								//customAssert.assertTrue(WriteDataToXl(code+"_"+event, "Premium Summary", testName, keyName, CellValue,common.NB_excel_data_map),"Error while writing Premium Summary data to excel ."+keyName);
						    	}else if(ls.size()==0){
						    		
								compareValues(Double.parseDouble(TestUtil.getStringfromMap(keyName,"")),Double.parseDouble(CellValue),cHash.get(prem_col[j]));
								premSmryData.put("PS_"+sec_name_withoutSpace+"_"+cHash.get(prem_col[j]), CellValue);
						    	}
						    keyName=null;
						    }
					}
						//customAssert.assertTrue(WriteDataToXl(code+"_"+event, "Premium Summary", testName, "PS_Duration", customPolicyDuration,common.NB_excel_data_map),"Error while writing Policy Duration data to excel .");
					if(ls.size()==0){
						PremiumSummarytableCalculation(premSmryData,sec_name_withoutSpace);}
			}
			
		 }
		 customAssert.assertTrue(k.Click("CCF_Btn_Save"), "Unable to click on Save Button on Premium Summary .");
		 
		 
		 if(ls.size()>0){ 
		 TransactionDetailsTable(cHash,code,event,true);
		 }else if(xlWrite){
			 Set<String> pKeys=premSmryData.keySet();
			 	for(String pkey:pKeys){
			 		customAssert.assertTrue(WriteDataToXl(code+"_"+event, "Premium Summary", testName,pkey,premSmryData.get(pkey) ,common.MTA_excel_data_map),"Error while writing Premium Summary data to excel ."+pkey) ;
			 	}
		 }
		
		 return true;
	}catch(Throwable t){
			k.ImplicitWaitOn();
			return false;
	}
  
 }

		 
public static boolean PremiumSummaryDataTraverse(int rcount, Hashtable<String,String> coverlist,Hashtable<String,String> cHash,String code, String event,boolean xlWrite){
    
    try{
           common.GrosspremSmryData.clear();
           String[] prem_col = {"gprem","comr","comm","nprem","gipt","nipt"};
           String sec_name_withoutSpace = null;
           String CellValue;
           String testName = (String)common.NB_excel_data_map.get("Automation Key");
           Hashtable<String,String> premSmryData = new Hashtable<String,String>();
           
           TestUtil.reportStatus("Covers Found -:"+ (rcount-1), "info", true);
           String tXpath = "//*[@class='matrix']/tbody/tr";
           String Trax_table = "html/body/div[3]/form/div/table[3]/tbody/tr";
           List<WebElement> ls = driver.findElements(By.xpath(Trax_table));
           
           for(int i =1;i<=rcount;i++){
                  String sectionXpath = tXpath+"["+i+"]/td[1]";
                  String sec_name = driver.findElement(By.xpath(sectionXpath)).getText();
                  
                  if(sec_name.contains("Frozen Food")){
                        sec_name_withoutSpace = "FrozenFoods";
                  }else if(sec_name.contains("Licence")){
                        sec_name_withoutSpace = "LossOfLicence";
                  }else if(sec_name.contains("Total")){
                        sec_name = "Total";
                        sec_name_withoutSpace = "Total";
                  }else{
                        sec_name_withoutSpace = sec_name.replaceAll(" ", "");
                  }
                  
                  String policy_status_actual = k.getText("Policy_status_header");
                  
                  if(policy_status_actual.contains("Rewind")){
                        if(sec_name_withoutSpace.contains("Total")){
                               if(sec_name_withoutSpace.contains("Total")==false && xlWrite==true )
                                      TestUtil.WriteDataToXl(code+"_"+event, "Premium Summary",(String)common.NB_excel_data_map.get("Automation Key"), "PS_"+sec_name_withoutSpace+"_IPT", TestUtil.getStringfromMap("PS_IPTRate",CommonFunction_VELA.businessEvent), common.NB_excel_data_map);
                                      
                                      //System.out.print(sec_name+"\t\t\t");
                                      TestUtil.reportStatus("---------------"+sec_name+"-----------------","Info",false);
                                      for(int j=0;j<prem_col.length;j++){
                                             String xpathVal;
                                             xpathVal = "//*[@id='"+coverlist.get(sec_name)+"_"+prem_col[j]+"']";
                                             String keyName = "PS_"+sec_name_withoutSpace+"_"+cHash.get(prem_col[j]);
                                             
                                             if(coverlist.get(sec_name).equals("tot") && prem_col[j].equals("comm")){
                                                    xpathVal = "//*[@id='"+coverlist.get(sec_name)+"_com']";
                                                    CellValue = driver.findElement(By.xpath(xpathVal)).getAttribute("value").replaceAll(",","");;
                                                    customAssert.assertTrue(WriteDataToXl(code+"_"+event, "Premium Summary", testName, keyName, CellValue,common.NB_excel_data_map),"Error while writing Premium Summary data to excel ."+keyName);
                                             }
                                             if(coverlist.get(sec_name).equals("tot") && prem_col[j].equals("comr")){
                                                    System.out.print(" ___ \t ");
                                             }else if(prem_col[j].equals("comr") && (coverlist.get(sec_name).equals("tot"))==false){
                                                    if(xlWrite){
                                                           k.scrollInViewByXpath(xpathVal);
                                                           driver.findElement(By.xpath(xpathVal)).click();
                                                           driver.findElement(By.xpath(xpathVal)).sendKeys(Keys.chord(Keys.CONTROL, "a"),TestUtil.getStringfromMap("PS_"+sec_name_withoutSpace+"_CR",CommonFunction_VELA.businessEvent));
                                                           driver.findElement(By.xpath(xpathVal)).sendKeys(Keys.TAB);
                                                    }
                                                    CellValue = driver.findElement(By.xpath(xpathVal)).getAttribute("value").replaceAll(",","");;
                                                    if(xlWrite){
                                                           premSmryData.put("PS_"+sec_name_withoutSpace+"_"+cHash.get(prem_col[j]), CellValue);
                                                           //customAssert.assertTrue(WriteDataToXl(code+"_"+event, "Premium Summary", testName, keyName, CellValue,common.NB_excel_data_map),"Error while writing Premium Summary data to excel ."+keyName);
                                                    }else if(ls.size()==0) {
                                                           compareValues(Double.parseDouble(TestUtil.getStringfromMap("PS_"+sec_name_withoutSpace+"_CR",CommonFunction_VELA.businessEvent)),Double.parseDouble(CellValue),cHash.get(prem_col[j]));
                                                           premSmryData.put("PS_"+sec_name_withoutSpace+"_"+cHash.get(prem_col[j]), CellValue);
                                                    }
                                                    keyName = "PS_"+sec_name_withoutSpace+"_"+cHash.get(prem_col[j-1]);
                                                    xpathVal = "//*[@id='"+coverlist.get(sec_name)+"_"+prem_col[j-1]+"']";
                                                    CellValue = driver.findElement(By.xpath(xpathVal)).getAttribute("value").replaceAll(",","");;
                                                    if(xlWrite){
                                                           premSmryData.put("PS_"+sec_name_withoutSpace+"_"+cHash.get(prem_col[j-1]), CellValue);
                                                           common.GrosspremSmryData.put("PS_"+sec_name_withoutSpace+"_"+cHash.get(prem_col[j-1]), CellValue);
                                                           //customAssert.assertTrue(WriteDataToXl(code+"_"+event, "Premium Summary", testName, keyName, CellValue,common.NB_excel_data_map),"Error while writing Premium Summary data to excel ."+keyName);
                                                    }      
                                             }else{
                                                    CellValue = driver.findElement(By.xpath(xpathVal)).getAttribute("value").replaceAll(",","");
                                                    if(xlWrite){
                                                           premSmryData.put("PS_"+sec_name_withoutSpace+"_"+cHash.get(prem_col[j]), CellValue);
                                                           //customAssert.assertTrue(WriteDataToXl(code+"_"+event, "Premium Summary", testName, keyName, CellValue,common.NB_excel_data_map),"Error while writing Premium Summary data to excel ."+keyName);
                                                    }else if(ls.size()==0){
                                                           
                                                           compareValues(Double.parseDouble(TestUtil.getStringfromMap(keyName,CommonFunction_VELA.businessEvent)),Double.parseDouble(CellValue),cHash.get(prem_col[j]));
                                                           premSmryData.put("PS_"+sec_name_withoutSpace+"_"+cHash.get(prem_col[j]), CellValue);
                                                    }
                                                 keyName=null;
                                                 }
                                      }
                                             //customAssert.assertTrue(WriteDataToXl(code+"_"+event, "Premium Summary", testName, "PS_Duration", customPolicyDuration,common.NB_excel_data_map),"Error while writing Policy Duration data to excel .");
                                      if(ls.size()==0){
                                             PremiumSummarytableCalculation(premSmryData,sec_name_withoutSpace);}
                        }else{
                               
                               if(sec_name.contains("Liability")){
                                      sec_name_withoutSpace = "Liability";
                               }
                               if(sec_name.contains("Frozen")){
                                      sec_name_withoutSpace = "FrozenFood";
                               }
                               if(sec_name.contains("Licence")){
                                      sec_name_withoutSpace = "LossofLicence";
                               }
                               
                               if((((String)common.NB_excel_data_map.get("CD_Add_"+sec_name_withoutSpace)).equalsIgnoreCase("Yes") &&
                                             ((String)common.NB_excel_data_map.get("CD_"+sec_name_withoutSpace)).equalsIgnoreCase("No"))){
                                      
                                      if(sec_name.contains("Employers")){
                                             sec_name_withoutSpace = "EmployersLiability";
                                      }
                                      if(sec_name.contains("Public")){
                                             sec_name_withoutSpace = "PublicLiability";
                                      }
                                      if(sec_name.contains("Product")){
                                             sec_name_withoutSpace = "ProductsLiability";
                                      }
                                      if(sec_name.contains("Owners")){
                                             sec_name_withoutSpace = "PropertyOwnersLiability";
                                      }
                                      if(sec_name.contains("Frozen")){
                                             sec_name_withoutSpace = "FrozenFoods";
                                      }
                                      if(sec_name.contains("Licence")){
                                             sec_name_withoutSpace = "LossOfLicence";
                                      }
                                      
                                      if(sec_name_withoutSpace.contains("Total")==false && xlWrite==true )
                                             if(((String)common.NB_excel_data_map.get("PS_InsuranceTaxButton")).equalsIgnoreCase("Yes")){
                                                    TestUtil.WriteDataToXl(code+"_"+event, "Premium Summary",(String)common.NB_excel_data_map.get("Automation Key"), "PS_"+sec_name_withoutSpace+"_IPT", "00.00", common.NB_excel_data_map);
                                             }else{
                                                    TestUtil.WriteDataToXl(code+"_"+event, "Premium Summary",(String)common.NB_excel_data_map.get("Automation Key"), "PS_"+sec_name_withoutSpace+"_IPT", TestUtil.getStringfromMap("PS_IPTRate",CommonFunction_VELA.businessEvent), common.NB_excel_data_map);
                                             }
                                      
                                             //System.out.print(sec_name+"\t\t\t");
                                             TestUtil.reportStatus("---------------"+sec_name+"-----------------","Info",false);
                                             for(int j=0;j<prem_col.length;j++){
                                                    String xpathVal;
                                                    xpathVal = "//*[@id='"+coverlist.get(sec_name)+"_"+prem_col[j]+"']";
                                                    String keyName = "PS_"+sec_name_withoutSpace+"_"+cHash.get(prem_col[j]);
                                                    
                                                    if(coverlist.get(sec_name).equals("tot") && prem_col[j].equals("comm")){
                                                           xpathVal = "//*[@id='"+coverlist.get(sec_name)+"_com']";
                                                           CellValue = driver.findElement(By.xpath(xpathVal)).getAttribute("value").replaceAll(",","");;
                                                           customAssert.assertTrue(WriteDataToXl(code+"_"+event, "Premium Summary", testName, keyName, CellValue,common.NB_excel_data_map),"Error while writing Premium Summary data to excel ."+keyName);
                                                    }
                                                    if(coverlist.get(sec_name).equals("tot") && prem_col[j].equals("comr")){
                                                           System.out.print(" ___ \t ");
                                                    }else if(prem_col[j].equals("comr") && (coverlist.get(sec_name).equals("tot"))==false){
                                                           if(xlWrite){
                                                                  k.scrollInViewByXpath(xpathVal);
                                                                  driver.findElement(By.xpath(xpathVal)).click();
                                                                  driver.findElement(By.xpath(xpathVal)).sendKeys(Keys.chord(Keys.CONTROL, "a"),TestUtil.getStringfromMap("PS_"+sec_name_withoutSpace+"_CR",CommonFunction_VELA.businessEvent));
                                                                  driver.findElement(By.xpath(xpathVal)).sendKeys(Keys.TAB);
                                                           }
                                                           CellValue = driver.findElement(By.xpath(xpathVal)).getAttribute("value").replaceAll(",","");;
                                                           if(xlWrite){
                                                                  premSmryData.put("PS_"+sec_name_withoutSpace+"_"+cHash.get(prem_col[j]), CellValue);
                                                                  //common.GrosspremSmryData.put("PS_"+sec_name_withoutSpace+"_"+cHash.get(prem_col[j-1]), CellValue);
                                                                  //customAssert.assertTrue(WriteDataToXl(code+"_"+event, "Premium Summary", testName, keyName, CellValue,common.NB_excel_data_map),"Error while writing Premium Summary data to excel ."+keyName);
                                                           }else if(ls.size()==0) {
                                                                  compareValues(Double.parseDouble(TestUtil.getStringfromMap("PS_"+sec_name_withoutSpace+"_CR",CommonFunction_VELA.businessEvent)),Double.parseDouble(CellValue),cHash.get(prem_col[j]));
                                                                  premSmryData.put("PS_"+sec_name_withoutSpace+"_"+cHash.get(prem_col[j]), CellValue);
                                                           }
                                                           keyName = "PS_"+sec_name_withoutSpace+"_"+cHash.get(prem_col[j-1]);
                                                           xpathVal = "//*[@id='"+coverlist.get(sec_name)+"_"+prem_col[j-1]+"']";
                                                           CellValue = driver.findElement(By.xpath(xpathVal)).getAttribute("value").replaceAll(",","");;
                                                           if(xlWrite){
                                                                  premSmryData.put("PS_"+sec_name_withoutSpace+"_"+cHash.get(prem_col[j-1]), CellValue);
                                                                  common.GrosspremSmryData.put("PS_"+sec_name_withoutSpace+"_"+cHash.get(prem_col[j-1]), CellValue);
                                                                  //customAssert.assertTrue(WriteDataToXl(code+"_"+event, "Premium Summary", testName, keyName, CellValue,common.NB_excel_data_map),"Error while writing Premium Summary data to excel ."+keyName);
                                                           }      
                                                    }else{
                                                           CellValue = driver.findElement(By.xpath(xpathVal)).getAttribute("value").replaceAll(",","");
                                                           if(xlWrite){
                                                                  premSmryData.put("PS_"+sec_name_withoutSpace+"_"+cHash.get(prem_col[j]), CellValue);
                                                                  //customAssert.assertTrue(WriteDataToXl(code+"_"+event, "Premium Summary", testName, keyName, CellValue,common.NB_excel_data_map),"Error while writing Premium Summary data to excel ."+keyName);
                                                           }else if(ls.size()==0){
                                                                  
                                                                  compareValues(Double.parseDouble(TestUtil.getStringfromMap(keyName,CommonFunction_VELA.businessEvent)),Double.parseDouble(CellValue),cHash.get(prem_col[j]));
                                                                  premSmryData.put("PS_"+sec_name_withoutSpace+"_"+cHash.get(prem_col[j]), CellValue);
                                                           }
                                                        keyName=null;
                                                        }
                                             }
                                                    //customAssert.assertTrue(WriteDataToXl(code+"_"+event, "Premium Summary", testName, "PS_Duration", customPolicyDuration,common.NB_excel_data_map),"Error while writing Policy Duration data to excel .");
                                             if(ls.size()==0){
                                                    PremiumSummarytableCalculation(premSmryData,sec_name_withoutSpace);}
                                             
                               }else if((((String)common.NB_excel_data_map.get("CD_Add_"+sec_name_withoutSpace)).equalsIgnoreCase("No") &&
                                             ((String)common.NB_excel_data_map.get("CD_"+sec_name_withoutSpace)).equalsIgnoreCase("Yes"))){
                                      
                                      if(sec_name.contains("Employers")){
                                             sec_name_withoutSpace = "EmployersLiability";
                                      }
                                      if(sec_name.contains("Public")){
                                             sec_name_withoutSpace = "PublicLiability";
                                      }
                                      if(sec_name.contains("Product")){
                                             sec_name_withoutSpace = "ProductsLiability";
                                      }
                                      if(sec_name.contains("Owners")){
                                             sec_name_withoutSpace = "PropertyOwnersLiability";
                                      }
                                      if(sec_name.contains("Frozen")){
                                             sec_name_withoutSpace = "FrozenFoods";
                                      }
                                      if(sec_name.contains("Licence")){
                                             sec_name_withoutSpace = "LossOfLicence";
                                      }
                                      
                                      if(sec_name_withoutSpace.contains("Total")==false && xlWrite==true )
                                             //TestUtil.WriteDataToXl(code+"_"+event, "Premium Summary",(String)common.NB_excel_data_map.get("Automation Key"), "PS_"+sec_name_withoutSpace+"_IPT", TestUtil.getStringfromMap("PS_IPTRate"), common.NB_excel_data_map);
                                             
                                             //System.out.print(sec_name+"\t\t\t");
                                             TestUtil.reportStatus("---------------"+sec_name+"-----------------","Info",false);
                                             for(int j=0;j<prem_col.length;j++){
                                                    String xpathVal;
                                                    xpathVal = "//*[@id='"+coverlist.get(sec_name)+"_"+prem_col[j]+"']";
                                                    String keyName = "PS_"+sec_name_withoutSpace+"_"+cHash.get(prem_col[j]);
                                                    
                                                    if(coverlist.get(sec_name).equals("tot") && prem_col[j].equals("comm")){
                                                           xpathVal = "//*[@id='"+coverlist.get(sec_name)+"_com']";
                                                           CellValue = driver.findElement(By.xpath(xpathVal)).getAttribute("value").replaceAll(",","");;
                                                           customAssert.assertTrue(WriteDataToXl(code+"_"+event, "Premium Summary", testName, keyName, CellValue,common.NB_excel_data_map),"Error while writing Premium Summary data to excel ."+keyName);
                                                    }
                                                    if(coverlist.get(sec_name).equals("tot") && prem_col[j].equals("comr")){
                                                           System.out.print(" ___ \t ");
                                                    }else if(prem_col[j].equals("comr") && (coverlist.get(sec_name).equals("tot"))==false){
                                                           if(xlWrite){
                                                                  k.scrollInViewByXpath(xpathVal);
                                                                  //driver.findElement(By.xpath(xpathVal)).click();
                                                                  //driver.findElement(By.xpath(xpathVal)).sendKeys(Keys.chord(Keys.CONTROL, "a"),TestUtil.getStringfromMap("PS_"+sec_name_withoutSpace+"_CR"));
                                                                  //driver.findElement(By.xpath(xpathVal)).sendKeys(Keys.TAB);
                                                           }
                                                           CellValue = driver.findElement(By.xpath(xpathVal)).getAttribute("value").replaceAll(",","");;
                                                           if(xlWrite){
                                                                  premSmryData.put("PS_"+sec_name_withoutSpace+"_"+cHash.get(prem_col[j]), CellValue);
                                                                  //common.GrosspremSmryData.put("PS_"+sec_name_withoutSpace+"_"+cHash.get(prem_col[j-1]), CellValue);
                                                                  //customAssert.assertTrue(WriteDataToXl(code+"_"+event, "Premium Summary", testName, keyName, CellValue,common.NB_excel_data_map),"Error while writing Premium Summary data to excel ."+keyName);
                                                           }else if(ls.size()==0) {
                                                                  compareValues(Double.parseDouble(TestUtil.getStringfromMap("PS_"+sec_name_withoutSpace+"_CR",CommonFunction_VELA.businessEvent)),Double.parseDouble(CellValue),cHash.get(prem_col[j]));
                                                                  premSmryData.put("PS_"+sec_name_withoutSpace+"_"+cHash.get(prem_col[j]), CellValue);
                                                           }
                                                           keyName = "PS_"+sec_name_withoutSpace+"_"+cHash.get(prem_col[j-1]);
                                                           xpathVal = "//*[@id='"+coverlist.get(sec_name)+"_"+prem_col[j-1]+"']";
                                                           CellValue = driver.findElement(By.xpath(xpathVal)).getAttribute("value").replaceAll(",","");;
                                                           if(xlWrite){
                                                                  premSmryData.put("PS_"+sec_name_withoutSpace+"_"+cHash.get(prem_col[j-1]), CellValue);
                                                                  common.GrosspremSmryData.put("PS_"+sec_name_withoutSpace+"_"+cHash.get(prem_col[j-1]), CellValue);
                                                                  //customAssert.assertTrue(WriteDataToXl(code+"_"+event, "Premium Summary", testName, keyName, CellValue,common.NB_excel_data_map),"Error while writing Premium Summary data to excel ."+keyName);
                                                           }      
                                                    }else{
                                                           CellValue = driver.findElement(By.xpath(xpathVal)).getAttribute("value").replaceAll(",","");
                                                           if(xlWrite){
                                                                  premSmryData.put("PS_"+sec_name_withoutSpace+"_"+cHash.get(prem_col[j]), CellValue);
                                                                  //customAssert.assertTrue(WriteDataToXl(code+"_"+event, "Premium Summary", testName, keyName, CellValue,common.NB_excel_data_map),"Error while writing Premium Summary data to excel ."+keyName);
                                                           }else if(ls.size()==0){
                                                                  
                                                                  compareValues(Double.parseDouble(TestUtil.getStringfromMap(keyName,CommonFunction_VELA.businessEvent)),Double.parseDouble(CellValue),cHash.get(prem_col[j]));
                                                                  premSmryData.put("PS_"+sec_name_withoutSpace+"_"+cHash.get(prem_col[j]), CellValue);
                                                           }
                                                        keyName=null;
                                                        }
                                             }
                                                    //customAssert.assertTrue(WriteDataToXl(code+"_"+event, "Premium Summary", testName, "PS_Duration", customPolicyDuration,common.NB_excel_data_map),"Error while writing Policy Duration data to excel .");
                                             if(ls.size()==0){
                                                    PremiumSummarytableCalculation(premSmryData,sec_name_withoutSpace);}
                               }
                               else if((((String)common.NB_excel_data_map.get("CD_Add_"+sec_name_withoutSpace)).equalsIgnoreCase("Yes") &&
                                             ((String)common.NB_excel_data_map.get("CD_"+sec_name_withoutSpace)).equalsIgnoreCase("Yes"))){
                                      
                                      if(sec_name.contains("Employers")){
                                             sec_name_withoutSpace = "EmployersLiability";
                                      }
                                      if(sec_name.contains("Public")){
                                             sec_name_withoutSpace = "PublicLiability";
                                      }
                                      if(sec_name.contains("Product")){
                                             sec_name_withoutSpace = "ProductsLiability";
                                      }
                                      if(sec_name.contains("Owners")){
                                             sec_name_withoutSpace = "PropertyOwnersLiability";
                                      }
                                      if(sec_name.contains("Frozen")){
                                             sec_name_withoutSpace = "FrozenFoods";
                                      }
                                      if(sec_name.contains("Licence")){
                                             sec_name_withoutSpace = "LossOfLicence";
                                      }
                                      
                                      if(sec_name_withoutSpace.contains("Total")==false && xlWrite==true )
                                             //TestUtil.WriteDataToXl(code+"_"+event, "Premium Summary",(String)common.NB_excel_data_map.get("Automation Key"), "PS_"+sec_name_withoutSpace+"_IPT", TestUtil.getStringfromMap("PS_IPTRate"), common.NB_excel_data_map);
                                             
                                             //System.out.print(sec_name+"\t\t\t");
                                             TestUtil.reportStatus("---------------"+sec_name+"-----------------","Info",false);
                                             for(int j=0;j<prem_col.length;j++){
                                                    String xpathVal;
                                                    xpathVal = "//*[@id='"+coverlist.get(sec_name)+"_"+prem_col[j]+"']";
                                                    String keyName = "PS_"+sec_name_withoutSpace+"_"+cHash.get(prem_col[j]);
                                                    
                                                    if(coverlist.get(sec_name).equals("tot") && prem_col[j].equals("comm")){
                                                           xpathVal = "//*[@id='"+coverlist.get(sec_name)+"_com']";
                                                           CellValue = driver.findElement(By.xpath(xpathVal)).getAttribute("value").replaceAll(",","");;
                                                           customAssert.assertTrue(WriteDataToXl(code+"_"+event, "Premium Summary", testName, keyName, CellValue,common.NB_excel_data_map),"Error while writing Premium Summary data to excel ."+keyName);
                                                    }
                                                    if(coverlist.get(sec_name).equals("tot") && prem_col[j].equals("comr")){
                                                           System.out.print(" ___ \t ");
                                                    }else if(prem_col[j].equals("comr") && (coverlist.get(sec_name).equals("tot"))==false){
                                                           if(xlWrite){
                                                                  k.scrollInViewByXpath(xpathVal);
                                                                  //driver.findElement(By.xpath(xpathVal)).click();
                                                                  //driver.findElement(By.xpath(xpathVal)).sendKeys(Keys.chord(Keys.CONTROL, "a"),TestUtil.getStringfromMap("PS_"+sec_name_withoutSpace+"_CR"));
                                                                  //driver.findElement(By.xpath(xpathVal)).sendKeys(Keys.TAB);
                                                           }
                                                           CellValue = driver.findElement(By.xpath(xpathVal)).getAttribute("value").replaceAll(",","");;
                                                           if(xlWrite){
                                                                  premSmryData.put("PS_"+sec_name_withoutSpace+"_"+cHash.get(prem_col[j]), CellValue);
                                                                  //common.GrosspremSmryData.put("PS_"+sec_name_withoutSpace+"_"+cHash.get(prem_col[j-1]), CellValue);
                                                                  //customAssert.assertTrue(WriteDataToXl(code+"_"+event, "Premium Summary", testName, keyName, CellValue,common.NB_excel_data_map),"Error while writing Premium Summary data to excel ."+keyName);
                                                           }else if(ls.size()==0) {
                                                                  compareValues(Double.parseDouble(TestUtil.getStringfromMap("PS_"+sec_name_withoutSpace+"_CR",CommonFunction_VELA.businessEvent)),Double.parseDouble(CellValue),cHash.get(prem_col[j]));
                                                                  premSmryData.put("PS_"+sec_name_withoutSpace+"_"+cHash.get(prem_col[j]), CellValue);
                                                           }
                                                           keyName = "PS_"+sec_name_withoutSpace+"_"+cHash.get(prem_col[j-1]);
                                                           xpathVal = "//*[@id='"+coverlist.get(sec_name)+"_"+prem_col[j-1]+"']";
                                                           CellValue = driver.findElement(By.xpath(xpathVal)).getAttribute("value").replaceAll(",","");;
                                                           if(xlWrite){
                                                                  premSmryData.put("PS_"+sec_name_withoutSpace+"_"+cHash.get(prem_col[j-1]), CellValue);
                                                                  common.GrosspremSmryData.put("PS_"+sec_name_withoutSpace+"_"+cHash.get(prem_col[j-1]), CellValue);
                                                                  //customAssert.assertTrue(WriteDataToXl(code+"_"+event, "Premium Summary", testName, keyName, CellValue,common.NB_excel_data_map),"Error while writing Premium Summary data to excel ."+keyName);
                                                           }      
                                                    }else{
                                                           CellValue = driver.findElement(By.xpath(xpathVal)).getAttribute("value").replaceAll(",","");
                                                           if(xlWrite){
                                                                  premSmryData.put("PS_"+sec_name_withoutSpace+"_"+cHash.get(prem_col[j]), CellValue);
                                                                  //customAssert.assertTrue(WriteDataToXl(code+"_"+event, "Premium Summary", testName, keyName, CellValue,common.NB_excel_data_map),"Error while writing Premium Summary data to excel ."+keyName);
                                                           }else if(ls.size()==0){
                                                                  
                                                                  compareValues(Double.parseDouble(TestUtil.getStringfromMap(keyName,CommonFunction_VELA.businessEvent)),Double.parseDouble(CellValue),cHash.get(prem_col[j]));
                                                                  premSmryData.put("PS_"+sec_name_withoutSpace+"_"+cHash.get(prem_col[j]), CellValue);
                                                           }
                                                        keyName=null;
                                                        }
                                             }
                                                    //customAssert.assertTrue(WriteDataToXl(code+"_"+event, "Premium Summary", testName, "PS_Duration", customPolicyDuration,common.NB_excel_data_map),"Error while writing Policy Duration data to excel .");
                                             if(ls.size()==0){
                                                    PremiumSummarytableCalculation(premSmryData,sec_name_withoutSpace);}
                               }
                        }
                        
                  }else{
                        if(sec_name_withoutSpace.contains("Total")==false && xlWrite==true )
                        	if(((String)common.NB_excel_data_map.get("PS_InsuranceTaxButton")).equalsIgnoreCase("Yes")){
								TestUtil.WriteDataToXl(code+"_"+event, "Premium Summary",(String)common.NB_excel_data_map.get("Automation Key"), "PS_"+sec_name_withoutSpace+"_IPT", "00.00", common.NB_excel_data_map);
							}else{
								TestUtil.WriteDataToXl(code+"_"+event, "Premium Summary",(String)common.NB_excel_data_map.get("Automation Key"), "PS_"+sec_name_withoutSpace+"_IPT", TestUtil.getStringfromMap("PS_IPTRate",CommonFunction_VELA.businessEvent), common.NB_excel_data_map);
							}
                               
                               //System.out.print(sec_name+"\t\t\t");
                               TestUtil.reportStatus("---------------"+sec_name+"-----------------","Info",false);
                               for(int j=0;j<prem_col.length;j++){
                                      String xpathVal;
                                      xpathVal = "//*[@id='"+coverlist.get(sec_name)+"_"+prem_col[j]+"']";
                                      String keyName = "PS_"+sec_name_withoutSpace+"_"+cHash.get(prem_col[j]);
                                      
                                      if(coverlist.get(sec_name).equals("tot") && prem_col[j].equals("comm")){
                                             xpathVal = "//*[@id='"+coverlist.get(sec_name)+"_com']";
                                             CellValue = driver.findElement(By.xpath(xpathVal)).getAttribute("value").replaceAll(",","");;
                                             customAssert.assertTrue(WriteDataToXl(code+"_"+event, "Premium Summary", testName, keyName, CellValue,common.NB_excel_data_map),"Error while writing Premium Summary data to excel ."+keyName);
                                      }
                                      if(coverlist.get(sec_name).equals("tot") && prem_col[j].equals("comr")){
                                             System.out.print(" ___ \t ");
                                      }else if(prem_col[j].equals("comr") && (coverlist.get(sec_name).equals("tot"))==false){
                                             if(xlWrite){
                                                    k.scrollInViewByXpath(xpathVal);
                                                    driver.findElement(By.xpath(xpathVal)).click();
                                                    driver.findElement(By.xpath(xpathVal)).sendKeys(Keys.chord(Keys.CONTROL, "a"),TestUtil.getStringfromMap("PS_"+sec_name_withoutSpace+"_CR",CommonFunction_VELA.businessEvent));
                                                    driver.findElement(By.xpath(xpathVal)).sendKeys(Keys.TAB);
                                             }
                                             CellValue = driver.findElement(By.xpath(xpathVal)).getAttribute("value").replaceAll(",","");;
                                             if(xlWrite){
                                                    premSmryData.put("PS_"+sec_name_withoutSpace+"_"+cHash.get(prem_col[j]), CellValue);
                                                    //customAssert.assertTrue(WriteDataToXl(code+"_"+event, "Premium Summary", testName, keyName, CellValue,common.NB_excel_data_map),"Error while writing Premium Summary data to excel ."+keyName);
                                             }else if(ls.size()==0) {
                                                    compareValues(Double.parseDouble(TestUtil.getStringfromMap("PS_"+sec_name_withoutSpace+"_CR",CommonFunction_VELA.businessEvent)),Double.parseDouble(CellValue),cHash.get(prem_col[j]));
                                                    premSmryData.put("PS_"+sec_name_withoutSpace+"_"+cHash.get(prem_col[j]), CellValue);
                                             }
                                             keyName = "PS_"+sec_name_withoutSpace+"_"+cHash.get(prem_col[j-1]);
                                             xpathVal = "//*[@id='"+coverlist.get(sec_name)+"_"+prem_col[j-1]+"']";
                                             CellValue = driver.findElement(By.xpath(xpathVal)).getAttribute("value").replaceAll(",","");;
                                             if(xlWrite){
                                                    premSmryData.put("PS_"+sec_name_withoutSpace+"_"+cHash.get(prem_col[j-1]), CellValue);
                                                    common.GrosspremSmryData.put("PS_"+sec_name_withoutSpace+"_"+cHash.get(prem_col[j-1]), CellValue);
                                                    //customAssert.assertTrue(WriteDataToXl(code+"_"+event, "Premium Summary", testName, keyName, CellValue,common.NB_excel_data_map),"Error while writing Premium Summary data to excel ."+keyName);
                                             }      
                                      }else{
                                             CellValue = driver.findElement(By.xpath(xpathVal)).getAttribute("value").replaceAll(",","");
                                             if(xlWrite){
                                                    premSmryData.put("PS_"+sec_name_withoutSpace+"_"+cHash.get(prem_col[j]), CellValue);
                                                    //customAssert.assertTrue(WriteDataToXl(code+"_"+event, "Premium Summary", testName, keyName, CellValue,common.NB_excel_data_map),"Error while writing Premium Summary data to excel ."+keyName);
                                             }else if(ls.size()==0){
                                                    
                                                    compareValues(Double.parseDouble(TestUtil.getStringfromMap(keyName,"")),Double.parseDouble(CellValue),cHash.get(prem_col[j]));
                                                    premSmryData.put("PS_"+sec_name_withoutSpace+"_"+cHash.get(prem_col[j]), CellValue);
                                             }
                                          keyName=null;
                                          }
                               }
                                      //customAssert.assertTrue(WriteDataToXl(code+"_"+event, "Premium Summary", testName, "PS_Duration", customPolicyDuration,common.NB_excel_data_map),"Error while writing Policy Duration data to excel .");
                               if(ls.size()==0){
                                      PremiumSummarytableCalculation(premSmryData,sec_name_withoutSpace);}
                  }
                  
           }
           customAssert.assertTrue(k.Click("CCF_Btn_Save"), "Unable to click on Save Button on Premium Summary .");
           
            
            if(ls.size()>0){ 
            TransactionPremiumTable(rcount,coverlist,cHash,code,event,xlWrite);
           }else if(xlWrite){
                  Set<String> pKeys=premSmryData.keySet();
                        for(String pkey:pKeys){
                               customAssert.assertTrue(WriteDataToXl(code+"_"+event, "Premium Summary", testName,pkey,premSmryData.get(pkey) ,common.NB_excel_data_map),"Error while writing Premium Summary data to excel ."+pkey) ;
                        }
           }
           
           return true;
    }catch(Throwable t){
                  k.ImplicitWaitOn();
                  return false;
    }

}

public static void TransactionPremiumTable(int rcount, Hashtable<String,String> coverlist,Hashtable<String,String> cHash,String code, String event, boolean xlWrite){
	//Transaction Premium Table
		try{
			k.ImplicitWaitOff();
			
			String Trax_table = "html/body/div[3]/form/div/table[3]";
			String[] prem_col = {"gprem","comr","comm","nprem","gipt","nipt"};
			String testName = (String)common.NB_excel_data_map.get("Automation Key");
			List<WebElement> col=driver.findElements(By.xpath("html/body/div[3]/form/div/table[3]/tbody/tr[1]/td"));
			//System.out.println(col.size());
			int cCount = col.size();
			if(driver.findElement(By.xpath(Trax_table)).isDisplayed()){
				
				Hashtable<String,String> transSmryData = new Hashtable<String,String>();
				String tXpath =Trax_table+"/tbody/tr";
				String CellValue;
				//System.out.println("Transaction Premium Table exist on premium summary page");
				TestUtil.reportStatus("Transaction Premium Table exist on premium summary page", "Info", true);
				//System.out.println("Covers Found -:"+ (rcount-1));
				TestUtil.reportStatus("Covers Found -:"+ (rcount-1), "Info", false);
				
				for(int i =1;i<=rcount;i++){
					String sectionXpath = tXpath+"["+i+"]/td[1]";
					String sec_name = driver.findElement(By.xpath(sectionXpath)).getText();
					//System.out.print(sec_name+"\t\t\t");
					if(sec_name.contains("Frozen Food")){
						sec_name = "FrozenFoods";
					}else if(sec_name.contains("Licence")){
						sec_name = "LossOfLicence";
					}else if(sec_name.contains("Total")){
						sec_name = "Total";
						sec_name = "Total";
					}else{
						sec_name = sec_name.replaceAll(" ", "");
					}
					
					TestUtil.reportStatus("---------------"+sec_name+"-----------------","Info",false);
					
					for(int j = 2; j<=cCount;j++){
						//transSmryData
						String ColumnValues = tXpath+"["+i+"]/td["+j+"]";
						CellValue = driver.findElement(By.xpath(ColumnValues)).getText().replaceAll(",","");;
						//System.out.print(CellValue +  "\t");	
						//TestUtil.reportStatus(CellValue +  "\t", "Info", false);
						if(cHash.get(prem_col[j-2]).equalsIgnoreCase("CR") && sec_name.contains("Total"))
						{}else{
						transSmryData.put("PS_"+sec_name.replaceAll(" ", "")+"_"+cHash.get(prem_col[j-2]), CellValue);}
					}
					PremiumSummarytableCalculation(transSmryData,sec_name);
					//System.out.println("\n___");
				}
			
			// Writing Data to Excel Sheet from Map
				Set<String> pKeys=transSmryData.keySet();
			 	for(String pkey:pKeys){
			 		if(xlWrite){
			 			customAssert.assertTrue(WriteDataToXl(code+"_"+event, "Premium Summary", testName,pkey,transSmryData.get(pkey) ,common.NB_excel_data_map),"Error while writing Premium Summary data to excel ."+pkey) ;
			 		}else{
			 			compareValues(Double.parseDouble(transSmryData.get(pkey)), Double.parseDouble(TestUtil.getStringfromMap(transSmryData.get(pkey),"")), pkey);
			 		}
			 	}
			}
		}
		catch(Throwable t ){
			k.ImplicitWaitOn();
			System.out.println("--"); 
		}
		
		//System.out.println("Gross Premium for Material Damage Cover in Transaction Premium table is :"+transSmryData.get("MaterialDamage_gprem"));
		 TestUtil.reportStatus("Values have been stored from Transaction Premium table", "info", true);
}

	public static void TransactionDetailsTable(Hashtable<String,String> cHash,String code, String event, boolean xlWrite){
		//Transaction Premium Table
			try{
				k.ImplicitWaitOff();
				List<WebElement> row = driver.findElements(By.xpath("html/body/div[3]/form/div/table[4]/tbody/tr"));
				//System.out.println(row.size());
				int rcount1 = row.size();
				String Trax_table = "html/body/div[3]/form/div/table[4]";
				String[] prem_col = {"gprem","comr","comm","nprem","gipt","nipt"};
				String testName = (String)common.MTA_excel_data_map.get("Automation Key");
				List<WebElement> col=driver.findElements(By.xpath("html/body/div[3]/form/div/table[4]/tbody/tr[1]/td"));
				//System.out.println(col.size());
				int cCount = col.size();
				if(driver.findElement(By.xpath(Trax_table)).isDisplayed()){
					
					Hashtable<String,String> transSmryData = new Hashtable<String,String>();
					String tXpath =Trax_table+"/tbody/tr";
					String CellValue;
					//System.out.println("Transaction Premium Table exist on premium summary page");
					TestUtil.reportStatus("Transaction Details Table exist on premium summary page", "Info", true);
					//System.out.println("Covers Found -:"+ (rcount-1));
					TestUtil.reportStatus("Covers Found -:"+ (rcount1-1), "Info", false);
					
					for(int i =1;i<=rcount1;i++){
						String sectionXpath = tXpath+"["+i+"]/td[1]";
						String sec_name = driver.findElement(By.xpath(sectionXpath)).getText();
						//System.out.print(sec_name+"\t\t\t");
						if(sec_name.contains("Frozen Food")){
							sec_name = "FrozenFoods";
						}else if(sec_name.contains("Licence")){
							sec_name = "LossOfLicence";
						}else if(sec_name.contains("Total")){
							sec_name = "Total";
							sec_name = "Total";
						}else{
							sec_name = sec_name.replaceAll(" ", "");
						}
						
						TestUtil.reportStatus("---------------"+sec_name+"-----------------","Info",false);
						
						for(int j = 2; j<=cCount;j++){
							//transSmryData
							String ColumnValues = tXpath+"["+i+"]/td["+j+"]";
							CellValue = driver.findElement(By.xpath(ColumnValues)).getText().replaceAll(",","");;
							//System.out.print(CellValue +  "\t");	
							//TestUtil.reportStatus(CellValue +  "\t", "Info", false);
							if(cHash.get(prem_col[j-2]).equalsIgnoreCase("CR") && sec_name.contains("Total"))
							{
								
							}else{
							transSmryData.put("PS_"+sec_name.replaceAll(" ", "")+"_"+cHash.get(prem_col[j-2]), CellValue);}
						}
						PremiumSummarytableCalculation(transSmryData,sec_name);
						//System.out.println("\n___");
					}
				
				// Writing Data to Excel Sheet from Map
					Set<String> pKeys=transSmryData.keySet();
				 	for(String pkey:pKeys){
				 		if(xlWrite){
				 			customAssert.assertTrue(WriteDataToXl(code+"_"+event, "Premium Summary", testName,pkey,transSmryData.get(pkey) ,common.MTA_excel_data_map),"Error while writing Premium Summary data to excel ."+pkey) ;
				 		}else{
				 			compareValues(Double.parseDouble(transSmryData.get(pkey)), Double.parseDouble(TestUtil.getStringfromMap(transSmryData.get(pkey),"")), pkey);
				 		}
				 	}
				}
			}
			catch(Throwable t ){
				k.ImplicitWaitOn();
				System.out.println("--"); 
			}
			
			//System.out.println("Gross Premium for Material Damage Cover in Transaction Premium table is :"+transSmryData.get("MaterialDamage_gprem"));
			 TestUtil.reportStatus("Values have been stored from Transaction Details table", "info", true);
	}
		

	public void TransactionDetailsTableCOB(Map<String,String> cHash,Map<String,String> locator_map,String SectionName, String event ){
		//Transaction Premium Table
			try{
				k.ImplicitWaitOff();
				List<WebElement> row = driver.findElements(By.xpath("html/body/div[3]/form/div/table[4]/tbody/tr"));
				//System.out.println(row.size());
				int rcount1 = row.size();
				String Trax_table = "html/body/div[3]/form/div/table[4]";
				String[] prem_col = {"gprem","comr","comm","nprem","gipt","nipt"};
				String testName = (String)common.MTA_excel_data_map.get("Automation Key");
				List<WebElement> col=driver.findElements(By.xpath("html/body/div[3]/form/div/table[4]/tbody/tr[1]/td"));
				//System.out.println(col.size());
				int cCount = col.size();
				if(driver.findElement(By.xpath(Trax_table)).isDisplayed()){
					
					Hashtable<String,String> transSmryData = new Hashtable<String,String>();
					String tXpath =Trax_table+"/tbody/tr";
					String CellValue;
					//System.out.println("Transaction Premium Table exist on premium summary page");
					TestUtil.reportStatus("Transaction Details Table exist on premium summary page", "Info", true);
					//System.out.println("Covers Found -:"+ (rcount-1));
					TestUtil.reportStatus("Covers Found -:"+ (rcount1-1), "Info", false);
					
					for(int i =1;i<=rcount1;i++){
						String sectionXpath = tXpath+"["+i+"]/td[1]";
						String sec_name = driver.findElement(By.xpath(sectionXpath)).getText();
						//System.out.print(sec_name+"\t\t\t");
						if(sec_name.contains("AbbeyLegalExpenses")){
							sec_name = "LegalExpenses";}
						else if(sec_name.contains("Totals")){
							sec_name = "Total";}
						else{
							sec_name = sec_name.replaceAll(" ", "");
						}
						
						TestUtil.reportStatus("---------------"+sec_name+"-----------------","Info",false);
						
						for(int j = 2; j<=cCount;j++){
							//transSmryData
							String ColumnValues = tXpath+"["+i+"]/td["+j+"]";
							CellValue = driver.findElement(By.xpath(ColumnValues)).getText().replaceAll(",","");;
							//System.out.print(CellValue +  "\t");	
							//TestUtil.reportStatus(CellValue +  "\t", "Info", false);
//							if(cHash.get(prem_col[j-2]).equalsIgnoreCase("CR") && sec_name.contains("Total"))
//							{
//								
//							}else{
//							transSmryData.put("PS_"+sec_name.replaceAll(" ", "")+"_"+cHash.get(prem_col[j-2]), CellValue);}
						}
						tran_err_count = tran_err_count + func_PremiumSummaryCalculation(cHash.get(sec_name),sec_name,locator_map);
					//	PremiumSummarytableCalculation(transSmryData,sec_name);
						//System.out.println("\n___");
					}
				
//				// Writing Data to Excel Sheet from Map
//					Set<String> pKeys=transSmryData.keySet();
//				 	for(String pkey:pKeys){
//				 		if(xlWrite){
//				 			customAssert.assertTrue(WriteDataToXl(code+"_"+event, "Premium Summary", testName,pkey,transSmryData.get(pkey) ,common.MTA_excel_data_map),"Error while writing Premium Summary data to excel ."+pkey) ;
//				 		}else{
//				 			compareValues(Double.parseDouble(transSmryData.get(pkey)), Double.parseDouble(TestUtil.getStringfromMap(transSmryData.get(pkey),"")), pkey);
//				 		}
//				 	}
				}
			}
			catch(Throwable t ){
				k.ImplicitWaitOn();
				System.out.println("--"); 
			}
			
			//System.out.println("Gross Premium for Material Damage Cover in Transaction Premium table is :"+transSmryData.get("MaterialDamage_gprem"));
			 TestUtil.reportStatus("Values have been stored from Transaction Details table", "info", true);
	}
    /*
     * ------------------------------------------------------------
     * PDF Verification Handling function. START
     * ------------------------------------------------------------
     */
		 
	public boolean funcPDFdocumentVerification(String docType){
		boolean retvalue = true;
		int doc_fail_count = 0;
		err_count=0;
		Map<Object,Object> data_map = null;
		if(common.currentRunningFlow.equals("NB")){
			data_map = common.NB_excel_data_map;}
		else if(common.currentRunningFlow.equals("MTA")){
			data_map = common.MTA_excel_data_map;
		}else if(common.currentRunningFlow.equals("Renewal")){
			data_map = common.Renewal_excel_data_map;
		}else if(common.currentRunningFlow.equals("Rewind")){
			data_map = common.Rewind_excel_data_map;
		}else if(common.currentRunningFlow.equals("Requote")){
			data_map = common.Requote_excel_data_map;
		}
		
		
		try{
			if(((String)data_map.get("DocumentVerification")).equals("No")){
				TestUtil.reportStatus("<b> PDF document verification is 'No' hence skipped verification . ", "Info", false);
				TestUtil.reportStatus("<b> Total count of document verification is : [ 0 ]</b>", "Info", false);
			}else{
				customAssert.assertTrue(common.funcButtonSelection(docType) , "Unable to click on <b>[  "+docType+"  ]</b>.");
					doc_fail_count = doc_fail_count + iteratePDFDocuments(docType);
					customAssert.SoftAssertEquals(doc_fail_count, 0,"Verification failure in "+docType);
					final_err_pdf_count = final_err_pdf_count + doc_fail_count;
					TestUtil.reportStatus(docType+" verification is Completed .", "Info", true);
					customAssert.assertTrue(k.Click("Tax_adj_BackBtn"), "Unable to click on back button.");
			}
			
			
			return retvalue;
		}
		catch(Throwable t) {
            String methodName = new Object(){}.getClass().getEnclosingMethod().getName();
            TestUtil.reportFunctionFailed("Failed in "+methodName+" function");
            Assert.fail("Unable to do verification for documents. \n", t);
            return false;
		}
		
	}
				
	/*
	 * PDF verification related functions:
	 * 
	 *  @Param docType - Either "Draft Documents" OR "Documents"
	 *  @Variable o - Number of documents
	 *  @Variable count - Documents data verification failure count
	 *  @Variable counter - incremental count for downloading same file (Used in PDFFileHandling method)
	 */
	
	public int iteratePDFDocuments(String docType) throws ParseException, IOException, InterruptedException{
		try{
			List<WebElement> l_row = driver.findElements(By.xpath("html/body/div[3]/form/div/div[2]/table/tbody/tr/td/a/span"));
			int row_size = l_row.size();
			
			Map<Object,Object> data_map = null;
			switch(common.currentRunningFlow){
				case "NB":
					data_map = common.NB_excel_data_map;
					break;
				case "MTA":					
					data_map = common.MTA_excel_data_map;
					break;
				case "Renewal":
					data_map = common.Renewal_excel_data_map;
					break;
				case "Requote":
					data_map = common.Requote_excel_data_map;
					break;
				case "Rewind":
					data_map = common.Rewind_excel_data_map;
					break;
			}
			
			if(row_size>0){
				for(int r=0;r<row_size;r++){
					String doc_name = l_row.get(r).getText();			
					if((String)data_map.get("pdf_"+doc_name)!=null && ((String)data_map.get("pdf_"+doc_name)).equals("Yes")){
						l_row.get(r).click();
						Thread.sleep(15000);
						TestUtil.reportStatus("Document -"+doc_name+" is present.", "info", true);
						if(CONFIG.get("PDFVerificationWithoutDownload").equals("Y")){
							counter = 0;
							pdf_count++;
							err_count = err_count + PDFFileHandling(doc_name,docType,data_map);
						}else{
						   driver.findElement(By.xpath("//*[@id='mainpanel']/div[3]/object")).click();
						   Actions action = new Actions(driver);
				           
						   action.keyDown(Keys.CONTROL).sendKeys("a").keyUp(Keys.CONTROL).perform();
						   action.keyDown(Keys.CONTROL).sendKeys("c").keyUp(Keys.CONTROL).perform();
						   
						   String PDFPath= workDir+"\\src\\com\\selenium\\database\\xls";
						   String fileName = TestBase.product+"_"+common.currentRunningFlow;
						   FileInputStream fis = new FileInputStream(new File(PDFPath+"\\"+fileName+".xlsx"));
						   
						   err_count = err_count + PDFDataVerification(fis,doc_name,docType);
							
						}
						
						l_row = driver.findElements(By.xpath("html/body/div[3]/form/div/div[2]/table/tbody/tr"));
					}else{
						continue;
					}
				}
			}
			TestUtil.reportStatus("Total count of <b>[  "+docType+" is : "+pdf_count+"  ]</b>", "Info", false);
			}catch(Throwable t)
			{
				String methodName = new Object(){}.getClass().getEnclosingMethod().getName();
				TestUtil.reportFunctionFailed("Failed in "+methodName+" function");   
				TestUtil.reportStatus("<p style='color:red'> Error in iteratePDFDocuments Method </p>", "Fail", true);
			 	return 1;
			}
			return err_count;
	}
			
public String downloadPDF(String code,String fileName , Map<Object, Object> data_map,String docType) throws InterruptedException, IOException {
	    
	    String timeStamp = new SimpleDateFormat("ddMMyyyyHHmmss", Locale.US).format(new Date());
	    try{
	     
	    	WebDriverWait wait = new WebDriverWait(driver, 50); 
	    	WebElement menuItem = wait.until(ExpectedConditions.presenceOfElementLocated(By.xpath("//*[@id='mainpanel']/div[3]/object")));  // until this submenu is found
	     
		     if(menuItem!=null && menuItem.isDisplayed()){
		           
		           driver.findElement(By.xpath("//*[@id='mainpanel']/div[3]/object")).click();
		           Actions action = new Actions(driver);
		           Thread.sleep(10000);
		           action.keyDown(Keys.SHIFT).sendKeys(Keys.TAB).keyUp(Keys.SHIFT).perform();
		           action.keyDown(Keys.SHIFT).sendKeys(Keys.TAB).keyUp(Keys.SHIFT).perform();
		           action.keyDown(Keys.SHIFT).sendKeys(Keys.TAB).keyUp(Keys.SHIFT).perform();
		           action.keyDown(Keys.SHIFT).sendKeys(Keys.TAB).keyUp(Keys.SHIFT).perform();
		           action.keyDown(Keys.SHIFT).sendKeys(Keys.TAB).keyUp(Keys.SHIFT).perform();
		           action.sendKeys(Keys.ENTER).perform();
		           k.waitTenSeconds();
		           
		           String policyNumber = "";
		           
		           switch (docType) {
				   		case "Draft Documents":
				   			policyNumber = (String)data_map.get(common.currentRunningFlow+"_QuoteNumber");
						break;
				   		case "Documents":
				   			policyNumber = (String)data_map.get(common.currentRunningFlow+"_PolicyNumber");
						break;
		
					}
		           
		           String formatPolicyNumber = policyNumber.replaceAll("/", "-");
		           
		           //String fileCode = code+"_"+fileName+"_"+timeStamp;
		           String fileCode = formatPolicyNumber+"_"+docType+"_"+fileName+"_"+timeStamp;
		           //System.out.println(workDir+"\\src\\com\\selenium\\Execution_Report\\Report\\PDF\\"+code+"\\"+TestBase.businessEvent+"\\"+fileCode);

		           String[] parms = {"wscript", workDir+"\\src\\BatFiles\\CloseDialog.vbs", workDir+"\\src\\com\\selenium\\Execution_Report\\Report\\PDF\\"+code+"\\"+TestBase.businessEvent+"\\"+fileCode};
		           Runtime.getRuntime().exec(parms);
		           return fileCode;
		     }else{
		           
		           return "";
		     }
	    }catch(Exception e){
	           String methodName = new Object(){}.getClass().getEnclosingMethod().getName();
	           TestUtil.reportFunctionFailed("Failed in "+methodName+" function");    
	           TestUtil.reportStatus("<p style='color:red'> PDF Document is not visible for download </p>", "Fail", true);
	           return "";
	    }
	}
	
	public int PDFFileHandling(String fileName,String docType,Map<Object, Object> data_map) throws IOException, ParseException, InterruptedException{
		String file_Name=null;
		String PDFCodePath = null;
		String PDFEventPath = null;
		String fileCode=null;
		int dataVerificationFailureCount = 0;
		String code = CommonFunction_VELA.product;
		try{
			//TestUtil.reportStatus(fileName+" document verification is started for product - [<b>"+code+"</b>] ", "Info", false);
			String PDFPath= workDir+"\\src\\com\\selenium\\Execution_Report\\Report\\PDF";
			PDFCodePath = PDFPath+"\\"+code/*+"\\"+TestBase.businessEvent*/;
			PDFEventPath = PDFCodePath+"\\"+TestBase.businessEvent;
			File pdfFldr = new File(PDFPath);
			File pdfCodeFldr=new File(PDFCodePath);
			File pdfCodeFldr1=new File(PDFCodePath+"\\"+TestBase.businessEvent);

			if(!pdfFldr.exists() && !pdfFldr.isDirectory()){
				pdfFldr.mkdir();
				}
			if(!pdfCodeFldr.exists() && !pdfCodeFldr.isDirectory()){
				pdfCodeFldr.mkdir();
				
			}
			if(!pdfCodeFldr1.exists() && !pdfCodeFldr1.isDirectory()){
				pdfCodeFldr1.mkdir();
				
			}
			
			fileCode = downloadPDF(code,fileName,data_map,docType);
			Thread.sleep(4000);
			file_Name = PDFEventPath+"\\"+fileCode+".pdf";
			//System.out.println(file_Name);
				
			File file = new File(file_Name);
			FileInputStream fis = new FileInputStream(file);
			TestUtil.reportStatus(fileName+" file is downloaded to the specified folder and ready for verification.", "Info", false);
			
			dataVerificationFailureCount = dataVerificationFailureCount + PDFDataVerification(fis,fileName,docType);
			TestUtil.reportStatus("<b> Total count of document verification is : [ "+pdf_count+" ]</b>", "Info", false);
			
			}
			
			// Below code will handle PDF failure up to 3 chance.
			catch(FileNotFoundException fnf)
			{
				
				if(counter==3){
					TestUtil.reportStatus("<b>Due to some reason , Not able to downalod -[  "+fileName+"  ]. 3 times tried to download his file .</b>", "Info", false);
				}else{
					counter++;
					TestUtil.reportStatus("Due to some reason , Not able to downalod - "+fileName+" . Retried downloading.", "Info", false);
					PDFFileHandling(fileName,docType,data_map);
				}
			return 0;
			}
			catch(NullPointerException npe)
			{
						TestUtil.reportStatus("Data Issue while verification . ", "Fail", false);
						return 1;
			}
			catch(Exception ex)
			{
				if(counter==3){
					TestUtil.reportStatus("<b>Due to some reason , Not able to downalod -[  "+fileName+"  ]. 3 times tried to download his file .</b>", "Info", false);
			}else{
				counter++;
				TestUtil.reportStatus("Due to some reason , Not able to downalod - "+fileName+" . Retried downloading.", "Info", false);
				PDFFileHandling(fileName,docType,data_map);
			}
		    return 0;
			}
		
		customAssert.assertTrue(fileDeletion(PDFCodePath) , "Unable to delete extra pdf files from folder : "+PDFCodePath);
		
		return dataVerificationFailureCount;
			
	}
			
	/**
	 * @param fis - Downloaded file referance
	 * @param fileName - e.g. Policy Schedule
	 * @param docType - Draft Documents/Documents
	 * @throws UnsupportedFlavorException 
	 */
	
@SuppressWarnings("rawtypes")
public int PDFDataVerification(FileInputStream fis,String fileName,String docType) throws IOException, ParseException, InterruptedException, UnsupportedFlavorException {
		
	String parsedText=null;
	Map<Object,Object> mdata =  null;
	Map<Object,Object> mdata_for_Cover =  null;
	int fail_count=0;
	
		if(CONFIG.get("PDFVerificationWithoutDownload").equals("Y")){
			
			PDFParser parser = new PDFParser(fis);
			parser.parse();
			COSDocument cosDoc = parser.getDocument();
		    PDDocument pdDoc = new PDDocument(cosDoc);
		    PDFTextStripper pdfStripper = new PDFTextStripper();
		    
			parsedText = pdfStripper.getText(pdDoc);
			int count = pdDoc.getNumberOfPages();
			pdfStripper.setStartPage(1);
			pdfStripper.setEndPage(count);
			
		}else{
			   Toolkit toolkit = Toolkit.getDefaultToolkit();
			   Clipboard clipboard = toolkit.getSystemClipboard();
			   String result = (String) clipboard.getData(DataFlavor.stringFlavor);
			   
			   parsedText = result;
			   
		}
		
		double FP = 0.0;
		
		switch (common.currentRunningFlow) {
			case "Renewal":
				mdata = common.Renewal_excel_data_map;
			break;
			case "Rewind":
				mdata = common.Rewind_excel_data_map;
			break;
			case "Requote":
				mdata = common.Requote_excel_data_map;
			break;
			default:
				mdata=common.NB_excel_data_map;
			break;
		
		}
		
		
		//System.out.println(parsedText);
		switch(fileName){
		
			case "Policy Schedule":
				
				DecimalFormat formatter = new DecimalFormat("#,###,###.##");
				int incrementalDays = Integer.parseInt(CONFIG.getProperty("DaysIncrementNumber"));
				int policyDuration =00;
				if(TestBase.businessEvent.equals("Renewal")){
					 policyDuration = Integer.parseInt((String)common.Renewal_excel_data_map.get("PS_Duration"));
				}else{
				    policyDuration = Integer.parseInt((String)mdata.get("PS_Duration"));
				}
				fail_count=0;
						
				if(docType.contains("Draft")){
					fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("QUOTATION SCHEDULE"), "Document : QUOTATION SCHEDULE", fileName);
				}else{
					fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("POLICY SCHEDULE"), "Document : POLICY SCHEDULE", fileName);
				}
				if(TestBase.businessEvent.equals("Renewal")){
					fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("INSURED NAME - "+(String)common.Renewal_excel_data_map.get("Renewal_ClientName")), "Insured Name : "+(String)common.Renewal_excel_data_map.get("Renewal_ClientName") , fileName);
				}else{
					fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("INSURED NAME - "+(String)common.NB_excel_data_map.get("NB_ClientName")), "Insured Name : "+(String)common.NB_excel_data_map.get("NB_ClientName") , fileName);
				}
				if(TestBase.businessEvent.equals("Renewal")){
					fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains((String)common.Renewal_excel_data_map.get("QC_AgencyName")), "BROKER NAME - "+(String)common.Renewal_excel_data_map.get("QC_AgencyName") , fileName);
				}else{
					fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains((String)common.NB_excel_data_map.get("QC_AgencyName")), "BROKER NAME - "+(String)common.NB_excel_data_map.get("QC_AgencyName") , fileName);
				}
				
				if(docType.contains("Draft")){
					if(!(TestBase.businessEvent.equals("Renewal"))){
						fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("Quote Reference: "+(String)mdata.get("NB_QuoteNumber")) ,"Quote Reference : "+mdata.get("NB_QuoteNumber"),fileName);
						fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("Quotation Date: "+common.daysIncrement((String)mdata.get("QuoteDate"), -incrementalDays)) ,"Quote Date : "+common.daysIncrement((String)mdata.get("QuoteDate"), -incrementalDays),fileName);
					}else{
						fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("Quote Reference: "+(String)common.Renewal_excel_data_map.get("Renewal_QuoteNumber")) ,"Quote Reference : "+common.Renewal_excel_data_map.get("Renewal_QuoteNumber"),fileName);
					}
				}else{
			/*change*/	if(!(TestBase.businessEvent.equals("Renewal"))){
						fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("Policy Number: "+(String)common.NB_excel_data_map.get("NB_PolicyNumber")) ,"Policy Number : "+common.NB_excel_data_map.get("NB_PolicyNumber"),fileName);
					}else{
						
						fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("Policy Number: "+(String)common.Renewal_excel_data_map.get("Renewal_PolicyNumber")) ,"Policy Number : "+common.Renewal_excel_data_map.get("Renewal_PolicyNumber"),fileName);
					}
					if(TestBase.businessEvent.equals("Renewal")){
						if(((String)common.Renewal_excel_data_map.get("PS_DefaultStartEndDate")).equals("No")){
							if(common.currentRunningFlow.equals("MTA")){
								fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("Effective Date: "+common.daysIncrement((String)common.MTA_excel_data_map.get("MTA_EffectiveDate"), 0)) ,"Effective Date : "+common.daysIncrement((String)common.MTA_excel_data_map.get("MTA_EffectiveDate"),0),fileName);
							}else {
								fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("Effective Date: "+common.daysIncrement((String)common.Renewal_excel_data_map.get("PS_PolicyStartDate"), 0)) ,"Effective Date : "+common.daysIncrement((String)common.Renewal_excel_data_map.get("PS_PolicyStartDate"), 0),fileName);
									
							}
						}else{
							if(common.currentRunningFlow.equals("MTA")){
								fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("Effective Date: "+common.daysIncrement((String)common.MTA_excel_data_map.get("MTA_EffectiveDate"), 0)) ,"Effective Date : "+common.daysIncrement((String)common.MTA_excel_data_map.get("MTA_EffectiveDate"),0),fileName);
							}else {
								fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("Effective Date: "+common.daysIncrement((String)common.Renewal_excel_data_map.get("PS_PolicyStartDate"), 0)) ,"Effective Date : "+common.daysIncrement((String)common.Renewal_excel_data_map.get("PS_PolicyStartDate"), 0),fileName);
								
						}
						}	
					}else{
						if(((String)mdata.get("PS_DefaultStartEndDate")).equals("No")){
							if(common.currentRunningFlow.equals("MTA")||(TestBase.businessEvent.equals("MTA")&&common.currentRunningFlow.equals("Rewind"))){
								fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("Effective Date: "+common.daysIncrement((String)common.MTA_excel_data_map.get("MTA_EffectiveDate"), 0)) ,"Effective Date : "+common.daysIncrement((String)common.MTA_excel_data_map.get("MTA_EffectiveDate"),0),fileName);
							}else{
								
								fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("Effective Date: "+common.daysIncrement((String)common.NB_excel_data_map.get("PS_PolicyStartDate"), 0)) ,"Effective Date : "+common.daysIncrement((String)common.NB_excel_data_map.get("PS_PolicyStartDate"), 0),fileName);
							}
						}else{
							if(common.currentRunningFlow.equals("MTA")||(TestBase.businessEvent.equals("MTA")&&common.currentRunningFlow.equals("Rewind"))){
								fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("Effective Date: "+common.daysIncrement((String)common.MTA_excel_data_map.get("MTA_EffectiveDate"), 0)) ,"Effective Date : "+common.daysIncrement((String)common.MTA_excel_data_map.get("MTA_EffectiveDate"),0),fileName);
							}else{
								fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("Effective Date: "+common.daysIncrement((String)common.NB_excel_data_map.get("PS_PolicyStartDate"), 0)) ,"Effective Date : "+common.daysIncrement((String)common.NB_excel_data_map.get("PS_PolicyStartDate"), 0),fileName);
							}
						}
						
					}
					
				}
				if(!(common.currentRunningFlow.equals("Renewal")||(TestBase.businessEvent.equals("Renewal")&&common.currentRunningFlow.equals("Rewind"))||(TestBase.businessEvent.equals("Renewal")&&common.currentRunningFlow.equals("MTA")))){
					if(TestBase.product.equalsIgnoreCase("LEA")){
						if(((String)mdata.get("PS_DefaultStartEndDate")).equals("No")){
							//fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("Period of insurance: From: "+common.daysIncrement((String)mdata.get("QC_InceptionDate"), 0)), "Insurance Start date : "+common.daysIncrement((String)mdata.get("QC_InceptionDate"), 0) , fileName);
							//Syntax in Doc is bit different hence commented.
							//fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("To:     "+common.daysIncrement((String)mdata.get("PS_PolicyStartDate"), policyDuration-1)), "Insurance End date :  "+common.daysIncrement((String)mdata.get("PS_PolicyStartDate"), policyDuration-1) , fileName);
						}else{
							//fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("Period of insurance: From: "+common.daysIncrement((String)mdata.get("QC_InceptionDate"), 0)), "Insurance Start date : "+common.daysIncrement((String)mdata.get("QC_InceptionDate"), 0) , fileName);
							//Syntax in Doc is bit different hence commented.
							//fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("To:     "+common.daysIncrement((String)mdata.get("QC_InceptionDate"), policyDuration-1)), "Renewal Date: "+common.daysIncrement((String)mdata.get("QC_InceptionDate"), policyDuration-1) , fileName);
			
						}
					}else{
						if(((String)mdata.get("PS_DefaultStartEndDate")).equals("No")){
							//fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("Period of Insurance: From: "+common.daysIncrement((String)mdata.get("QC_InceptionDate"), 0)), "Insurance Start date : "+common.daysIncrement((String)mdata.get("QC_InceptionDate"), 0) , fileName);
							//fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("To: "+common.daysIncrement((String)mdata.get("QC_InceptionDate"), policyDuration-1)), "Insurance End date :  "+common.daysIncrement((String)mdata.get("QC_InceptionDate"), policyDuration-1) , fileName);
						}else{
							//fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("Period of Insurance: From: "+common.daysIncrement((String)mdata.get("QC_InceptionDate"), 0)), "Insurance Start date : "+common.daysIncrement((String)mdata.get("QC_InceptionDate"), 0) , fileName);
							//fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("To: "+common.daysIncrement((String)mdata.get("QC_InceptionDate"), policyDuration-1)), "Renewal Date: "+common.daysIncrement((String)mdata.get("QC_InceptionDate"), policyDuration-1) , fileName);
			
						}
					}
					
				}
				
				switch (CommonFunction_VELA.product) {
				case "COA":
					if(common.currentRunningFlow.contains("MTA")){
						mdata= common.MTA_excel_data_map;
					}else if(common.currentRunningFlow.contains("CAN")){
						mdata= common.CAN_excel_data_map;
					}else if(common.currentRunningFlow.contains("Rewind")){
						mdata= common.Rewind_excel_data_map;
					}else if(common.currentRunningFlow.contains("Renewal")){
						mdata= common.Renewal_excel_data_map;
					}else{
						mdata= common.NB_excel_data_map;
					}
					
					
					if(((String)mdata.get("CD_EmployersLiability")).equals("Yes")){
						fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("Employers Liability Operative"), "Employers Liability Operative" , fileName);
						fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("EMPLOYERS LIABILITY SECTION"), "EMPLOYERS LIABILITY SECTION" , fileName);
						String EL_LOI = (String)mdata.get("EL_LOI");
						double GP = 0.0;
						
						if(common.currentRunningFlow.contains("MTA") && TestBase.businessEvent.equalsIgnoreCase("MTA") ||
								common.currentRunningFlow.contains("Rewind") && TestBase.businessEvent.equalsIgnoreCase("MTA")){
							
							if(common_VELA.transaction_Details_Premium_Values.get("Employers Liability_FP")==null){
								FP = 0.0;
							}else{
								FP = common_VELA.transaction_Details_Premium_Values.get("Employers Liability_FP").get("Gross Premium");
							}
							GP = common_VELA.transaction_Details_Premium_Values.get("Employers Liability").get("Gross Premium") + FP;
							
						}else if(!((String)mdata.get("PS_Duration")).equalsIgnoreCase("365")){
							GP = common_VELA.transaction_Premium_Values.get("Employers Liability").get("Gross Premium");
						}else{
							GP = Double.parseDouble((String)mdata.get("PS_EmployersLiability_GP"));
						}
						
						/*if(!((String)mdata.get("PS_Duration")).equalsIgnoreCase("365")){
							GP = transaction_Premium_Values.get("Employers Liability").get("Gross Premium");
						}else{
							GP = Double.parseDouble((String)mdata.get("PS_EmployersLiability_GP"));
						}*/
						
						String Section_Pemium =  common.getWholeNumber(GP);
						
						//String Section_Pemium =  formatter.format((int) Math.floor(Double.parseDouble((String)mdata.get("PS_EmployersLiability_GP"))));
						fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("Section Premium "+Section_Pemium), "Section Premium  "+Section_Pemium, fileName);				
						fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("Limit of Indemnity - Any One Occurrence "+EL_LOI), "Limit of Indemnity - Any One Occurrence "+EL_LOI , fileName);
//						double rate = funcRateCalculatorPDF("Employers Liability",(String)mdata.get("EL_LOI"));
//						fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains(Double.toString(rate)), Double.toString(rate), fileName);
						
					}else{
						fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("Employers Liability Not Operative"), "Employers Liability Not Operative" , fileName);
					}
					
					if(((String)mdata.get("CD_Public&ProductsLiability")).equals("Yes")){
						fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("PUBLIC AND PRODUCTS LIABILITY SECTION"), "PUBLIC AND PRODUCTS LIABILITY SECTION" , fileName);
						fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("Public & Products Liability Operative"), "APPENDIX TO LIABILITY SECTION" , fileName);
						String PPL_LOI = (String)mdata.get("PPL_LOI_PPLiability");
						
						double GP = 0.0;
						
						if(common.currentRunningFlow.contains("MTA") && TestBase.businessEvent.equalsIgnoreCase("MTA") ||
								common.currentRunningFlow.contains("Rewind") && TestBase.businessEvent.equalsIgnoreCase("MTA")){
							
							if(common_VELA.transaction_Details_Premium_Values.get("Public & Products Liability_FP")==null){
								FP = 0.0;
							}else{
								FP = common_VELA.transaction_Details_Premium_Values.get("Public & Products Liability_FP").get("Gross Premium");
							}
							
							GP = common_VELA.transaction_Details_Premium_Values.get("Public & Products Liability").get("Gross Premium") + FP;
						}else if(!((String)mdata.get("PS_Duration")).equalsIgnoreCase("365")){
							GP = common_VELA.transaction_Premium_Values.get("Public & Products Liability").get("Gross Premium");
						}else{
							GP = Double.parseDouble((String)mdata.get("PS_Public&ProductsLiability_GP"));
						}
						
						/*if(!((String)mdata.get("PS_Duration")).equalsIgnoreCase("365")){
							GP = transaction_Premium_Values.get("Public & Products Liability").get("Gross Premium");
						}else{
							GP = Double.parseDouble((String)mdata.get("PS_Public&ProductsLiability_GP"));
						}*/
						
						String Section_Pemium =  common.getWholeNumber(GP);
						
						fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("Section Premium "+Section_Pemium), "Section Premium  "+Section_Pemium, fileName);				
						fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("Limit of Indemnity Any One Occurrence for all claims other than arising out of Pollution "+PPL_LOI), "Limit of Indemnity Any One Occurrence for all claims other than arising out of Pollution "+PPL_LOI , fileName);
						
					}else{
						fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("Public & Products Liability Not Operative"), "Public & Products Liability Not Operative" , fileName);
					}
					
					if(((String)mdata.get("CD_AnnualWorks")).equals("Yes")){
						fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("Contract Works Operative"), "Contract Works Operative" , fileName);
						fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("CONTRACT WORKS SECTION"), "CONTRACT WORKS SECTION" , fileName);
						String AW_LOI = (String)mdata.get("AW_LOI");
						fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("Limit of Indemnity - Any One Occurrence "+AW_LOI), "Limit of Indemnity - Any One Occurrence "+AW_LOI , fileName);
						
						double GP = 0.0;
						
						
						if(common.currentRunningFlow.contains("MTA") && TestBase.businessEvent.equalsIgnoreCase("MTA") ||
								common.currentRunningFlow.contains("Rewind") && TestBase.businessEvent.equalsIgnoreCase("MTA")){
							
							if(common_VELA.transaction_Details_Premium_Values.get("Annual Works_FP")==null){
								FP = 0.0;
							}else{
								FP = common_VELA.transaction_Details_Premium_Values.get("Annual Works_FP").get("Gross Premium");
							}
							
							GP = common_VELA.transaction_Details_Premium_Values.get("Annual Works").get("Gross Premium") + FP;
						}else if(!((String)mdata.get("PS_Duration")).equalsIgnoreCase("365")){
							GP = common_VELA.transaction_Premium_Values.get("Annual Works").get("Gross Premium");
						}else{
							GP = Double.parseDouble((String)mdata.get("PS_AnnualWorks_GP"));
						}
						
						/*if(!((String)mdata.get("PS_Duration")).equalsIgnoreCase("365")){
							GP = transaction_Premium_Values.get("Annual Works").get("Gross Premium");
						}else{
							GP = Double.parseDouble((String)mdata.get("PS_AnnualWorks_GP"));
						}*/
						
						String Section_Pemium =  common.getWholeNumber(GP);
						
						//String Section_Pemium =  formatter.format((int) Math.floor(Double.parseDouble((String)mdata.get("PS_AnnualWorks_GP"))));
						fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("Section Premium "+Section_Pemium), "Section Premium  "+Section_Pemium, fileName);				
//						double rate = funcRateCalculatorPDF("Annual Works",(String)mdata.get("EL_LOI"));
//						fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains(Double.toString(rate)), Double.toString(rate), fileName);
						}else{
							if(!((String)mdata.get("CD_SingleProject")).equals("Yes")){
								fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("Contract Works Not Operative"), "Contract Works Not Operative" , fileName);
							}
						}
					
					if(((String)mdata.get("CD_OwnPlant")).equals("Yes")){
						fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("Own Plant Operative"), "Own Plant Operative" , fileName);
						fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("OWN PLANT SECTION"), "OWN PLANT SECTION" , fileName);
						String OP_LOI = (String)mdata.get("OP_LOI");
						//Below line is not working in all servers excluding 56 hence commenting line.
						//fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("Property Insured Limit of Indemnity - Any One Occurrence "+OP_LOI), "Own Plant Limit of Indemnity - Any One Occurrence "+OP_LOI , fileName);				
						
						double GP = 0.0;
						if(common.currentRunningFlow.contains("MTA") && TestBase.businessEvent.equalsIgnoreCase("MTA") ||
								common.currentRunningFlow.contains("Rewind") && TestBase.businessEvent.equalsIgnoreCase("MTA")){
							
							if(common_VELA.transaction_Details_Premium_Values.get("Own Plant_FP")==null){
								FP = 0.0;
							}else{
								FP = common_VELA.transaction_Details_Premium_Values.get("Own Plant_FP").get("Gross Premium");
							}
							
							GP = common_VELA.transaction_Details_Premium_Values.get("Own Plant").get("Gross Premium") + FP;
						}else if(!((String)mdata.get("PS_Duration")).equalsIgnoreCase("365")){
							GP = common_VELA.transaction_Premium_Values.get("Own Plant").get("Gross Premium");
						}else{
							GP = Double.parseDouble((String)mdata.get("PS_OwnPlant_GP"));
						}
						
						String Section_Pemium =  common.getWholeNumber(GP);
						
						//String Section_Pemium =  formatter.format((int) Math.floor(Double.parseDouble((String)mdata.get("PS_OwnPlant_GP"))));
						fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("Section Premium "+Section_Pemium), "Section Premium  "+Section_Pemium, fileName);				
//						double rate = funcRateCalculatorPDF("Own Plant",(String)mdata.get("EL_LOI"));
//						fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains(Double.toString(rate)), Double.toString(rate), fileName);
					}else{
						fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("Own Plant Not Operative"), "Own Plant Not Operative" , fileName);
					}
					
					if(((String)mdata.get("CD_HiredInPlant")).equals("Yes")){
						fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("Hired in Plant Operative"), "Hired in Plant Operative" , fileName);
						fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("HIRED IN PLANT SECTION"), "HIRED IN PLANT SECTION" , fileName);
						String HIP_LOI = (String)mdata.get("HIP_LOI");
						fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("Limit of Indemnity - Any One Occurrence "+HIP_LOI), "Limit of Indemnity - Any One Occurrence "+HIP_LOI , fileName);				
						
						double GP = 0.0;
						
						if(common.currentRunningFlow.contains("MTA") && TestBase.businessEvent.equalsIgnoreCase("MTA") ||
								common.currentRunningFlow.contains("Rewind") && TestBase.businessEvent.equalsIgnoreCase("MTA")){
							
							if(common_VELA.transaction_Details_Premium_Values.get("Hired In Plant_FP")==null){
								FP = 0.0;
							}else{
								FP = common_VELA.transaction_Details_Premium_Values.get("Hired In Plant_FP").get("Gross Premium");
							}
							
							GP = common_VELA.transaction_Details_Premium_Values.get("Hired In Plant").get("Gross Premium") + FP;
						}else if(!((String)mdata.get("PS_Duration")).equalsIgnoreCase("365")){
							GP = common_VELA.transaction_Premium_Values.get("Hired In Plant").get("Gross Premium");
						}else{
							GP = Double.parseDouble((String)mdata.get("PS_HiredInPlant_GP"));
						}
						
						/*if(!((String)mdata.get("PS_Duration")).equalsIgnoreCase("365")){
							GP = transaction_Premium_Values.get("Hired In Plant").get("Gross Premium");
						}else{
							GP = Double.parseDouble((String)mdata.get("PS_HiredInPlant_GP"));
						}*/
						
						String Section_Pemium =  common.getWholeNumber(GP);
						
						//String Section_Pemium =  formatter.format((int) Math.floor(Double.parseDouble((String)mdata.get("PS_HiredInPlant_GP"))));
						fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("Section Premium "+Section_Pemium), "Section Premium  "+Section_Pemium, fileName);				
//						double rate = funcRateCalculatorPDF("Hired In Plant",(String)mdata.get("EL_LOI"));
//						fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains(Double.toString(rate)), Double.toString(rate), fileName);
					}else{
						fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("Hired in Plant Not Operative"), "Legal Expenses Not Operative" , fileName);
					}
					if(((String)mdata.get("CD_JCT6.5.1")).equals("Yes")){
						fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("JCT Clause 6.5.1 Insurance (or equivalent) Operative"), "JCT Clause 6.5.1 Insurance (or equivalent) Operative" , fileName);
						fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("JCT CLAUSE 6.5.1 (or equivalent) SECTION"), "JCT CLAUSE 6.5.1 (or equivalent) SECTION" , fileName);
						
						String JCT_LOI = "";
						
						if(common.currentRunningFlow.contains("Renewal")){
							JCT_LOI = (String)common.Renewal_excel_data_map.get("JCT_LOI_Required");
						}else{
							if(!TestBase.businessEvent.equals("Renewal")){
							JCT_LOI = (String)common.NB_excel_data_map.get("JCT_LOI_Required");
							}else{
							JCT_LOI = (String)mdata.get("JCT_LOI_Required");	
							}
						}
					
						fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("Limit of Indemnity - Any One Occurrence "+JCT_LOI), "Limit of Indemnity - Any One Occurrence "+JCT_LOI , fileName);
						
						double GP = 0.0;
						
						if(common.currentRunningFlow.contains("MTA") && TestBase.businessEvent.equalsIgnoreCase("MTA") ||
								common.currentRunningFlow.contains("Rewind") && TestBase.businessEvent.equalsIgnoreCase("MTA")){
							
							if(common_VELA.transaction_Details_Premium_Values.get("JCT 6.5.1_FP")==null){
								FP = 0.0;
							}else{
								FP = common_VELA.transaction_Details_Premium_Values.get("JCT 6.5.1_FP").get("Gross Premium");
							}
							
							GP = common_VELA.transaction_Details_Premium_Values.get("JCT 6.5.1").get("Gross Premium") + FP;
						}else if(!((String)mdata.get("PS_Duration")).equalsIgnoreCase("365")){
							GP = common_VELA.transaction_Premium_Values.get("JCT 6.5.1").get("Gross Premium");
						}else{
							GP = Double.parseDouble((String)mdata.get("PS_JCT6.5.1_GP"));
						}
						
						/*if(!((String)mdata.get("PS_Duration")).equalsIgnoreCase("365")){
							GP = transaction_Premium_Values.get("JCT 6.5.1").get("Gross Premium");
						}else{
							GP = Double.parseDouble((String)mdata.get("PS_JCT6.5.1_GP"));
						}
						*/
						String Section_Pemium =  common.getWholeNumber(GP);
						
						//String Section_Pemium =  formatter.format((int) Math.floor(Double.parseDouble((String)mdata.get("PS_JCT6.5.1_GP"))));
						//fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("Section Premium "+Section_Pemium), "Section Premium  "+Section_Pemium, fileName);
//						double rate = funcRateCalculatorPDF("JCT 6.5.1",(String)mdata.get("EL_LOI"));
//						fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains(Double.toString(rate)), Double.toString(rate), fileName);
	
					}else{
						fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("JCT Clause 6.5.1 Insurance (or equivalent) Not Operative"), "JCT Clause 6.5.1 Insurance (or equivalent) Not Operative" , fileName);
					}
					if(((String)mdata.get("CD_PropertyOwnersLiability")).equals("Yes")){
						fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("Property Owners Liability Operative"), "Property Owners Liability Operative" , fileName);
						fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("PROPERTY OWNERS LIABILITY SECTION"), "PROPERTY OWNERS LIABILITY SECTION" , fileName);
						
						String POL_LOI = "";
						
						if(common.currentRunningFlow.contains("Renewal")){
							POL_LOI = (String)common.Renewal_excel_data_map.get("POL_LOI");
						}else{
							if(!TestBase.businessEvent.equals("Renewal")){
							POL_LOI = (String)common.NB_excel_data_map.get("POL_LOI");
							}else{
								POL_LOI = (String)mdata.get("POL_LOI");	
							}
							fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("Limit of Indemnity - Any One Occurrence "+POL_LOI), "Limit of Indemnity - Any One Occurrence "+POL_LOI , fileName);
						}
						
						double GP = 0.0;
						
						if(common.currentRunningFlow.contains("MTA") && TestBase.businessEvent.equalsIgnoreCase("MTA") ||
								common.currentRunningFlow.contains("Rewind") && TestBase.businessEvent.equalsIgnoreCase("MTA")){
							
							if(common_VELA.transaction_Details_Premium_Values.get("Property Owners Liability_FP")==null){
								FP = 0.0;
							}else{
								FP = common_VELA.transaction_Details_Premium_Values.get("Property Owners Liability_FP").get("Gross Premium");
							}
							
							GP = common_VELA.transaction_Details_Premium_Values.get("Property Owners Liability").get("Gross Premium") + FP;
						}else if(!((String)mdata.get("PS_Duration")).equalsIgnoreCase("365")){
							GP = common_VELA.transaction_Premium_Values.get("Property Owners Liability").get("Gross Premium");
						}else{
							GP = Double.parseDouble((String)mdata.get("PS_PropertyOwnersLiability_GP"));
						}
						
						/*if(!((String)mdata.get("PS_Duration")).equalsIgnoreCase("365")){
							GP = transaction_Premium_Values.get("Property Owners Liability").get("Gross Premium");
						}else{
							GP = Double.parseDouble((String)mdata.get("PS_PropertyOwnersLiability_GP"));
						}*/
						
						String Section_Pemium =  common.getWholeNumber(GP);
						
						//String Section_Pemium =  formatter.format((int) Math.floor(Double.parseDouble((String)mdata.get("PS_PropertyOwnersLiability_GP"))));
						fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("Section Premium "+Section_Pemium), "Section Premium  "+Section_Pemium, fileName);
//						double rate = funcRateCalculatorPDF("Property Owners Liability",(String)mdata.get("EL_LOI"));
//						fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains(Double.toString(rate)), Double.toString(rate), fileName);
					}else{
						fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("Property Owners Liability Not Operative"), "Property Owners Liability Not Operative" , fileName);
					}
					if(((String)mdata.get("CD_LegalExpenses")).equals("Yes")){
						fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("Legal Expenses Operative"), "Legal Expenses Operative" , fileName);
						fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("LEGAL EXPENSES SECTION"), "LEGAL EXPENSES SECTION" , fileName);
						
//						String LE_LimitOfLiability = (String)common.NB_excel_data_map.get("LE_LimitOfLiability");
//						fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("Limit of Liability "+LE_LimitOfLiability), "Limit of Liability &pound;"+LE_LimitOfLiability , fileName);
						
						double GP = 0.0;
						
						if(common.currentRunningFlow.contains("MTA") && TestBase.businessEvent.equalsIgnoreCase("MTA") ||
								common.currentRunningFlow.contains("Rewind") && TestBase.businessEvent.equalsIgnoreCase("MTA")){
							
							if(common_VELA.transaction_Details_Premium_Values.get("Abbey Legal Expenses_FP")==null){
								FP = 0.0;
							}else{
								FP = common_VELA.transaction_Details_Premium_Values.get("Abbey Legal Expenses_FP").get("Gross Premium");
							}
							
							GP = common_VELA.transaction_Details_Premium_Values.get("Abbey Legal Expenses").get("Gross Premium") + FP;
						}else if(!((String)mdata.get("PS_Duration")).equalsIgnoreCase("365")){
							GP = common_VELA.transaction_Premium_Values.get("Abbey Legal Expenses").get("Gross Premium");
						}else{
							GP = Double.parseDouble((String)mdata.get("PS_LegalExpenses_GP"));
						}
						
						/*if(!((String)mdata.get("PS_Duration")).equalsIgnoreCase("365")){
							GP = transaction_Premium_Values.get("Abbey Legal Expenses").get("Gross Premium");
						}else{
							GP = Double.parseDouble((String)mdata.get("PS_LegalExpenses_GP"));
						}*/
						
						String Section_Pemium =  common.getWholeNumber(GP);
						
						//String Section_Pemium =  formatter.format((int) Math.floor(Double.parseDouble((String)mdata.get("PS_LegalExpenses_GP"))));
						fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("Section Premium "+Section_Pemium), "Section Premium  "+Section_Pemium, fileName);
//						double rate = funcRateCalculatorPDF("Legal Expenses",(String)mdata.get("EL_LOI"));
//						fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains(Double.toString(rate)), Double.toString(rate), fileName);
		
					}else{
						fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("Legal Expenses Not Operative"), "Legal Expenses Not Operative" , fileName);
					}
					if(((String)mdata.get("CD_Terrorism")).equals("Yes")){
						fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("Terrorism Operative"), "Terrorism Operative" , fileName);
						fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("TERRORISM SECTION"), "TERRORISM SECTION" , fileName);
						
						double GP = 0.0;
						
						if(common.currentRunningFlow.contains("MTA") && TestBase.businessEvent.equalsIgnoreCase("MTA") ||
								common.currentRunningFlow.contains("Rewind") && TestBase.businessEvent.equalsIgnoreCase("MTA")){
							
							if(common_VELA.transaction_Details_Premium_Values.get("Terrorism_FP")==null){
								FP = 0.0;
							}else{
								FP = common_VELA.transaction_Details_Premium_Values.get("Terrorism_FP").get("Gross Premium");
							}
							
							GP = common_VELA.transaction_Details_Premium_Values.get("Terrorism").get("Gross Premium") + FP;
						}else if(!((String)mdata.get("PS_Duration")).equalsIgnoreCase("365")){
							GP = common_VELA.transaction_Premium_Values.get("Terrorism").get("Gross Premium");
						}else{
							GP = Double.parseDouble((String)mdata.get("PS_Terrorism_GP"));
						}
						
						/*if(!((String)mdata.get("PS_Duration")).equalsIgnoreCase("365")){
							GP = transaction_Premium_Values.get("Terrorism").get("Gross Premium");
						}else{
							GP = Double.parseDouble((String)mdata.get("PS_Terrorism_GP"));
						}
						*/
						String Section_Pemium =  common.getWholeNumber(GP);
						
						//String Section_Pemium = formatter.format((int) Math.floor(Double.parseDouble((String)mdata.get("PS_Terrorism_GP")))); 
						fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("Section Premium "+Section_Pemium), "Section Premium  "+Section_Pemium, fileName);
//						double rate = funcRateCalculatorPDF("Terrorism",(String)mdata.get("EL_LOI"));
//						fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains(Double.toString(rate)), Double.toString(rate), fileName);
	
					}else{
						fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("Terrorism Not Operative"), "Terrorism Not Operative" , fileName);
					}
					break;
				case "COB":
					
					if(common.currentRunningFlow.contains("MTA")){
						mdata= common.MTA_excel_data_map;
					}else if(common.currentRunningFlow.contains("CAN")){
						mdata= common.CAN_excel_data_map;
					}else if(common.currentRunningFlow.contains("Rewind")){
						mdata= common.Rewind_excel_data_map;
					}else if(common.currentRunningFlow.contains("Requote")){
						mdata= common.Requote_excel_data_map;
					}else{
						mdata= common.NB_excel_data_map;
					}
					
					if(((String)mdata.get("CD_EmployersLiability")).equals("Yes")){
						fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("Employers Liability Operative"), "Employers Liability Operative" , fileName);
						fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("EMPLOYERS LIABILITY SECTION"), "EMPLOYERS LIABILITY SECTION" , fileName);
						String EL_LOI = (String)mdata.get("EL_LOI");
						double GP = 0.0;
						
						if(common.currentRunningFlow.contains("MTA") && TestBase.businessEvent.equalsIgnoreCase("MTA") ||
								common.currentRunningFlow.contains("Rewind") && TestBase.businessEvent.equalsIgnoreCase("MTA")){
							
							if(common_VELA.transaction_Details_Premium_Values.get("Employers Liability_FP")==null){
								FP = 0.0;
							}else{
								FP = common_VELA.transaction_Details_Premium_Values.get("Employers Liability_FP").get("Gross Premium");
							}
							GP = common_VELA.transaction_Details_Premium_Values.get("Employers Liability").get("Gross Premium") + FP;
							
						}else if(!((String)mdata.get("PS_Duration")).equalsIgnoreCase("365")){
							GP = common_VELA.transaction_Premium_Values.get("Employers Liability").get("Gross Premium");
						}else{
							GP = Double.parseDouble((String)mdata.get("PS_EmployersLiability_GP"));
						}
						
						String Section_Pemium =  formatter.format((int) Math.floor(GP));
						
						//String Section_Pemium =  formatter.format((int) Math.floor(Double.parseDouble((String)mdata.get("PS_EmployersLiability_GP"))));
						//fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("Section Premium "+Section_Pemium), "Section Premium  "+Section_Pemium, fileName);				
						fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("Limit of Indemnity - Any One Occurrence "+EL_LOI), "Limit of Indemnity - Any One Occurrence "+EL_LOI , fileName);
//						double rate = funcRateCalculatorPDF("Employers Liability",(String)mdata.get("EL_LOI"));
//						fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains(Double.toString(rate)), Double.toString(rate), fileName);
						
					}else{
						if(common.currentRunningFlow.contains("NB")){
							fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("Employers Liability Not Operative"), "Employers Liability Not Operative" , fileName);
						}						
					}
					
					if(((String)mdata.get("CD_Public&ProductsLiability")).equals("Yes")){
						fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("PUBLIC AND PRODUCTS LIABILITY SECTION"), "PUBLIC AND PRODUCTS LIABILITY SECTION" , fileName);
						fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("Public & Products Liability Operative"), "APPENDIX TO LIABILITY SECTION" , fileName);
						String PPL_LOI = (String)mdata.get("PPL_LOI_PPLiability");
						
						double GP = 0.0;
						
						if(common.currentRunningFlow.contains("MTA") && TestBase.businessEvent.equalsIgnoreCase("MTA") ||
								common.currentRunningFlow.contains("Rewind") && TestBase.businessEvent.equalsIgnoreCase("MTA")){
							
							if(common_VELA.transaction_Details_Premium_Values.get("Public & Products Liability_FP")==null){
								FP = 0.0;
							}else{
								FP = common_VELA.transaction_Details_Premium_Values.get("Public & Products Liability_FP").get("Gross Premium");
							}
							
							GP = common_VELA.transaction_Details_Premium_Values.get("Public & Products Liability").get("Gross Premium") + FP;
						}else if(!((String)mdata.get("PS_Duration")).equalsIgnoreCase("365")){
							GP = common_VELA.transaction_Premium_Values.get("Public & Products Liability").get("Gross Premium");
						}else{
							GP = Double.parseDouble((String)mdata.get("PS_Public&ProductsLiability_GP"));
						}
						
						String Section_Pemium =  formatter.format((int) Math.floor(GP));
						
						//String Section_Pemium =  formatter.format(Double.parseDouble((String)mdata.get("PS_Public&ProductsLiability_GP")));
						fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("Section Premium "+Section_Pemium), "Section Premium  "+Section_Pemium, fileName);				
						fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("Limit of Indemnity Any One Occurrence for all claims other than arising out of Pollution "+PPL_LOI), "Limit of Indemnity Any One Occurrence for all claims other than arising out of Pollution "+PPL_LOI , fileName);
//						double rate = funcRateCalculatorPDF("Public & Products Liability",(String)mdata.get("EL_LOI"));
//						fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains(Double.toString(rate)), Double.toString(rate), fileName);
						/*if(((String)mdata.get("PPL_RetroactiveDate"))==null)
						{
							fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("Cyber Liability "+((String)mdata.get("PS_PolicyStartDate"))) ,"Professional Negligence "+((String)mdata.get("PS_PolicyStartDate")),fileName);
							fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("Professional Negligence "+((String)mdata.get("PS_PolicyStartDate"))) ,"Professional Negligence "+((String)mdata.get("PS_PolicyStartDate")),fileName);
						}else{
							fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("Professional Negligence "+((String)mdata.get("PPL_RetroactiveDate"))) ,"Professional Negligence "+((String)mdata.get("PPL_RetroactiveDate")),fileName);
							fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("Cyber Liability "+((String)mdata.get("PPL_RetroactiveDate"))) ,"Cyber Liability "+((String)mdata.get("PPL_RetroactiveDate")),fileName);
						}*/
					}else{
						if(common.currentRunningFlow.contains("NB")){
							fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("Public & Products Liability Not Operative"), "Public & Products Liability Not Operative" , fileName);
						}						
					}
					
					if(((String)mdata.get("CD_AnnualWorks")).equals("Yes")){
						fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("Contract Works Operative"), "Contract Works Operative" , fileName);
						fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("CONTRACT WORKS SECTION"), "CONTRACT WORKS SECTION" , fileName);
						String AW_LOI = (String)mdata.get("AW_LOI");
						fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("Limit of Indemnity - Any One Occurrence "+AW_LOI), "Limit of Indemnity - Any One Occurrence "+AW_LOI , fileName);
						
						double GP = 0.0;
						
						if(common.currentRunningFlow.contains("MTA") && TestBase.businessEvent.equalsIgnoreCase("MTA") ||
								common.currentRunningFlow.contains("Rewind") && TestBase.businessEvent.equalsIgnoreCase("MTA")){
							
							if(common_VELA.transaction_Details_Premium_Values.get("Annual Works_FP")==null){
								FP = 0.0;
							}else{
								FP = common_VELA.transaction_Details_Premium_Values.get("Annual Works_FP").get("Gross Premium");
							}
							
							GP = common_VELA.transaction_Details_Premium_Values.get("Annual Works").get("Gross Premium") + FP;
						}else if(!((String)mdata.get("PS_Duration")).equalsIgnoreCase("365")){
							GP = common_VELA.transaction_Premium_Values.get("Annual Works").get("Gross Premium");
						}else{
							GP = Double.parseDouble((String)mdata.get("PS_AnnualWorks_GP"));
						}
						
						String Section_Pemium =  formatter.format((int) Math.floor(GP));
						
						//String Section_Pemium =  formatter.format((int) Math.floor(Double.parseDouble((String)mdata.get("PS_AnnualWorks_GP"))));
						
						//if(common.currentRunningFlow.contains("MTA")){
							fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("Section Premium "+Section_Pemium), "Section Premium  "+Section_Pemium, fileName);
						//}
										
//						double rate = funcRateCalculatorPDF("Annual Works",(String)mdata.get("EL_LOI"));
//						fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains(Double.toString(rate)), Double.toString(rate), fileName);
						}else{
							if(!((String)mdata.get("CD_SingleProject")).equals("Yes") && common.currentRunningFlow.contains("NB")){
								fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("Contract Works Not Operative"), "Contract Works Not Operative" , fileName);
							}
						}
					
					if(((String)mdata.get("CD_OwnPlant")).equals("Yes")){
						fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("Own Plant Operative"), "Own Plant Operative" , fileName);
						fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("OWN PLANT SECTION"), "OWN PLANT SECTION" , fileName);
						String OP_LOI = (String)mdata.get("OP_LOI");
						//Below line is not working in all servers excluding 56 hence commenting line.
						//fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("Property Insured Limit of Indemnity - Any One Occurrence "+OP_LOI), "Own Plant Limit of Indemnity - Any One Occurrence "+OP_LOI , fileName);				
						
						double GP = 0.0;
						if(common.currentRunningFlow.contains("MTA") && TestBase.businessEvent.equalsIgnoreCase("MTA") ||
								common.currentRunningFlow.contains("Rewind") && TestBase.businessEvent.equalsIgnoreCase("MTA")){
							
							if(common_VELA.transaction_Details_Premium_Values.get("Own Plant_FP")==null){
								FP = 0.0;
							}else{
								FP = common_VELA.transaction_Details_Premium_Values.get("Own Plant_FP").get("Gross Premium");
							}
							
							GP = common_VELA.transaction_Details_Premium_Values.get("Own Plant").get("Gross Premium") + FP;
						}else if(!((String)mdata.get("PS_Duration")).equalsIgnoreCase("365")){
							GP = common_VELA.transaction_Premium_Values.get("Own Plant").get("Gross Premium");
						}else{
							GP = Double.parseDouble((String)mdata.get("PS_OwnPlant_GP"));
						}
						
						String Section_Pemium =  formatter.format((int) Math.floor(GP));
						
						//String Section_Pemium =  formatter.format((int) Math.floor(Double.parseDouble((String)mdata.get("PS_OwnPlant_GP"))));
						fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("Section Premium "+Section_Pemium), "Section Premium  "+Section_Pemium, fileName);				
//						double rate = funcRateCalculatorPDF("Own Plant",(String)mdata.get("EL_LOI"));
//						fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains(Double.toString(rate)), Double.toString(rate), fileName);
					}else{
						if(common.currentRunningFlow.contains("NB")){
							fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("Own Plant Not Operative"), "Own Plant Not Operative" , fileName);
						}
					}
					
					if(((String)mdata.get("CD_HiredInPlant")).equals("Yes")){
						fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("Hired in Plant Operative"), "Hired in Plant Operative" , fileName);
						fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("HIRED IN PLANT SECTION"), "HIRED IN PLANT SECTION" , fileName);
						String HIP_LOI = (String)mdata.get("HIP_LOI");
						fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("Limit of Indemnity - Any One Occurrence "+HIP_LOI), "Limit of Indemnity - Any One Occurrence "+HIP_LOI , fileName);				
						
						double GP = 0.0;
						if(common.currentRunningFlow.contains("MTA") && TestBase.businessEvent.equalsIgnoreCase("MTA") ||
								common.currentRunningFlow.contains("Rewind") && TestBase.businessEvent.equalsIgnoreCase("MTA")){
							
							if(common_VELA.transaction_Details_Premium_Values.get("Hired In Plant_FP")==null){
								FP = 0.0;
							}else{
								FP = common_VELA.transaction_Details_Premium_Values.get("Hired In Plant_FP").get("Gross Premium");
							}
							
							GP = common_VELA.transaction_Details_Premium_Values.get("Hired In Plant").get("Gross Premium") + FP;
						}else if(!((String)mdata.get("PS_Duration")).equalsIgnoreCase("365")){
							GP = common_VELA.transaction_Premium_Values.get("Hired In Plant").get("Gross Premium");
						}else{
							GP = Double.parseDouble((String)mdata.get("PS_HiredInPlant_GP"));
						}
						
						String Section_Pemium =  formatter.format((int) Math.floor(GP));
						
						//String Section_Pemium =  formatter.format((int) Math.floor(Double.parseDouble((String)mdata.get("PS_HiredInPlant_GP"))));
						fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("Section Premium "+Section_Pemium), "Section Premium  "+Section_Pemium, fileName);				
//						double rate = funcRateCalculatorPDF("Hired In Plant",(String)mdata.get("EL_LOI"));
//						fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains(Double.toString(rate)), Double.toString(rate), fileName);
					}else{
						if(common.currentRunningFlow.contains("NB")){
							fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("Hired in Plant Not Operative"), "Legal Expenses Not Operative" , fileName);
						}						
					}
					if(((String)mdata.get("CD_JCT6.5.1")).equals("Yes")){
						fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("JCT Clause 6.5.1 Insurance (or equivalent) Operative"), "JCT Clause 6.5.1 Insurance (or equivalent) Operative" , fileName);
						fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("JCT CLAUSE 6.5.1 (or equivalent) SECTION"), "JCT CLAUSE 6.5.1 (or equivalent) SECTION" , fileName);
						
						String JCT_LOI = (String)mdata.get("JCT_LOI_Required");
						fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("Limit of Indemnity - Any One Occurrence "+JCT_LOI), "Limit of Indemnity - Any One Occurrence "+JCT_LOI , fileName);
						
						double GP = 0.0;
						if(common.currentRunningFlow.contains("MTA") && TestBase.businessEvent.equalsIgnoreCase("MTA") ||
								common.currentRunningFlow.contains("Rewind") && TestBase.businessEvent.equalsIgnoreCase("MTA")){
							
							if(common_VELA.transaction_Details_Premium_Values.get("JCT 6.5.1_FP")==null){
								FP = 0.0;
							}else{
								FP = common_VELA.transaction_Details_Premium_Values.get("JCT 6.5.1_FP").get("Gross Premium");
							}
							
							GP = common_VELA.transaction_Details_Premium_Values.get("JCT 6.5.1").get("Gross Premium") + FP;
						}else if(!((String)mdata.get("PS_Duration")).equalsIgnoreCase("365")){
							GP = common_VELA.transaction_Premium_Values.get("JCT 6.5.1").get("Gross Premium");
						}else{
							GP = Double.parseDouble((String)mdata.get("PS_JCT6.5.1_GP"));
						}
						
						String Section_Pemium =  formatter.format((int) Math.floor(GP));
						
						//String Section_Pemium =  formatter.format((int) Math.floor(Double.parseDouble((String)mdata.get("PS_JCT6.5.1_GP"))));
						//fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("Section Premium "+Section_Pemium), "Section Premium  "+Section_Pemium, fileName);
//						double rate = funcRateCalculatorPDF("JCT 6.5.1",(String)mdata.get("EL_LOI"));
//						fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains(Double.toString(rate)), Double.toString(rate), fileName);
	
					}else{
						if(common.currentRunningFlow.contains("NB")){
							fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("JCT Clause 6.5.1 Insurance (or equivalent) Not Operative"), "JCT Clause 6.5.1 Insurance (or equivalent) Not Operative" , fileName);
						}						
					}
					if(((String)mdata.get("CD_PropertyOwnersLiability")).equals("Yes")){
						fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("Property Owners Liability Operative"), "Property Owners Liability Operative" , fileName);
						fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("PROPERTY OWNERS LIABILITY SECTION"), "PROPERTY OWNERS LIABILITY SECTION" , fileName);
						
						String POL_LOI = (String)mdata.get("POL_LOI");
						fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("Limit of Indemnity - Any One Occurrence "+POL_LOI), "Limit of Indemnity - Any One Occurrence "+POL_LOI , fileName);
						
						double GP = 0.0;
						
						if(common.currentRunningFlow.contains("MTA") && TestBase.businessEvent.equalsIgnoreCase("MTA") ||
								common.currentRunningFlow.contains("Rewind") && TestBase.businessEvent.equalsIgnoreCase("MTA")){
							
							if(common_VELA.transaction_Details_Premium_Values.get("Property Owners Liability_FP")==null){
								FP = 0.0;
							}else{
								FP = common_VELA.transaction_Details_Premium_Values.get("Property Owners Liability_FP").get("Gross Premium");
							}
							
							GP = common_VELA.transaction_Details_Premium_Values.get("Property Owners Liability").get("Gross Premium") + FP;
						}else if(!((String)mdata.get("PS_Duration")).equalsIgnoreCase("365")){
							GP = common_VELA.transaction_Premium_Values.get("Property Owners Liability").get("Gross Premium");
						}else{
							GP = Double.parseDouble((String)mdata.get("PS_PropertyOwnersLiability_GP"));
						}
						
						String Section_Pemium =  formatter.format((int) Math.floor(GP));
						
						//String Section_Pemium =  formatter.format((int) Math.floor(Double.parseDouble((String)mdata.get("PS_PropertyOwnersLiability_GP"))));
						//fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("Section Premium "+Section_Pemium), "Section Premium  "+Section_Pemium, fileName);
//						double rate = funcRateCalculatorPDF("Property Owners Liability",(String)mdata.get("EL_LOI"));
//						fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains(Double.toString(rate)), Double.toString(rate), fileName);
					}else{
						if(common.currentRunningFlow.contains("NB")){
							fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("Property Owners Liability Not Operative"), "Property Owners Liability Not Operative" , fileName);
						}
					}
					if(((String)mdata.get("CD_LegalExpenses")).equals("Yes")){
						fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("Legal Expenses Operative"), "Legal Expenses Operative" , fileName);
						fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("LEGAL EXPENSES SECTION"), "LEGAL EXPENSES SECTION" , fileName);
						
//						String LE_LimitOfLiability = (String)common.NB_excel_data_map.get("LE_LimitOfLiability");
//						fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("Limit of Liability "+LE_LimitOfLiability), "Limit of Liability &pound;"+LE_LimitOfLiability , fileName);
						
						double GP = 0.0;
						if(common.currentRunningFlow.contains("MTA") && TestBase.businessEvent.equalsIgnoreCase("MTA") ||
								common.currentRunningFlow.contains("Rewind") && TestBase.businessEvent.equalsIgnoreCase("MTA")){
							
							if(common_VELA.transaction_Details_Premium_Values.get("Abbey Legal Expenses_FP")==null){
								FP = 0.0;
							}else{
								FP = common_VELA.transaction_Details_Premium_Values.get("Abbey Legal Expenses_FP").get("Gross Premium");
							}
							
							GP = common_VELA.transaction_Details_Premium_Values.get("Abbey Legal Expenses").get("Gross Premium") + FP;
						}else if(!((String)mdata.get("PS_Duration")).equalsIgnoreCase("365")){
							GP = common_VELA.transaction_Premium_Values.get("Abbey Legal Expenses").get("Gross Premium");
						}else{
							GP = Double.parseDouble((String)mdata.get("PS_LegalExpenses_GP"));
						}
						
						String Section_Pemium =  formatter.format((int) Math.floor(GP));
						
						//String Section_Pemium =  formatter.format((int) Math.floor(Double.parseDouble((String)mdata.get("PS_LegalExpenses_GP"))));
						fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("Section Premium "+Section_Pemium), "Section Premium  "+Section_Pemium, fileName);
//						double rate = funcRateCalculatorPDF("Legal Expenses",(String)mdata.get("EL_LOI"));
//						fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains(Double.toString(rate)), Double.toString(rate), fileName);
		
					}else{
						if(common.currentRunningFlow.contains("NB")){
							fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("Legal Expenses Not Operative"), "Legal Expenses Not Operative" , fileName);
						}
					}
					if(((String)mdata.get("CD_Terrorism")).equals("Yes")){
						fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("Terrorism Operative"), "Terrorism Operative" , fileName);
						fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("TERRORISM SECTION"), "TERRORISM SECTION" , fileName);
						
						double GP = 0.0;
						
						if(common.currentRunningFlow.contains("MTA") && TestBase.businessEvent.equalsIgnoreCase("MTA") ||
								common.currentRunningFlow.contains("Rewind") && TestBase.businessEvent.equalsIgnoreCase("MTA")){
							
							if(common_VELA.transaction_Details_Premium_Values.get("Terrorism_FP")==null){
								FP = 0.0;
							}else{
								FP = common_VELA.transaction_Details_Premium_Values.get("Terrorism_FP").get("Gross Premium");
							}
							
							GP = common_VELA.transaction_Details_Premium_Values.get("Terrorism").get("Gross Premium") + FP;
						}else if(!((String)mdata.get("PS_Duration")).equalsIgnoreCase("365")){
							GP = common_VELA.transaction_Premium_Values.get("Terrorism").get("Gross Premium");
						}else{
							GP = Double.parseDouble((String)mdata.get("PS_Terrorism_GP"));
						}
						
						String Section_Pemium =  formatter.format((int) Math.floor(GP));
						
						//String Section_Pemium = formatter.format((int) Math.floor(Double.parseDouble((String)mdata.get("PS_Terrorism_GP")))); 
						fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("Section Premium "+Section_Pemium), "Section Premium  "+Section_Pemium, fileName);
//						double rate = funcRateCalculatorPDF("Terrorism",(String)mdata.get("EL_LOI"));
//						fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains(Double.toString(rate)), Double.toString(rate), fileName);
	
					}else{
						if(common.currentRunningFlow.contains("NB")){
							fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("Terrorism Not Operative"), "Terrorism Not Operative" , fileName);
						}						
					}
					break;
				case "OFC":
					
					if(common.currentRunningFlow.contains("MTA")){
						mdata= common.MTA_excel_data_map;
					}else if(common.currentRunningFlow.contains("CAN")){
						mdata= common.CAN_excel_data_map;
					}else if(common.currentRunningFlow.contains("Rewind")){
						mdata= common.Rewind_excel_data_map;
					}else if(common.currentRunningFlow.contains("Requote")){
						mdata= common.Requote_excel_data_map;
					}else{
						mdata= common.NB_excel_data_map;
					}
					
					if(((String)mdata.get("CD_EmployersLiability")).equals("Yes")){
						fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("Employers Liability Operative"), "Employers Liability Operative" , fileName);
						fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("EMPLOYERS LIABILITY SECTION"), "EMPLOYERS LIABILITY SECTION" , fileName);
						String EL_LOI = (String)mdata.get("EL_LOI");
						double GP = 0.0;
						
						if(common.currentRunningFlow.contains("MTA") && TestBase.businessEvent.equalsIgnoreCase("MTA") ||
								common.currentRunningFlow.contains("Rewind") && TestBase.businessEvent.equalsIgnoreCase("MTA")){
							
							if(common_VELA.transaction_Details_Premium_Values.get("Employers Liability_FP")==null){
								FP = 0.0;
							}else{
								FP = common_VELA.transaction_Details_Premium_Values.get("Employers Liability_FP").get("Gross Premium");
							}
							GP = common_VELA.transaction_Details_Premium_Values.get("Employers Liability").get("Gross Premium") + FP;
							
						}else if(!((String)mdata.get("PS_Duration")).equalsIgnoreCase("365")){
							GP = common_VELA.transaction_Premium_Values.get("Employers Liability").get("Gross Premium");
						}else{
							GP = Double.parseDouble((String)mdata.get("PS_EmployersLiability_GP"));
						}
						
						String Section_Pemium =  formatter.format((int) Math.floor(GP));
						
						//String Section_Pemium =  formatter.format((int) Math.floor(Double.parseDouble((String)mdata.get("PS_EmployersLiability_GP"))));
						//fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("Section Premium "+Section_Pemium), "Section Premium  "+Section_Pemium, fileName);				
						fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("Limit of Indemnity - Any One Occurrence "+EL_LOI), "Limit of Indemnity - Any One Occurrence "+EL_LOI , fileName);
//						double rate = funcRateCalculatorPDF("Employers Liability",(String)mdata.get("EL_LOI"));
//						fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains(Double.toString(rate)), Double.toString(rate), fileName);
						
					}else{
						if(common.currentRunningFlow.contains("NB")){
							fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("Employers Liability Not Operative"), "Employers Liability Not Operative" , fileName);
						}						
					}
					
					if(((String)mdata.get("CD_Public&ProductsLiability")).equals("Yes")){
						fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("PUBLIC AND PRODUCTS LIABILITY SECTION"), "PUBLIC AND PRODUCTS LIABILITY SECTION" , fileName);
						fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("Public & Products Liability Operative"), "APPENDIX TO LIABILITY SECTION" , fileName);
						String PPL_LOI = (String)mdata.get("PPL_LOI_PPLiability");
						
						double GP = 0.0;
						
						if(common.currentRunningFlow.contains("MTA") && TestBase.businessEvent.equalsIgnoreCase("MTA") ||
								common.currentRunningFlow.contains("Rewind") && TestBase.businessEvent.equalsIgnoreCase("MTA")){
							
							if(common_VELA.transaction_Details_Premium_Values.get("Public & Products Liability_FP")==null){
								FP = 0.0;
							}else{
								FP = common_VELA.transaction_Details_Premium_Values.get("Public & Products Liability_FP").get("Gross Premium");
							}
							
							GP = common_VELA.transaction_Details_Premium_Values.get("Public & Products Liability").get("Gross Premium") + FP;
						}else if(!((String)mdata.get("PS_Duration")).equalsIgnoreCase("365")){
							GP = common_VELA.transaction_Premium_Values.get("Public & Products Liability").get("Gross Premium");
						}else{
							GP = Double.parseDouble((String)mdata.get("PS_Public&ProductsLiability_GP"));
						}
						
						String Section_Pemium =  formatter.format((int) Math.floor(GP));
						
						//String Section_Pemium =  formatter.format(Double.parseDouble((String)mdata.get("PS_Public&ProductsLiability_GP")));
						fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("Section Premium "+Section_Pemium), "Section Premium  "+Section_Pemium, fileName);				
						fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("Limit of Indemnity Any One Occurrence for all claims other than arising out of Pollution "+PPL_LOI), "Limit of Indemnity Any One Occurrence for all claims other than arising out of Pollution "+PPL_LOI , fileName);
//						double rate = funcRateCalculatorPDF("Public & Products Liability",(String)mdata.get("EL_LOI"));
//						fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains(Double.toString(rate)), Double.toString(rate), fileName);
						/*if(((String)mdata.get("PPL_RetroactiveDate"))==null)
						{
							fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("Cyber Liability "+((String)mdata.get("PS_PolicyStartDate"))) ,"Professional Negligence "+((String)mdata.get("PS_PolicyStartDate")),fileName);
							fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("Professional Negligence "+((String)mdata.get("PS_PolicyStartDate"))) ,"Professional Negligence "+((String)mdata.get("PS_PolicyStartDate")),fileName);
						}else{
							fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("Professional Negligence "+((String)mdata.get("PPL_RetroactiveDate"))) ,"Professional Negligence "+((String)mdata.get("PPL_RetroactiveDate")),fileName);
							fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("Cyber Liability "+((String)mdata.get("PPL_RetroactiveDate"))) ,"Cyber Liability "+((String)mdata.get("PPL_RetroactiveDate")),fileName);
						}*/
					}else{
						if(common.currentRunningFlow.contains("NB")){
							fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("Public & Products Liability Not Operative"), "Public & Products Liability Not Operative" , fileName);
						}						
					}
					
					if(((String)mdata.get("CD_AnnualWorks")).equals("Yes")){
						fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("Contract Works Operative"), "Contract Works Operative" , fileName);
						fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("CONTRACT WORKS SECTION"), "CONTRACT WORKS SECTION" , fileName);
						String AW_LOI = (String)mdata.get("AW_LOI");
						fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("Limit of Indemnity - Any One Occurrence "+AW_LOI), "Limit of Indemnity - Any One Occurrence "+AW_LOI , fileName);
						
						double GP = 0.0;
						
						if(common.currentRunningFlow.contains("MTA") && TestBase.businessEvent.equalsIgnoreCase("MTA") ||
								common.currentRunningFlow.contains("Rewind") && TestBase.businessEvent.equalsIgnoreCase("MTA")){
							
							if(common_VELA.transaction_Details_Premium_Values.get("Annual Works_FP")==null){
								FP = 0.0;
							}else{
								FP = common_VELA.transaction_Details_Premium_Values.get("Annual Works_FP").get("Gross Premium");
							}
							
							GP = common_VELA.transaction_Details_Premium_Values.get("Annual Works").get("Gross Premium") + FP;
						}else if(!((String)mdata.get("PS_Duration")).equalsIgnoreCase("365")){
							GP = common_VELA.transaction_Premium_Values.get("Annual Works").get("Gross Premium");
						}else{
							GP = Double.parseDouble((String)mdata.get("PS_AnnualWorks_GP"));
						}
						
						String Section_Pemium =  formatter.format((int) Math.floor(GP));
						
						//String Section_Pemium =  formatter.format((int) Math.floor(Double.parseDouble((String)mdata.get("PS_AnnualWorks_GP"))));
						
						//if(common.currentRunningFlow.contains("MTA")){
							fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("Section Premium "+Section_Pemium), "Section Premium  "+Section_Pemium, fileName);
						//}
										
//						double rate = funcRateCalculatorPDF("Annual Works",(String)mdata.get("EL_LOI"));
//						fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains(Double.toString(rate)), Double.toString(rate), fileName);
						}else{
							if(!((String)mdata.get("CD_SingleProject")).equals("Yes") && common.currentRunningFlow.contains("NB")){
								fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("Contract Works Not Operative"), "Contract Works Not Operative" , fileName);
							}
						}
					
					if(((String)mdata.get("CD_OwnPlant")).equals("Yes")){
						fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("Own Plant Operative"), "Own Plant Operative" , fileName);
						fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("OWN PLANT SECTION"), "OWN PLANT SECTION" , fileName);
						String OP_LOI = (String)mdata.get("OP_LOI");
						//Below line is not working in all servers excluding 56 hence commenting line.
						//fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("Property Insured Limit of Indemnity - Any One Occurrence "+OP_LOI), "Own Plant Limit of Indemnity - Any One Occurrence "+OP_LOI , fileName);				
						
						double GP = 0.0;
						if(common.currentRunningFlow.contains("MTA") && TestBase.businessEvent.equalsIgnoreCase("MTA") ||
								common.currentRunningFlow.contains("Rewind") && TestBase.businessEvent.equalsIgnoreCase("MTA")){
							
							if(common_VELA.transaction_Details_Premium_Values.get("Own Plant_FP")==null){
								FP = 0.0;
							}else{
								FP = common_VELA.transaction_Details_Premium_Values.get("Own Plant_FP").get("Gross Premium");
							}
							
							GP = common_VELA.transaction_Details_Premium_Values.get("Own Plant").get("Gross Premium") + FP;
						}else if(!((String)mdata.get("PS_Duration")).equalsIgnoreCase("365")){
							GP = common_VELA.transaction_Premium_Values.get("Own Plant").get("Gross Premium");
						}else{
							GP = Double.parseDouble((String)mdata.get("PS_OwnPlant_GP"));
						}
						
						String Section_Pemium =  formatter.format((int) Math.floor(GP));
						
						//String Section_Pemium =  formatter.format((int) Math.floor(Double.parseDouble((String)mdata.get("PS_OwnPlant_GP"))));
						fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("Section Premium "+Section_Pemium), "Section Premium  "+Section_Pemium, fileName);				
//						double rate = funcRateCalculatorPDF("Own Plant",(String)mdata.get("EL_LOI"));
//						fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains(Double.toString(rate)), Double.toString(rate), fileName);
					}else{
						if(common.currentRunningFlow.contains("NB")){
							fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("Own Plant Not Operative"), "Own Plant Not Operative" , fileName);
						}
					}
					
					if(((String)mdata.get("CD_HiredInPlant")).equals("Yes")){
						fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("Hired in Plant Operative"), "Hired in Plant Operative" , fileName);
						fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("HIRED IN PLANT SECTION"), "HIRED IN PLANT SECTION" , fileName);
						String HIP_LOI = (String)mdata.get("HIP_LOI");
						fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("Limit of Indemnity - Any One Occurrence "+HIP_LOI), "Limit of Indemnity - Any One Occurrence "+HIP_LOI , fileName);				
						
						double GP = 0.0;
						if(common.currentRunningFlow.contains("MTA") && TestBase.businessEvent.equalsIgnoreCase("MTA") ||
								common.currentRunningFlow.contains("Rewind") && TestBase.businessEvent.equalsIgnoreCase("MTA")){
							
							if(common_VELA.transaction_Details_Premium_Values.get("Hired In Plant_FP")==null){
								FP = 0.0;
							}else{
								FP = common_VELA.transaction_Details_Premium_Values.get("Hired In Plant_FP").get("Gross Premium");
							}
							
							GP = common_VELA.transaction_Details_Premium_Values.get("Hired In Plant").get("Gross Premium") + FP;
						}else if(!((String)mdata.get("PS_Duration")).equalsIgnoreCase("365")){
							GP = common_VELA.transaction_Premium_Values.get("Hired In Plant").get("Gross Premium");
						}else{
							GP = Double.parseDouble((String)mdata.get("PS_HiredInPlant_GP"));
						}
						
						String Section_Pemium =  formatter.format((int) Math.floor(GP));
						
						//String Section_Pemium =  formatter.format((int) Math.floor(Double.parseDouble((String)mdata.get("PS_HiredInPlant_GP"))));
						fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("Section Premium "+Section_Pemium), "Section Premium  "+Section_Pemium, fileName);				
//						double rate = funcRateCalculatorPDF("Hired In Plant",(String)mdata.get("EL_LOI"));
//						fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains(Double.toString(rate)), Double.toString(rate), fileName);
					}else{
						if(common.currentRunningFlow.contains("NB")){
							fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("Hired in Plant Not Operative"), "Legal Expenses Not Operative" , fileName);
						}						
					}
					if(((String)mdata.get("CD_JCT6.5.1")).equals("Yes")){
						fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("JCT Clause 6.5.1 Insurance (or equivalent) Operative"), "JCT Clause 6.5.1 Insurance (or equivalent) Operative" , fileName);
						fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("JCT CLAUSE 6.5.1 (or equivalent) SECTION"), "JCT CLAUSE 6.5.1 (or equivalent) SECTION" , fileName);
						
						String JCT_LOI = (String)mdata.get("JCT_LOI_Required");
						fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("Limit of Indemnity - Any One Occurrence "+JCT_LOI), "Limit of Indemnity - Any One Occurrence "+JCT_LOI , fileName);
						
						double GP = 0.0;
						if(common.currentRunningFlow.contains("MTA") && TestBase.businessEvent.equalsIgnoreCase("MTA") ||
								common.currentRunningFlow.contains("Rewind") && TestBase.businessEvent.equalsIgnoreCase("MTA")){
							
							if(common_VELA.transaction_Details_Premium_Values.get("JCT 6.5.1_FP")==null){
								FP = 0.0;
							}else{
								FP = common_VELA.transaction_Details_Premium_Values.get("JCT 6.5.1_FP").get("Gross Premium");
							}
							
							GP = common_VELA.transaction_Details_Premium_Values.get("JCT 6.5.1").get("Gross Premium") + FP;
						}else if(!((String)mdata.get("PS_Duration")).equalsIgnoreCase("365")){
							GP = common_VELA.transaction_Premium_Values.get("JCT 6.5.1").get("Gross Premium");
						}else{
							GP = Double.parseDouble((String)mdata.get("PS_JCT6.5.1_GP"));
						}
						
						String Section_Pemium =  formatter.format((int) Math.floor(GP));
						
						//String Section_Pemium =  formatter.format((int) Math.floor(Double.parseDouble((String)mdata.get("PS_JCT6.5.1_GP"))));
						//fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("Section Premium "+Section_Pemium), "Section Premium  "+Section_Pemium, fileName);
//						double rate = funcRateCalculatorPDF("JCT 6.5.1",(String)mdata.get("EL_LOI"));
//						fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains(Double.toString(rate)), Double.toString(rate), fileName);
	
					}else{
						if(common.currentRunningFlow.contains("NB")){
							fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("JCT Clause 6.5.1 Insurance (or equivalent) Not Operative"), "JCT Clause 6.5.1 Insurance (or equivalent) Not Operative" , fileName);
						}						
					}
					if(((String)mdata.get("CD_PropertyOwnersLiability")).equals("Yes")){
						fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("Property Owners Liability Operative"), "Property Owners Liability Operative" , fileName);
						fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("PROPERTY OWNERS LIABILITY SECTION"), "PROPERTY OWNERS LIABILITY SECTION" , fileName);
						
						String POL_LOI = (String)mdata.get("POL_LOI");
						fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("Limit of Indemnity - Any One Occurrence "+POL_LOI), "Limit of Indemnity - Any One Occurrence "+POL_LOI , fileName);
						
						double GP = 0.0;
						
						if(common.currentRunningFlow.contains("MTA") && TestBase.businessEvent.equalsIgnoreCase("MTA") ||
								common.currentRunningFlow.contains("Rewind") && TestBase.businessEvent.equalsIgnoreCase("MTA")){
							
							if(common_VELA.transaction_Details_Premium_Values.get("Property Owners Liability_FP")==null){
								FP = 0.0;
							}else{
								FP = common_VELA.transaction_Details_Premium_Values.get("Property Owners Liability_FP").get("Gross Premium");
							}
							
							GP = common_VELA.transaction_Details_Premium_Values.get("Property Owners Liability").get("Gross Premium") + FP;
						}else if(!((String)mdata.get("PS_Duration")).equalsIgnoreCase("365")){
							GP = common_VELA.transaction_Premium_Values.get("Property Owners Liability").get("Gross Premium");
						}else{
							GP = Double.parseDouble((String)mdata.get("PS_PropertyOwnersLiability_GP"));
						}
						
						String Section_Pemium =  formatter.format((int) Math.floor(GP));
						
						//String Section_Pemium =  formatter.format((int) Math.floor(Double.parseDouble((String)mdata.get("PS_PropertyOwnersLiability_GP"))));
						//fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("Section Premium "+Section_Pemium), "Section Premium  "+Section_Pemium, fileName);
//						double rate = funcRateCalculatorPDF("Property Owners Liability",(String)mdata.get("EL_LOI"));
//						fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains(Double.toString(rate)), Double.toString(rate), fileName);
					}else{
						if(common.currentRunningFlow.contains("NB")){
							fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("Property Owners Liability Not Operative"), "Property Owners Liability Not Operative" , fileName);
						}
					}
					if(((String)mdata.get("CD_LegalExpenses")).equals("Yes")){
						fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("Legal Expenses Operative"), "Legal Expenses Operative" , fileName);
						fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("LEGAL EXPENSES SECTION"), "LEGAL EXPENSES SECTION" , fileName);
						
//						String LE_LimitOfLiability = (String)common.NB_excel_data_map.get("LE_LimitOfLiability");
//						fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("Limit of Liability "+LE_LimitOfLiability), "Limit of Liability &pound;"+LE_LimitOfLiability , fileName);
						
						double GP = 0.0;
						if(common.currentRunningFlow.contains("MTA") && TestBase.businessEvent.equalsIgnoreCase("MTA") ||
								common.currentRunningFlow.contains("Rewind") && TestBase.businessEvent.equalsIgnoreCase("MTA")){
							
							if(common_VELA.transaction_Details_Premium_Values.get("Abbey Legal Expenses_FP")==null){
								FP = 0.0;
							}else{
								FP = common_VELA.transaction_Details_Premium_Values.get("Abbey Legal Expenses_FP").get("Gross Premium");
							}
							
							GP = common_VELA.transaction_Details_Premium_Values.get("Abbey Legal Expenses").get("Gross Premium") + FP;
						}else if(!((String)mdata.get("PS_Duration")).equalsIgnoreCase("365")){
							GP = common_VELA.transaction_Premium_Values.get("Abbey Legal Expenses").get("Gross Premium");
						}else{
							GP = Double.parseDouble((String)mdata.get("PS_LegalExpenses_GP"));
						}
						
						String Section_Pemium =  formatter.format((int) Math.floor(GP));
						
						//String Section_Pemium =  formatter.format((int) Math.floor(Double.parseDouble((String)mdata.get("PS_LegalExpenses_GP"))));
						fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("Section Premium "+Section_Pemium), "Section Premium  "+Section_Pemium, fileName);
//						double rate = funcRateCalculatorPDF("Legal Expenses",(String)mdata.get("EL_LOI"));
//						fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains(Double.toString(rate)), Double.toString(rate), fileName);
		
					}else{
						if(common.currentRunningFlow.contains("NB")){
							fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("Legal Expenses Not Operative"), "Legal Expenses Not Operative" , fileName);
						}
					}
					if(((String)mdata.get("CD_Terrorism")).equals("Yes")){
						fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("Terrorism Operative"), "Terrorism Operative" , fileName);
						fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("TERRORISM SECTION"), "TERRORISM SECTION" , fileName);
						
						double GP = 0.0;
						
						if(common.currentRunningFlow.contains("MTA") && TestBase.businessEvent.equalsIgnoreCase("MTA") ||
								common.currentRunningFlow.contains("Rewind") && TestBase.businessEvent.equalsIgnoreCase("MTA")){
							
							if(common_VELA.transaction_Details_Premium_Values.get("Terrorism_FP")==null){
								FP = 0.0;
							}else{
								FP = common_VELA.transaction_Details_Premium_Values.get("Terrorism_FP").get("Gross Premium");
							}
							
							GP = common_VELA.transaction_Details_Premium_Values.get("Terrorism").get("Gross Premium") + FP;
						}else if(!((String)mdata.get("PS_Duration")).equalsIgnoreCase("365")){
							GP = common_VELA.transaction_Premium_Values.get("Terrorism").get("Gross Premium");
						}else{
							GP = Double.parseDouble((String)mdata.get("PS_Terrorism_GP"));
						}
						
						String Section_Pemium =  formatter.format((int) Math.floor(GP));
						
						//String Section_Pemium = formatter.format((int) Math.floor(Double.parseDouble((String)mdata.get("PS_Terrorism_GP")))); 
						fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("Section Premium "+Section_Pemium), "Section Premium  "+Section_Pemium, fileName);
//						double rate = funcRateCalculatorPDF("Terrorism",(String)mdata.get("EL_LOI"));
//						fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains(Double.toString(rate)), Double.toString(rate), fileName);
	
					}else{
						if(common.currentRunningFlow.contains("NB")){
							fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("Terrorism Not Operative"), "Terrorism Not Operative" , fileName);
						}						
					}
					break;
				case "XOC":
				case "XOQ":
					
					if(common.currentRunningFlow.contains("MTA")){
						mdata= common.MTA_excel_data_map;
					}else if(common.currentRunningFlow.contains("CAN")){
						mdata= common.CAN_excel_data_map;
					}else if(common.currentRunningFlow.contains("Rewind")){
						mdata= common.Rewind_excel_data_map;
					}else if(common.currentRunningFlow.contains("Requote")){
						mdata= common.Requote_excel_data_map;
					}else if(common.currentRunningFlow.contains("Renewal")){
						mdata= common.Renewal_excel_data_map;
					}else{
						mdata= common.NB_excel_data_map;
					}
				
					if(((String)mdata.get("CD_CombinedLiability")).equals("Yes")){
						fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("Combined Liability Operative"), "Combined Liability Operative" , fileName);
						fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("EXCESS OF LOSS LIABILITIES SECTION"), "EXCESS OF LOSS LIABILITIES SECTION" , fileName);
						
						//formatter.format(mdata.get("XOC_CL_PL_ExcessLayer"))
						String PLExessLayer = formatter.format(Double.parseDouble((String)mdata.get("XOC_CL_PL_ExcessLayer")));
						String PLExessLiablity = formatter.format(Double.parseDouble((String)mdata.get("XOC_CL_PL_AttchmntLayerInsCover")));
						fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("Public & Products Liability Limit of Liability "+PLExessLayer+" in Excess of "+PLExessLiablity), "Public & Products Liability Limit of Liability "+PLExessLayer+" in Excess of "+PLExessLiablity , fileName);
						String ELExessLayer = formatter.format(Double.parseDouble((String)mdata.get("XOC_CL_ExcessLiabilityIns")));
						String ELExessLiablity = formatter.format(Double.parseDouble((String)mdata.get("XOC_CL_ExcessLiabilityIns")));
						fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("Employers Liability Limit of Liability "+ELExessLayer+" in Excess of "+ELExessLiablity), "Employers Liability Limit of Liability "+ELExessLayer+" in Excess of "+ELExessLiablity , fileName);
						//For Employers Liability
						fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("Limit of Liability by this insurance "+ELExessLayer+" any one occurrence"), "Limit of Liability by this insurance"+ELExessLayer+" any one occurrence", fileName);
						fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("Insurer/s "+((String)mdata.get("XOC_CL_LayerInsuranceCoverList")).replaceAll(",",", ")), "Insurer/s "+((String)mdata.get("XOC_CL_LayerInsuranceCoverList")).replaceAll(",",", "), fileName);				
						fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("Limit of Indemnity "+formatter.format(Double.parseDouble((String)mdata.get("XOC_CL_PrimaryLayerofIndeminity")))), "Limit of Indemnity "+formatter.format(Double.parseDouble((String)mdata.get("XOC_CL_PrimaryLayerofIndeminity"))), fileName);
						
						
						
						//for Public liability
						fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("Limit of Liability by this insurance "+PLExessLayer+" any one occurrence"), "Limit of Liability by this insurance"+PLExessLayer+" any one occurrence", fileName);
						fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("Insurer/s "+((String)mdata.get("XOC_CL_PL_LayerInsuranceCoverList")).replaceAll(",",", ")), "Insurer/s "+(String)mdata.get("XOC_CL_PL_LayerInsuranceCoverList"), fileName);				
						fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("Limit of Indemnity "+formatter.format(Double.parseDouble((String)mdata.get("XOC_CL_PL_PrimaryLayerOfIndeminity")))), "Limit of Indemnity "+formatter.format(Double.parseDouble((String)mdata.get("XOC_CL_PL_PrimaryLayerOfIndeminity"))), fileName);
						
						
						if(!docType.contains("Draft")){
							if(common.currentRunningFlow.equals("Renewal")||(TestBase.businessEvent.equals("Renewal")&&common.currentRunningFlow.equals("Rewind"))||(TestBase.businessEvent.equals("Renewal")&&common.currentRunningFlow.equals("MTA"))){
								fail_count = fail_count + CommonFunction.verification(parsedText.contains("Policy Number: "+(String)common.Renewal_excel_data_map.get("Renewal_PolicyNumber")), "Policy Number:"+(String)mdata.get("Renewal_PolicyNumber"), fileName);
									}else{
							fail_count = fail_count + CommonFunction.verification(parsedText.contains("Policy Number: "+(String)common.NB_excel_data_map.get("NB_PolicyNumber")), "Policy Number:"+(String)mdata.get("NB_PolicyNumber"), fileName);
							}
							}
						}else{
							fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("Combined Liability Not Operative"), "Combined Liability Not Operative" , fileName);
					}
					if(((String)mdata.get("CD_EmployersLiability")).equals("Yes")){
						fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("Employers Liability Operative"), "Employers Liability Operative" , fileName);
						fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("EXCESS OF LOSS LIABILITIES SECTION"), "EXCESS OF LOSS LIABILITIES SECTION" , fileName);
						
						String ELExessLayer = formatter.format(Double.parseDouble((String)mdata.get("XOC_EL_ExcessLayer")));
						String ELExessLiablity = formatter.format(Double.parseDouble((String)mdata.get("XOC_EL_ExcessLiabilityIns")));
						fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("Employers Liability Limit of Liability "+ELExessLayer+" in Excess of "+ELExessLiablity), "Employers Liability Limit of Liability "+ELExessLayer+" in Excess of "+ELExessLiablity , fileName);
						fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("Limit of Liability by this insurance "+ELExessLayer+" any one occurrence"), "Limit of Liability by this insurance"+ELExessLayer+" any one occurrence", fileName);
						fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("Insurer/s "+((String)mdata.get("XOC_EL_LyerInsuranceCoverList")).replaceAll(",",", ")), "Insurer/s "+((String)mdata.get("XOC_EL_LyerInsuranceCoverList")).replaceAll(",",", "), fileName);				
						fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("Limit of Indemnity "+formatter.format(Double.parseDouble((String)mdata.get("XOC_EL_PrimaryLayerofIndeminity")))), "Limit of Indemnity "+formatter.format(Double.parseDouble((String)mdata.get("XOC_EL_PrimaryLayerofIndeminity"))), fileName);
						
						
						if(!docType.contains("Draft")){
							if(common.currentRunningFlow.equals("Renewal")||(TestBase.businessEvent.equals("Renewal")&&common.currentRunningFlow.equals("Rewind"))||(TestBase.businessEvent.equals("Renewal")&&common.currentRunningFlow.equals("MTA"))){
								fail_count = fail_count + CommonFunction.verification(parsedText.contains("Policy Number: "+(String)common.Renewal_excel_data_map.get("Renewal_PolicyNumber")), "Policy Number:"+(String)mdata.get("Renewal_PolicyNumber"), fileName);
									}else{
							fail_count = fail_count + CommonFunction.verification(parsedText.contains("Policy Number: "+(String)common.NB_excel_data_map.get("NB_PolicyNumber")), "Policy Number:"+(String)mdata.get("NB_PolicyNumber"), fileName);
							}
							}
						}else{
						fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("Employers Liability Not Operative"), "Employers Liability Not Operative" , fileName);
					}
					
					if(((String)mdata.get("CD_Public&ProductsLiability")).equals("Yes")){
						fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("Public & Products Liability Operative"), "Public & Products Liability Operative" , fileName);
						fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("EXCESS OF LOSS LIABILITIES SECTION"), "EXCESS OF LOSS LIABILITIES SECTION" , fileName);
						
						String PLExessLayer = formatter.format(Double.parseDouble((String)mdata.get("XOC_PL_ExcessLayer")));
						String PLExessLiablity = formatter.format(Double.parseDouble((String)mdata.get("XOC_PL_ExcessLiabilityIns")));
						fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("Public & Products Liability Limit of Liability "+PLExessLayer+" in Excess of "+PLExessLiablity), "Public & Products Liability Limit of Liability "+PLExessLayer+" in Excess of "+PLExessLiablity , fileName);
						//For Public Liability
						fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("Limit of Liability by this insurance "+PLExessLayer+" any one occurrence"), "Limit of Liability by this insurance "+PLExessLayer+" any one occurrence", fileName);
						fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("Insurer/s "+((String)mdata.get("XOC_PL_LyerInsuranceCoverList")).replaceAll(",",", ")), "Insurer/s "+((String)mdata.get("XOC_PL_LyerInsuranceCoverList")).replaceAll(",",", "), fileName);				
						fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("Limit of Indemnity "+formatter.format(Double.parseDouble((String)mdata.get("XOC_PL_PrimaryLayerofIndeminity")))), "Limit of Indemnity "+formatter.format(Double.parseDouble((String)mdata.get("XOC_PL_PrimaryLayerofIndeminity"))), fileName);
						
						if(common.currentRunningFlow.equals("NB")){
						customAssert.assertTrue(common_VELA.verifyEndorsementONPremiumSummary(common.NB_excel_data_map),"Insurance tax adjustment is having issue(S).");
						}
						if(!docType.contains("Draft")){
							if(common.currentRunningFlow.equals("Renewal")||(TestBase.businessEvent.equals("Renewal")&&common.currentRunningFlow.equals("Rewind"))||(TestBase.businessEvent.equals("Renewal")&&common.currentRunningFlow.equals("MTA"))){
								fail_count = fail_count + CommonFunction.verification(parsedText.contains("Policy Number: "+(String)common.Renewal_excel_data_map.get("Renewal_PolicyNumber")), "Policy Number:"+(String)mdata.get("Renewal_PolicyNumber"), fileName);
									}else{
							fail_count = fail_count + CommonFunction.verification(parsedText.contains("Policy Number: "+(String)common.NB_excel_data_map.get("NB_PolicyNumber")), "Policy Number:"+(String)mdata.get("NB_PolicyNumber"), fileName);
							}
							}
					}else{
						fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("Public & Products Liability Not Operative"), "Public & Products Liability Not Operative" , fileName);
					}
					if(((String)mdata.get("CD_JCT6.5.1")).equals("Yes")){
						fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("JCT 6.5.1 Operative"), "JCT 6.5.1 Operative" , fileName);
						//fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("JCT CLAUSE 6.5.1 (or equivalent) SECTION"), "JCT 6.5.1 (or equivalent) SECTION" , fileName);
						
						fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("JCT 6.5.1 Limit of Liability "+formatter.format(Double.parseDouble((String)mdata.get("XOC_JCT_ExcessLayer")))+" in Excess of "+formatter.format(Double.parseDouble((String)mdata.get("XOC_JCT_ExcessLiabilityIns")))), "Limit of Liability by this insurance"+(String)mdata.get("XOC_JCT_ExcessLayer")+" any one occurrence", fileName);
						fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("Insurer/s "+((String)mdata.get("XOC_JCT_LyerInsuranceCoverList")).replaceAll(",", ", ")), "Insurer/s "+((String)mdata.get("XOC_JCT_LyerInsuranceCoverList")).replaceAll(",", ", "), fileName);				
						fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("Limit of Indemnity "+formatter.format(Double.parseDouble((String)mdata.get("XOC_JCT_PrimaryLayerofIndeminity")))), "Limit of Indemnity "+formatter.format(Double.parseDouble((String)mdata.get("XOC_JCT_PrimaryLayerofIndeminity"))), fileName);
						
							
						if(!docType.contains("Draft")){
							if(common.currentRunningFlow.equals("Renewal")||(TestBase.businessEvent.equals("Renewal")&&common.currentRunningFlow.equals("Rewind"))||(TestBase.businessEvent.equals("Renewal")&&common.currentRunningFlow.equals("MTA"))){
								fail_count = fail_count + CommonFunction.verification(parsedText.contains("Policy Number: "+(String)common.Renewal_excel_data_map.get("Renewal_PolicyNumber")), "Policy Number:"+(String)common.Renewal_excel_data_map.get("Renewal_PolicyNumber"), fileName);
									}else{
							fail_count = fail_count + CommonFunction.verification(parsedText.contains("Policy Number: "+(String)common.NB_excel_data_map.get("NB_PolicyNumber")), "Policy Number:"+(String)common.NB_excel_data_map.get("NB_PolicyNumber"), fileName);
							}
							}
					}else{
						fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("JCT 6.5.1 Not Operative"), "JCT 6.5.1 Not Operative" , fileName);
					}
					if(((String)mdata.get("CD_ThirdPartyMotorLiability")).equals("Yes")){
						fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("Third Party Motor Liability Operative"), "Third Party Motor Liability Operative" , fileName);
						fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("EXCESS OF LOSS LIABILITIES SECTION"), "EXCESS OF LOSS LIABILITIES SECTION" , fileName);

						fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("Third Party Motor Liability Limit of Liability "+formatter.format(Double.parseDouble((String)mdata.get("Excess_Layer")))+" in Excess of "+formatter.format(Double.parseDouble((String)mdata.get("Excess_LiabiltyIns")))), "Limit of Liability by this insurance"+(String)mdata.get("TPM_excessLayer")+" any one occurrence", fileName);
						fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("Insurer/s "+((String)mdata.get("PrimaryLayerInsCover")).replace(",", ", ")), "Insurer/s "+((String)mdata.get("PrimaryLayerInsCover")).replace(",", ", "), fileName);				
						fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("Limit of Indemnity "+formatter.format(Double.parseDouble((String)mdata.get("LimitOfIndemnity")))), "Limit of Indemnity "+formatter.format(Double.parseDouble((String)mdata.get("LimitOfIndemnity"))), fileName);
						
		//				customAssert.assertTrue(common_VELA.verifyEndorsementONPremiumSummary(common.NB_excel_data_map),"Insurance tax adjustment is having issue(S).");
						
						if(!docType.contains("Draft")){
							if(common.currentRunningFlow.equals("Renewal")||(TestBase.businessEvent.equals("Renewal")&&common.currentRunningFlow.equals("Rewind"))||(TestBase.businessEvent.equals("Renewal")&&common.currentRunningFlow.equals("MTA"))){
								fail_count = fail_count + CommonFunction.verification(parsedText.contains("Policy Number: "+(String)common.Renewal_excel_data_map.get("Renewal_PolicyNumber")), "Policy Number:"+(String)mdata.get("Renewal_PolicyNumber"), fileName);
									}else{
							fail_count = fail_count + CommonFunction.verification(parsedText.contains("Policy Number: "+(String)common.NB_excel_data_map.get("NB_PolicyNumber")), "Policy Number:"+(String)mdata.get("NB_PolicyNumber"), fileName);
							}
							}
						}else{
							if(((String)mdata.get("CD_CombinedLiability")).equals("Yes") ||((String)mdata.get("CD_Public&ProductsLiability")).equals("Yes"))
								fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("Third Party Motor Liability Operative"), "Third Party Motor Liability Operative" , fileName);
							else
								fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("Third Party Motor Liability Not Operative"), "Third Party Motor Liability Not Operative" , fileName);
					}
					break;
				

				default:
					break;
				}

				
				//This will verify endorsement in Section Endorsements.
				String flag="true";
				Iterator collectiveDataIT = common.EndorsementCollectiveData.entrySet().iterator();
				while(collectiveDataIT.hasNext()){
					Map.Entry collectiveDataMapValue = (Map.Entry)collectiveDataIT.next();
					String collectiveEndorsementCode = collectiveDataMapValue.getKey().toString();
					
					Iterator individualDataIT = common.EndorsementCollectiveData.get(collectiveEndorsementCode).entrySet().iterator();
					while(individualDataIT.hasNext()){
						Map.Entry individualDataMapValue = (Map.Entry)individualDataIT.next();
						String individualEndorsementSection = individualDataMapValue.getValue().toString();
						if(individualEndorsementSection.contains("Contract Lift")){
							individualEndorsementSection = "CPA Contract Lift Cover (Lifted Goods)";
						}
						if(individualEndorsementSection.contains("Offshore Work")){
							individualEndorsementSection = "Offshore Work And Visits";
						}
						if(individualEndorsementSection.contains("Contract Works")){
							individualEndorsementSection = "Contract Works";
						}
						String mergedEndorsementText = null;
						if(common.EndorsementCollectiveData.get(collectiveEndorsementCode).containsValue("Policy")){
							mergedEndorsementText = collectiveEndorsementCode + " " + individualEndorsementSection;
						}else{
							mergedEndorsementText = individualEndorsementSection + " " +collectiveEndorsementCode;
						}
						
						if(parsedText.contains(mergedEndorsementText)){
							TestUtil.reportStatus("Verified Endorsement : [<b> "+collectiveEndorsementCode+" -- "+individualEndorsementSection+"</b>] in "+fileName+" document.", "Pass", false);
							//TestUtil.reportStatus("Applied Endorsement <b> [ "+collectiveEndorsementCode+" </b> with title as <b> "+individualEndorsementSection+" ] </b> is present on premium summary page.", "Info", false);
							fail_count = fail_count + 0;
							flag = "true";
							break;
						}else{
							flag="false";
						}
					}
					if(flag.equalsIgnoreCase("false")){
						TestUtil.reportStatus("<p style='color:red'> PDF Document: "+fileName+" does not contain [<b> "+collectiveEndorsementCode+" </b>] </p>", "Fail", false);
						//TestUtil.reportStatus("<p style='color:red'> Endorsement <b> [ "+collectiveEndorsementCode+" ] </b> is not present on premium summary page.</p>", "Info", false);
						fail_count = fail_count + 1;
					}
				}
				
				//Validate extra endorsement present on Endorsement screen should not be present on Premium Screen.
				Iterator extraEndorsementDetailsIT = common.ExtraEndorsementList.entrySet().iterator();
				while(extraEndorsementDetailsIT.hasNext()){
					Map.Entry extraEdnorsementValue = (Map.Entry)extraEndorsementDetailsIT.next();
					String extraEDCode = extraEdnorsementValue.getValue().toString();
					
					if(parsedText.contains(extraEDCode)){
						TestUtil.reportStatus("<p style='color:red'> PDF Document: "+fileName+" does not contain [<b> "+extraEDCode+" </b>] </p>", "Fail", false);
						//TestUtil.reportStatus("<p style='color:red'> Endorsement <b> [ "+collectiveEndorsementCode+" ] </b> is not present on premium summary page.</p>", "Info", false);
						fail_count = fail_count + 1;
						//TestUtil.reportStatus("<p style='color:red'> Extra endorsement <b> [ "+extraEDCode+" ] </b> is getting displayed on Premium Summary screen which should not be present. </p>", "Info", true);
					}
				}
				
				//This will verify endorsements presents below "Sections Endorsements" table.
				flag="true";
				collectiveDataIT = common.EndorsementCollectiveData.entrySet().iterator();
				while(collectiveDataIT.hasNext()){
					Map.Entry collectiveDataMapValue = (Map.Entry)collectiveDataIT.next();
					String collectiveEndorsementCode = collectiveDataMapValue.getKey().toString();
					
					Iterator individualDataIT = common.EndorsementCollectiveData.get(collectiveEndorsementCode).entrySet().iterator();
					while(individualDataIT.hasNext()){
						Map.Entry individualDataMapValue = (Map.Entry)individualDataIT.next();
						String individualEndorsementTitle = individualDataMapValue.getValue().toString();
						if(individualEndorsementTitle.contains("Contract Lift")){
							individualEndorsementTitle = "CPA Contract Lift Cover (Lifted Goods)";
						}
						if(individualEndorsementTitle.contains("Offshore Work")){
							individualEndorsementTitle = "Offshore Work And Visits";
						}
						String mergedEndorsementText = collectiveEndorsementCode+" - "+individualEndorsementTitle;
						if(parsedText.contains(mergedEndorsementText)){
							//TestUtil.reportStatus("Verified Endorsement : [<b> "+collectiveEndorsementCode+" - "+individualEndorsementTitle+"</b>] in "+fileName+" document.", "Pass", false);
							//TestUtil.reportStatus("Applied Endorsement <b> [ "+collectiveEndorsementCode+" </b> with title as <b> "+individualEndorsementSection+" ] </b> is present on premium summary page.", "Info", false);
							fail_count = fail_count + 0;
							flag = "true";
							break;
						}else{
							flag="false";
						}
					}
					if(flag.equalsIgnoreCase("false")){
						TestUtil.reportStatus("<p style='color:red'> PDF Document: "+fileName+" does not contain [<b> "+collectiveEndorsementCode+" </b>] </p>", "Fail", false);
						//TestUtil.reportStatus("<p style='color:red'> Endorsement <b> [ "+collectiveEndorsementCode+" ] </b> is not present on premium summary page.</p>", "Info", false);
						fail_count = fail_count + 1;
					}
				}
				
				//Validate extra endorsement present on Endorsement screen should not be present on Premium Screen.
				extraEndorsementDetailsIT = common.ExtraEndorsementList.entrySet().iterator();
				while(extraEndorsementDetailsIT.hasNext()){
					Map.Entry extraEdnorsementValue = (Map.Entry)extraEndorsementDetailsIT.next();
					String extraEDCode = extraEdnorsementValue.getValue().toString();
					
					if(parsedText.contains(extraEDCode)){
						TestUtil.reportStatus("<p style='color:red'> PDF Document: "+fileName+" does not contain [<b> "+extraEDCode+" </b>] </p>", "Fail", false);
						//TestUtil.reportStatus("<p style='color:red'> Endorsement <b> [ "+collectiveEndorsementCode+" ] </b> is not present on premium summary page.</p>", "Info", false);
						fail_count = fail_count + 1;
						//TestUtil.reportStatus("<p style='color:red'> Extra endorsement <b> [ "+extraEDCode+" ] </b> is getting displayed on Premium Summary screen which should not be present. </p>", "Info", true);
					}
				}	
				
				if(common.currentRunningFlow.contains("MTA")||(TestBase.businessEvent.equals("MTA")&&common.currentRunningFlow.contains("Rewind"))){
					
					if(TestBase.product.equals("XOC") || TestBase.product.equals("XOQ")) {
						
						double total_Gross_Premium = common_VELA.transaction_Details_Premium_Values.get("Totals").get("Gross Premium");
						String formated_G_premium="";
						formated_G_premium = (formatter.format(total_Gross_Premium)).toString();
						String formated_G_premium_1 = formated_G_premium.split("\\.")[0];
						if(total_Gross_Premium < 0){
							fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("Return Premium "+formated_G_premium_1), "Return Premium = &pound;"+formated_G_premium_1 , fileName);
						}else{
							fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("Additional Premium "+formated_G_premium_1), "Additional Premium = &pound;"+formated_G_premium_1 , fileName);
						}
					
						
			           // fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("Return Premium "+formated_G_premium), "Additional Premium = &pound;"+formated_G_premium , fileName);
						
						String total_policy_fee = (String)mdata.get("PS_TotalAdminFee");
						String formated_policy_fee = formatter.format((int) Math.floor(Double.parseDouble(total_policy_fee)));
						fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("Policy Fee "+formated_policy_fee), "Policy Fee &pound;"+formated_policy_fee , fileName);
						
						double total_I_tax = common_VELA.transaction_Details_Premium_Values.get("Totals").get("Insurance Tax");
						String formated_I_tax="";
					formated_I_tax = formatter.format(total_I_tax).toString();
					fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("Tax "+formated_I_tax), "Insurance Premium Tax = &pound;"+formated_I_tax , fileName);
						
					double total_p = total_Gross_Premium + Double.parseDouble(total_policy_fee) + total_I_tax;
						String formated_total_Premium="";
					    formated_total_Premium = formatter.format(total_p).toString();
					    String formated_total_Premium_1 = formated_total_Premium.split("\\.")[0];
					    fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("TOTAL "+formated_total_Premium_1), "TOTAL &pound;"+formated_total_Premium_1 , fileName);
					
					}else {
					
					
					double total_Gross_Premium = common_VELA.transaction_Details_Premium_Values.get("Totals").get("Gross Premium");
					String formated_G_premium = formatter.format((int) Math.floor(total_Gross_Premium));
					fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("Additional Premium "+formated_G_premium), "Additional Premium = &pound;"+formated_G_premium , fileName);
					
					String total_policy_fee = (String)mdata.get("PS_TotalAdminFee");
					String formated_policy_fee = formatter.format((int) Math.floor(Double.parseDouble(total_policy_fee)));
					
					fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("Policy Fee "+formated_policy_fee), "Policy Fee &pound;"+formated_policy_fee , fileName);
					
					double total_I_tax = common_VELA.transaction_Details_Premium_Values.get("Totals").get("Insurance Tax");
					String formated_I_tax = formatter.format((int) Math.floor(total_I_tax));
					
					fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("Insurance Premium Tax "+formated_I_tax), "Insurance Premium Tax = &pound;"+formated_I_tax , fileName);
					double total_p = total_Gross_Premium + Double.parseDouble(total_policy_fee) + total_I_tax;
					String formated_total_Premium = formatter.format((int) Math.floor(total_p));
					
					fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("TOTAL "+formated_total_Premium), "TOTAL &pound;"+formated_total_Premium , fileName);
					}
				}else if(!((String)mdata.get("PS_Duration")).equalsIgnoreCase("365")){
					
					double total_Gross_Premium = transaction_Premium_Values.get("Totals").get("Gross Premium");
					String formated_G_premium = formatter.format((int) Math.floor(total_Gross_Premium));
					fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("Premium "+formated_G_premium), "Premium = &pound;"+formated_G_premium , fileName);
					
					String total_policy_fee = (String)mdata.get("PS_TotalAdminFee");
					String formated_policy_fee = formatter.format((int) Math.floor(Double.parseDouble(total_policy_fee)));
					
					fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("Policy Fee "+formated_policy_fee), "Policy Fee &pound;"+formated_policy_fee , fileName);
					
					double total_I_tax = transaction_Premium_Values.get("Totals").get("Insurance Tax");
					String formated_I_tax = formatter.format((int) Math.floor(total_I_tax));
					
					fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("Insurance Premium Tax "+formated_I_tax), "Insurance Premium Tax = &pound;"+formated_I_tax , fileName);
					double total_p=(transaction_Premium_Values.get("Totals").get("Gross Premium")) + (transaction_Premium_Values.get("Totals").get("Insurance Tax")) + Double.parseDouble((String)mdata.get("PS_TotalAdminFee"));
					String formated_total_Premium = formatter.format((int) Math.floor(total_p));
					
					fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("TOTAL "+formated_total_Premium), "TOTAL &pound;"+formated_total_Premium , fileName);
					
				}else{
					String total_Gross_Premium = (String)mdata.get("PS_Total_GP");
					String formated_G_premium = formatter.format((int) Math.floor(Double.parseDouble(total_Gross_Premium)));
					fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("Premium "+formated_G_premium), "Premium = &pound;"+formated_G_premium , fileName);
					
					String total_policy_fee = (String)mdata.get("PS_TotalAdminFee");
					String formated_policy_fee = formatter.format((int) Math.floor(Double.parseDouble(total_policy_fee)));
					
					fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("Policy Fee "+formated_policy_fee), "Policy Fee &pound;"+formated_policy_fee , fileName);
					
					String total_I_tax = (String)mdata.get("PS_Total_GT"); 
					String formated_I_tax = formatter.format((int) Math.floor(Double.parseDouble(total_I_tax)));
					
					fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("Tax "+formated_I_tax), "Tax = &pound;"+formated_I_tax , fileName);
					double total_p=(Double.parseDouble((String)mdata.get("PS_Total_GP"))) + (Double.parseDouble((String)mdata.get("PS_Total_GT"))) + Double.parseDouble((String)mdata.get("PS_TotalAdminFee"));
					
					String formated_total_Premium = formatter.format((int) Math.floor(total_p));
					
					fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("TOTAL "+formated_total_Premium), "TOTAL &pound;"+formated_total_Premium , fileName);
					
				}
				
				break;
				
			case "Certificate of Insurance":
								
				formatter = new DecimalFormat("#,###,###.##");
				incrementalDays = Integer.parseInt(CONFIG.getProperty("DaysIncrementNumber"));
				if(TestBase.businessEvent.equals("Renewal")){
				policyDuration = Integer.parseInt((String)mdata.get("PS_Duration"));
				}else{
				policyDuration = Integer.parseInt((String)mdata.get("PS_Duration"));
				}
				fail_count=0;
						
					fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("CERTIFICATE OF INSURANCE"), "Document : CERTIFICATE OF INSURANCE", fileName);
					fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("CERTIFICATE OF QUALIFYING INSURANCE"), "CERTIFICATE OF QUALIFYING INSURANCE" , fileName);
					fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("INDEMNITY YEAR"), "INDEMNITY YEAR" , fileName);
					fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("PRINCIPAL ADDRESS OF "+(String)mdata.get("PG_Address")), "PRINCIPAL ADDRESS OF "+(String)mdata.get("PG_Address") , fileName);
					if(common.currentRunningFlow.equals("Renewal")){
						fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("NAME OF INSURED FIRM: "+(String)mdata.get(common.currentRunningFlow+"_ClientName")), "NAME OF INSURED FIRM: "+(String)mdata.get(common.currentRunningFlow+"_ClientName") , fileName);
						fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("POLICY NUMBER: "+(String)mdata.get(common.currentRunningFlow+"_PolicyNumber")) ,"POLICY NUMBER: "+mdata.get(common.currentRunningFlow+"_PolicyNumber"),fileName);
				
					}else{
						fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("NAME OF INSURED FIRM: "+(String)mdata.get("NB_ClientName")), "NAME OF INSURED FIRM: "+(String)mdata.get("NB_ClientName") , fileName);
						fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("POLICY NUMBER: "+(String)mdata.get("NB_PolicyNumber")) ,"POLICY NUMBER: "+mdata.get("NB_PolicyNumber"),fileName);
					}
					
				
				break;
		
			case "Statement of Fact":
				
				fail_count=0;
				formatter = new DecimalFormat("#,###,###.##");
				String formated_turnover = null;
				incrementalDays = Integer.parseInt(CONFIG.getProperty("DaysIncrementNumber"));
				//Below line is not working in all servers excluding 56 hence commenting line.
				//fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains((String)mdata.get("pdf_ProductName")), "Product name :"+(String)mdata.get("pdf_ProductName") , fileName);
				
				if(TestBase.businessEvent.equals("Renewal")){
					fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("INSURED NAME - "+(String)common.Renewal_excel_data_map.get("Renewal_ClientName")), "Insured Name : "+(String)common.Renewal_excel_data_map.get("Renewal_ClientName") , fileName);
						
				}else{
					if(common.currentRunningFlow.contains("NB") || common.currentRunningFlow.contains("MTA")|| common.currentRunningFlow.contains("Rewind")){
						fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("INSURED NAME - "+(String)common.NB_excel_data_map.get("NB_ClientName")), "Insured Name : "+(String)common.NB_excel_data_map.get("NB_ClientName") , fileName);
					}else{
						fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("INSURED NAME - "+(String)mdata.get(common.currentRunningFlow+"_ClientName")), "Insured Name : "+(String)mdata.get(common.currentRunningFlow+"_ClientName") , fileName);
					}
				}
				if(TestBase.businessEvent.equals("Renewal")){
					fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("BROKER NAME - "+(String)common.Renewal_excel_data_map.get("QC_AgencyName")), "BROKER NAME - "+(String)common.Renewal_excel_data_map.get("QC_AgencyName") , fileName);
				}else{
					fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("BROKER NAME - "+(String)common.NB_excel_data_map.get("QC_AgencyName")), "BROKER NAME - "+(String)common.NB_excel_data_map.get("QC_AgencyName") , fileName);
				}
				
				if(docType.contains("Draft")){
					if(!(common.currentRunningFlow.equals("Renewal")||(TestBase.businessEvent.equals("Renewal")&&common.currentRunningFlow.equals("Rewind"))||(TestBase.businessEvent.equals("Renewal")&&common.currentRunningFlow.equals("MTA")))){
						fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("Quote Reference: "+(String)mdata.get("NB_QuoteNumber")) ,"Quote Reference : "+mdata.get("NB_QuoteNumber"),fileName);
						fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("Quotation Date: "+common.daysIncrement((String)mdata.get("QuoteDate"), -incrementalDays)) ,"Quote Date : "+common.daysIncrement((String)mdata.get("QuoteDate"), -incrementalDays),fileName);
					}else{
						fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("Quote Reference: "+(String)common.Renewal_excel_data_map.get("Renewal_QuoteNumber")) ,"Quote Reference : "+common.Renewal_excel_data_map.get("Renewal_QuoteNumber"),fileName);
				}
				}
				/*if(TestBase.businessEvent.equals("Renewal")){
					//fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("Registered Address: "+(String)common.Renewal_excel_data_map.get("PG_Address")), "Registered Address: "+(String)common.Renewal_excel_data_map.get("PG_Address") , fileName);
						
				}else{
					fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("Registered Address: "+(String)mdata.get("CC_Address")), "Registered Address: "+(String)mdata.get("CC_Address") , fileName);
				}*/
				String[] substring = null;
				String[] substringParsedText = null;
				
				if(!TestBase.product.equalsIgnoreCase("LEA")&&!TestBase.product.equalsIgnoreCase("XOC")&&!TestBase.product.equalsIgnoreCase("XOQ")){
					
					if(common.currentRunningFlow.equals("MTA")) {
					if(((String)mdata.get("CD_Public&ProductsLiability")).equals("Yes") && ((String)common.MTA_excel_data_map.get("CD_AnnualWorks")).equals("Yes")){
						if(((String)mdata.get("CD_LegalExpenses")).equals("Yes")){
							formated_turnover = formatter.format(Double.parseDouble((String)common.MTA_excel_data_map.get("LE_Turnover")));
						}else{
							formated_turnover = formatter.format(Double.parseDouble((String)common.MTA_excel_data_map.get("PG_TurnOver")));
						}
						fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("Turnover "+formated_turnover), "Turnover &pound;"+formated_turnover , fileName);
					}
					}else {
						if(((String)mdata.get("CD_Public&ProductsLiability")).equals("Yes") && ((String)mdata.get("CD_AnnualWorks")).equals("Yes")){
							if(((String)mdata.get("CD_LegalExpenses")).equals("Yes")){
								formated_turnover = formatter.format(Double.parseDouble((String)mdata.get("LE_Turnover")));
							}else{
								formated_turnover = formatter.format(Double.parseDouble((String)mdata.get("PG_TurnOver")));
							}
							fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("Turnover "+formated_turnover), "Turnover &pound;"+formated_turnover , fileName);
						}
						
						
					}
					substring = parsedText.split("Operative Sections");
					substringParsedText = substring[1].split("Employee Wages Breakdown");
				}
				
				switch (CommonFunction_VELA.product) {
				case "COB":
				case "COA":
					/*if(((String)mdata.get("CD_JCT6.5.1")).equals("Yes")){
						fail_count = fail_count + CommonFunction_VELA.verification(substringParsedText[0].contains("JCT 6.5.1"), "JCT 6.5.1" , fileName);
					}else{
						fail_count = fail_count + CommonFunction_VELA.verification(!substringParsedText[0].contains("JCT 6.5.1"), "JCT 6.5.1" , fileName);
					}
					if(((String)mdata.get("CD_PropertyOwnersLiability")).equals("Yes")){
						fail_count = fail_count + CommonFunction_VELA.verification(substringParsedText[0].contains("Property Owners Liability"), "Property Owners Liability" , fileName);
					}else{
						fail_count = fail_count + CommonFunction_VELA.verification(!substringParsedText[0].contains("Property Owners Liability"), "Property Owners Liability" , fileName);
					}*/					
			
					break;
				case "XOC":
				case "XOQ":
					if(common.currentRunningFlow.contains("MTA")){
						mdata= common.MTA_excel_data_map;
					}else if(common.currentRunningFlow.contains("CAN")){
						mdata= common.CAN_excel_data_map;
					}else if(common.currentRunningFlow.contains("Rewind")){
						mdata= common.Rewind_excel_data_map;
					}else if(common.currentRunningFlow.contains("Requote")){
						mdata= common.Requote_excel_data_map;
					}else if(common.currentRunningFlow.contains("Renewal")){
						mdata= common.Renewal_excel_data_map;
					}else{
						mdata= common.NB_excel_data_map;
					}
					
					if(isRequote.equalsIgnoreCase("Yes")){
						if(((String)mdata.get("CD_Add_CombinedLiability")).equals("Yes")){
							fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("Employers Liability"), "Employers Liability " , fileName);
							fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("Public & Products Liability"), "Public & Products Liability" , fileName);
						}
						if(((String)mdata.get("CD_Add_EmployersLiability")).equals("Yes")){
							fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("Employers Liability"), "Employers Liability " , fileName);
						}
						if(((String)mdata.get("CD_Add_Public&ProductsLiability")).equals("Yes")){
							fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("Public & Products Liability"), "Public & Products Liability" , fileName);
						}
						if(((String)mdata.get("CD_Add_JCT6.5.1")).equals("Yes")){
							fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("JCT 6.5.1"), "JCT 6.5.1" , fileName);
						}
						if(((String)mdata.get("CD_Add_ThirdPartyMotorLiability")).equals("Yes")){
							fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("Third Party Motor Liability"), "Third Party Motor Liability" , fileName);
						}	
					}
					else{
					if(((String)mdata.get("CD_CombinedLiability")).equals("Yes")){
						fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("Employers Liability"), "Employers Liability " , fileName);
						fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("Public & Products Liability"), "Public & Products Liability" , fileName);
					}
					if(((String)mdata.get("CD_EmployersLiability")).equals("Yes")){
						fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("Employers Liability"), "Employers Liability " , fileName);
					}
					if(((String)mdata.get("CD_Public&ProductsLiability")).equals("Yes")){
						fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("Public & Products Liability"), "Public & Products Liability" , fileName);
					}
					if(((String)mdata.get("CD_JCT6.5.1")).equals("Yes")){
						fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("JCT 6.5.1"), "JCT 6.5.1" , fileName);
					}
					if(((String)mdata.get("CD_ThirdPartyMotorLiability")).equals("Yes")){
						fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("Third Party Motor Liability"), "Third Party Motor Liability" , fileName);
					}
					
					}
					break;
				default:
					break;
				}
				
				break;
				
			case "Policy Wording":
				
				TestUtil.reportStatus(fileName+" Verification Not in Scope . ", "Info", true);
				break;
				
			case "Employers Liability Certificate":
				
//				fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("Policy Number: "+(String)mdata.get("NB_PolicyNumber")), "Policy Number: "+(String)mdata.get("NB_PolicyNumber") , fileName);
				fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("Name of Insured: "+(String)mdata.get("NB_ClientName")), "Name of Insured: "+(String)mdata.get("NB_ClientName") , fileName);
				fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("Date of Commencement of Insurance: "+common.daysIncrement((String)mdata.get("QC_InceptionDate"), 0)), "Date of Commencement of Insurance: "+common.daysIncrement((String)mdata.get("QC_InceptionDate"), 0) , fileName);
				fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("Date of Expiry of Insurance: "+common.daysIncrement((String)mdata.get("QC_DeadlineDate"), 0)), "Date of Expiry of Insurance: "+common.daysIncrement((String)mdata.get("QC_DeadlineDate"), 0) , fileName);
				
				break;
			case "Invoice":
				formatter = new DecimalFormat("#,###,###.##");
				
				switch (common.currentRunningFlow) {
				case "MTA":
					mdata = common.MTA_excel_data_map;
					break;
				/*case "Renewal":
					mdata = common.Renewal_excel_data_map;
					break;
				case "Rewind":
					mdata = common.Rewind_excel_data_map;
					break;	*/
				}
				
				if(common.currentRunningFlow.contains("MTA")) {
					int i = 0;
				}
				//This line is thorwing error because defect is raised against this. As per Rahul , This is commented untill resolution.
				//fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("Payment Due Date: On or before "+common.getLastDayOfMonth((String)mdata.get("QC_InceptionDate"), 1)), "Payment Due Date: On or before "+common.getLastDayOfMonth((String)mdata.get("QC_InceptionDate"), 1) , fileName);
				
				if(common.currentRunningFlow.contains("NB") || common.currentRunningFlow.contains("MTA") || common.currentRunningFlow.contains("Rewind")|| common.currentRunningFlow.contains("Requote")){
					if(!TestBase.businessEvent.equals("Renewal")){
					fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("Policy No: "+(String)common.NB_excel_data_map.get("NB_PolicyNumber")), "Policy No: "+(String)common.NB_excel_data_map.get("NB_PolicyNumber") , fileName);
					fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains((String)common.NB_excel_data_map.get("NB_ClientName")), (String)common.NB_excel_data_map.get("NB_ClientName"), fileName);
					}else{
						fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("Policy No: "+(String)common.Renewal_excel_data_map.get("Renewal_PolicyNumber")), "Policy No: "+(String)common.Renewal_excel_data_map.get("Renewal_PolicyNumber") , fileName);
						fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains((String)common.Renewal_excel_data_map.get("Renewal_ClientName")), (String)common.Renewal_excel_data_map.get("Renewal_ClientName"), fileName);
					}
					
				}else{
					fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("Policy No: "+(String)mdata.get(common.currentRunningFlow+"_PolicyNumber")), "Policy No: "+(String)mdata.get(common.currentRunningFlow+"_PolicyNumber") , fileName);
					fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains((String)mdata.get(common.currentRunningFlow+"_ClientName")), (String)mdata.get(common.currentRunningFlow+"_ClientName"), fileName);
				}
				
				if(!TestBase.businessEvent.contains("Renewal")){
					if(!TestBase.businessEvent.equals("Renewal")){
					fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("Invoice Date: "+(String)common.NB_excel_data_map.get("QC_InceptionDate")), "Invoice Date: "+(String)common.NB_excel_data_map.get("QC_InceptionDate") , fileName);
					}
					
					if((common.currentRunningFlow.contains("MTA") && TestBase.businessEvent.equalsIgnoreCase("MTA")) ||
							common.currentRunningFlow.contains("Rewind") && TestBase.businessEvent.equalsIgnoreCase("MTA")){
						fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("Period: "+(String)common.MTA_excel_data_map.get("MTA_EffectiveDate")+" to "+common.daysIncrementWithOutFormation((String)common.NB_excel_data_map.get("QC_InceptionDate"), Integer.parseInt((String)mdata.get("PS_Duration"))-1)), "Period: "+(String)common.MTA_excel_data_map.get("MTA_EffectiveDate")+" to "+common.daysIncrementWithOutFormation((String)common.NB_excel_data_map.get("QC_InceptionDate"), Integer.parseInt((String)mdata.get("PS_Duration"))-1) , fileName);
					}else{
						if(!TestBase.businessEvent.equals("Renewal")){
						fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("Period: "+(String)common.NB_excel_data_map.get("QC_InceptionDate")+" to "+common.daysIncrementWithOutFormation((String)common.NB_excel_data_map.get("QC_InceptionDate"), Integer.parseInt((String)mdata.get("PS_Duration"))-1)), "Period: "+(String)common.NB_excel_data_map.get("QC_InceptionDate")+" to "+common.daysIncrementWithOutFormation((String)common.NB_excel_data_map.get("QC_InceptionDate"), Integer.parseInt((String)mdata.get("PS_Duration"))-1) , fileName);
						}else{
					fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("Period: "+(String)common.Renewal_excel_data_map.get("PS_PolicyStartDate")+" to "+common.daysIncrementWithOutFormation((String)common.Renewal_excel_data_map.get("PS_PolicyStartDate"), Integer.parseInt((String)mdata.get("PS_Duration"))-1)), "Period: "+(String)common.Renewal_excel_data_map.get("PS_PolicyStartDate")+" to "+common.daysIncrementWithOutFormation((String)common.Renewal_excel_data_map.get("PS_PolicyStartDate"), Integer.parseInt((String)mdata.get("PS_Duration"))-1) , fileName);
								
						}
						}
					
				}
				
				if(common.currentRunningFlow.contains("MTA")||(TestBase.businessEvent.equals("MTA")&&common.currentRunningFlow.contains("Rewind"))){
					
					if(TestBase.product.equals("XOC") || TestBase.product.equals("XOQ")) {
						
						double total_Gross_Premium = common_VELA.transaction_Details_Premium_Values.get("Totals").get("Gross Premium");
						String formated_G_premium="";
						formated_G_premium = (formatter.format(total_Gross_Premium)).toString();
						String formated_G_premium_1 = formated_G_premium.split("\\.")[0];
						if(total_Gross_Premium < 0){
							fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("Return Premium "+formated_G_premium_1), "Return Premium = &pound;"+formated_G_premium_1 , fileName);
						}else{
							fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("Additional Premium "+formated_G_premium_1), "Additional Premium = &pound;"+formated_G_premium_1 , fileName);
						}
					
						
			           // fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("Return Premium "+formated_G_premium), "Additional Premium = &pound;"+formated_G_premium , fileName);
						
						String total_policy_fee = (String)mdata.get("PS_TotalAdminFee");
						String formated_policy_fee = formatter.format((int) Math.floor(Double.parseDouble(total_policy_fee)));
						fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("Policy Fee "+formated_policy_fee), "Policy Fee &pound;"+formated_policy_fee , fileName);
						
						double total_I_tax = common_VELA.transaction_Details_Premium_Values.get("Totals").get("Insurance Tax");
						String formated_I_tax="";
						formated_I_tax = formatter.format(total_I_tax).toString();
						fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("Tax "+formated_I_tax), "Insurance Premium Tax = &pound;"+formated_I_tax , fileName);
						
						double total_p = total_Gross_Premium + Double.parseDouble(total_policy_fee) + total_I_tax - common_VELA.transaction_Details_Premium_Values.get("Totals").get("Broker Commission");
						String formated_total_Premium="";
					    formated_total_Premium = formatter.format(total_p).toString();
					    String formated_total_Premium_1 = formated_total_Premium.split("\\.")[0];
					    fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("Total "+formated_total_Premium_1), "Total &pound;"+formated_total_Premium_1 , fileName);
					
					}else {
					
					
					double total_Gross_Premium = common_VELA.transaction_Details_Premium_Values.get("Totals").get("Gross Premium");
					String formated_G_premium = formatter.format((int) Math.floor(total_Gross_Premium));
					fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("Additional Premium "+formated_G_premium), "Additional Premium = &pound;"+formated_G_premium , fileName);
					
					String total_policy_fee = (String)mdata.get("PS_TotalAdminFee");
					String formated_policy_fee = formatter.format((int) Math.floor(Double.parseDouble(total_policy_fee)));
					
					fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("Policy Fee "+formated_policy_fee), "Policy Fee &pound;"+formated_policy_fee , fileName);
					
					double total_I_tax = common_VELA.transaction_Details_Premium_Values.get("Totals").get("Insurance Tax");
					String formated_I_tax = formatter.format((int) Math.floor(total_I_tax));
					
					fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("Tax "+formated_I_tax), "Insurance Premium Tax = &pound;"+formated_I_tax , fileName);
					double total_p = total_Gross_Premium + Double.parseDouble(total_policy_fee) + total_I_tax - common_VELA.transaction_Details_Premium_Values.get("Totals").get("Broker Commission");
					String formated_total_Premium = formatter.format((int) Math.floor(total_p));
					
					fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("Total "+formated_total_Premium), "Total &pound;"+formated_total_Premium , fileName);
					}
				}else if(!((String)mdata.get("PS_Duration")).equalsIgnoreCase("365")){
					
					double total_Gross_Premium = transaction_Premium_Values.get("Totals").get("Gross Premium");
					String formated_G_premium = formatter.format((int) Math.floor(total_Gross_Premium));
					fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("Premium "+formated_G_premium), "Premium = &pound;"+formated_G_premium , fileName);
					
					String total_policy_fee = (String)mdata.get("PS_TotalAdminFee");
					String formated_policy_fee = formatter.format((int) Math.floor(Double.parseDouble(total_policy_fee)));
					
					fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("Policy Fee "+formated_policy_fee), "Policy Fee &pound;"+formated_policy_fee , fileName);
					
					double total_I_tax = transaction_Premium_Values.get("Totals").get("Insurance Tax");
					String formated_I_tax = formatter.format((int) Math.floor(total_I_tax));
					
					fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("Insurance Premium Tax "+formated_I_tax), "Insurance Premium Tax = &pound;"+formated_I_tax , fileName);
					double total_p=(transaction_Premium_Values.get("Totals").get("Gross Premium")) + (transaction_Premium_Values.get("Totals").get("Insurance Tax")) + Double.parseDouble((String)mdata.get("PS_TotalAdminFee"));
					String formated_total_Premium = formatter.format((int) Math.floor(total_p));
					
					fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("TOTAL "+formated_total_Premium), "TOTAL &pound;"+formated_total_Premium , fileName);
					
				}else{
					String total_Gross_Premium = (String)mdata.get("PS_Total_GP");
					String formated_G_premium = formatter.format((int) Math.floor(Double.parseDouble(total_Gross_Premium)));
					fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("Premium "+formated_G_premium), "Premium = &pound;"+formated_G_premium , fileName);
					
					String total_policy_fee = (String)mdata.get("PS_TotalAdminFee");
					String formated_policy_fee = formatter.format((int) Math.floor(Double.parseDouble(total_policy_fee)));
					
					fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("Policy Fee "+formated_policy_fee), "Policy Fee &pound;"+formated_policy_fee , fileName);
					
					String total_I_tax = (String)mdata.get("PS_Total_GT"); 
					String formated_I_tax = formatter.format((int) Math.floor(Double.parseDouble(total_I_tax)));
					
					fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("Tax "+formated_I_tax), "Tax = &pound;"+formated_I_tax , fileName);
					double total_p=(Double.parseDouble((String)mdata.get("PS_Total_GP"))) + (Double.parseDouble((String)mdata.get("PS_Total_GT"))) + Double.parseDouble((String)mdata.get("PS_TotalAdminFee"))- (Double.parseDouble((String)mdata.get("PS_BrokerCommissionTotal")));
					
					String formated_total_Premium = formatter.format((int) Math.floor(total_p));
					
					fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("Total "+formated_total_Premium), "Total &pound;"+formated_total_Premium , fileName);
					
				}
				
				
				/*if(!common.currentRunningFlow.contains("MTA")){
					if(!((String)mdata.get("PS_Duration")).equalsIgnoreCase("365")){
						
						double total_Gross_Premium = transaction_Premium_Values.get("Totals").get("Gross Premium");
						String formated_G_premium = formatter.format((int) Math.floor(total_Gross_Premium));
						fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("Premium "+formated_G_premium), "Premium = &pound;"+formated_G_premium , fileName);
						
						String total_policy_fee = (String)mdata.get("PS_TotalAdminFee");
						String formated_policy_fee = formatter.format((int) Math.floor(Double.parseDouble(total_policy_fee)));
						
						fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("Policy Fee "+formated_policy_fee), "Policy Fee &pound;"+formated_policy_fee , fileName);
						
						double total_I_tax = transaction_Premium_Values.get("Totals").get("Insurance Tax");
						String formated_I_tax = formatter.format((int) Math.floor(total_I_tax));
						
						fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("Tax "+formated_I_tax), "Insurance Premium Tax = &pound;"+formated_I_tax , fileName);
						double total_p=(transaction_Premium_Values.get("Totals").get("Gross Premium")) + (transaction_Premium_Values.get("Totals").get("Insurance Tax")) + Double.parseDouble((String)mdata.get("PS_TotalAdminFee"))  - (transaction_Premium_Values.get("Totals").get("Broker Commission"));
						String formated_total_Premium = formatter.format((int) Math.floor(total_p));
						
						fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("Total "+formated_total_Premium), "Total &pound;"+formated_total_Premium , fileName);
		
					}else{
						String total_Gross_Premium = (String)mdata.get("PS_Total_GP");
						String formated_G_premium = formatter.format((int) Math.floor(Double.parseDouble(total_Gross_Premium)));
						fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("Premium "+formated_G_premium), "Premium = &pound;"+formated_G_premium , fileName);
						
						String total_policy_fee = (String)mdata.get("PS_TotalAdminFee");
						String formated_policy_fee = formatter.format((int) Math.floor(Double.parseDouble(total_policy_fee)));
						
						fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("Policy Fee "+formated_policy_fee), "Policy Fee &pound;"+formated_policy_fee , fileName);
						
						String total_I_tax = (String)mdata.get("PS_Total_GT"); 
						String formated_I_tax = formatter.format((int) Math.floor(Double.parseDouble(total_I_tax)));
						
						fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("Tax "+formated_I_tax), "Insurance Premium Tax = &pound;"+formated_I_tax , fileName);
						double total_p=(Double.parseDouble((String)mdata.get("PS_Total_GP"))) + (Double.parseDouble((String)mdata.get("PS_Total_GT"))) + Double.parseDouble((String)mdata.get("PS_TotalAdminFee"))  - Double.parseDouble((String)mdata.get("PS_BrokerCommissionTotal"));
						
						String formated_total_Premium = formatter.format((int) Math.floor(total_p));
						
						fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("Total "+formated_total_Premium), "Total &pound;"+formated_total_Premium , fileName);
						
					}
				}*/
				
				break;
		
		}
		
		return fail_count;
		
	}
		
public boolean verifyEndorsementONPremiumSummary(Map<Object, Object> map_data) {
	
	try{
		k.ImplicitWaitOff();
		String flag = "true";
		List<WebElement> listOfParagraphTags = driver.findElements(By.xpath("//*[@id='mainpanel']/p"));
		
		for(int i=0;i<listOfParagraphTags.size()-1;i++){
			String textName = listOfParagraphTags.get(i).getText();
			
			if(textName.contains("Endorsement")){
				
				Iterator collectiveDataIT = EndorsementCollectiveData.entrySet().iterator();
				while(collectiveDataIT.hasNext()){
					Map.Entry collectiveDataMapValue = (Map.Entry)collectiveDataIT.next();
					String collectiveEndorsementCode = collectiveDataMapValue.getKey().toString();
					
					Iterator individualDataIT = EndorsementCollectiveData.get(collectiveEndorsementCode).entrySet().iterator();
					while(individualDataIT.hasNext()){
						Map.Entry individualDataMapValue = (Map.Entry)individualDataIT.next();
						String individualEndorsementTitle = individualDataMapValue.getValue().toString();
						if(individualEndorsementTitle.contains("Contract Lift")){
							individualEndorsementTitle = "CPA Contract Lift Cover (Lifted Goods)";
						}
						if(individualEndorsementTitle.contains("Offshore Work")){
							individualEndorsementTitle = "Offshore Work And Visits";
						}
						String mergedEndorsementText = collectiveEndorsementCode + " " + individualEndorsementTitle;
						if(textName.toLowerCase().contains(mergedEndorsementText.toLowerCase())){
							TestUtil.reportStatus("Applied Endorsement <b> [ "+collectiveEndorsementCode+" </b> with title as <b> "+individualEndorsementTitle+" ] </b> is present on premium summary page.", "Info", false);
							flag = "true";
							break;
						}else{
							flag="false";
						}
					}
					if(flag.equalsIgnoreCase("false")){
						TestUtil.reportStatus("<p style='color:red'> Endorsement <b> [ "+collectiveEndorsementCode+" ] </b> is not present on premium summary page.</p>", "Info", false);
					}
				}
				
				//Validate extra endorsement present on Endorsement screen should not be present on Premium Screen.
				Iterator extraEndorsementDetailsIT = ExtraEndorsementList.entrySet().iterator();
				while(extraEndorsementDetailsIT.hasNext()){
					Map.Entry extraEdnorsementValue = (Map.Entry)extraEndorsementDetailsIT.next();
					String extraEDCode = extraEdnorsementValue.getValue().toString();
					
					if(textName.contains(extraEDCode)){
						TestUtil.reportStatus("<p style='color:red'> Extra endorsement <b> [ "+extraEDCode+" ] </b> is getting displayed on Premium Summary screen which should not be present. </p>", "Info", true);
					}
				}
				break;
			}

		}
	}catch(Throwable t){
		k.ImplicitWaitOn();
		return false;
	}finally{
		k.ImplicitWaitOn();
	}
	return true;
}

public double funcRateCalculatorPDF(String covername,String AdjustedRate){
	try{
		Map<Object,Object> mdata =  null;
		
		switch (common.currentRunningFlow) {
			case "Renewal":
				mdata = common.Renewal_excel_data_map;
			break;
			default:
				mdata=common.NB_excel_data_map;
			break;
		
		}
		if(covername.equals("Public & Products Liability")){covername="Public&ProductsLiability";}
		if(covername.equals("Employers Liability")){covername="EmployersLiability";}
		if(covername.equals("Annual Works")){covername="AnnualWorks";}
		if(covername.equals("Own Plant")){covername="OwnPlant";}
		if(covername.equals("Hired In Plant")){covername="HiredInPlant";}
		if(covername.equals("JCT 6.5.1")){covername="JCT6.5.1";}
		if(covername.equals("Terrorism")){covername="Terrorism";}
		if(covername.equals("Property Owners Liability")){covername="PropertyOwnersLiability";}
		if(covername.equals("Legal Expenses")){covername="LegalExpenses";}
		
		
		String brokerComm = (String)mdata.get("PS_"+covername+"_BrokerComm_rate");
		String penComm =  (String)mdata.get("PS_"+covername+"_PenComm_rate");
		double comm = Double.parseDouble(brokerComm)+Double.parseDouble(penComm);
		double rate = Double.parseDouble(AdjustedRate)+(Double.parseDouble(AdjustedRate)/(1-(comm/100))*(comm/100));
		return rate;	
	}
	catch(Exception e){
        String methodName = new Object(){}.getClass().getEnclosingMethod().getName();
        TestUtil.reportFunctionFailed("Failed in "+methodName+" function");    
        TestUtil.reportStatus("<p style='color:red'> PDF Document is not visible for download </p>", "Fail", true);
        return 0.00;
	}
}

	/*
	 * This function will delete unnecessary 
	 * PDF files files from mentioned Path
	 * 
	 * @param filePath - folder path from where extra files needs to be deleted
	 */
	
	public boolean fileDeletion(String filePath) {
		
		File f = new File(filePath);
		File[] listOfFiles = f.listFiles();
		int size = listOfFiles.length;
		//System.out.println(size);
		
		for(int i=0;i<size;i++){
			if (listOfFiles[i].isFile()) {
				
				int position = listOfFiles[i].getName().lastIndexOf(".");
				if(position!=-1){
					/*
					 *  @Variable fileName - it will return fileName without extention
					 */
					String fileName = listOfFiles[i].getName().substring(0,position);  
					if(fileName.contains("pdf")){
						listOfFiles[i].delete();
					}
				}
			}
		}
		return true;
	}
			
	public static int verification(boolean result,String data , String fileName) {
		
		if(result){
			TestUtil.reportStatus("Verified [<b> "+data+" </b>] in "+fileName+" document.", "Pass", false);
			return 0;
		}else{
			TestUtil.reportStatus("<p style='color:red'> PDF Document: "+fileName+" does not contain [<b> "+data+" </b>]</p>", "Fail", false);
			return 1;
		}

	}

	/*
     * ------------------------------------------------------------
     * PDF Verification Handling function. END
     * ------------------------------------------------------------
     */
	
	// Count difference of days from 2 dates.
	public double countDays(Hashtable<String, String> mdata){
		
		SimpleDateFormat format = new SimpleDateFormat("dd/MM/yyyy");

		Date d1 = null;
		Date d2 = null;
		Date d3 = null;
		
		try {
			d1 = format.parse(mdata.get("Inception_Date"));
			d2 = format.parse(mdata.get("Deadline_Date"));
			d3 = format.parse(mdata.get("Create_Endorsment_Date"));
			
			//in milliseconds
			double diff = d2.getTime() - d1.getTime();
			double diff_1 = d3.getTime() - d1.getTime();
			double diffDays = ((diff / (24 * 60 * 60 * 1000))) - (diff_1 / (24 * 60 * 60 * 1000));
			
			return diffDays+1;
		}
		catch(Throwable t){
			return 0;
		}
		
	}

	//Created by Jainil : 
	public String daysIncrement(String date,int days) throws ParseException{
		
		final String OLD_FORMAT = "dd/MM/yyyy";
		final String NEW_FORMAT = "dd/MMMM/yyyy";
		// August 12, 2010
		//String oldDateString = "09/01/2016";
		SimpleDateFormat sdf = new SimpleDateFormat(OLD_FORMAT);
		Date d = sdf.parse(date);
		Calendar c1 = Calendar.getInstance();
		c1.setTime(d); 
		sdf.applyPattern(NEW_FORMAT);
		//System.out.println("Original Date is : " + sdf.format(c1.getTime()));
		c1.add(Calendar.DATE,days);
		//System.out.println("New date is : " + sdf.format(c1.getTime()).replaceAll("/", " "));
		
		return sdf.format(c1.getTime()).replaceAll("/", " ");
	}

	@SuppressWarnings("unused")
	public String DateDiff(String date,String date1) throws ParseException{
		
		SimpleDateFormat format = new SimpleDateFormat("MM/dd/yyyy HH:mm:ss");
		  
		Date d1 = null;
		Date d2 = null;
		  
		try {
		  d1 = df.parse(date);
		  d2 = df.parse(date1);
		  
		   //in milliseconds
		  long diff = d1.getTime() - d2.getTime();
		  
		  long diffDays = (diff / (24 * 60 * 60 * 1000))+1;
		  
		  System.out.print(diffDays + " days, ");
		  
		  return String.valueOf(diffDays);
		}
		catch (Throwable t)
		{
		  t.printStackTrace();
		  return null;
		}
	}
		
	// -----------------------------------------------------------------------------------------------------------------------------------------
    
	// All Cover specific Functions :	     

		// property Details Table Handling Functions:
		     
		 public static boolean PropertyDetails_HandleTables(Map<Object, Object> map_data, String Main_Cover, int count) throws Throwable, Exception{
			 String coverName;
			 double dTotal_Rate = 0.00, dAdjusted_Rate = 0.00, d_MD_Premium = 0.00, d_BI_Premium = 0.00, d_MD_TotalPremium = 0.00, d_BI_TotalPremium = 0.00;
			 int startCountCol;
			 boolean bVal =true;
			 			 
			 String table_Path = "html/body/div[3]/form/div/table[";
			 
			 if(Main_Cover.contains("MD")){
				 //table_Path = "html/body/div[3]/form/div/table[4]";
				 table_Path= "html/body/div[3]/form/div/table["+k.getTableIndex("Declared Value", "xpath", "html/body/div[3]/form/div/table") +"]";
				 
			 }else{
				 //table_Path = "html/body/div[3]/form/div/table[5]";
				 table_Path= "html/body/div[3]/form/div/table["+k.getTableIndex("Ind Period", "xpath", "html/body/div[3]/form/div/table") +"]";
			 }
			 
			 //Put data to table :
			 
				 func_PD_InputTo_Table(map_data, Main_Cover, table_Path, count);
					
				 customAssert.assertTrue(k.Click("CCF_Btn_Save"), "Unable to click on Save Button on Insured Properties .");
				 
				// Comparisons : 
				
				 
				 WebElement table= driver.findElement(By.xpath(table_Path));
				 int numOfRow = table.findElements(By.tagName("tr")).size();
				 
				 k.pressDownKeyonPage();
				 k.pressDownKeyonPage();
				 
				 for(int j=0;j < numOfRow-2;j++){		
					 coverName = driver.findElement(By.xpath(table_Path + "/tbody/tr["+(j+1)+"]/td[1]")).getText();
					 
					 // Read Values from table :
					 
					 if(Main_Cover.contains("MD")){
						 dTotal_Rate = Double.parseDouble(k.GetText_DynamicXpathWebDriver(driver, table_Path + "/tbody/tr["+(j+1)+"]/td[9]/input"));
						 dAdjusted_Rate = Double.parseDouble(k.GetText_DynamicXpathWebDriver(driver, table_Path + "/tbody/tr["+(j+1)+"]/td[12]/input"));
						 d_MD_Premium = Double.parseDouble(k.GetText_DynamicXpathWebDriver(driver, table_Path + "/tbody/tr["+(j+1)+"]/td[13]/input"));
						 d_MD_TotalPremium = d_MD_TotalPremium + d_MD_Premium;
					 }else{
						 dTotal_Rate = Double.parseDouble(k.GetText_DynamicXpathWebDriver(driver, table_Path + "/tbody/tr["+(j+1)+"]/td[10]/input"));
						 dAdjusted_Rate = Double.parseDouble(k.GetText_DynamicXpathWebDriver(driver, table_Path + "/tbody/tr["+(j+1)+"]/td[13]/input"));				 
						 d_BI_Premium = Double.parseDouble(k.GetText_DynamicXpathWebDriver(driver, table_Path + "/tbody/tr["+(j+1)+"]/td[14]/input"));
						 d_BI_TotalPremium = d_BI_TotalPremium + d_BI_Premium;
					 }
					 
					// Calculate Values for total rate, adjusted rate, MD_Premium and BI Premium :
					 
					 if(Main_Cover.contains("MD")){
						 startCountCol = 4 ;		 		
					 }else{
						 startCountCol = 5 ;
					 }
						 PD_TotalRate = Double.parseDouble(k.GetText_DynamicXpathWebDriver(driver, table_Path + "/tbody/tr["+(j+1)+"]/td["+startCountCol+"]/input"))
							 		+ Double.parseDouble(k.GetText_DynamicXpathWebDriver(driver, table_Path + "/tbody/tr["+(j+1)+"]/td["+(startCountCol+1)+"]/input"))
							 		+ Double.parseDouble(k.GetText_DynamicXpathWebDriver(driver, table_Path + "/tbody/tr["+(j+1)+"]/td["+(startCountCol+2)+"]/input"))
							 		+ Double.parseDouble(k.GetText_DynamicXpathWebDriver(driver, table_Path + "/tbody/tr["+(j+1)+"]/td["+(startCountCol+3)+"]/input"))
							 		+ Double.parseDouble(k.GetText_DynamicXpathWebDriver(driver, table_Path + "/tbody/tr["+(j+1)+"]/td["+(startCountCol+4)+"]/input"));
					 
						 PD_AdjustedRate = func_PD_CalculateAdjustedRate(map_data,PD_TotalRate, Main_Cover, coverName, count);
					 
						 if(Main_Cover.contains("MD")){
							 PD_MD_Premium = (( Double.parseDouble(k.GetText_DynamicXpathWebDriver(driver, table_Path + "/tbody/tr["+(j+1)+"]/td[2]/input").replace(",", ""))* PD_AdjustedRate)/100);
							 PD_MD_TotalPremium = PD_MD_TotalPremium + PD_MD_Premium;
							
						 }else{
							 PD_BI_Premium = (( Double.parseDouble(k.GetText_DynamicXpathWebDriver(driver, table_Path + "/tbody/tr["+(j+1)+"]/td[2]/input").replace(",", ""))* PD_AdjustedRate)/100);
							 PD_BI_TotalPremium = PD_BI_TotalPremium + PD_BI_Premium;
							
						 }				 
						 
						 // Compare values :
						 
						 //customAssert.assertTrue(compareValues(dTotal_Rate,PD_TotalRate,"Total Rate"),"Mismatched Total Rate Values"); 
						 //customAssert.assertTrue(compareValues(dAdjusted_Rate,PD_AdjustedRate,"Adjusted Rate"),"Mismatched Adjusted Rate Values");
						 if(Main_Cover.contains("MD")){
							 customAssert.assertTrue(compareValues(d_MD_Premium,Double.parseDouble(common.roundedOff(Double.toString(PD_MD_Premium))),"MD premium"),"Mismatched MD premium Values");		 		
						 }else{
							 customAssert.assertTrue(compareValues(d_BI_Premium,Double.parseDouble(common.roundedOff(Double.toString(PD_BI_Premium))),"BI Premium"),"Mismatched BI Premium Values");
						 } 						  
				 }					
				 	
				 
				 if(Main_Cover.contains("MD")){
					 TestUtil.WriteDataToXl_innerSheet(CommonFunction_VELA.product+"_"+CommonFunction_VELA.businessEvent, "Property Details", common.NB_Structure_of_InnerPagesMaps.get("Property Details").get(count).get("Automation Key"), "MD_TotalPremium", String.valueOf(PD_MD_TotalPremium),common.NB_Structure_of_InnerPagesMaps.get("Property Details").get(count));							 
				 }else{
					 TestUtil.WriteDataToXl_innerSheet(CommonFunction_VELA.product+"_"+CommonFunction_VELA.businessEvent, "Property Details",  common.NB_Structure_of_InnerPagesMaps.get("Property Details").get(count).get("Automation Key"), "BI_TotalPremium", String.valueOf(PD_BI_TotalPremium),common.NB_Structure_of_InnerPagesMaps.get("Property Details").get(count));
				 }
			 
			 return bVal;
		 }
		 
		 public static double func_PD_CalculateAdjustedRate(Map<Object, Object> map_data, double pdTotalRate, String CoverName, String sectionName, int count){
			 double adjustedRate = 0.00;
			 double fisrtFactor = 0.00, sFactor = 0.00;
			 String Abvr = "";
			 //int count = 1;
			 
			 if(sectionName.contains("-")){
				 if(CoverName.contains("MD")){
					 Abvr = "BSI_MD_";
				 }
				 else{
					 Abvr = "BSI_BI_";
				 }				 
			 }else{
				 Abvr = func_GetAbrrivation(CoverName, sectionName);
			 }
			 
			 fisrtFactor = ((((Double.parseDouble(common.NB_Structure_of_InnerPagesMaps.get("Property Details").get(count).get(Abvr + "TechAdjust"))) * pdTotalRate)/ 100 ) + pdTotalRate);
			 sFactor = (((Double.parseDouble(common.NB_Structure_of_InnerPagesMaps.get("Property Details").get(count).get(Abvr + "CommAdjust"))) * fisrtFactor)/ 100 ); 
			 adjustedRate = fisrtFactor + sFactor;
			 
			 return adjustedRate;
		 }
		 
				 
		 public static boolean func_PD_InputTo_Table(Map<Object, Object> map_data, String CoverName, String tablePath, int count){
			 boolean bVal =true;
			 String sectionName;
			 String Abvr;
			 int FixRows, totalColumns;
			 int dynamicRow_Start;
			 String absXpath;
			 
			 WebElement table= driver.findElement(By.xpath(tablePath));
			 
			//Get number of rows in table 
			    int numOfRow = table.findElements(By.tagName("tr")).size();
			    
			    if(CoverName.contains("MD")){
					 FixRows = 4;		
					 dynamicRow_Start = 5;
					 totalColumns = 12;
				 }else{
					 FixRows = 6;
					 dynamicRow_Start = 7;
					 totalColumns = 13;
				 }
			   			   
			    for(int j=0;j<dynamicRow_Start-1;j++){							 
			    	sectionName = driver.findElement(By.xpath(tablePath + "/tbody/tr["+(j+1)+"]/td[1]")).getText();
			    	Abvr = func_GetAbrrivation(CoverName, sectionName);
			    	
			    	if(CoverName.contains("MD")){
			    		//customAssert.assertTrue(k.DynamicXpathWebDriver_Inner(driver, tablePath + "/tbody/tr["+(j+1)+"]/td[2]/input", common.NB_excel_data_map , "Property Details", count , Abvr , "DeclaredValue", "Input"),"BAC");
			    		customAssert.assertTrue(k.DynamicXpathWebDriver_Inner(driver, tablePath + "/tbody/tr["+(j+1)+"]/td[2]/input",common.NB_Structure_of_InnerPagesMaps , "Property Details", count , Abvr , "DeclaredValue", sectionName,"Input"),"BAC");
			    		//customAssert.assertTrue(k.DynamicXpathWebDriver(driver, tablePath + "/tbody/tr["+(j+1)+"]/td[3]/input", (String)map_data.get(Abvr + "DayOne"), "Input"),"BAC");
			    		customAssert.assertTrue(k.DynamicXpathWebDriver_Inner(driver, tablePath + "/tbody/tr["+(j+1)+"]/td[4]/input", common.NB_Structure_of_InnerPagesMaps , "Property Details", count , Abvr , "FireRate",sectionName, "Input"),"BAC");
			    		customAssert.assertTrue(k.DynamicXpathWebDriver_Inner(driver, tablePath + "/tbody/tr["+(j+1)+"]/td[5]/input", common.NB_Structure_of_InnerPagesMaps , "Property Details", count , Abvr , "PerilsRate",sectionName, "Input"),"BAC");
			    		customAssert.assertTrue(k.DynamicXpathWebDriver_Inner(driver, tablePath + "/tbody/tr["+(j+1)+"]/td[6]/input", common.NB_Structure_of_InnerPagesMaps , "Property Details", count , Abvr , "SprinkRate",sectionName, "Input"),"BAC");
			    		customAssert.assertTrue(k.DynamicXpathWebDriver_Inner(driver, tablePath + "/tbody/tr["+(j+1)+"]/td[7]/input", common.NB_Structure_of_InnerPagesMaps , "Property Details", count , Abvr , "ADRate", sectionName,"Input"),"BAC");
			    		customAssert.assertTrue(k.DynamicXpathWebDriver_Inner(driver, tablePath + "/tbody/tr["+(j+1)+"]/td[8]/input", common.NB_Structure_of_InnerPagesMaps , "Property Details", count , Abvr , "SubsRate",sectionName, "Input"),"BAC");
			    		customAssert.assertTrue(k.DynamicXpathWebDriver_Inner(driver, tablePath + "/tbody/tr["+(j+1)+"]/td[10]/input", common.NB_Structure_of_InnerPagesMaps , "Property Details", count , Abvr , "TechAdjust",sectionName, "Input"),"BAC");
			    		customAssert.assertTrue(k.DynamicXpathWebDriver_Inner(driver, tablePath + "/tbody/tr["+(j+1)+"]/td[11]/input", common.NB_Structure_of_InnerPagesMaps , "Property Details", count , Abvr , "CommAdjust", sectionName,"Input"),"BAC");
			    	}else{
			    		customAssert.assertTrue(k.DynamicXpathWebDriver_Inner(driver, tablePath + "/tbody/tr["+(j+1)+"]/td[2]/input", common.NB_Structure_of_InnerPagesMaps , "Property Details", count , Abvr , "DeclaredValue",sectionName, "Input"),"BAC");
			    		//customAssert.assertTrue(k.DynamicXpathWebDriver(driver, tablePath + "/tbody/tr["+(j+1)+"]/td[3]/input", (String)map_data.get(Abvr + "DeclarationUplift "), "Input"),"BAC");
			    		//customAssert.assertTrue(k.DynamicXpathWebDriver(driver, tablePath + "/tbody/tr["+(j+1)+"]/td[4]/input", (String)map_data.get(Abvr + "IndPeriod"), "Input"),"BAC");
			    		customAssert.assertTrue(k.DynamicXpathWebDriver_Inner(driver, tablePath + "/tbody/tr["+(j+1)+"]/td[5]/input", common.NB_Structure_of_InnerPagesMaps , "Property Details", count , Abvr , "FireRate",sectionName, "Input"),"BAC");
			    		customAssert.assertTrue(k.DynamicXpathWebDriver_Inner(driver, tablePath + "/tbody/tr["+(j+1)+"]/td[6]/input", common.NB_Structure_of_InnerPagesMaps , "Property Details", count , Abvr , "PerilsRate",sectionName, "Input"),"BAC");
			    		customAssert.assertTrue(k.DynamicXpathWebDriver_Inner(driver, tablePath + "/tbody/tr["+(j+1)+"]/td[7]/input", common.NB_Structure_of_InnerPagesMaps , "Property Details", count , Abvr , "SprinkRate",sectionName, "Input"),"BAC");
			    		customAssert.assertTrue(k.DynamicXpathWebDriver_Inner(driver, tablePath + "/tbody/tr["+(j+1)+"]/td[8]/input", common.NB_Structure_of_InnerPagesMaps , "Property Details", count , Abvr , "ADRate",sectionName, "Input"),"BAC");
			    		customAssert.assertTrue(k.DynamicXpathWebDriver_Inner(driver, tablePath + "/tbody/tr["+(j+1)+"]/td[9]/input", common.NB_Structure_of_InnerPagesMaps , "Property Details", count , Abvr , "SubsRate",sectionName, "Input"),"BAC");
			    		customAssert.assertTrue(k.DynamicXpathWebDriver_Inner(driver, tablePath + "/tbody/tr["+(j+1)+"]/td[11]/input", common.NB_Structure_of_InnerPagesMaps , "Property Details", count , Abvr , "TechAdjust",sectionName, "Input"),"BAC");
			    		customAssert.assertTrue(k.DynamicXpathWebDriver_Inner(driver, tablePath + "/tbody/tr["+(j+1)+"]/td[12]/input", common.NB_Structure_of_InnerPagesMaps , "Property Details", count , Abvr , "CommAdjust", sectionName,"Input"),"BAC");
			    	}
			    	
			    }
			    	
			    for(int l=FixRows;l<dynamicRow_Start;l++){							 
				    	sectionName = driver.findElement(By.xpath(tablePath + "/tbody/tr["+(l+1)+"]/td[1]")).getText();
				   					    	
				    	if(CoverName.contains("MD")){
				    		Abvr = "BSI_MD_";
				    		//customAssert.assertTrue(k.DynamicXpathWebDriver(driver, tablePath + "/tbody/tr["+(l+1)+"]/td[2]/input", (String)map_data.get(Abvr + "DeclaredValue"), "Input"),"BAC");
				    		//customAssert.assertTrue(k.DynamicXpathWebDriver(driver, tablePath + "/tbody/tr["+(l+1)+"]/td[3]/input", (String)map_data.get(Abvr + "DayOne"), "Input"),"BAC");
				    		customAssert.assertTrue(k.DynamicXpathWebDriver_Inner(driver, tablePath + "/tbody/tr["+(l+1)+"]/td[4]/input", common.NB_Structure_of_InnerPagesMaps , "Property Details", count , Abvr , "FireRate",sectionName, "Input"),"Unable to enter FireRate");
				    		customAssert.assertTrue(k.DynamicXpathWebDriver_Inner(driver, tablePath + "/tbody/tr["+(l+1)+"]/td[5]/input", common.NB_Structure_of_InnerPagesMaps , "Property Details", count , Abvr , "PerilsRate",sectionName, "Input"),"Unable to enter PerilsRate");
				    		customAssert.assertTrue(k.DynamicXpathWebDriver_Inner(driver, tablePath + "/tbody/tr["+(l+1)+"]/td[6]/input", common.NB_Structure_of_InnerPagesMaps , "Property Details", count , Abvr , "SprinkRate",sectionName, "Input"),"Unable to enter SprinkRate");
				    		customAssert.assertTrue(k.DynamicXpathWebDriver_Inner(driver, tablePath + "/tbody/tr["+(l+1)+"]/td[7]/input", common.NB_Structure_of_InnerPagesMaps , "Property Details", count , Abvr , "ADRate",sectionName, "Input"),"Unable to enter ADRate");
				    		customAssert.assertTrue(k.DynamicXpathWebDriver_Inner(driver, tablePath + "/tbody/tr["+(l+1)+"]/td[8]/input", common.NB_Structure_of_InnerPagesMaps , "Property Details", count , Abvr , "SubsRate",sectionName, "Input"),"Unable to enter SubsRate");
				    		customAssert.assertTrue(k.DynamicXpathWebDriver_Inner(driver, tablePath + "/tbody/tr["+(l+1)+"]/td[10]/input", common.NB_Structure_of_InnerPagesMaps , "Property Details", count , Abvr , "TechAdjust",sectionName, "Input"),"Unable to enter TechAdjust");
				    		customAssert.assertTrue(k.DynamicXpathWebDriver_Inner(driver, tablePath + "/tbody/tr["+(l+1)+"]/td[11]/input", common.NB_Structure_of_InnerPagesMaps , "Property Details", count , Abvr , "CommAdjust", sectionName,"Input"),"Unable to enter CommAdjust");
				    	}else{
				    		Abvr = "BSI_BI_";
				    		//customAssert.assertTrue(k.DynamicXpathWebDriver(driver, tablePath + "/tbody/tr["+(l+1)+"]/td[2]/input", (String)map_data.get(Abvr + "DeclaredValue"), "Input"),"BAC");
				    		//customAssert.assertTrue(k.DynamicXpathWebDriver(driver, tablePath + "/tbody/tr["+(l+1)+"]/td[3]/input", (String)map_data.get(Abvr + "DeclarationUplift "), "Input"),"BAC");
				    		//customAssert.assertTrue(k.DynamicXpathWebDriver(driver, tablePath + "/tbody/tr["+(l+1)+"]/td[4]/input", (String)map_data.get(Abvr + "IndPeriod"), "Input"),"BAC");
				    		customAssert.assertTrue(k.DynamicXpathWebDriver_Inner(driver, tablePath + "/tbody/tr["+(l+1)+"]/td[5]/input", common.NB_Structure_of_InnerPagesMaps , "Property Details", count , Abvr , "FireRate",sectionName, "Input"),"Unable to enter FireRate");
				    		customAssert.assertTrue(k.DynamicXpathWebDriver_Inner(driver, tablePath + "/tbody/tr["+(l+1)+"]/td[6]/input", common.NB_Structure_of_InnerPagesMaps , "Property Details", count , Abvr , "PerilsRate",sectionName, "Input"),"Unable to enter PerilsRate");
				    		customAssert.assertTrue(k.DynamicXpathWebDriver_Inner(driver, tablePath + "/tbody/tr["+(l+1)+"]/td[7]/input", common.NB_Structure_of_InnerPagesMaps , "Property Details", count , Abvr , "SprinkRate",sectionName, "Input"),"Unable to enter SprinkRate");
				    		customAssert.assertTrue(k.DynamicXpathWebDriver_Inner(driver, tablePath + "/tbody/tr["+(l+1)+"]/td[8]/input", common.NB_Structure_of_InnerPagesMaps , "Property Details", count , Abvr , "ADRate",sectionName, "Input"),"Unable to enter ADRate");
				    		customAssert.assertTrue(k.DynamicXpathWebDriver_Inner(driver, tablePath + "/tbody/tr["+(l+1)+"]/td[9]/input", common.NB_Structure_of_InnerPagesMaps , "Property Details", count , Abvr , "SubsRate",sectionName, "Input"),"Unable to enter SubsRate");
				    		customAssert.assertTrue(k.DynamicXpathWebDriver_Inner(driver, tablePath + "/tbody/tr["+(l+1)+"]/td[11]/input", common.NB_Structure_of_InnerPagesMaps , "Property Details", count , Abvr , "TechAdjust",sectionName, "Input"),"Unable to enter TechAdjust");
				    		customAssert.assertTrue(k.DynamicXpathWebDriver_Inner(driver, tablePath + "/tbody/tr["+(l+1)+"]/td[12]/input", common.NB_Structure_of_InnerPagesMaps , "Property Details", count , Abvr , "CommAdjust",sectionName, "Input"),"Unable to enter CommAdjust");
				    	}
				
			     }
			 
			 return bVal;
		 }
		 
		 // End of Property Details Table handling functions	 
		 
		 
		 // All Cover (Except Terrorism) Table Handling :
		
		 
		 public static double func_GIT_HandleTables(Map<Object, Object> map_data, String sCoverAbvr, String sSheetName, String sInnerSheetName) throws Throwable{
			 String SectionName, sFinalMap = "", Abvr = "", sTablePath = "";
			 double sAdjustedRate = 0.00, sPremium = 0.00, sTotalPremium = 0.00;
			 double dBookRate = 0.00;
			 int dynamicRow, count = 0;
			 boolean bVal =true;
			 
			 WebElement table= driver.findElement(By.className("matrix"));
			 int numOfRow = table.findElements(By.tagName("tr")).size();
			 
			 sTablePath = "html/body/div[3]/form/div/table[4]/tbody/tr[";
			 //Put data to table :
			 
			 if(sCoverAbvr.contains("EL") || sCoverAbvr.contains("M")|| sCoverAbvr.contains("FG") || sCoverAbvr.contains("CDS") || sCoverAbvr.contains("FF") || sCoverAbvr.contains("LOL")){
				 dynamicRow = 2;
			 }else if(sCoverAbvr.contains("SAR")){
				 dynamicRow = 1;
			 }else if(sCoverAbvr.contains("CAR")){
				 dynamicRow = 7;
			 }else if(sCoverAbvr.contains("CER")|| sCoverAbvr.contains("GIT")){
				 dynamicRow = 3;
			 }else if(sCoverAbvr.contains("MC")){
				 dynamicRow = 9;
			 }else{
				 dynamicRow = 4;
			 }
			 
			 for(int j=0; j<numOfRow-2; j++){							 
				 SectionName = driver.findElement(By.xpath("html/body/div[3]/form/div/table[4]/tbody/tr["+(j+1)+"]/td[1]")).getText();
				 
				 if(j < (dynamicRow-1)){
								 
					 Abvr = sCoverAbvr +"_" + func_GetAbrrivation(sCoverAbvr, SectionName);
					
					 customAssert.assertTrue(k.DynamicXpathWebDriver(driver, "html/body/div[3]/form/div/table[4]/tbody/tr["+(j+1)+"]/td[2]/input", common.NB_excel_data_map , sSheetName, 0 , Abvr , "SumInsured", SectionName, "Input"),"Unable to enter sum insured value in "+ sCoverAbvr +" Table for : " + SectionName);
					 customAssert.assertTrue(k.DynamicXpathWebDriver(driver, "html/body/div[3]/form/div/table[4]/tbody/tr["+(j+1)+"]/td[3]/input", common.NB_excel_data_map , sSheetName, 0 , Abvr , "BookRate",SectionName, "Input"),"Unable to enter BookRate value in " + sCoverAbvr +" Table for : " + SectionName);
					 customAssert.assertTrue(k.DynamicXpathWebDriver(driver, "html/body/div[3]/form/div/table[4]/tbody/tr["+(j+1)+"]/td[4]/input", common.NB_excel_data_map , sSheetName, 0 , Abvr , "TechAdjust",SectionName, "Input"),"Unable to enter TechAdjust value in " + sCoverAbvr +" Table for : " + SectionName);
					 customAssert.assertTrue(k.DynamicXpathWebDriver(driver, "html/body/div[3]/form/div/table[4]/tbody/tr["+(j+1)+"]/td[5]/input", common.NB_excel_data_map , sSheetName, 0 , Abvr , "CommAdjust", SectionName,"Input"),"Unable to enter CommAdjust value in " + sCoverAbvr +" Table for : " + SectionName);	 
				 }else{
					 if(sCoverAbvr.contains("FG")){
						 Abvr = "AD_SOE_";
					 }else{
						 Abvr = "AD_" + sCoverAbvr +"_";
					 }
					 
					 //customAssert.assertTrue(k.DynamicXpathWebDriver_Inner(driver, "//*[@id='table0']/tbody/tr["+(j+1)+"]/td[2]/input", common.NB_Structure_of_InnerPagesMaps , sInnerSheetName, count , Abvr , "SumInsured", "Input"),"Unable to enter sum insured value in "+ sCoverAbvr +" Table for : " + SectionName);
					 customAssert.assertTrue(k.DynamicXpathWebDriver_Inner(driver, "html/body/div[3]/form/div/table[4]/tbody/tr["+(j+1)+"]/td[3]/input", common.NB_Structure_of_InnerPagesMaps , sInnerSheetName, count , Abvr , "BookRate", SectionName,"Input"),"Unable to enter BookRate value in " + sCoverAbvr +" Table for : " + SectionName);
					 customAssert.assertTrue(k.DynamicXpathWebDriver_Inner(driver, "html/body/div[3]/form/div/table[4]/tbody/tr["+(j+1)+"]/td[4]/input", common.NB_Structure_of_InnerPagesMaps , sInnerSheetName, count , Abvr , "TechAdjust",SectionName, "Input"),"Unable to enter TechAdjust value in " + sCoverAbvr +" Table for : " + SectionName);
					 customAssert.assertTrue(k.DynamicXpathWebDriver_Inner(driver, "html/body/div[3]/form/div/table[4]/tbody/tr["+(j+1)+"]/td[5]/input", common.NB_Structure_of_InnerPagesMaps , sInnerSheetName, count , Abvr , "CommAdjust",SectionName, "Input"),"Unable to enter CommAdjust value in " + sCoverAbvr +" Table for : " + SectionName);
					 
				 }
			 }
			 customAssert.assertTrue(k.Click("CCF_Btn_Save"), "Unable to click on Save Button on Employers Liability .");
			 
			// Read, Calculate and Compare Values from table :
			 
			 Cover_TotalPremium = 0.00;
			 
			for(int j=0; j<numOfRow-2; j++){	
				 
				 SectionName = driver.findElement(By.xpath("html/body/div[3]/form/div/table[4]/tbody/tr["+(j+1)+"]/td[1]")).getText();	
				 
				 if(j < (dynamicRow-1)){
					 Abvr = sCoverAbvr +"_" + func_GetAbrrivation(sCoverAbvr, SectionName);
					 sFinalMap = "StringMap";
				 }else{
					 if(sCoverAbvr.contains("FG")){
						 Abvr = "AD_SOE_";
					 }else{
						 Abvr = "AD_" + sCoverAbvr +"_";
					 }
					 sFinalMap = "InnerPageMap";
					 
				 }
				 
				 // -- reading Value from table :
				 
				 dBookRate = Double.parseDouble(driver.findElement(By.xpath("html/body/div[3]/form/div/table[4]/tbody/tr["+(j+1)+"]/td[3]/input")).getAttribute("value").replaceAll(" ", ""));
				 sAdjustedRate = Double.parseDouble(driver.findElement(By.xpath("html/body/div[3]/form/div/table[4]/tbody/tr["+(j+1)+"]/td[6]/input")).getAttribute("value").replaceAll(" ", ""));
				 sPremium = Double.parseDouble(driver.findElement(By.xpath("html/body/div[3]/form/div/table[4]/tbody/tr["+(j+1)+"]/td[7]/input")).getAttribute("value").replaceAll(" ", ""));
				 
				 if(j == (numOfRow - 1)){
					 sTotalPremium = Double.parseDouble(driver.findElement(By.xpath("html/body/div[3]/form/div/table[4]/tbody/tr["+(numOfRow)+"]/td[7]/input")).getAttribute("value").replaceAll(" ", ""));
				 }
				 
				 // -- calculation :
				 
				 Cover_AdjustedRate = func_AllCovers_CalculateAdjustedRate(map_data,dBookRate, Abvr, SectionName, sFinalMap, count, sInnerSheetName);
				 String sPVal = driver.findElement(By.xpath("html/body/div[3]/form/div/table[4]/tbody/tr["+(j+1)+"]/td[2]/input")).getAttribute("value").replaceAll(",", "");
				 Cover_Premium = ((Cover_AdjustedRate * Double.parseDouble(sPVal))/100);
				 
				 
				 Cover_TotalPremium = Cover_TotalPremium + Cover_Premium;
							 
				// Compare values :
				 
				 //customAssert.assertTrue(compareValues(sAdjustedRate, Cover_AdjustedRate,"Adjusted Rate"),"Mismatched Adjusted Rate Values for secion : " + SectionName + " In Cover : "+ sCoverAbvr); 
				 customAssert.assertTrue(compareValues(sPremium, Cover_Premium, "Premium"),"Mismatched Premium Values for secion : " + SectionName + " In Cover : "+ sCoverAbvr);					 
				 
			 }			
			 
			 return Cover_TotalPremium;
		 }
		 
		 
		 
		 public static double func_CAR_HandleTables(Map<Object, Object> map_data, String sCoverAbvr, String sSheetName, String sInnerSheetName) throws Throwable, Exception{
			 String SectionName, sFinalMap = "", Abvr = "", sTablePath = "";
			 double sAdjustedRate = 0.00, sPremium = 0.00, sTotalPremium = 0.00;
			 double dBookRate = 0.00;
			 int dynamicRow, count = 0;
			 boolean bVal =true;
			 
			 WebElement table= driver.findElement(By.className("matrix"));
			 int numOfRow = table.findElements(By.tagName("tr")).size();
			 
			 sTablePath = "html/body/div[3]/form/div/table[10]/tbody/tr[";
			 //Put data to table :
			 
			 if(sCoverAbvr.equals("EL") || sCoverAbvr.equals("Money") || sCoverAbvr.contains("CDS") || sCoverAbvr.contains("FF") || sCoverAbvr.contains("LOL")){
				 dynamicRow = 2;
			 }else if(sCoverAbvr.contains("SAR")){
				 dynamicRow = 1;
			 }else if(sCoverAbvr.contains("CAR")){
				 dynamicRow = 7;
			 }else if(sCoverAbvr.contains("CER")|| sCoverAbvr.contains("GIT") || sCoverAbvr.contains("FG")){
				 dynamicRow = 3;
			 }else if(sCoverAbvr.contains("MC")){
				 dynamicRow = 9;
			 }else{
				 dynamicRow = 4;
			 }
			 
			 for(int j=0; j<numOfRow-2; j++){							 
				 SectionName = driver.findElement(By.xpath("html/body/div[3]/form/div/table[10]/tbody/tr["+(j+1)+"]/td[1]")).getText();
				 
				 if(j < (dynamicRow-1)){
								 
					 Abvr = sCoverAbvr +"_" + func_GetAbrrivation(sCoverAbvr, SectionName);
					
					 customAssert.assertTrue(k.DynamicXpathWebDriver(driver, "html/body/div[3]/form/div/table[10]/tbody/tr["+(j+1)+"]/td[2]/input", common.NB_excel_data_map , sSheetName, 0 , Abvr , "SumInsured", SectionName,"Input"),"Unable to enter sum insured value in "+ sCoverAbvr +" Table for : " + SectionName);
					 customAssert.assertTrue(k.DynamicXpathWebDriver(driver, "html/body/div[3]/form/div/table[10]/tbody/tr["+(j+1)+"]/td[3]/input", common.NB_excel_data_map , sSheetName, 0 , Abvr , "BookRate", SectionName,"Input"),"Unable to enter BookRate value in " + sCoverAbvr +" Table for : " + SectionName);
					 customAssert.assertTrue(k.DynamicXpathWebDriver(driver, "html/body/div[3]/form/div/table[10]/tbody/tr["+(j+1)+"]/td[4]/input", common.NB_excel_data_map , sSheetName, 0 , Abvr , "TechAdjust",SectionName, "Input"),"Unable to enter TechAdjust value in " + sCoverAbvr +" Table for : " + SectionName);
					 customAssert.assertTrue(k.DynamicXpathWebDriver(driver, "html/body/div[3]/form/div/table[10]/tbody/tr["+(j+1)+"]/td[5]/input", common.NB_excel_data_map , sSheetName, 0 , Abvr , "CommAdjust", SectionName,"Input"),"Unable to enter CommAdjust value in " + sCoverAbvr +" Table for : " + SectionName);	 
				 }else{
					 
					 Abvr = "AD_" + sCoverAbvr +"_";
					 //customAssert.assertTrue(k.DynamicXpathWebDriver_Inner(driver, "//*[@id='table0']/tbody/tr["+(j+1)+"]/td[2]/input", common.NB_Structure_of_InnerPagesMaps , sSheetName, 0 , Abvr , "SumInsured", "Input"),"Unable to enter sum insured value in "+ sCoverAbvr +" Table for : " + SectionName);
					 customAssert.assertTrue(k.DynamicXpathWebDriver_Inner(driver, "html/body/div[3]/form/div/table[10]/tbody/tr["+(j+1)+"]/td[3]/input", common.NB_Structure_of_InnerPagesMaps , sInnerSheetName, 0 , Abvr , "BookRate", SectionName , "Input"),"Unable to enter BookRate value in " + sCoverAbvr +" Table for : " + SectionName);
					 customAssert.assertTrue(k.DynamicXpathWebDriver_Inner(driver, "html/body/div[3]/form/div/table[10]/tbody/tr["+(j+1)+"]/td[4]/input", common.NB_Structure_of_InnerPagesMaps , sInnerSheetName, 0 , Abvr , "TechAdjust",SectionName ,  "Input"),"Unable to enter TechAdjust value in " + sCoverAbvr +" Table for : " + SectionName);
					 customAssert.assertTrue(k.DynamicXpathWebDriver_Inner(driver, "html/body/div[3]/form/div/table[10]/tbody/tr["+(j+1)+"]/td[5]/input", common.NB_Structure_of_InnerPagesMaps , sInnerSheetName, 0 , Abvr , "CommAdjust",SectionName, "Input"),"Unable to enter CommAdjust value in " + sCoverAbvr +" Table for : " + SectionName);
					 
				 }
			 }
			 customAssert.assertTrue(k.Click("CCF_Btn_Save"), "Unable to click on Save Button on Employers Liability .");
			 
			// Read, Calculate and Compare Values from table :
			 
			 Cover_TotalPremium = 0.00;
			 
			for(int j=0; j<numOfRow-2; j++){	
				 
				 SectionName = driver.findElement(By.xpath("html/body/div[3]/form/div/table[10]/tbody/tr["+(j+1)+"]/td[1]")).getText();	
				 
				 if(j < (dynamicRow-1)){
					 Abvr = sCoverAbvr +"_" + func_GetAbrrivation(sCoverAbvr, SectionName);
					 sFinalMap = "StringMap";
				 }else{
					 Abvr = "AD_" + sCoverAbvr +"_";
					 sFinalMap = "InnerPageMap";
					 
				 }
				 
				 // -- reading Value from table :
				 
				 dBookRate = Double.parseDouble(driver.findElement(By.xpath("html/body/div[3]/form/div/table[10]/tbody/tr["+(j+1)+"]/td[3]/input")).getAttribute("value").replaceAll(" ", ""));
				 sAdjustedRate = Double.parseDouble(driver.findElement(By.xpath("html/body/div[3]/form/div/table[10]/tbody/tr["+(j+1)+"]/td[6]/input")).getAttribute("value").replaceAll(" ", ""));
				 sPremium = Double.parseDouble(driver.findElement(By.xpath("html/body/div[3]/form/div/table[10]/tbody/tr["+(j+1)+"]/td[7]/input")).getAttribute("value").replaceAll(" ", ""));
				 
				 if(j == (numOfRow - 1)){
					 sTotalPremium = Double.parseDouble(driver.findElement(By.xpath("html/body/div[3]/form/div/table[10]/tbody/tr["+(numOfRow)+"]/td[7]/input")).getAttribute("value").replaceAll(" ", ""));
				 }
				 
				 // -- calculation :
				 
				 Cover_AdjustedRate = func_AllCovers_CalculateAdjustedRate(map_data,dBookRate, Abvr, SectionName, sFinalMap, count, sInnerSheetName);
				 String sPVal = driver.findElement(By.xpath("html/body/div[3]/form/div/table[10]/tbody/tr["+(j+1)+"]/td[2]/input")).getAttribute("value").replaceAll(",", "");
				 Cover_Premium = ((Cover_AdjustedRate * Double.parseDouble(sPVal))/100);
				 
				 
				 Cover_TotalPremium = Cover_TotalPremium + Cover_Premium;
							 
				// Compare values :
				 
				 //customAssert.assertTrue(compareValues(sAdjustedRate, Cover_AdjustedRate,"Adjusted Rate"),"Mismatched Adjusted Rate Values for secion : " + SectionName + " In Cover : "+ sCoverAbvr); 
				 customAssert.assertTrue(compareValues(sPremium, Double.parseDouble(common.roundedOff(Double.toString(Cover_Premium))), "Premium"),"Mismatched Premium Values for secion : " + SectionName + " In Cover : "+ sCoverAbvr);					 
				 
			 }			
			 
			 return Cover_TotalPremium;
		 }
		 
		 
		 
		 public static double func_AllCvers_HandleTables(Map<Object, Object> map_data, String sCoverAbvr, String sSheetName, String sInnerSheetName) throws Throwable, Exception{
			 String SectionName, sFinalMap = "", Abvr = "", sTablePath = "";
			 double sAdjustedRate = 0.00, sPremium = 0.00, sTotalPremium = 0.00;
			 double dBookRate = 0.00;
			 int dynamicRow, count = 0;
			 boolean bVal =true;
			 
			 WebElement table= driver.findElement(By.className("matrix"));
			 int numOfRow = table.findElements(By.tagName("tr")).size();
			 
			 sTablePath = "//*[@id='table0']/tbody/";
			 //Put data to table :
			 
			 if(sCoverAbvr.equals("MC")){
				 dynamicRow = 9;
			 }else if(sCoverAbvr.contains("EL") ||sCoverAbvr.contains("M")|| sCoverAbvr.contains("POL")||sCoverAbvr.contains("CDS") || sCoverAbvr.contains("FF") || sCoverAbvr.contains("LOL")){
				 dynamicRow = 2;
			 }else if(sCoverAbvr.contains("SAR")){
				 dynamicRow = 1;
			 }else if(sCoverAbvr.contains("CAR")){
				 dynamicRow = 7;
			 }else if(sCoverAbvr.contains("CER")|| sCoverAbvr.contains("GIT") || sCoverAbvr.contains("FG")){
				 dynamicRow = 3;
			 }else{
				 dynamicRow = 4;
			 }
			 
			 for(int j=0; j<numOfRow-2; j++){							 
				 SectionName = table.findElement(By.xpath("//*[@id='table0']/tbody/tr["+(j+1)+"]/td[1]")).getText();
				 
				 if(j < (dynamicRow-1)){
								 
					 Abvr = sCoverAbvr +"_" + func_GetAbrrivation(sCoverAbvr, SectionName);
					
					 customAssert.assertTrue(k.DynamicXpathWebDriver(driver, "//*[@id='table0']/tbody/tr["+(j+1)+"]/td[2]/input", common.NB_excel_data_map , sSheetName , 0 , Abvr ,"SumInsured",SectionName, "Input"),"Unable to enter sum insured value in "+ sCoverAbvr +" Table for : " + SectionName);
					 customAssert.assertTrue(k.DynamicXpathWebDriver(driver, "//*[@id='table0']/tbody/tr["+(j+1)+"]/td[3]/input", common.NB_excel_data_map , sSheetName , 0 , Abvr, "BookRate", SectionName,"Input"),"Unable to enter BookRate value in " + sCoverAbvr +" Table for : " + SectionName);
					 customAssert.assertTrue(k.DynamicXpathWebDriver(driver, "//*[@id='table0']/tbody/tr["+(j+1)+"]/td[4]/input", common.NB_excel_data_map , sSheetName , 0 , Abvr ,"TechAdjust",SectionName, "Input"),"Unable to enter TechAdjust value in " + sCoverAbvr +" Table for : " + SectionName);
					 customAssert.assertTrue(k.DynamicXpathWebDriver(driver, "//*[@id='table0']/tbody/tr["+(j+1)+"]/td[5]/input", common.NB_excel_data_map , sSheetName , 0 , Abvr ,"CommAdjust", SectionName,"Input"),"Unable to enter CommAdjust value in " + sCoverAbvr +" Table for : " + SectionName);	 
				 }else{
					 
					 Abvr = "AD_" + sCoverAbvr +"_";
					 //customAssert.assertTrue(k.DynamicXpathWebDriver_Inner(driver, "//*[@id='table0']/tbody/tr["+(j+1)+"]/td[2]/input", common.NB_Structure_of_InnerPagesMaps , sInnerSheetName, count , Abvr , "SumInsured", "Input"),"Unable to enter sum insured value in "+ sCoverAbvr +" Table for : " + SectionName);
					 customAssert.assertTrue(k.DynamicXpathWebDriver_Inner(driver, "//*[@id='table0']/tbody/tr["+(j+1)+"]/td[3]/input", common.NB_Structure_of_InnerPagesMaps , sInnerSheetName, count , Abvr , "BookRate",SectionName ,"Input"),"Unable to enter BookRate value in " + sCoverAbvr +" Table for : " + SectionName);
					 customAssert.assertTrue(k.DynamicXpathWebDriver_Inner(driver, "//*[@id='table0']/tbody/tr["+(j+1)+"]/td[4]/input", common.NB_Structure_of_InnerPagesMaps , sInnerSheetName, count , Abvr , "TechAdjust",SectionName, "Input"),"Unable to enter TechAdjust value in " + sCoverAbvr +" Table for : " + SectionName);
					 customAssert.assertTrue(k.DynamicXpathWebDriver_Inner(driver, "//*[@id='table0']/tbody/tr["+(j+1)+"]/td[5]/input", common.NB_Structure_of_InnerPagesMaps , sInnerSheetName, count , Abvr , "CommAdjust",SectionName, "Input"),"Unable to enter CommAdjust value in " + sCoverAbvr +" Table for : " + SectionName);
				 }
			 }
			 customAssert.assertTrue(k.Click("CCF_Btn_Save"), "Unable to click on Save Button on Employers Liability .");
			 
			// Read, Calculate and Compare Values from table :
			 
			Cover_TotalPremium = 0.00;
			
			for(int j=0; j<numOfRow-2; j++){	
				 
				 SectionName = driver.findElement(By.xpath("//*[@id='table0']/tbody/tr["+(j+1)+"]/td[1]")).getText();	
				 
				 if(j < (dynamicRow-1)){
					 Abvr = sCoverAbvr +"_" + func_GetAbrrivation(sCoverAbvr, SectionName);
					 sFinalMap = "StringMap";
				 }else{
					 Abvr = "AD_" + sCoverAbvr +"_";
					 sFinalMap = "InnerPageMap";
					 
				 }
				 
				 // -- reading Value from table :
				 
				 dBookRate = Double.parseDouble(driver.findElement(By.xpath("//*[@id='table0']/tbody/tr["+(j+1)+"]/td[3]/input")).getAttribute("value").replaceAll(" ", ""));
				 sAdjustedRate = Double.parseDouble(driver.findElement(By.xpath("//*[@id='table0']/tbody/tr["+(j+1)+"]/td[6]/input")).getAttribute("value").replaceAll(" ", ""));
				 sPremium = Double.parseDouble(driver.findElement(By.xpath("//*[@id='table0']/tbody/tr["+(j+1)+"]/td[7]/input")).getAttribute("value").replaceAll(" ", ""));
				 
				 if(j == (numOfRow - 1)){
					 sTotalPremium = Double.parseDouble(driver.findElement(By.xpath("//*[@id='table0']/tbody/tr["+(numOfRow)+"]/td[7]/input")).getAttribute("value").replaceAll(" ", ""));
				 }
				 
				 // -- calculation :
				 
				 Cover_AdjustedRate = func_AllCovers_CalculateAdjustedRate(map_data,dBookRate, Abvr, SectionName, sFinalMap, count, sInnerSheetName);
				 String sPVal = driver.findElement(By.xpath("//*[@id='table0']/tbody/tr["+(j+1)+"]/td[2]/input")).getAttribute("value").replaceAll(",", "");
				 Cover_Premium = ((Cover_AdjustedRate * Double.parseDouble(sPVal))/100);
				 
				 
				 Cover_TotalPremium = Cover_TotalPremium + Cover_Premium;
							 
				// Compare values :
				 
				 //customAssert.assertTrue(compareValues(sAdjustedRate, Cover_AdjustedRate,"Adjusted Rate"),"Mismatched Adjusted Rate Values for secion : " + SectionName + " In Cover : "+ sCoverAbvr); 
				 customAssert.assertTrue(compareValues(sPremium, Double.parseDouble(common.roundedOff(Double.toString(Cover_Premium))), "Premium"),"Mismatched Premium Values for secion : " + SectionName + " In Cover : "+ sCoverAbvr);					 
				 
			 }			
			 
			 return Cover_TotalPremium;
		 }
		 
		 public static double func_AllCovers_CalculateAdjustedRate(Map<Object, Object> map_data, double dBookRate, String Abvr, String sectionName, String sMap, int count, String sSheetName){
				 double adjustedRate = 0.00;
				 double fisrtFactor = 0.00, sFactor = 0.00;
				 
				 
				 if(sMap.contains("InnerPageMap")){
					 fisrtFactor = ((((Double.parseDouble(common.NB_Structure_of_InnerPagesMaps.get(sSheetName).get(count).get(Abvr + "TechAdjust"))) * dBookRate)/ 100 ) + dBookRate );
					 sFactor = (((Double.parseDouble(common.NB_Structure_of_InnerPagesMaps.get(sSheetName).get(count).get(Abvr + "CommAdjust")))* fisrtFactor)/100);
				 }else{
					 fisrtFactor = ((((Double.parseDouble((String)map_data.get(Abvr + "TechAdjust"))) * dBookRate)/ 100 ) + dBookRate );
					 sFactor = (((Double.parseDouble((String)map_data.get(Abvr + "CommAdjust")))* fisrtFactor)/100);
				 }
				 
				 adjustedRate = fisrtFactor + sFactor ;
		 
				 return adjustedRate;
		 }
		 
		 // End of  All Cover (Except Terrorism) Table Handling functions
		 	
		 // Terrorism Table handling :
		 
		 public static boolean func_Terrorism_HandleTables(Map<Object, Object> map_data, String sCoverAbvr) throws Throwable, Exception{
			 String SectionName, Abvr = "";
			 double sPremium = 0.00, sTotalPremium = 0.00;
			 double dBookRate = 0.00;
			 boolean bVal =true;
			 
			 WebElement table= driver.findElement(By.className("matrix"));
			 int numOfRow = table.findElements(By.tagName("tr")).size();
			 		 		 
			 for(int j=0; j<numOfRow-2; j++){	
				 
				 SectionName = driver.findElement(By.xpath("html/body/div[3]/form/div/table[1]/tbody/tr["+(j+1)+"]/td[1]")).getText();	
				 Abvr = sCoverAbvr +"_" + func_GetAbrrivation(sCoverAbvr, SectionName);
				 
				 customAssert.assertTrue(k.DynamicXpathWebDriver(driver, "html/body/div[3]/form/div/table[1]/tbody/tr["+(j+1)+"]/td[2]/input", map_data , "Terrorism" , 0 , Abvr , "SumInsured", SectionName , "Input"),"Unable to enter sum insured value in "+ sCoverAbvr +" Table for : " + SectionName);
				 customAssert.assertTrue(k.DynamicXpathWebDriver(driver, "html/body/div[3]/form/div/table[1]/tbody/tr["+(j+1)+"]/td[3]/input", map_data , "Terrorism" , 0 , Abvr , "BookRate", SectionName , "Input"),"Unable to enter BookRate value in " + sCoverAbvr +" Table for : " + SectionName);
				
			 }
			 
			 customAssert.assertTrue(k.Click("CCF_Btn_Save"), "Unable to click on Save Button on Terrorism .");
			 
			// Read, Calculate and Compare Values from table :
			 
			 for(int j=0; j<numOfRow-2; j++){	
				 
				 SectionName = driver.findElement(By.xpath("html/body/div[3]/form/div/table[1]/tbody/tr["+(j+1)+"]/td[1]")).getText();	
				 Abvr = sCoverAbvr +"_" + func_GetAbrrivation(sCoverAbvr, SectionName);
							 
				 // -- reading Value from table :
				 
				 dBookRate = Double.parseDouble(driver.findElement(By.xpath("html/body/div[3]/form/div/table[1]/tbody/tr["+(j+1)+"]/td[3]/input")).getAttribute("value").replaceAll(" ", ""));			
				 sPremium = Double.parseDouble(driver.findElement(By.xpath("html/body/div[3]/form/div/table[1]/tbody/tr["+(j+1)+"]/td[4]/input")).getAttribute("value").replaceAll(" ", ""));
				 
				 if((j+1) == (numOfRow-1)){
					 sTotalPremium = Double.parseDouble(table.findElement(By.xpath("html/body/div[3]/form/div/table[1]/tbody/tr["+(numOfRow)+"]/td["+7+"]/input")).getAttribute("value").replaceAll(" ", ""));
				 }
				 
				 // -- calculation :			 
				 double sVal = Double.parseDouble(driver.findElement(By.xpath("html/body/div[3]/form/div/table[1]/tbody/tr["+(j+1)+"]/td[2]/input")).getAttribute("value").replaceAll(",", ""));
				 Cover_Premium = ((sVal*dBookRate)/100);
				 Cover_TotalPremium = Cover_TotalPremium + Cover_Premium;
							 
				// Compare values :
						 
				 if((j+1) == (numOfRow-1)){
					 customAssert.assertTrue(compareValues(sTotalPremium, Double.parseDouble(common.roundedOff(Double.toString(Cover_TotalPremium))),"Total premium"),"Mismatched Total premium Values for secion : " + SectionName + " In Cover : "+ sCoverAbvr );
					 TestUtil.WriteDataToXl(common.product+"_"+common.businessEvent, "Premium Summary",(String)common.NB_excel_data_map.get("Automation Key"), "PS_Terrorism_NP", String.valueOf(Cover_TotalPremium), map_data);
				 }		 
			 }	
			 
			 return bVal;
		 }
		 		 	 
		 // End of Terrorism table handling unctions
		 
		 public static String func_GetAbrrivation(String CoverName, String SecionName){
				String Abrrivation = "";
				
				if(SecionName.length() < 1){
					Abrrivation = "";
				}else{
					
				switch(CoverName){
				 
				 	case "MD":
				 		
				 		switch(SecionName){
					 		case "Buildings":
						 		Abrrivation = "BLD_";
						 		break;
						 	case "Machinery":
						 		Abrrivation = "MCH_";
						 		break;
						 	case "Stock":
						 		Abrrivation = "Stock_";
						 		break;
						 	case "Contents":
						 		Abrrivation = "CO_";
						 		break;
						 	case "Computer Equipment":
						 		Abrrivation = "CEP_";
						 		break;
						 		
						 	default :
						 		Abrrivation = "";	
				 		}
				 		
				 		break;
				 
				 	case "BI":
				 		
				 			switch(SecionName){
					 			case "Gross Profit":
							 		Abrrivation = "GPT_";
							 		break;
							 	case "Revenue":
							 		Abrrivation = "RVN_";
							 		break;
							 	case "Rent Receivable":
							 		Abrrivation = "RentRCV_";
							 		break;
							 	case "Rent Payable":
							 		Abrrivation = "RentP_";
							 		break;
							 	case "Increased Cost of Working":
							 		Abrrivation = "ICW_";
							 		break;
							 	case "Additional Increased Cost of Working":
							 		Abrrivation = "AICW_";
							 		break;
							 	default :
							 		Abrrivation = "";
				 			}
				 			
				 		break;
				 	case "LOI":
				 		
			 			switch(SecionName){
				 			case "Rent Receivable":
						 		Abrrivation = "RentRCV_";
						 		break;
						 	default :
						 		Abrrivation = "";
			 			}
			 			
			 		break;
				 	case "EL":
				 		Abrrivation = "CW_";
			 			break;
			 		
				 	case "PL":
				 		
			 			switch(SecionName){
				 			case "Turnover":
						 		Abrrivation = "Turnover_";
						 		break;
						 	case "Work Away Wages":
						 		Abrrivation = "WAW_";
						 		break;
						 	case "Payments to Bona Fide Subcontractors":
						 		Abrrivation = "PBFS_";
						 		break;				 		
						 	default :
						 		Abrrivation = "";
			 			}
			 			break;

				 	case "PRL":
				 		
			 			switch(SecionName){
				 			case "Turnover UK Only":
						 		Abrrivation = "TurnoverUK_";
						 		break;
						 	case "Turnover North America":
						 		Abrrivation = "TurnoverNA_";
						 		break;
						 	case "Turnover Rest Of World":
						 		Abrrivation = "TurnoverROW_";
						 		break;				 		
						 	default :
						 		Abrrivation = "";
			 			}
			 			break;
				 	case "POL":
				 		
			 			switch(SecionName){
				 			case "Buildings Declared Value":
						 		Abrrivation = "BuildingsDeclaredValue_";
						 		break;
						 	default :
						 		Abrrivation = "";
			 			}
			 			break;	
				 	case "SAR":
				 			Abrrivation = "";
				 			break;
				 			
				 	case "CAR":
				 		
			 			switch(SecionName){
				 			case "Contracting Turnover":
						 		Abrrivation = "CT_";
						 		break;
						 	case "Contract Value":
						 		Abrrivation = "CV_";
						 		break;
						 	case "Constructional Plant Tools & Equipment":
						 		Abrrivation = "CPTE_";
						 		break;				 		
						 	case "Temporary Buildings":
						 		Abrrivation = "TB_";
						 		break;
						 	case "Hired In Property Charges":
						 		Abrrivation = "HIPC_";
						 		break;
						 	case "Employees Personal Property":
						 		Abrrivation = "EPP_";
						 		break;
						 	default :
						 		Abrrivation = "";
			 			}
			 			break;
			 			
				 	case "CER":
				 		
			 			switch(SecionName){
				 			case "Computers":
						 		Abrrivation = "Computers_";
						 		break;
						 	case "Additional Expenditure":
						 		Abrrivation = "AdditionalExp_";
						 		break;
						 	default :
						 		Abrrivation = "";
			 			}
			 			break;
			 			
				 	case "M":
				 		Abrrivation = "EAC_";
			 			break;
			 			
				 	case "GIT":
				 		
			 			switch(SecionName){
				 			case "Estimated Annual Sendings":
						 		Abrrivation = "EAS_";
						 		break;
						 	case "Total Sum Insured for Your vehicles":
						 		Abrrivation = "TSIFYV_";
						 		break;
						 	default :
						 		Abrrivation = "";
			 			}
			 			break;
			 			
				 	case "MC":
				 		
			 			switch(SecionName){
				 			case "Zone 1 Carryings":
						 		Abrrivation = "Zone1_";
						 		break;
						 	case "Zone 2 Carryings":
						 		Abrrivation = "Zone2_";
						 		break;
						 	case "Zone 3 Carryings":
						 		Abrrivation = "Zone3_";
						 		break;				 		
						 	case "Zone 4 Carryings":
						 		Abrrivation = "Zone4_";
						 		break;
						 	case "Zone 5 Carryings":
						 		Abrrivation = "Zone5_";
						 		break;
						 	case "Zone 6 Carryings":
						 		Abrrivation = "Zone6_";
						 		break;
						 	case "Zone 7 Carryings":
						 		Abrrivation = "Zone7_";
						 		break;
						 	case "Zone 8 Carryings":
						 		Abrrivation = "Zone8_";
						 		break;
						 	default :
						 		Abrrivation = "";
			 			}
			 			break;
			 			
				 	case "CDS":
				 		Abrrivation = "ALOL_";
			 			break;
			 		
				 	case "DO":		 		
			 				 		
			 			switch(SecionName){
				 			case "Directors and Officers Limit":
						 		Abrrivation = "DOL_";
						 		break;
						 	case "Corporate Liability Limit":
						 		Abrrivation = "CLL_";
						 		break;
						 	case "Employment Practices Liability Limit":
						 		Abrrivation = "EPLL_";
						 		break;				 		
						 	default :
						 		Abrrivation = "";
			 			}
			 			break;
			 			
				 	case "FF":
				 		Abrrivation = "";
			 			break;
			 			
				 	case "LOL":
				 		Abrrivation = "LL_";
			 			break;
			 		
				 	case "FG":
				 		Abrrivation = "AYE_";
			 			break;
			 			
				 	case "TER":
				 		
			 			switch(SecionName){
				 			case "Zone A":
						 		Abrrivation = "ZoneA_";
						 		break;
						 	case "Zone B":
						 		Abrrivation = "ZoneB_";
						 		break;
						 	case "Zone C":
						 		Abrrivation = "ZoneC_";
						 		break;				 		
						 	case "Zone D":
						 		Abrrivation = "ZoneD_";
						 		break;
						 	case "Average Items":
						 		Abrrivation = "AverageItems_";
						 		break;
						 	case "Business Interruption":
						 		Abrrivation = "BI_";
						 		break;
						 	case "Loss of Income":
						 		Abrrivation = "LOI_";
						 		break;
						 	default :
						 		Abrrivation = "";
			 			}
			 			break;
				 }
			
				}
				 
				 return Abrrivation;
			 }

		 
	// --------------------- Cover Specific Functions Ends here ---------------------------------------------
		
		 

 
 public int countDecimalPlaces(String d_Number){
	 
	 if(d_Number!=null){
	 	int integerPlaces = d_Number.indexOf('.');
		int decimalPlaces = d_Number.length() - integerPlaces - 1;
		if(integerPlaces==-1){
			return 0;
		}
	 
		return decimalPlaces;
	 }else {
		 return 0;
	 }
}
 public boolean decideRewindMethod(){
	 
		
		try {
			
			
			switch (CommonFunction_VELA.product) {
			case "COB":
				if(common.currentRunningFlow.equals("NB")){
					customAssert.assertTrue(common_COB.funcRewindOperation(),"Error in function Rewind Operation .");
				}else if(common.currentRunningFlow.equals("MTA")){
					customAssert.assertTrue(common_COB.funcRewindOperation_MTA(),"Error in function Rewind Operation .");
				}
				
				break;
			case "COA":
				if(common.currentRunningFlow.equals("NB")){
					customAssert.assertTrue(common_COA.funcRewindOperation(),"Error in function COA Rewind Operation .");
				}
				
				break;
			case "XOC":
				if(common.currentRunningFlow.equals("NB")){
					customAssert.assertTrue(common_XOC.funcRewindOperation(),"Error in function XOC Rewind Operation .");
				}else if(common.currentRunningFlow.equals("MTA")){
					customAssert.assertTrue(common_XOC.funcRewindOperation_MTA(),"Error in function Rewind Operation .");
				}
				
				break;
			case "XOE":
				if(common.currentRunningFlow.equals("NB")){
					customAssert.assertTrue(common_XOC.funcRewindOperation(),"Error in function XOE Rewind Operation .");
				}
			case "XOQ":
				if(common.currentRunningFlow.equals("NB")){
					customAssert.assertTrue(common_XOC.funcRewindOperation(),"Error in function XOQ Rewind Operation .");
				}
				
				break;	
			case "LEA":
				if(common.currentRunningFlow.equals("NB")){
					customAssert.assertTrue(common_LEA.funcRewindOperation(),"Error in function LEA Rewind Operation .");
				}	
				break;
			
			}
			
			
			
		} catch (Exception e) {
			return false;
		}
		
		return true;
		
	}
 public boolean decideMTAMethod(){
	 
		
		try {
			
			
			switch (CommonFunction_VELA.product) {
			case "CCF":
				common_CCF.funcMTAOperation();
				break;
			case "CCG":
				
				break;
			case "CTA":
				common_CTA.funcRewindOperation();
				break;
			case "POB":
				common_POB.funcRewindOperation();
				
				break;
			case "POC":
				common_POB.funcRewindOperation();
				break;
			case "XOE":
				common_XOE.funcRewindOperation();
				break;
			case "SPI":
				customAssert.assertTrue(common_SPI.funcRewindOperation(),"Error in function Rewind Operation .");
				break;

			}
			
			
			
		} catch (Exception e) {
			return false;
		}
		
		return true;
		
	}
 
 public boolean funcRewind(){
	 
		
		try {
			
			customAssert.assertTrue(common.funcButtonSelection("Rewind"));
			customAssert.assertTrue(common.funcPageNavigation("Rewind Policy", ""),"Rewind Policy page navigations issue(S)");
			
			if(common.currentRunningFlow.equals("MTA")){
				customAssert.assertTrue(k.Input("RewindReason", (String)common.MTA_excel_data_map.get("MTA_RewindReason")));
				customAssert.assertTrue(common.funcButtonSelection("Rewind Endorsement"));
			}else if(common.currentRunningFlow.equals("NB")){
				customAssert.assertTrue(k.Input("RewindReason", (String)common.NB_excel_data_map.get("NB_RewindReason")));
				customAssert.assertTrue(common.funcButtonSelection("Rewind"));
			}else if(common.currentRunningFlow.equals("Renewal")){
				customAssert.assertTrue(k.Input("RewindReason", (String)common.Renewal_excel_data_map.get("Renewal_RewindReason")));
				customAssert.assertTrue(common.funcButtonSelection("Rewind"));
			}
			//customAssert.assertTrue(common.funcButtonSelection("Rewind"));
			customAssert.assertTrue(common.funcPageNavigation("Premium Summary", ""),"Rewind Policy page navigations issue(S)");
			//customAssert.assertTrue(common.funcButtonSelection("Put Rewind On Cover"));
			
		} catch (Exception e) {
			return false;
		}
		
		return true;
		
	}
 
 @SuppressWarnings({ "static-access", "unused" })
	public boolean insuranceTaxVerification() {
		

		
		try {
			common.funcButtonSelection("Insurance Tax");
			
			customAssert.assertTrue(funcPageNavigation("Tax Adjustment", ""),"Unable to land on Tax adjustment screen.");
			String sectionName;
			switch ((String)common.NB_excel_data_map.get("PS_InsuranceTaxButton")) {
			case "Yes":
				String value = null;
				List<WebElement> list = k.findElements("insuranceTaxExemptionRadioButton");
				for(int i=0;i<list.size();i++){
					
					boolean selectedStatus =  list.get(i).isSelected();
					if(selectedStatus){
						value = list.get(i).getAttribute("Value");	
					}
				}
				
				taxTable_tBody = k.getObject("inssuranceTaxMainTableBODY"); 
				List<WebElement> listOfCovers = taxTable_tBody.findElements(By.tagName("tr"));
				countOfCovers = listOfCovers.size();
				
				for(int j=0;j<countOfCovers-1;j++){
					
					sectionName = taxTable_tBody.findElement(By.xpath("tr["+(j+1)+"]/td[1]")).getText().replaceAll(" ", "");
					if(sectionName.contains("Excess of Loss")){
						sectionName = "PropertyExcessofLoss";
					}
					
					if(sectionName.equalsIgnoreCase("") || sectionName==null || sectionName.equalsIgnoreCase("Totals")){
						continue;
					}else{
						
						String actGP =  taxTable_tBody.findElement(By.xpath("tr["+(j+1)+"]/td[2]")).getText();
						String actGT =  taxTable_tBody.findElement(By.xpath("tr["+(j+1)+"]/td[5]")).getText();
						
						String expGP = (String)common.NB_excel_data_map.get("PS_"+sectionName.replaceAll(" ", "")+"_GP");
						String expGT = (String)common.NB_excel_data_map.get("PS_"+sectionName.replaceAll(" ", "")+"_GT");
						
						if(verification(actGP,expGP,sectionName,"Gross Premium") && 
								verification(actGT,expGT,sectionName,"Gross Tax")){
							
							TestUtil.reportStatus("[<b>  "+sectionName+"  </b>]  cover --- Verified on Insurance Tax screen. Gross Premium is :  <b>[ "+expGP+" ]</b> , Gross Tax is :  <b>[ "+expGT+" ]</b> ", "PASS", false);
						}
						
					}
					taxTable_tBody = k.getObject("inssuranceTaxMainTableBODY");
					List<WebElement> list3 = taxTable_tBody.findElements(By.tagName("tr"));
					countOfCovers = list3.size();
					
				}
				
				TestUtil.reportStatus("<b>Policy Exempt from insurance tax radio button is selected as 'Yes' Hence skipped adjustment operation for all covers.</b>", "Info", false);
				break;
				
			case "No":
				
				TestUtil.reportStatus("<b> Tax adjustment Verificatiion is started after removing cover. </b>", "Info", false);
				taxTable_tBody = k.getObject("inssuranceTaxMainTableBODY"); 
				List<WebElement> list2 = taxTable_tBody.findElements(By.tagName("tr"));
				countOfCovers = list2.size();
				
				
				for(int j=0;j<countOfCovers-1;j++){
					
					taxTable_tBody = k.getObject("inssuranceTaxMainTableBODY");
					sectionName = taxTable_tBody.findElement(By.xpath("tr["+(j+1)+"]/td[1]")).getText();
					if(sectionName.contains("Excess of Loss")){
						sectionName = "Property Excess of Loss";
					}
					
					if(sectionName.equalsIgnoreCase("") || sectionName==null || sectionName.equalsIgnoreCase("Totals")){
						continue;
					}else{
						
						String actGP =  taxTable_tBody.findElement(By.xpath("tr["+(j+1)+"]/td[2]")).getText();
						String actGT =  taxTable_tBody.findElement(By.xpath("tr["+(j+1)+"]/td[5]")).getText();
						
						String expGP = (String)common.NB_excel_data_map.get("PS_"+sectionName.replaceAll(" ", "")+"_GP");
						String expGT = (String)common.NB_excel_data_map.get("PS_"+sectionName.replaceAll(" ", "")+"_GT");
						
						if(verification(actGP,expGP,sectionName,"Gross Premium") && 
								verification(actGT,expGT,sectionName,"Gross Tax")){
							
							TestUtil.reportStatus("[<b>  "+sectionName+"  </b>]  cover --- Verified on Insurance Tax screen. Gross Premium is :  <b>[ "+expGP+" ]</b> , Gross Tax is :  <b>[ "+expGT+" ]</b> ", "PASS", false);
						}
						
					}
					taxTable_tBody = k.getObject("inssuranceTaxMainTableBODY");
					List<WebElement> list3 = taxTable_tBody.findElements(By.tagName("tr"));
					countOfCovers = list3.size();
				}
				TestUtil.reportStatus("<b> Tax adjustment operatios is completed. </b>", "Info", false);
				break;
			}
			
			common.funcPageNavigation("", "Save");
			k.Click("Tax_adj_BackBtn");
				
			return true;
		}catch (Throwable t) {
			return false;
		}
		
	}
 
 /****
  * 
  * Variable - tradeCodeValue ---- > TradeCode from Excel Sheet
  * Variable - pageName ---- > Trade code selection Page. E.G - Property Details/Policy Details
  * Variable - currentPropertyIndex ---- > This variable is only used for Inner pages to get current index. For non Inner pass as "0"
  * 
  */
 	@SuppressWarnings("static-access")
	public boolean tradeCodeSelection(String tradeCodeValue , String pageName , int currentPropertyIndex) {
		
 		try{
 			customAssert.assertTrue(k.Click("CCF_Btn_SelectTradeCode"), "Unable to click on Select Trade Code button in Policy Details .");
 			customAssert.assertTrue(common.funcPageNavigation("Trade Code Selection", ""), "Navigation problem to Trade Code Selection page .");
 			String a_selectedTradeCode = null;
 			String a_selectedTradeCode_desc = null;
 	 		List<WebElement> list = k.findElements("TradeCodeName");/*driver.findElements(By.xpath("//*[contains(@class,'std')]/tBody/tr/td/a"));*/
 	 		String flag = null;
 	 		String v_exp_selectedTradeCode_Desc = null;
 	 		for(int i=0;i<list.size();i++){
 	 			
 	 			String tradeCode = list.get(i).getText();
 	 			if(tradeCodeValue.equalsIgnoreCase(tradeCode)){
 	 				JavascriptExecutor j_exe = (JavascriptExecutor) driver;
 					j_exe.executeScript("arguments[0].scrollIntoView(true);", list.get(i));
 					v_exp_selectedTradeCode_Desc = driver.findElement(By.xpath("//*[contains(@class,'std')]/tBody/tr["+(i+1)+"]/td[2]")).getText();
 	 				list.get(i).click();
 	 				flag = "found";
 	 				break;
 	 			}else{
 	 				flag = "Not Found";
 	 			}
 	 		}
 	 		
 	 		if(!flag.equalsIgnoreCase("found")){
 	 			
 	 			if((String)common.NB_excel_data_map.get("PD_TCS_TradeCode")==null || ((String)common.NB_excel_data_map.get("PD_TCS_TradeCode")).equalsIgnoreCase("")){
 	 				TestUtil.reportStatus("Trade code value is empty. Please check your datasheet. Trade code is mandatory to proceed further. Path : "+common.product+"_"+common.businessEvent+".xlsx > "+(String)common.NB_excel_data_map.get("Automation Key")+" > Policy Details Sheet > Field Name : TCS_TradeCode ", "Fail", true);
 	 			}else{
 	 				TestUtil.reportStatus("Trade code <b>[  "+(String)common.NB_excel_data_map.get("PD_TCS_TradeCode")+"  ]</b> is not present in the selection list. Please enter valid Trade code. Trade code is mandatory to proceed further. Path to update value : "+common.product+"_"+common.businessEvent+".xlsx > "+(String)common.NB_excel_data_map.get("Automation Key")+" > Policy Details Sheet > Field Name : TCS_TradeCode ", "Fail", true);
 	 			}
 	 			return false;
 	 		}else{
 	 			
 	 			switch (pageName) {
				case "Policy Details":
					
					switch (CommonFunction_VELA.product) {
					case "CCG":
						TestUtil.WriteDataToXl(CommonFunction_VELA.product+"_"+CommonFunction_VELA.businessEvent, "Policy Details" , (String)common.NB_excel_data_map.get("Automation Key"), "PD_TCS_TradeCode_HazardGroup", k.getText("CCF_Gray_PD_TradeCode_HazardGroup"), common.NB_excel_data_map);
						break;
					case "POC":
						TestUtil.WriteDataToXl(CommonFunction_VELA.product+"_"+CommonFunction_VELA.businessEvent, "Policy Details" , (String)common.NB_excel_data_map.get("Automation Key"), "PD_TCS_TradeCode_HazardGroup", k.getText("CCF_Gray_PD_TradeCode_HazardGroup"), common.NB_excel_data_map);
						break;
					case "XOE":
						TestUtil.WriteDataToXl(CommonFunction_VELA.product+"_"+CommonFunction_VELA.businessEvent, "Policy Details" , (String)common.NB_excel_data_map.get("Automation Key"), "PD_TCS_TradeCode_HazardGroup", k.getText("CCF_Gray_PD_TradeCode_HazardGroup"), common.NB_excel_data_map);
						break;	
					}	
					a_selectedTradeCode = k.getText("CCF_Gray_PD_TradeCode");
					customAssert.SoftAssertEquals(a_selectedTradeCode, tradeCodeValue,"Trade Code on Policy Details Screen is incorrect - Expected [ <b>"+tradeCodeValue+"</b>] and Actual [<b>"+a_selectedTradeCode+"</b>]  .");
	 	 			TestUtil.reportStatus("Trade Code on Policy Details Screen is Correct.", "Pass", true);
	 	 			
	 	 			a_selectedTradeCode_desc = k.getText("CCF_Gray_PD_TradeCode_Desc");
	 	 			customAssert.SoftAssertEquals(a_selectedTradeCode_desc, v_exp_selectedTradeCode_Desc,"Trade Code Description on Policy Details Screen is incorrect- Expected [ <b>"+v_exp_selectedTradeCode_Desc+"</b>] and Actual [<b>"+a_selectedTradeCode+"</b>]  . ");
	 	 			TestUtil.reportStatus("Trade Code Description on Policy Details Screen is Correct.", "Pass", true);
	 	 			
					break;
				case "Property Details":
					a_selectedTradeCode = k.getText("CCF_Gray_PD_TradeCode");
	 	 			customAssert.SoftAssertEquals(a_selectedTradeCode, tradeCodeValue,"Trade Code on Policy Details Screen is incorrect - Expected [ <b>"+tradeCodeValue+"</b>] and Actual [<b>"+a_selectedTradeCode+"</b>]  .");
	 	 			TestUtil.reportStatus("Trade Code on Policy Details Screen is Correct.", "Pass", true);
	 	 			
	 	 			a_selectedTradeCode_desc = k.getText("CCF_Gray_PD_TradeCode_Desc");
	 	 			customAssert.SoftAssertEquals(a_selectedTradeCode_desc, v_exp_selectedTradeCode_Desc,"Trade Code Description on Policy Details Screen is incorrect- Expected [ <b>"+v_exp_selectedTradeCode_Desc+"</b>] and Actual [<b>"+a_selectedTradeCode+"</b>]  . ");
	 	 			TestUtil.reportStatus("Trade Code Description on Policy Details Screen is Correct.", "Pass", true);
	 	 			
					break;
				case "Contractors All Risks":
					a_selectedTradeCode = k.getText("CCF_Gray_PD_TradeCode_CAR");
	 	 			customAssert.SoftAssertEquals(a_selectedTradeCode, tradeCodeValue,"Trade Code on Policy Details Screen is incorrect - Expected [ <b>"+tradeCodeValue+"</b>] and Actual [<b>"+a_selectedTradeCode+"</b>]  .");
	 	 			TestUtil.reportStatus("Trade Code on Policy Details Screen is Correct.", "Pass", true);
	 	 			
	 	 			a_selectedTradeCode_desc = k.getText("CCF_Gray_PD_TradeCode_Desc_CAR");
	 	 			customAssert.SoftAssertEquals(a_selectedTradeCode_desc, v_exp_selectedTradeCode_Desc,"Trade Code Description on Policy Details Screen is incorrect- Expected [ <b>"+v_exp_selectedTradeCode_Desc+"</b>] and Actual [<b>"+a_selectedTradeCode+"</b>]  . ");
	 	 			TestUtil.reportStatus("Trade Code Description on Policy Details Screen is Correct.", "Pass", true);
	 	 			
					break;

				default:
					break;
				}
 	 			
 	 			return true;
 	 		}
 		}catch(Throwable t){
 			return false;
 		}
	}
 	
    public boolean funcDecline(Map<Object, Object> map_data){
		
		 boolean retvalue = true;
		 int counter = 0;
			try {     
				
				
				customAssert.assertTrue(funcButtonSelection("Decline"),"Unable to click on Decline button.");
				customAssert.assertTrue(common.funcPageNavigation("Decline Reason", ""), "Navigation problem to Decline Reason page .");
				// Click on Decline button
				
				map_data.put("Decline_Reason",  k.GetDropDownSelectedValue("Decline_ReasonList"));
				customAssert.assertTrue(k.Input("Decline_AdditionalInfo", "Test Decline"),"Unable to enter additional info on Decline Reason page");
				map_data.put("Decline_AdditionalInfo",  k.getAttribute("Decline_AdditionalInfo","value"));
				if(common.currentRunningFlow.equals("MTA")){
					customAssert.assertTrue(funcButtonSelection("Decline Endorsement"),"Unable to click on Decline Endorsement button on Decline page.");
				}else if(common.currentRunningFlow.equals("NB")){
					customAssert.assertTrue(funcButtonSelection("Decline"),"Unable to click on Decline button on Decline page.");
				}else if(common.currentRunningFlow.equals("Renewal")){
					customAssert.assertTrue(funcButtonSelection("Decline Renewal"),"Unable to click on Decline button on Decline page.");
				}
				
				return retvalue;	
			}catch(Throwable t){
				return false;
			}
			
	}
    //verify decline status -     NTU / Decline Details
    public boolean funcVerifyDeclineNTUstatus(Map<Object, Object> map_data){
    	try{
    		//NTU / Decline Details
    		customAssert.assertTrue(common.funcMenuSelection("Navigate", "NTU / Decline Details"),"Unable to navigate page - NTU / Decline Details");
    		customAssert.assertTrue(common.funcPageNavigation("NTU / Decline Details", ""), "Navigation problem to NTU / Decline Details page .");
    		String DeclineReason = k.getText("DeclineReason");
    		String AdditionalInfo=k.getText("DeclineAdditionalInfo");
    		String RevisitQuote=k.getText("DeclineRevisitQuote");
    		String SendDeclineEmailToBrkr=k.getText("DeclineEmail");
    		if(map_data.get("Decline_Reason").equals(DeclineReason)){
	    		TestUtil.reportStatus("Decline Reason: "+DeclineReason, "Info", false);
	    		TestUtil.reportStatus("Additional Info: "+AdditionalInfo, "Info", false);
	    		TestUtil.reportStatus("Revisit Quote: "+RevisitQuote, "Info", false);
	    		TestUtil.reportStatus("Send Decline Mail to Broker: "+SendDeclineEmailToBrkr, "Info", false);
	    		return true;
    		}else{TestUtil.reportStatus("Decline Reason Mismatched with Expected :"+map_data.get("Decline_Reason")+"|| Actual value is "+DeclineReason, "Fail", true);
    		throw new Exception();
    		}
    	}catch(Throwable t){
    		TestUtil.reportStatus("Failed In Decline Details Page " , "Fail", false);
    		ErrorUtil.addVerificationFailure(t);
    		return false;
    		}
    }
    	   	
    	
    public boolean funcNTU(Map<Object, Object> map_data){
		
		 boolean retvalue = true;
			try {     
				
				customAssert.assertTrue(funcButtonSelection("NTU"),"Unable to click on NTU button.");
				customAssert.assertTrue(common.funcPageNavigation("NTU Reason", ""), "Navigation problem to NTU Reason page .");
				// Click on Decline button
				
				map_data.put("NTU_Reason",  k.GetDropDownSelectedValue("NTU_ReasonList"));
				customAssert.assertTrue(k.Input("NTU_AdditionalInfo","Test NTU"),"Unable to enter additional info on NTU page");
				map_data.put("NTU_AdditionalInfo",  k.getAttribute("NTU_AdditionalInfo","value"));
				if(common.currentRunningFlow.equals("MTA")){
					customAssert.assertTrue(funcButtonSelection("NTU Endorsement"),"Unable to click on NTU Endorsement button on NTU Reason page.");
				}else if(common.currentRunningFlow.equals("NB")){
					customAssert.assertTrue(funcButtonSelection("NTU"),"Unable to click on NTU button on NTU Reason page.");
				}else if(common.currentRunningFlow.equals("Renewal")){
					customAssert.assertTrue(funcButtonSelection("NTU Renewal"),"Unable to click on NTU button on NTU Reason page.");
				} 
				
				
				return retvalue;	
			}catch(Throwable t){
				return false;
			}
			
			}
   //verify decline status -     NTU / Decline Details
   public boolean funcVerifyNTUstatus(Map<Object, Object> map_data){
   	try{
   		//NTU / Decline Details
   		customAssert.assertTrue(common.funcMenuSelection("Navigate", "NTU / Decline Details"),"Unable to navigate page - NTU / Decline Details");
   		customAssert.assertTrue(common.funcPageNavigation("NTU / Decline Details", ""), "Navigation problem to NTU / Decline Details page .");
   		String NTUReason = k.getText("NTUReason");
   		String AdditionalInfo=k.getText("NTUAdditionalInfo");
   		String RevisitQuote=k.getText("NTURevisitQuote");
   		
   		if(map_data.get("NTU_Reason").equals(NTUReason)){
	    		TestUtil.reportStatus("NTU Reason: "+NTUReason, "Info", false);
	    		TestUtil.reportStatus("Additional Info: "+AdditionalInfo, "Info", false);
	    		TestUtil.reportStatus("Revisit Quote: "+RevisitQuote, "Info", false);
	    		
	    		return true;
   		}else{TestUtil.reportStatus("NTU Reason Mis-matched with Expected :"+map_data.get("NTU_Reason")+"|| Actual value is "+NTUReason, "Fail", true);
   		throw new Exception();
   		}
   	}catch(Throwable t){
   		TestUtil.reportStatus("Failed In NTU Details Page " , "Fail", false);
   		ErrorUtil.addVerificationFailure(t);
   		return false;
   		}
   }
    
   public boolean createEndorsement(Map<Object, Object> map_data){
	   try{
		   customAssert.assertTrue(common.funcMenuSelection("Navigate","Premium Summary"),"Issue while Navigating to Premium Summary screen . ");
		   customAssert.assertTrue(funcButtonSelection("Create Endorsement"),"Unable to click on Create Endorsement button.");
			customAssert.assertTrue(common.funcPageNavigation("Create Endorsement", ""), "Navigation problem to Create Endorsement Reason page .");
			customAssert.assertTrue(k.Input("Endorsement_AdditionalInfo","Test Endorsement"),"Unable to enter additional info on Create Endorsement page");
//			map_data.put("NTU_AdditionalInfo",  k.getAttribute("NTU_AdditionalInfo","value"));
			customAssert.assertTrue(funcButtonSelection("Create Endorsement"),"Unable to click on Create Endorsement button on Create Endorsement page.");
			
		   return true;
	   }
	   catch(Throwable t){
	   		TestUtil.reportStatus("Failed In Create Endorsement function. " , "Fail", false);
	   		ErrorUtil.addVerificationFailure(t);
	   		return false;
	   		}
   }
   
   public boolean funcGoOnCover_Endorsement(Map<Object, Object> map_data){
		
		 boolean retvalue = true;
			try {   
				customAssert.assertTrue(common.funcPageNavigation("Premium Summary", ""), "Navigation problem to Premium Summary page .");
				customAssert.assertTrue(funcButtonSelection("Go On Cover"), "Unable to click on Go on cover button .");
				customAssert.assertTrue(k.Click("Endorsement_On_cover_accept"), "Unable to Click Put Endorsement On Cover button on Go On Cover page .");
				return retvalue;

			} catch(Throwable t) {
				String methodName = new Object(){}.getClass().getEnclosingMethod().getName();
				TestUtil.reportFunctionFailed("Failed in "+methodName+" function");
				k.reportErr("Failed in "+methodName+" function", t);
				Assert.fail("Unable to enter details in Go On Cover", t);
				return false;
			}
		}
   
   public boolean funcDiscardMTA(Map<Object, Object> map_data){
		
		 boolean retvalue = true;
			try {     
				
				customAssert.assertTrue(funcButtonSelection("Discard Endorsement"),"Unable to click on Decline button.");
				customAssert.assertTrue(k.AcceptPopup(),"Error while accepting discard pop up");
				
				return retvalue;	
			}catch(Throwable t){
				return false;
			}
			
	}
   public void CancellationPremiumTables( String code, String event, String tableName, boolean re_Calc){
		//Transaction Premium Table
			try{
				k.ImplicitWaitOff();
				Hashtable<String,String> coverlist = new Hashtable<String,String>();
				Hashtable<String,String> cHash = new Hashtable<String,String>();
				String[] prem_col = {"gprm","comr","comm","nprem","gipt","nipt"};
				String testName = (String)common.CAN_excel_data_map.get("Automation Key");
				
				coverlist.put("Material Damage","md7");
				coverlist.put("Business Interruption","bi2");
				coverlist.put("Terrorism","tr2");
				coverlist.put("Employers Liability","el3");
				coverlist.put("Public Liability","pl2");
				coverlist.put("Products Liability","pr1");
				coverlist.put("Specified All Risks","sar");
				coverlist.put("Contractors All Risks","car");
				coverlist.put("Computers and Electronic Risks","it");
				coverlist.put("Money","mn2");
				coverlist.put("Goods In Transit","gt2");
				coverlist.put("Marine Cargo","mar");
				coverlist.put("Cyber and Data Security","cyb");
				coverlist.put("Directors and Officers","do2");
				coverlist.put("Frozen Foods","ff2");
				coverlist.put("Loss of Licence","ll2");
				coverlist.put("Fidelity Guarantee","fg");
				coverlist.put("Legal Expenses","lg2");
				coverlist.put("Total","tot");
				
				cHash.put("gprm","GP");
				cHash.put("comr","CR");
				cHash.put("comm","GC");
				cHash.put("nprem","NP");
				cHash.put("gipt","GT");
				cHash.put("nipt","NPIPT");
				cHash.put("com","GC");
				//html/body/div[3]/form/div/table[3]/tbody/tr
				switch (tableName){
				
					case "AP":
						String Trax_table = "html/body/div[3]/form/div/table[3]";
						int rcount = driver.findElements(By.xpath(Trax_table+"/tbody/tr")).size();
						
						
						List<WebElement> col=driver.findElements(By.xpath("html/body/div[3]/form/div/table[3]/tbody/tr[1]/td"));
						//System.out.println(col.size());
						int cCount = col.size();
						Hashtable<String,String> transSmryData = new Hashtable<String,String>();
						String tXpath =Trax_table+"/tbody/tr";
						String CellValue;
						//System.out.println("Transaction Premium Table exist on premium summary page");
						TestUtil.reportStatus("Annual Premium Table exist on premium summary page", "Info", true);
						//System.out.println("Covers Found -:"+ (rcount-1));
						TestUtil.reportStatus("Covers Found -:"+ (rcount-1), "Info", false);
							
							for(int i =1;i<=rcount;i++){
								String sectionXpath = tXpath+"["+i+"]/td[1]";
								String sec_name = driver.findElement(By.xpath(sectionXpath)).getText();
								//System.out.print(sec_name+"\t\t\t");
								if(sec_name.contains("Frozen Food")){
									sec_name = "FrozenFoods";
								}else if(sec_name.contains("Licence")){
									sec_name = "LossOfLicence";
								}else if(sec_name.contains("Total")){
									sec_name = "Total";
									sec_name = "Total";
								}else{
									sec_name = sec_name.replaceAll(" ", "");
								}
								
								TestUtil.reportStatus("---------------"+sec_name+"-----------------","Info",false);
								
								for(int j = 2; j<=cCount;j++){
									//Annual Premium Data
									String ColumnValues = tXpath+"["+i+"]/td["+j+"]";
									CellValue = driver.findElement(By.xpath(ColumnValues)).getText().replaceAll(",","");;
									if(cHash.get(prem_col[j-2]).equalsIgnoreCase("CR") && sec_name.contains("Total"))
									{}else{
									transSmryData.put("PS_"+sec_name.replaceAll(" ", "")+"_"+cHash.get(prem_col[j-2]), CellValue);}
								}
								PremiumSummarytableCalculation(transSmryData,sec_name);
							
							} 
						
						// Writing Data to Excel Sheet from Map
							Set<String> pKeys=transSmryData.keySet();
						 	for(String pkey:pKeys){
//						 		if(re_Calc){
//						 			customAssert.assertTrue(WriteDataToXl(code+"_"+event, "Premium Summary", testName,pkey,transSmryData.get(pkey) ,common.NB_excel_data_map),"Error while writing Premium Summary data to excel ."+pkey) ;
//						 		}else{
						 			compareValues(Double.parseDouble(TestUtil.getStringfromMap(pkey,"NB")),Double.parseDouble(transSmryData.get(pkey)), pkey);
//						 		}
						 	}
						
						
						
						 	 TestUtil.reportStatus("Values have been stored from Annual Premium table", "info", true);
						
						break;
						
					case "CP":
						String CAN_table = "html/body/div[3]/form/div/table[4]";
						int crowcount = driver.findElements(By.xpath(CAN_table+"/tbody/tr")).size();
						int cColCount = driver.findElements(By.xpath("html/body/div[3]/form/div/table[4]/tbody/tr[1]/td")).size();
						Hashtable<String,String> CanSmryData = new Hashtable<String,String>();
						String cXpath =CAN_table+"/tbody/tr";
						String cCellValue;
						
						String rPath  = "html/body/div[3]/form/div/table[4]/tbody/tr[";
						String rPath2 = "]/td[";
						String cPath  = "]/input";
						
						// html/body/div[3]/form/div/table[4]/tbody/tr[1]/td[2]/input
						for(int l =1; l<=crowcount;l++){
							String sectionXpath = rPath+l+"]/td[1]";
							String sec_name = driver.findElement(By.xpath(sectionXpath)).getText();
							//System.out.print(sec_name+"\t\t\t");
							if(sec_name.contains("Frozen Food")){
								sec_name = "FrozenFoods";
							}else if(sec_name.contains("Licence")){
								sec_name = "LossOfLicence";
							}else if(sec_name.contains("Total")){
								sec_name = "Total";
								sec_name = "Total";
							}else{
								sec_name = sec_name.replaceAll(" ", "");
							}
							
							for(int m =2;m<=cColCount;m++){
								String cXPath =rPath+l+"]/td["+m+"]";
								String cellVariable = "PS_"+sec_name+"_"+cHash.get(prem_col[m-2]);
								if(cHash.get(prem_col[m-2]).equals("GP") && m==2 && !sec_name.contains("Total")){
									String gpXPath =rPath+l+"]/td["+m+"]/input";
									String gPrem =null;
									if(re_Calc){
										String cGP;
										gPrem = driver.findElement(By.xpath(gpXPath)).getAttribute("value").replaceAll(",", "");
										String changeGP = (String)common.CAN_excel_data_map.get("CAN_"+sec_name+"_"+cHash.get(prem_col[m-2]));
										if(Integer.parseInt(changeGP)!=0){
											double New_GP = Double.parseDouble(gPrem) - Double.parseDouble(changeGP);
											cGP = f.format(New_GP);
											 k.scrollInViewByXpath(gpXPath);
											driver.findElement(By.xpath(gpXPath)).clear();
											driver.findElement(By.xpath(gpXPath)).sendKeys(cGP);
											driver.findElement(By.xpath(gpXPath)).sendKeys(Keys.TAB);
											k.Click("cancelRecalc");
											gPrem = driver.findElement(By.xpath(gpXPath)).getAttribute("value").replaceAll(",", "");
											
											TestUtil.reportStatus("Section :"+sec_name+" change value for Gross Premium is :<b>"+changeGP, "Info", false);
											TestUtil.reportStatus("Section :"+sec_name+" updated Gross Premium is :<b>"+New_GP, "Info", false);
										}else{
											 k.scrollInViewByXpath(gpXPath);
											gPrem = driver.findElement(By.xpath(gpXPath)).getAttribute("value").replaceAll(",", "");
										}
										
									}else {
										 k.scrollInViewByXpath(gpXPath);
										gPrem = driver.findElement(By.xpath(gpXPath)).getAttribute("value").replaceAll(",", "");
									}
									
									CanSmryData.put(cellVariable, gPrem);
									continue;
								}
								 k.scrollInViewByXpath(cXPath);
								String cellvalue = driver.findElement(By.xpath(cXPath)).getText().replaceAll(",", "");
								CanSmryData.put(cellVariable, cellvalue);
							}
							PremiumSummarytableCalculation(CanSmryData,sec_name);
												
						}
						// Writing Data to Excel Sheet from Map
						Set<String> cKeys=CanSmryData.keySet();
					 	for(String pkey:cKeys){
//					 		if(re_Calc){
					 			//customAssert.assertTrue(WriteDataToXl(code+"_"+event, "Premium Summary", testName,pkey,CanSmryData.get(pkey) ,common.CAN_excel_data_map),"Error while writing Premium Summary data to excel"+pkey) ;
					 		if(pkey.equalsIgnoreCase("PS_Total_CR")==false){
					 			common.CAN_excel_data_map.put(pkey, CanSmryData.get(pkey));}
//					 		}else{
					 			//compareValues(Double.parseDouble(TestUtil.getStringfromMap(pkey,"NB")),Double.parseDouble(CanSmryData.get(pkey)), pkey);
//					 		}
					 	}
						
						 TestUtil.reportStatus("Values have been Verified from <b> Cancellation Premium table", "info", true);					
						break;
						
					default:
						break;
						
				}
				
			} 
			catch(Throwable t ){
				k.ImplicitWaitOn();
				ErrorUtil.addVerificationFailure(t);
				 
			}
			
			//System.out.println("Gross Premium for Material Damage Cover in Transaction Premium table is :"+transSmryData.get("MaterialDamage_gprem"));
			
	}
  
   
   /**
    * 
    * -----------------------------------Renewal flow Functions : Starting------------------------- 
    * 
    */
   
   
   public boolean funcSearchPolicy_Renewal(Map<Object, Object> map_data)
	{
		boolean ret_value = true;
		//String cl_name = (String)map_data.get("NB_ClientName");
		try{
			
			customAssert.assertTrue(k.getText("searchPoliciesPage_Header").equalsIgnoreCase("Search Policies"), "Search policies Page is not loaded . ");
			customAssert.assertTrue(k.Click("comm_clear"),"Unable to Clear Search Policies Filter Data .");
			customAssert.assertTrue(k.Input("Policy_Number_txtBox", (String)map_data.get("Renewal_PolicyNumber")), "Unable to enter policy number.");
			customAssert.assertTrue(k.Click("comm_search"), "Unable to click on search button.");
			TestUtil.reportStatus("Policy: "+(String)map_data.get("Renewal_PolicyNumber")+" successfully searched . ", "Info", true);
			TestUtil.WriteDataToXl(CommonFunction_VELA.product+"_"+CommonFunction_VELA.businessEvent, "Renewal",(String)common.Renewal_excel_data_map.get("Automation Key"), "Renewal_ClientName", k.getText("Policy_Client_Name"), common.Renewal_excel_data_map);
			if(!TestBase.product.equals("SPI"))
				TestUtil.WriteDataToXl(CommonFunction_VELA.product+"_"+CommonFunction_VELA.businessEvent, "Policy Details",(String)common.Renewal_excel_data_map.get("Automation Key"), "PD_ProposerName", k.getText("Policy_Client_Name"), common.Renewal_excel_data_map);
			else
				TestUtil.WriteDataToXl(CommonFunction_VELA.product+"_"+CommonFunction_VELA.businessEvent, "PolicyGeneral",(String)common.Renewal_excel_data_map.get("Automation Key"), "PG_InsuredName", k.getText("Policy_Client_Name"), common.Renewal_excel_data_map);
			customAssert.assertTrue(k.Click("Policy_Client_Name"), "Unable to click on client name . ");
		
		}catch(Throwable t){
		   String methodName = new Object(){}.getClass().getEnclosingMethod().getName();
           TestUtil.reportFunctionFailed("Failed in "+methodName+" function");     
           k.reportErr("Failed in "+methodName+" function", t);
           ret_value = false;;
		}
		
		return ret_value;
	}
   
   
   public boolean funcVerifyPolicyStatus_Renewal(Map<Object, Object> map_data,String code,String event,String exp_Policy_Status)
	{
		boolean ret_value = true;
		String policy_status_actual=null;
		String testName = (String)map_data.get("Automation Key");
		try{
			
			policy_status_actual = k.getText("Policy_status_header");
			customAssert.assertEquals(policy_status_actual, exp_Policy_Status,"Mismatch in Policy Status - Expected: <b>"+exp_Policy_Status+"</b> Actual: <b>"+policy_status_actual+"</b> on Premium Summary Page . ");
			customAssert.assertTrue(WriteDataToXl(code+"_"+event, "Renewal", testName, "Renewal_CurrentPolicyStatus", exp_Policy_Status,common.Renewal_excel_data_map),"Error while writing data to excel for field >Renewal_CurrentPolicyStatus<");
			
			TestUtil.reportStatus("Verified Policy Status as <b>"+exp_Policy_Status+"</b> successfully . ", "Info", true);
		}catch(Throwable t){
			ret_value = false;
		}
		
		return ret_value;
	}
   
   
   public boolean funcUpdateCoverDetails(Map<Object, Object> map_data){
	   
	try {
			customAssert.assertTrue(common.funcMenuSelection("Navigate", "Covers"),"Cover page is having issue(S)");
			customAssert.assertTrue(common.funcPageNavigation("Covers", ""),"Cover page is having issue(S)");
			String coverName = null;
			String c_locator = null;
			k.pressDownKeyonPage();
			String all_cover = ObjectMap.properties.getProperty(CommonFunction_VELA.product+"_CD_AllCovers");
			String[] split_all_covers = all_cover.split(",");
			for(String coverWithLocator : split_all_covers){
				String coverWithoutLocator = coverWithLocator.split("_")[0];
				try{
					//CoversDetails_data_list.add(coverWithoutLocator);
					coverName = coverWithLocator.split("__")[0];	
					c_locator = coverWithLocator.split("__")[1];
					k.waitTwoSeconds();
					if(c_locator.equals("pcw")){
						if(((String) common.Renewal_excel_data_map.get("CD_AnnualWorks")).equalsIgnoreCase("Yes")){
							//TestUtil.WriteDataToXl(CommonFunction_VELA.product+"_"+CommonFunction_VELA.businessEvent, "CoverDetails",(String)map_data.get("Automation Key"), "CD_"+coverName, "No", common.Renewal_excel_data_map);
							map_data.put("CD_"+coverName,"No");
						}else{
							if (!driver.findElement(By.xpath("//*[contains(@name,'"+c_locator+"_selected')]")).isSelected()){
								JavascriptExecutor j_exe = (JavascriptExecutor) driver;
								j_exe.executeScript("arguments[0].scrollIntoView(true);", driver.findElement(By.xpath("//*[contains(@name,'"+c_locator+"_selected')]")));
								
									if(((String) common.Renewal_excel_data_map.get("CD_"+coverName)).equalsIgnoreCase("No"))
										continue;
									else
										//TestUtil.WriteDataToXl(CommonFunction_VELA.product+"_"+CommonFunction_VELA.businessEvent, "CoverDetails",(String)map_data.get("Automation Key"), "CD_"+coverName, "No", common.Renewal_excel_data_map);
										map_data.put("CD_"+coverName,"No");
								
								}else{
									if(((String) common.Renewal_excel_data_map.get("CD_"+coverName)).equalsIgnoreCase("Yes"))
										continue;
									else
										//TestUtil.WriteDataToXl(CommonFunction_VELA.product+"_"+CommonFunction_VELA.businessEvent, "CoverDetails",(String)map_data.get("Automation Key"), "CD_"+coverName, "Yes", common.Renewal_excel_data_map);
										map_data.put("CD_"+coverName,"Yes");
								}
						}
					}else if(c_locator.equals("cob_hcp")){
						String agency_Name = driver.findElement(By.xpath("html/body/div[3]/form/table/tbody/tr[2]/td[2]")).getText();
						if(agency_Name.equals("M722")){
							if (!driver.findElement(By.xpath("//*[contains(@name,'"+c_locator+"_selected')]")).isSelected()){
								JavascriptExecutor j_exe = (JavascriptExecutor) driver;
								j_exe.executeScript("arguments[0].scrollIntoView(true);", driver.findElement(By.xpath("//*[contains(@name,'"+c_locator+"_selected')]")));
								
									if(((String) common.Renewal_excel_data_map.get("CD_"+coverName)).equalsIgnoreCase("No"))
										continue;
									else
										//TestUtil.WriteDataToXl(CommonFunction_VELA.product+"_"+CommonFunction_VELA.businessEvent, "CoverDetails",(String)map_data.get("Automation Key"), "CD_"+coverName, "No", common.Renewal_excel_data_map);
										map_data.put("CD_"+coverName,"No");
								
								}else{
									if(((String) common.Renewal_excel_data_map.get("CD_"+coverName)).equalsIgnoreCase("Yes"))
										continue;
									else
										//TestUtil.WriteDataToXl(CommonFunction_VELA.product+"_"+CommonFunction_VELA.businessEvent, "CoverDetails",(String)map_data.get("Automation Key"), "CD_"+coverName, "Yes", common.Renewal_excel_data_map);
										map_data.put("CD_"+coverName,"Yes");
								}
						}else{
							//TestUtil.WriteDataToXl(CommonFunction_VELA.product+"_"+CommonFunction_VELA.businessEvent, "CoverDetails",(String)map_data.get("Automation Key"), "CD_"+coverName, "No", common.Renewal_excel_data_map);
							map_data.put("CD_"+coverName,"No");
						}
					}
					else{
						if (!driver.findElement(By.xpath("//*[contains(@name,'"+c_locator+"_selected')]")).isSelected()){
							JavascriptExecutor j_exe = (JavascriptExecutor) driver;
							j_exe.executeScript("arguments[0].scrollIntoView(true);", driver.findElement(By.xpath("//*[contains(@name,'"+c_locator+"_selected')]")));
							
								if(((String) common.Renewal_excel_data_map.get("CD_"+coverName)).equalsIgnoreCase("No"))
									continue;
								else
									//TestUtil.WriteDataToXl(CommonFunction_VELA.product+"_"+CommonFunction_VELA.businessEvent, "CoverDetails",(String)map_data.get("Automation Key"), "CD_"+coverName, "No", common.Renewal_excel_data_map);
									map_data.put("CD_"+coverName,"No");
							
							}else{
								if(((String) common.Renewal_excel_data_map.get("CD_"+coverName)).equalsIgnoreCase("Yes"))
									continue;
								else
									//TestUtil.WriteDataToXl(CommonFunction_VELA.product+"_"+CommonFunction_VELA.businessEvent, "CoverDetails",(String)map_data.get("Automation Key"), "CD_"+coverName, "Yes", common.Renewal_excel_data_map);
									map_data.put("CD_"+coverName,"Yes");
							}
					}	
					
				}catch(Throwable tt){
					System.out.println("Error while Updating Cover data for renewal - "+coverWithoutLocator);
					break;
				}
	 		}
 	 
	 	  return true;
		} catch (Exception e) {
			return false;
		}
	   
   }
   
   
   @SuppressWarnings("static-access")
	public boolean funcGetPremiums(Map<Object, Object> data_map){
	   
	   try{
		   double exp_Premium = 0.0;
		   String sectionName = "";
		   
		   customAssert.assertTrue(common.funcPageNavigation("Premium Summary", ""),"Premium Summary page is having issue(S)");
		   /*String flag = "false";
		   k.ImplicitWaitOff();
		   if(k.isDisplayed("CCF_AdjustmentInfo")){
			   flag = "true";
		   }*/
		   
		   String quoteNumber = k.getText("Quote_Number");
		   String startDate = k.getAttribute("Policy_Start_Date", "value");
		   String endDate = k.getAttribute("Policy_End_Date", "value");
		   String adminFee = k.getAttribute("PS_adminFee", "value");
		   
		   //TestUtil.WriteDataToXl(CommonFunction_VELA.product+"_"+CommonFunction_VELA.businessEvent, "Renewal",(String)common.Renewal_excel_data_map.get("Automation Key"), "Renewal_QuoteNumber", quoteNumber, common.Renewal_excel_data_map);
		   //TestUtil.WriteDataToXl(CommonFunction_VELA.product+"_"+CommonFunction_VELA.businessEvent, "Premium Summary",(String)common.Renewal_excel_data_map.get("Automation Key"), "PS_PolicyStartDate", startDate, common.Renewal_excel_data_map);
		   //TestUtil.WriteDataToXl(CommonFunction_VELA.product+"_"+CommonFunction_VELA.businessEvent, "QuoteCreation",(String)common.Renewal_excel_data_map.get("Automation Key"), "QC_InceptionDate", startDate, common.Renewal_excel_data_map);
		   //TestUtil.WriteDataToXl(CommonFunction_VELA.product+"_"+CommonFunction_VELA.businessEvent, "Premium Summary",(String)common.Renewal_excel_data_map.get("Automation Key"), "PS_PolicyEndDate", endDate , common.Renewal_excel_data_map);
		   //TestUtil.WriteDataToXl(CommonFunction_VELA.product+"_"+CommonFunction_VELA.businessEvent, "Premium Summary",(String)common.Renewal_excel_data_map.get("Automation Key"), "PS_AdminFee", adminFee , common.Renewal_excel_data_map);
		   //TestUtil.WriteDataToXl(CommonFunction_VELA.product+"_"+CommonFunction_VELA.businessEvent, "Premium Summary",(String)common.Renewal_excel_data_map.get("Automation Key"), "PS_TotalAdminFee", adminFee , common.Renewal_excel_data_map);
		   
		   data_map.put("Renewal_QuoteNumber",quoteNumber);
		   data_map.put("PS_PolicyStartDate",startDate);
		   data_map.put("QC_InceptionDate",startDate);
		   data_map.put("PS_PolicyEndDate",endDate);
		   data_map.put("PS_AdminFee",adminFee);
		   data_map.put("PS_TotalAdminFee",adminFee);
		   
		   final Map<String,String> locator_map = new HashMap<>();
		   locator_map.put("PenComm", "pencom");
		   locator_map.put("NetPremium", "nprem");
		   locator_map.put("NetNetPremium", "nnprem");
		   locator_map.put("BrokerComm", "comm");
		   locator_map.put("GrossPremium", "gprem");
		   locator_map.put("InsuranceTax", "gipt");
		   locator_map.put("IPTRate", "iptr");
			
		   final Map<String,String> section_map = new HashMap<>();
		   if(common.product.contains("XOC") ||common.product.contains("XOQ") )
			   section_map.put("Public&ProductsLiability", "pl");
		   else
			   section_map.put("Public&ProductsLiability", "pl_pr");
			
			section_map.put("EmployersLiability", "el");
			section_map.put("AnnualWorks", "acw");
			section_map.put("SingleProject", "pcw");
			section_map.put("OwnPlant", "op");
			section_map.put("HireCoverPlus", "hcp");
			section_map.put("HiredInPlant", "hp");
			section_map.put("JCT6.5.1", "jc");
			section_map.put("Terrorism", "ter");
			section_map.put("PropertyOwnersLiability", "po");
			section_map.put("LegalExpenses", "lea");
			section_map.put("Total", "tot");
			section_map.put("CombinedLiability","cl");
			section_map.put("ThirdPartyMotorLiability", "tp");

		   
		   String annualTble_xpath = "html/body/div[3]/form/div/table[2]";
		  // String policy_status_actual = k.getText("Policy_status_header");
		   int trans_tble_Rows = driver.findElements(By.xpath(annualTble_xpath+"/tbody/tr")).size();
		  
		   for(int i =1;i<=trans_tble_Rows-1;i++){
				String annualTblXpath2 = "/tbody/tr["+i+"]/td[1]";
				sectionName = driver.findElement(By.xpath(annualTble_xpath+annualTblXpath2)).getText().replaceAll(" ", "");
				if(sectionName.contains("AbbeyLegalExpenses")){
					sectionName = "LegalExpenses";}
				else if(sectionName.contains("Totals")){
					sectionName = "Total";
				}
				customAssert.assertTrue(funcGetPremiumValues(section_map.get(sectionName),sectionName,locator_map),"Issue while taking premium values from application to Map for : "+sectionName);
				exp_Premium = exp_Premium + Double.parseDouble((String)data_map.get("PS_"+sectionName+"_TotalPremium"));
			}
			
			double Total_GP = 00.00;
			double Total_GT = 00.00;
			double Total_NetNetPemium = 00.00,Total_PenComm = 00.00,Total_NetPremium=00.00 ,Total_BrokComm = 00.00 ;
			
			for(int i =1;i<=trans_tble_Rows-1;i++){
				String annualTblXpath2 = "/tbody/tr["+i+"]/td[1]";
				sectionName = driver.findElement(By.xpath(annualTble_xpath+annualTblXpath2)).getText().replaceAll(" ", "");
				if(sectionName.contains("AbbeyLegalExpenses")){
					sectionName = "LegalExpenses";}
				else if(sectionName.contains("Totals")){
					sectionName = "Total";
				}
				Total_GP = Total_GP + Double.parseDouble((String)data_map.get("PS_"+sectionName+"_GP"));
				Total_GT = Total_GT + Double.parseDouble((String)data_map.get("PS_"+sectionName+"_GT"));
				Total_NetNetPemium = Total_NetNetPemium + Double.parseDouble((String)data_map.get("PS_"+sectionName+"_NetNetPremium"));
				Total_PenComm = Total_PenComm + Double.parseDouble((String)data_map.get("PS_"+sectionName+"_PenComm"));
				Total_BrokComm = Total_BrokComm + Double.parseDouble((String)data_map.get("PS_"+sectionName+"_BrokerComm"));
				Total_NetPremium = Total_NetPremium + Double.parseDouble((String)data_map.get("PS_"+sectionName+"_NetPremium"));
			}
			
			data_map.put("PS_Total_GP",Double.toString(Total_GP));
			data_map.put("PS_Total_GT",Double.toString(Total_GT));
			data_map.put("PS_NetNetPemiumTotal",Double.toString(Total_NetNetPemium));
			data_map.put("PS_PenCommTotal",Double.toString(Total_PenComm));
			data_map.put("PS_BrokerCommissionTotal",Double.toString(Total_BrokComm));
			data_map.put("PS_NetPremiumTotal",Double.toString(Total_NetPremium));
			
			//System.out.println(data_map);
			
			
			return true;
		   
	   }catch(Exception e){
		   return false;
	   }
  }
   
   
   public boolean decideRENEWALFlow(Map<Object ,Object> map_data){
		 
		
		try {
			
			switch (CommonFunction_VELA.product) {
			case "COB":
				
				switch ((String)common.Renewal_excel_data_map.get("Renewal_Status")) {
				case "Endorsment On Cover":
					customAssert.assertTrue(common_COB.funcEndorsmentOnCoverOperation(map_data));
					break;
				case "Renewal On Cover":
					customAssert.assertTrue(common_COB.funcRenewalOnCoveOperation(map_data));
					break;
				case "Renewal NTU":
					customAssert.assertTrue(common_COB.funcRenewalNTUOperation(map_data));
					break;
				case "Renewal Declined":
					customAssert.assertTrue(common_COB.funcRenewalDeclinedOperation(map_data));
					break;
				case "Renewal Rewind":
					customAssert.assertTrue(common_COB.funcRenewalRewindOperation(map_data));
					break;
				
				}
				
				break;
			}
		} catch (Exception e) {
			return false;
		}
		
		return true;
		
	}
   
   
   public boolean funcAssignUnderWriter(String loginUser){
	   Boolean retvalue = false;
         try {               
        	    Assert.assertTrue(common.funcPageNavigation("Assign Underwriter",""), "Assign Underwriter Page does not open.");
                String tablexpath ="html/body/div[3]/form/div/table";
                WebElement table= driver.findElement(By.xpath(tablexpath));
        		//Get number of rows in table 
        		int numOfRow = table.findElements(By.tagName("tr")).size();
        	
        		//divided Xpath In three parts to pass Row_count and Col_count values.
        		String first_part = tablexpath+"/tbody/tr[";
        		String second_part = "]/td[";
        		String third_part = "]";
        		
        		for(int i=1;i<=numOfRow;i++){
        			
 				 String sName_path = first_part+i+second_part+"1"+third_part;	        				 
 			     String sName = driver.findElement(By.xpath(sName_path)).getText();	        			  
        			 if(loginUser.equalsIgnoreCase(sName)){
        				 retvalue=true;
        				 String sAssign_path = first_part+i+second_part+"4"+third_part+"/a";
        				 k.scrollInViewByXpath(sAssign_path);
        				 driver.findElement(By.xpath(sAssign_path)).click();	        				
        				 return retvalue;
        			 }
        		}
        		
        		if(retvalue = false){
        			TestUtil.reportStatus("Underwriter "+loginUser+" is not present", "Fail", true);
					return retvalue;
        		}
                return true;
         }catch(Throwable t) {
        	 return false;
         }
	}
   
   
   public boolean funcButtonVerification(String btnName){
       boolean retValue = true;
       
       	if (!(btnName=="")){
             if(btnName.equalsIgnoreCase("Save")){
                     TestUtil.reportStatus("Save button is present on page.","info",false);
                     k.isDisplayed("saveBtn");
              }else if(btnName.equalsIgnoreCase("Next")){
                     TestUtil.reportStatus("Next button is present on page.","info",false);
                     k.isDisplayed("nextBtn");
              }else if(btnName.equalsIgnoreCase("Back")){
          	 	TestUtil.reportStatus("Back button is present on page.","info",false);
          	 	k.isDisplayed("backBtn");
           }else if(btnName.equalsIgnoreCase("Quote")){
          	 	TestUtil.reportStatus("Quote button is present on page.","info",false);
          	 	k.isDisplayed("quoteBtn");
           }else if(btnName.equalsIgnoreCase("Assign Underwriter")){
                     TestUtil.reportStatus("Assign Underwriter button is present on page.", "info", false);
                     k.isDisplayed("assignUWBtn");
                     }
              else if(btnName.equalsIgnoreCase("Create Endorsement")){
                  TestUtil.reportStatus("Create Endorsement button is present on page.", "info", false);
                  k.isDisplayed("createEndor");
                  }
              else if(btnName.equalsIgnoreCase("Send to Underwriter")){
                  TestUtil.reportStatus("Send to Underwriter button is present on page.", "info", false);
                  k.isDisplayed("sendUWbtn");
              }
              else if(btnName.equalsIgnoreCase("Indication Accept")){
                  TestUtil.reportStatus("Indication Accept button is present on page.", "info", false);
                  k.isDisplayed("indicateAcceptBtn");
              }
              else if(btnName.equalsIgnoreCase("NTU")){
                  TestUtil.reportStatus("NTU button is present on page.", "info", false);
                  k.isDisplayed("ntuBtn");
              }else if(btnName.equalsIgnoreCase("Refer Details")){
                  TestUtil.reportStatus("Refer Details button is present on page.", "info", false);
                  k.isDisplayed("refer_detailsbtn");
              }else if(btnName.equalsIgnoreCase("Rewind")){
                  TestUtil.reportStatus("Rewind Button is present on page", "info", false);
                  k.isDisplayed("rewind_btn");
              }else if(btnName.equalsIgnoreCase("Cancel Policy")){
                  TestUtil.reportStatus("Cancel Policy Button is present on page", "info", false);
                  k.isDisplayed("cancelPolicy");
              }else if(btnName.equalsIgnoreCase("Documents")){
                  TestUtil.reportStatus("Documents Button is present on page", "info", false);
                  k.isDisplayed("docs_btn");
              } else if(btnName.equalsIgnoreCase("Excesses")){
                  TestUtil.reportStatus("Excesses Button is present on page", "info", false);
                  k.isDisplayed("excesses_btn");
              }else {
                     TestUtil.reportStatus("Unable to parse Button <b>"+btnName+"</b> name on page " ,"fail",true);
                     return false;
              }
       }
       return retValue;
     }
   
   
   public static boolean PremiumSummaryDataTraverse_Renewal(int rcount, Hashtable<String,String> coverlist,Hashtable<String,String> cHash,String code, String event,boolean xlWrite){
		
		try{
			common.GrosspremSmryData.clear();
			String[] prem_col = {"gprem","comr","comm","nprem","gipt","nipt"};
			String sec_name_withoutSpace = null;
			String CellValue;
			String testName = (String)common.Renewal_excel_data_map.get("Automation Key");
			Hashtable<String,String> premSmryData = new Hashtable<String,String>();
			
			TestUtil.reportStatus("Covers Found -:"+ (rcount-1), "info", true);
			String tXpath = "//*[@class='matrix']/tbody/tr";
			String Trax_table = "//p[text()=' Transaction Premium']//following-sibling::table[@id='table0']";
			String Trax_details_table = "//p[text()=' Transaction Details ']//following-sibling::table[@id='table0']";
			List<WebElement> ls = driver.findElements(By.xpath(Trax_table));
			List<WebElement> ls1 = driver.findElements(By.xpath(Trax_details_table));
			String policy_status_actual = "";
			 for(int i =1;i<=rcount;i++){
				 String sectionXpath = tXpath+"["+i+"]/td[1]";
				 String sec_name = driver.findElement(By.xpath(sectionXpath)).getText();
				
				if(sec_name.contains("Frozen Food")){
					sec_name_withoutSpace = "FrozenFoods";
				}else if(sec_name.contains("Licence")){
					sec_name_withoutSpace = "LossOfLicence";
				}else if(sec_name.contains("Total")){
					sec_name = "Total";
					sec_name_withoutSpace = "Total";
				}else{
					sec_name_withoutSpace = sec_name.replaceAll(" ", "");
				}
				
				policy_status_actual = k.getText("Policy_status_header");
				if(policy_status_actual.contains("Endorsement Submitted")){
						if(sec_name_withoutSpace.contains("Total")==false && xlWrite==true )
							//TestUtil.WriteDataToXl(code+"_"+event, "Premium Summary",(String)common.Renewal_excel_data_map.get("Automation Key"), "PS_"+sec_name_withoutSpace+"_IPT", TestUtil.getStringfromMap("PS_IPTRate",""), common.MTA_excel_data_map);
							
							//System.out.print(sec_name+"\t\t\t");
							TestUtil.reportStatus("---------------"+sec_name+"-----------------","Info",false);
							for(int j=0;j<prem_col.length;j++){
								String xpathVal;
								xpathVal = "//*[@id='"+coverlist.get(sec_name)+"_"+prem_col[j]+"']";
								 String keyName = "PS_"+sec_name_withoutSpace+"_"+cHash.get(prem_col[j]);
								
								if(coverlist.get(sec_name).equals("tot") && prem_col[j].equals("comm")){
									xpathVal = "//*[@id='"+coverlist.get(sec_name)+"_com']";
									CellValue = driver.findElement(By.xpath(xpathVal)).getAttribute("value").replaceAll(",","");;
									customAssert.assertTrue(WriteDataToXl(code+"_"+event, "Premium Summary", testName, keyName, CellValue,common.MTA_excel_data_map),"Error while writing Premium Summary data to excel ."+keyName);
								}
								if(coverlist.get(sec_name).equals("tot") && prem_col[j].equals("comr")){
									System.out.print(" ___ \t ");
								}else if(prem_col[j].equals("comr") && (coverlist.get(sec_name).equals("tot"))==false){
									if(xlWrite){
										k.scrollInViewByXpath(xpathVal);
										//driver.findElement(By.xpath(xpathVal)).click();
										//driver.findElement(By.xpath(xpathVal)).sendKeys(Keys.chord(Keys.CONTROL, "a"),TestUtil.getStringfromMap("PS_"+sec_name_withoutSpace+"_CR",""));
										//driver.findElement(By.xpath(xpathVal)).sendKeys(Keys.TAB);
									}
									CellValue = driver.findElement(By.xpath(xpathVal)).getAttribute("value").replaceAll(",","");;
									if(xlWrite){
										premSmryData.put("PS_"+sec_name_withoutSpace+"_"+cHash.get(prem_col[j]), CellValue);
										//customAssert.assertTrue(WriteDataToXl(code+"_"+event, "Premium Summary", testName, keyName, CellValue,common.NB_excel_data_map),"Error while writing Premium Summary data to excel ."+keyName);
									}else if(ls.size()==0) {
										compareValues(Double.parseDouble(TestUtil.getStringfromMap("PS_"+sec_name_withoutSpace+"_CR","")),Double.parseDouble(CellValue),cHash.get(prem_col[j]));
										premSmryData.put("PS_"+sec_name_withoutSpace+"_"+cHash.get(prem_col[j]), CellValue);
									}
									keyName = "PS_"+sec_name_withoutSpace+"_"+cHash.get(prem_col[j-1]);
									xpathVal = "//*[@id='"+coverlist.get(sec_name)+"_"+prem_col[j-1]+"']";
									CellValue = driver.findElement(By.xpath(xpathVal)).getAttribute("value").replaceAll(",","");;
									if(xlWrite){
										premSmryData.put("PS_"+sec_name_withoutSpace+"_"+cHash.get(prem_col[j-1]), CellValue);
										common.GrosspremSmryData.put("PS_"+sec_name_withoutSpace+"_"+cHash.get(prem_col[j-1]), CellValue);
										//customAssert.assertTrue(WriteDataToXl(code+"_"+event, "Premium Summary", testName, keyName, CellValue,common.NB_excel_data_map),"Error while writing Premium Summary data to excel ."+keyName);
									}	
								}else{
								    	CellValue = driver.findElement(By.xpath(xpathVal)).getAttribute("value").replaceAll(",","");
								    	if(xlWrite){
										premSmryData.put("PS_"+sec_name_withoutSpace+"_"+cHash.get(prem_col[j]), CellValue);
										//customAssert.assertTrue(WriteDataToXl(code+"_"+event, "Premium Summary", testName, keyName, CellValue,common.NB_excel_data_map),"Error while writing Premium Summary data to excel ."+keyName);
								    	}else if(ls.size()==0){
								    		
										compareValues(Double.parseDouble(TestUtil.getStringfromMap(keyName,"")),Double.parseDouble(CellValue),cHash.get(prem_col[j]));
										premSmryData.put("PS_"+sec_name_withoutSpace+"_"+cHash.get(prem_col[j]), CellValue);
								    	}
								    keyName=null;
								    }
							}
								//customAssert.assertTrue(WriteDataToXl(code+"_"+event, "Premium Summary", testName, "PS_Duration", customPolicyDuration,common.NB_excel_data_map),"Error while writing Policy Duration data to excel .");
							if(ls.size()==0){
								PremiumSummarytableCalculation_Renewal(premSmryData,sec_name_withoutSpace);
							}
					
				}else{
					if(sec_name_withoutSpace.contains("Total")==false && xlWrite==true )
						if(policy_status_actual.contains("Rewind")){
							//TestUtil.WriteDataToXl(code+"_"+event, "Premium Summary",(String)common.Renewal_excel_data_map.get("Automation Key"), "PS_"+sec_name_withoutSpace+"_IPT", TestUtil.getStringfromMap("PS_IPTRate",CommonFunction.businessEvent), common.Renewal_excel_data_map);
						}else{
							TestUtil.WriteDataToXl(code+"_"+event, "Premium Summary",(String)common.Renewal_excel_data_map.get("Automation Key"), "PS_"+sec_name_withoutSpace+"_IPT", TestUtil.getStringfromMap("PS_IPTRate",CommonFunction_VELA.businessEvent), common.Renewal_excel_data_map);
						}
						
						//System.out.print(sec_name+"\t\t\t");
						//TestUtil.reportStatus("---------------"+sec_name+"-----------------","Info",false);
						for(int j=0;j<prem_col.length;j++){
							String xpathVal;
							xpathVal = "//*[@id='"+coverlist.get(sec_name)+"_"+prem_col[j]+"']";
							String keyName = "PS_"+sec_name_withoutSpace+"_"+cHash.get(prem_col[j]);
							
							if(coverlist.get(sec_name).equals("tot") && prem_col[j].equals("comm")){
								xpathVal = "//*[@id='"+coverlist.get(sec_name)+"_com']";
								CellValue = driver.findElement(By.xpath(xpathVal)).getAttribute("value").replaceAll(",","");;
								customAssert.assertTrue(WriteDataToXl(code+"_"+event, "Premium Summary", testName, keyName, CellValue,common.Renewal_excel_data_map),"Error while writing Premium Summary data to excel ."+keyName);
							}
							if(coverlist.get(sec_name).equals("tot") && prem_col[j].equals("comr")){
								System.out.print(" ___ \t ");
							}else if(prem_col[j].equals("comr") && (coverlist.get(sec_name).equals("tot"))==false){
								if(xlWrite){
									k.scrollInViewByXpath(xpathVal);
									driver.findElement(By.xpath(xpathVal)).click();
									driver.findElement(By.xpath(xpathVal)).sendKeys(Keys.chord(Keys.CONTROL, "a"),TestUtil.getStringfromMap("PS_"+sec_name_withoutSpace+"_CR",CommonFunction_VELA.businessEvent));
									driver.findElement(By.xpath(xpathVal)).sendKeys(Keys.TAB);
								}
								CellValue = driver.findElement(By.xpath(xpathVal)).getAttribute("value").replaceAll(",","");;
								if(xlWrite){
									premSmryData.put("PS_"+sec_name_withoutSpace+"_"+cHash.get(prem_col[j]), CellValue);
									//customAssert.assertTrue(WriteDataToXl(code+"_"+event, "Premium Summary", testName, keyName, CellValue,common.NB_excel_data_map),"Error while writing Premium Summary data to excel ."+keyName);
								}else if(ls.size()==0) {
									compareValues(Double.parseDouble(TestUtil.getStringfromMap("PS_"+sec_name_withoutSpace+"_CR",CommonFunction_VELA.businessEvent)),Double.parseDouble(CellValue),cHash.get(prem_col[j]));
									premSmryData.put("PS_"+sec_name_withoutSpace+"_"+cHash.get(prem_col[j]), CellValue);
								}
								keyName = "PS_"+sec_name_withoutSpace+"_"+cHash.get(prem_col[j-1]);
								xpathVal = "//*[@id='"+coverlist.get(sec_name)+"_"+prem_col[j-1]+"']";
								CellValue = driver.findElement(By.xpath(xpathVal)).getAttribute("value").replaceAll(",","");;
								if(xlWrite){
									premSmryData.put("PS_"+sec_name_withoutSpace+"_"+cHash.get(prem_col[j-1]), CellValue);
									common.GrosspremSmryData.put("PS_"+sec_name_withoutSpace+"_"+cHash.get(prem_col[j-1]), CellValue);
									//customAssert.assertTrue(WriteDataToXl(code+"_"+event, "Premium Summary", testName, keyName, CellValue,common.NB_excel_data_map),"Error while writing Premium Summary data to excel ."+keyName);
								}	
							}else{
							    	CellValue = driver.findElement(By.xpath(xpathVal)).getAttribute("value").replaceAll(",","");
							    	if(xlWrite){
									premSmryData.put("PS_"+sec_name_withoutSpace+"_"+cHash.get(prem_col[j]), CellValue);
									//customAssert.assertTrue(WriteDataToXl(code+"_"+event, "Premium Summary", testName, keyName, CellValue,common.NB_excel_data_map),"Error while writing Premium Summary data to excel ."+keyName);
							    	}else if(ls.size()==0){
							    		
									compareValues(Double.parseDouble(TestUtil.getStringfromMap(keyName,CommonFunction_VELA.businessEvent)),Double.parseDouble(CellValue),cHash.get(prem_col[j]));
									premSmryData.put("PS_"+sec_name_withoutSpace+"_"+cHash.get(prem_col[j]), CellValue);
							    	}
							    keyName=null;
							    }
						}
							//customAssert.assertTrue(WriteDataToXl(code+"_"+event, "Premium Summary", testName, "PS_Duration", customPolicyDuration,common.NB_excel_data_map),"Error while writing Policy Duration data to excel .");
						if(policy_status_actual.contains("Rewind")){
							if(ls.size()==0){
								PremiumSummarytableCalculation_Renewal(premSmryData,sec_name_withoutSpace);}
						}
						
				}
			}
				
				
			 customAssert.assertTrue(k.Click("CCF_Btn_Save"), "Unable to click on Save Button on Premium Summary .");
			 
			 
			 if(ls.size()>0){ 
				 TransactionPremiumTable_Renewal(rcount,coverlist,cHash,code,event,xlWrite);
			 }
			 else if(ls1.size()>0){
				 TransactionDetailsTable(cHash,code,event,xlWrite);
			 }
			 else if(xlWrite){	 
				 Set<String> pKeys=premSmryData.keySet();
				 	for(String pkey:pKeys){
				 		customAssert.assertTrue(WriteDataToXl(code+"_"+event, "Premium Summary", testName,pkey,premSmryData.get(pkey) ,common.Renewal_excel_data_map),"Error while writing Premium Summary data to excel ."+pkey) ;
				 	}
			 }
			
			 return true;
		}catch(Throwable t){
				k.ImplicitWaitOn();
				return false;
		}
	  
	 }
   
   public static void TransactionPremiumTable_Renewal(int rcount, Hashtable<String,String> coverlist,Hashtable<String,String> cHash,String code, String event, boolean xlWrite){
		//Transaction Premium Table
			try{
				k.ImplicitWaitOff();
				String Trax_table = "html/body/div[3]/form/div/table[4]";
				String[] prem_col = {"gprem","comr","comm","nprem","gipt","nipt"};
				String testName = (String)common.Renewal_excel_data_map.get("Automation Key");
				List<WebElement> col=driver.findElements(By.xpath("html/body/div[3]/form/div/table[4]/tbody/tr[1]/td"));
				//System.out.println(col.size());
				int cCount = col.size();
				if(driver.findElement(By.xpath(Trax_table)).isDisplayed()){
					
					Hashtable<String,String> transSmryData = new Hashtable<String,String>();
					String tXpath =Trax_table+"/tbody/tr";
					String CellValue;
					//System.out.println("Transaction Premium Table exist on premium summary page");
					TestUtil.reportStatus("Transaction Premium Table exist on premium summary page", "Info", true);
					//System.out.println("Covers Found -:"+ (rcount-1));
					TestUtil.reportStatus("Covers Found -:"+ (rcount-1), "Info", false);
					
					for(int i =1;i<=rcount;i++){
						String sectionXpath = tXpath+"["+i+"]/td[1]";
						String sec_name = driver.findElement(By.xpath(sectionXpath)).getText();
						//System.out.print(sec_name+"\t\t\t");
						if(sec_name.contains("Frozen Food")){
							sec_name = "FrozenFoods";
						}else if(sec_name.contains("Licence")){
							sec_name = "LossOfLicence";
						}else if(sec_name.contains("Total")){
							sec_name = "Total";
							sec_name = "Total";
						}else{
							sec_name = sec_name.replaceAll(" ", "");
						}
						
						TestUtil.reportStatus("---------------"+sec_name+"-----------------","Info",false);
						
						for(int j = 2; j<=cCount;j++){
							//transSmryData
							String ColumnValues = tXpath+"["+i+"]/td["+j+"]";
							CellValue = driver.findElement(By.xpath(ColumnValues)).getText().replaceAll(",","");;
							//System.out.print(CellValue +  "\t");	
							//TestUtil.reportStatus(CellValue +  "\t", "Info", false);
							if(cHash.get(prem_col[j-2]).equalsIgnoreCase("CR") && sec_name.contains("Total"))
							{}else{
							transSmryData.put("PS_"+sec_name.replaceAll(" ", "")+"_"+cHash.get(prem_col[j-2]), CellValue);}
						}
						PremiumSummarytableCalculation(transSmryData,sec_name);
						//System.out.println("\n___");
					}
				
				// Writing Data to Excel Sheet from Map
					Set<String> pKeys=transSmryData.keySet();
				 	for(String pkey:pKeys){
				 		if(xlWrite){
				 			customAssert.assertTrue(WriteDataToXl(code+"_"+event, "Premium Summary", testName,pkey,transSmryData.get(pkey) ,common.Renewal_excel_data_map),"Error while writing Premium Summary data to excel ."+pkey) ;
				 		}else{
				 			compareValues(Double.parseDouble(transSmryData.get(pkey)), Double.parseDouble(TestUtil.getStringfromMap(transSmryData.get(pkey),CommonFunction_VELA.businessEvent)), pkey);
				 		}
				 	}
				}
			}
			catch(Throwable t ){
				k.ImplicitWaitOn();
				System.out.println("--"); 
			}
			
			//System.out.println("Gross Premium for Material Damage Cover in Transaction Premium table is :"+transSmryData.get("MaterialDamage_gprem"));
			 TestUtil.reportStatus("Values have been stored from Transaction Premium table", "info", true);
	}
  
 
 
  public boolean funcPremiumSummary_Renewal(Map<Object, Object> map_data,String code,String event,String flowName){
		
		boolean r_value= true;
		String testName = (String)map_data.get("Automation Key");
		String customPolicyDuration=null;
		
		try{
			customAssert.assertTrue(common.funcPageNavigation("Premium Summary", ""),"Premium Summary page navigations issue(S)");
			
			customAssert.assertTrue(k.SelectRadioBtn("Payment_Warranty_rules", (String)map_data.get("PS_PaymentWarrantyRules")),"Unable to Select Payment_Warranty_rules radio button . ");
			
			if(((String)map_data.get("PS_PaymentWarrantyRules")).equals("Yes")){
				
				customAssert.assertTrue(k.Click("Payment_Warranty_Due_Date"), "Unable to Click Payment_Warranty_Due_Date date picker .");
				customAssert.assertTrue(k.Input("Payment_Warranty_Due_Date", (String)map_data.get("PS_PaymentWarrantyDueDate")),"Unable to Enter Payment_Warranty_Due_Date .");
				customAssert.assertTrue(k.Click("calander_btn"), "Unable to click on done button in calander.");
			}
			customAssert.assertTrue(k.Click("CCF_Btn_Save"), "Unable to click on Save Button on Premium Summary .");
			customAssert.assertTrue(common.funcPremiumSummaryTable_Renewal(code, event, map_data),"Premium summary Calculation function failed");		
			customAssert.assertTrue(k.Click("CCF_Btn_Save"), "Unable to click on Save Button on Premium Summary .");
			customPolicyDuration = k.getText("Policy_Duration");
			customAssert.assertTrue(WriteDataToXl(code+"_"+event, "Premium Summary", testName, "PS_Duration", customPolicyDuration,map_data),"Error while writing Policy Duration data to excel .");
			TestUtil.reportStatus("Policy Duration = "+customPolicyDuration+" Days . ", "Info", true);
			
			TestUtil.reportStatus("Premium Summary details are filled sucessfully . ", "Info", true);
			
		}catch(Throwable t){
			return false;
		}
	
	return r_value;
	}
  
  public boolean funcPremiumSummaryTable_Renewal(String code,String event,Map<Object, Object> map_data) throws Exception{
		
		String testName = (String)map_data.get("Automation Key");
		WebDriverWait wait;
		wait = new WebDriverWait(driver, 5);
		Hashtable<String,String> coverlist = new Hashtable<String,String>();
		Hashtable<String,String> premSmryData = new Hashtable<String,String>();
		Hashtable<String,String> transSmryData = new Hashtable<String,String>();
		Hashtable<String,String> cHash = new Hashtable<String,String>();
		boolean transPremFlag =false;
		String[] prem_col = {"gprem","comr","comm","nprem","gipt","nipt"};
		String[] prem_header = {"GrossPremium","CommissionRate","Commission","NetPremium","GrossIPT","NetIPT"};
		//System.out.println(prem_col(0));
		if(CommonFunction_VELA.product.equalsIgnoreCase("POB")|| CommonFunction_VELA.product.equalsIgnoreCase("POC")){
			coverlist.put("Material Damage","md8");
			coverlist.put("Loss Of Rental Income","bi3");
			coverlist.put("Property Owners Liability","pl3");
			coverlist.put("Terrorism","tr3");
		}else if(CommonFunction_VELA.product.equalsIgnoreCase("XOE")){
			coverlist.put("Property Excess of Loss","xo1");
			coverlist.put("Terrorism","tr2");
		}else{
			coverlist.put("Material Damage","md7");
			coverlist.put("Business Interruption","bi2");
			coverlist.put("Terrorism","tr2");
		}
		coverlist.put("Employers Liability","el3");
		coverlist.put("Public Liability","pl2");
		coverlist.put("Products Liability","pr1");
		coverlist.put("Specified All Risks","sar");
		coverlist.put("Contractors All Risks","car");
		coverlist.put("Computers and Electronic Risks","it");
		coverlist.put("Money","mn2");
		coverlist.put("Goods In Transit","gt2");
		coverlist.put("Marine Cargo","mar");
		coverlist.put("Cyber and Data Security","cyb");
		if(code.equalsIgnoreCase("CTA")){
			coverlist.put("Directors and Officers","do_pct");
		}else{
			coverlist.put("Directors and Officers","do2");
			}
		coverlist.put("Frozen Foods","ff2");
		coverlist.put("Loss of Licence","ll2");
		coverlist.put("Fidelity Guarantee","fg");
		coverlist.put("Legal Expenses","lg2");
		coverlist.put("Total","tot");
		
		cHash.put("gprem","GP");
		cHash.put("comr","CR");
		cHash.put("comm","GC");
		cHash.put("nprem","NP");
		cHash.put("gipt","GT");
		cHash.put("nipt","NPIPT");
		cHash.put("com","GC");
		
		if (driver.findElement(By.xpath("//*[@id='main']/form/p")).getText().contains("Premium Summary")==false){
			Assert.fail("Premium summary Page couldn't displayed");
		}
		String stDate = null;
		String endDate =null;
		try{
			k.ImplicitWaitOff();
			stDate = driver.findElement(By.xpath("//*[@name='start_date']")).getAttribute("value");
		}catch(Exception e){
			stDate = driver.findElement(By.xpath("//*[@id='start_date']")).getText() ;//getAttribute("value");
		}
		try{
			k.ImplicitWaitOff();
			endDate = driver.findElement(By.xpath("//*[@name='end_date']")).getAttribute("value");
		}catch(Exception e){
			 endDate = driver.findElement(By.xpath("//*[@id='end_date']")).getText() ;//.getAttribute("value");
		}
		String duration = driver.findElement(By.xpath("//*[@id='duration']")).getText();
		List<WebElement> col=driver.findElements(By.xpath("html/body/div[3]/form/div/table[2]/tbody/tr[1]/td"));
		int cCount = col.size();
		
		List<WebElement> row = driver.findElements(By.xpath("html/body/div[3]/form/div/table[2]/tbody/tr"));
		//System.out.println(row.size());
		int rcount = row.size();
		String Status = driver.findElement(By.xpath("//*[@id='headbox']/tbody/tr[1]/td[6]")).getText();
		//System.out.println("Policy Status - "+ Status); 
		TestUtil.reportStatus("Current Policy Status - "+ Status, "Info", false);
		switch(Status){
		
		case "Endorsement Submitted":  		
			customAssert.assertTrue(PremiumSummaryDataTraverse_Renewal(rcount,coverlist,cHash,code,event,true),"Failed in Premium Summary Calculation");
			customAssert.assertTrue(common.insuranceTaxAdjustmentHandling_RenewalEndorsment(code,event),"Insurance tax adjustment is having issue(S).");
			TestUtil.reportStatus("Premium Summary data verification after Insurance Tax Adjustment", "Info", true);
			customAssert.assertTrue(PremiumSummaryDataTraverse_Renewal(rcount,coverlist,cHash,code,event,false),"Failed in Premium Summary Calculation after Insurance adjustment");
			break;	
		case "Renewal Submitted (Rewind)":  		
			customAssert.assertTrue(PremiumSummaryDataTraverse_Renewal(rcount,coverlist,cHash,code,event,true),"Failed in Premium Summary Calculation");
			customAssert.assertTrue(common.insuranceTaxAdjustmentHandling_RenewalEndorsment(code,event),"Insurance tax adjustment is having issue(S).");
			TestUtil.reportStatus("Premium Summary data verification after Insurance Tax Adjustment", "Info", true);
			customAssert.assertTrue(PremiumSummaryDataTraverse_Renewal(rcount,coverlist,cHash,code,event,false),"Failed in Premium Summary Calculation after Insurance adjustment");
			break;	
		}
		
		
		double FinalPremium = 0.0 , Total_GrossPremium , Total_GrossTax , calcFinalPremium = 0.0;
		switch (common.currentRunningFlow) {
		case "NB":
			FinalPremium =Double.parseDouble(k.getTextByXpath("//*[@class='gttext']").replaceAll(",",""));
			Total_GrossPremium =Double.parseDouble(TestUtil.getStringfromMap("PS_Total_GP",""));// premSmryData.get("PS_Total_GP"));
			Total_GrossTax=Double.parseDouble(TestUtil.getStringfromMap("PS_Total_GT",""));// premSmryData.get("PS_Total_GT"));
			calcFinalPremium = Total_GrossPremium +Total_GrossTax;
			break;
		case "CAN":
			FinalPremium =Double.parseDouble(k.getTextByXpath("//*[@class='gttext']").replaceAll(",",""));
			Total_GrossPremium =Double.parseDouble(TestUtil.getStringfromMap("PS_Total_GP",""));// premSmryData.get("PS_Total_GP"));
			Total_GrossTax=Double.parseDouble(TestUtil.getStringfromMap("PS_Total_GT",""));// premSmryData.get("PS_Total_GT"));
			calcFinalPremium = Total_GrossPremium +Total_GrossTax;
			break;
		case "MTA":
			FinalPremium =Double.parseDouble(k.getTextByXpath("//*[@class='gttext']").replaceAll(",",""));
			Total_GrossPremium =Double.parseDouble(TestUtil.getStringfromMap("PS_Total_GP",""));// premSmryData.get("PS_Total_GP"));
			Total_GrossTax=Double.parseDouble(TestUtil.getStringfromMap("PS_Total_GT",""));// premSmryData.get("PS_Total_GT"));
			calcFinalPremium = Total_GrossPremium +Total_GrossTax;
			break;
		case "Renewal":
			FinalPremium =Double.parseDouble(k.getTextByXpath("//*[@class='gttext']").replaceAll(",",""));
			Total_GrossPremium =Double.parseDouble(TestUtil.getStringfromMap("PS_Total_GP",CommonFunction_VELA.businessEvent));// premSmryData.get("PS_Total_GP"));
			Total_GrossTax=Double.parseDouble(TestUtil.getStringfromMap("PS_Total_GT",CommonFunction_VELA.businessEvent));// premSmryData.get("PS_Total_GT"));
			calcFinalPremium = Total_GrossPremium +Total_GrossTax;
			break;
		
		default:
			break;
		}
		
		compareValues(calcFinalPremium,FinalPremium,"Policy Premium ");
		TestUtil.reportStatus("Final Policy Premium  :<b>"+calcFinalPremium, "Info", false);

		k.ImplicitWaitOn();
		return true;
		
	}
  
  @SuppressWarnings("static-access")
	public boolean insuranceTaxAdjustmentHandling_RenewalEndorsment(String code , String event){
	 	Map<Object, Object> map_to_update=common.Renewal_excel_data_map;
		try {
			
			common.funcButtonSelection("Insurance Tax");
			customAssert.assertTrue(funcPageNavigation("Tax Adjustment", ""),"Unable to land on Tax adjustment screen.");
			String sectionName;
			
			//customAssert.assertTrue(verifyCoverDetails(),"PremiumValue verification is causing issue(S).");
			//customAssert.assertTrue(verifyGrossPremiumValues(),"PremiumValue verification is causing issue(S).");
			String policy_status_actual = k.getText("Policy_status_header");
			
			switch ((String)map_to_update.get("PS_InsuranceTaxButton")) {
			case "Yes":
				String value = null;
				List<WebElement> list = k.findElements("insuranceTaxExemptionRadioButton");
				for(int i=0;i<list.size();i++){
					
					boolean selectedStatus =  list.get(i).isSelected();
					if(selectedStatus){
						value = list.get(i).getAttribute("Value");	
					}
				}
				
				if(CommonFunction_VELA.product.equalsIgnoreCase("XOE")){
					if(value.equalsIgnoreCase("No")){
						customAssert.assertTrue(k.SelectRadioBtn("insuranceTaxExemptionRadioButton", (String)map_to_update.get("PS_InsuranceTaxButton")));
						k.waitTwoSeconds();
						customAssert.assertTrue(k.AcceptPopup(), "Unable to accept alert box.");
					}
				}else{
					if(((String)map_to_update.get("PD_TaxExempt")).equalsIgnoreCase("No") && value.equalsIgnoreCase("No")){
						customAssert.assertTrue(k.SelectRadioBtn("insuranceTaxExemptionRadioButton", (String)map_to_update.get("PS_InsuranceTaxButton")));
						k.waitTwoSeconds();
						customAssert.assertTrue(k.AcceptPopup(), "Unable to accept alert box.");
					}
				}
				
				taxTable_tBody = k.getObject("inssuranceTaxMainTableBODY"); 
				List<WebElement> listOfCovers = taxTable_tBody.findElements(By.tagName("tr"));
				countOfCovers = listOfCovers.size();
				
				for(int j=0;j<countOfCovers-1;j++){
					
					sectionName = taxTable_tBody.findElement(By.xpath("tr["+(j+1)+"]/td[1]")).getText().replaceAll(" ", "");
					if(sectionName.contains("ExcessofLoss")){
						sectionName = "PropertyExcessofLoss";
					}
					TestUtil.WriteDataToXl(code+"_"+event, "Premium Summary",(String)map_to_update.get("Automation Key"), "PS_"+sectionName+"_GT", common.roundedOff("00.00"), map_to_update);
					TestUtil.WriteDataToXl(code+"_"+event, "Premium Summary",(String)map_to_update.get("Automation Key"), "PS_"+sectionName+"_IPT", common.roundedOff("00.00"), map_to_update);
					TestUtil.WriteDataToXl(code+"_"+event, "Premium Summary",(String)map_to_update.get("Automation Key"), "PS_"+sectionName+"_NPIPT", common.roundedOff("00.00"), map_to_update);
					totalGrossPremium = totalGrossPremium + Double.parseDouble(common.roundedOff((String)map_to_update.get("PS_"+sectionName+"_GP")));
				}
				
				if(policy_status_actual.contains("Endorsment Submitted")){
					common.totalGrossPremium = 0.0;
					common.totalGrossTax = 0.0;
					common.totalNetPremiumTax = 0.0;
					
					for(int j=0;j<countOfCovers-1;j++){
						
						taxTable_tBody = k.getObject("inssuranceTaxMainTableBODY");
						sectionName = taxTable_tBody.findElement(By.xpath("tr["+(j+1)+"]/td[1]")).getText();
						if(sectionName.contains("Excess of Loss")){
							sectionName = "Property Excess of Loss";
						}
						
						if(sectionName.equalsIgnoreCase("") || sectionName==null || sectionName.equalsIgnoreCase("Totals")){
							continue;
						}else{
							
							String expGP = (String)map_to_update.get("PS_"+sectionName.replaceAll(" ", "")+"_GP");
							String expGT = (String)map_to_update.get("PS_"+sectionName.replaceAll(" ", "")+"_GT");
							String expNPIT = (String)map_to_update.get("PS_"+sectionName.replaceAll(" ", "")+"_NPIPT");
							
							common.totalGrossPremium = common.totalGrossPremium + Double.parseDouble(expGP);
							common.totalGrossTax = common.totalGrossTax + Double.parseDouble(expGT);
							common.totalNetPremiumTax = common.totalNetPremiumTax + Double.parseDouble(expNPIT);
							
						}
						taxTable_tBody = k.getObject("inssuranceTaxMainTableBODY");
						List<WebElement> list3 = taxTable_tBody.findElements(By.tagName("tr"));
						countOfCovers = list3.size();
					}
				}
				if(policy_status_actual.contains("Rewind")){
					common.totalGrossPremium = 0.0;
					common.totalGrossTax = 0.0;
					common.totalNetPremiumTax = 0.0;
					
					for(int j=0;j<countOfCovers-1;j++){
						
						taxTable_tBody = k.getObject("inssuranceTaxMainTableBODY");
						sectionName = taxTable_tBody.findElement(By.xpath("tr["+(j+1)+"]/td[1]")).getText();
						if(sectionName.contains("Excess of Loss")){
							sectionName = "Property Excess of Loss";
						}
						
						if(sectionName.equalsIgnoreCase("") || sectionName==null || sectionName.equalsIgnoreCase("Totals")){
							continue;
						}else{
							
							/*String actGP =  taxTable_tBody.findElement(By.xpath("tr["+(j+1)+"]/td[2]")).getText();
							String actGT =  taxTable_tBody.findElement(By.xpath("tr["+(j+1)+"]/td[5]")).getText();
							*/
							String expGP = (String)map_to_update.get("PS_"+sectionName.replaceAll(" ", "")+"_GP");
							String expGT = (String)map_to_update.get("PS_"+sectionName.replaceAll(" ", "")+"_GT");
							String expNPIT = (String)map_to_update.get("PS_"+sectionName.replaceAll(" ", "")+"_NPIPT");
							
							common.totalGrossPremium = common.totalGrossPremium + Double.parseDouble(expGP);
							common.totalGrossTax = common.totalGrossTax + Double.parseDouble(expGT);
							common.totalNetPremiumTax = common.totalNetPremiumTax + Double.parseDouble(expNPIT);
							
						}
						taxTable_tBody = k.getObject("inssuranceTaxMainTableBODY");
						List<WebElement> list3 = taxTable_tBody.findElements(By.tagName("tr"));
						countOfCovers = list3.size();
					}
				}
				TestUtil.reportStatus("<b> Tax adjustment operatios is completed. </b>", "Info", false);
				
				TestUtil.WriteDataToXl(code+"_"+event, "Premium Summary",(String)map_to_update.get("Automation Key"), "PS_Total_GP", common.roundedOff(Double.toString(totalGrossPremium)), map_to_update);
				TestUtil.WriteDataToXl(code+"_"+event, "Premium Summary",(String)map_to_update.get("Automation Key"), "PS_Total_GT", common.roundedOff("00.00"), map_to_update);
				TestUtil.WriteDataToXl(code+"_"+event, "Premium Summary",(String)map_to_update.get("Automation Key"), "PS_Total_NPIPT", common.roundedOff("00.00"), map_to_update);
				TestUtil.reportStatus("<b>Policy Exempt from insurance tax radio button is selected as 'Yes' Hence skipped adjustment operation for all covers.</b>", "Info", false);
				break;
				
			case "No":
				
				TestUtil.reportStatus("<b> Tax adjustment operatios is started. </b>", "Info", false);
				customAssert.assertTrue(k.SelectRadioBtn("insuranceTaxExemptionRadioButton", (String)common.Renewal_excel_data_map.get("PS_InsuranceTaxButton")));
				//taxTable_tHead = k.getObject("inssuranceTaxMainTableHEAD");
				taxTable_tBody = k.getObject("inssuranceTaxMainTableBODY"); 
				List<WebElement> list2 = taxTable_tBody.findElements(By.tagName("tr"));
				countOfCovers = list2.size();
				
				
				for(int j=0;j<countOfCovers-1;j++){
					
					taxTable_tBody = k.getObject("inssuranceTaxMainTableBODY");
					sectionName = taxTable_tBody.findElement(By.xpath("tr["+(j+1)+"]/td[1]")).getText();
					if(sectionName.contains("Excess of Loss")){
						sectionName = "Property Excess of Loss";
					}
					
					String grossPremium =  taxTable_tBody.findElement(By.xpath("tr["+(j+1)+"]/td[2]")).getText();
					//String iptRate =  taxTable_tBody.findElement(By.xpath("tr["+(j+1)+"]/td[4]")).getText();
					//String grossTax =  taxTable_tBody.findElement(By.xpath("tr["+(j+1)+"]/td[5]")).getText();
					
					if(sectionName.equalsIgnoreCase("") || sectionName==null || sectionName.equalsIgnoreCase("Totals")){
						continue;
					}else{
						
						customAssert.assertTrue(adjustInsuranceTax_Renewal(grossPremium,sectionName,code,event),"Adjust insurance Tax function is causing issue(S).");
						customAssert.assertTrue(verifyAdjustedTaxValues_Renewal(sectionName,code,event),"Verify adjusted Tax function is having issue(S).");
					}
						
					taxTable_tBody = k.getObject("inssuranceTaxMainTableBODY");
					List<WebElement> list3 = taxTable_tBody.findElements(By.tagName("tr"));
					countOfCovers = list3.size();
				}
				if(policy_status_actual.contains("Endorsement Submitted")){
					common.totalGrossPremiumMTA = 0.0;
					common.totalGrossTaxMTA = 0.0;
					common.totalNetPremiumTaxMTA = 0.0;
					
					for(int j=0;j<countOfCovers-1;j++){
						
						taxTable_tBody = k.getObject("inssuranceTaxMainTableBODY");
						sectionName = taxTable_tBody.findElement(By.xpath("tr["+(j+1)+"]/td[1]")).getText();
						if(sectionName.contains("Excess of Loss")){
							sectionName = "Property Excess of Loss";
						}
						
						if(sectionName.equalsIgnoreCase("") || sectionName==null || sectionName.equalsIgnoreCase("Totals")){
							continue;
						}else{
							
							String expGP = (String)map_to_update.get("PS_"+sectionName.replaceAll(" ", "")+"_GP");
							String expGT = (String)map_to_update.get("PS_"+sectionName.replaceAll(" ", "")+"_GT");
							String expNPIT = (String)map_to_update.get("PS_"+sectionName.replaceAll(" ", "")+"_NPIPT");
							
							common.totalGrossPremiumMTA = common.totalGrossPremiumMTA + Double.parseDouble(expGP);
							common.totalGrossTaxMTA = common.totalGrossTaxMTA + Double.parseDouble(expGT);
							common.totalNetPremiumTaxMTA = common.totalNetPremiumTaxMTA + Double.parseDouble(expNPIT);
							
						}
						taxTable_tBody = k.getObject("inssuranceTaxMainTableBODY");
						List<WebElement> list3 = taxTable_tBody.findElements(By.tagName("tr"));
						countOfCovers = list3.size();
					}
				}
				if(policy_status_actual.contains("Rewind")){
					common.totalGrossPremium = 0.0;
					common.totalGrossTax = 0.0;
					common.totalNetPremiumTax = 0.0;
					
					for(int j=0;j<countOfCovers-1;j++){
						
						taxTable_tBody = k.getObject("inssuranceTaxMainTableBODY");
						sectionName = taxTable_tBody.findElement(By.xpath("tr["+(j+1)+"]/td[1]")).getText();
						if(sectionName.contains("Excess of Loss")){
							sectionName = "Property Excess of Loss";
						}
						
						if(sectionName.equalsIgnoreCase("") || sectionName==null || sectionName.equalsIgnoreCase("Totals")){
							continue;
						}else{
							
							String expGP = (String)common.Renewal_excel_data_map.get("PS_"+sectionName.replaceAll(" ", "")+"_GP");
							String expGT = (String)common.Renewal_excel_data_map.get("PS_"+sectionName.replaceAll(" ", "")+"_GT");
							String expNPIT = (String)common.Renewal_excel_data_map.get("PS_"+sectionName.replaceAll(" ", "")+"_NPIPT");
							
							common.totalGrossPremium = common.totalGrossPremium + Double.parseDouble(expGP);
							common.totalGrossTax = common.totalGrossTax + Double.parseDouble(expGT);
							common.totalNetPremiumTax = common.totalNetPremiumTax + Double.parseDouble(expNPIT);
							
						}
						taxTable_tBody = k.getObject("inssuranceTaxMainTableBODY");
						List<WebElement> list3 = taxTable_tBody.findElements(By.tagName("tr"));
						countOfCovers = list3.size();
					}
				}
				TestUtil.reportStatus("<b> Tax adjustment operatios is completed. </b>", "Info", false);
				TestUtil.WriteDataToXl(code+"_"+event, "Premium Summary",(String)map_to_update.get("Automation Key"), "PS_Total_GP", common.roundedOff(Double.toString(totalGrossPremium)), map_to_update);
				TestUtil.WriteDataToXl(code+"_"+event, "Premium Summary",(String)map_to_update.get("Automation Key"), "PS_Total_GT", common.roundedOff(Double.toString(totalGrossTax)), map_to_update);
				TestUtil.WriteDataToXl(code+"_"+event, "Premium Summary",(String)map_to_update.get("Automation Key"), "PS_Total_NPIPT", common.roundedOff(Double.toString(totalNetPremiumTax)), map_to_update);
			
				break;
			default:
				break;
			}
			
			common.funcPageNavigation("", "Save");
			k.Click("Tax_adj_BackBtn");
				
			return true;
		}catch (Throwable t) {
			k.ImplicitWaitOn();
			return false;
		}
	}
	
  @SuppressWarnings("static-access")
	public static boolean adjustInsuranceTax_Renewal(String grossPremium,String sectionName,String code,String event){
		try{
			variableTaxAdjustmentDataMaps = new LinkedHashMap<>();
			variableTaxAdjustmentVerificationMaps = new LinkedHashMap<>();
			variableTaxAdjustmentIDs = new HashMap<>();
			grossTaxValues_Map = new HashMap<>();
			headerNameStorage = new ArrayList<>();
			inputarraylist = new ArrayList<>();
			inputarraylistMTA = new ArrayList<>();
			Adjusted_Premium_map = new HashMap<>();
			
			adjustedPremium = Double.parseDouble(common.roundedOff((String)common.GrosspremSmryData.get("PS_"+sectionName.replaceAll(" ", "")+"_GP")));
			if(sectionName.contains("Property Excess of Loss")){
				sectionName = "Excess of Loss";
			}
			
			int count = common.no_of_inner_data_sets.get("Variable Tax Adjustment");
					
			int counter = 0;
			String coverName = sectionName;
			String policy_status_actual = k.getText("Policy_status_header");
			for(int l=0;l<count;l++){
				if(policy_status_actual.contains("Endorsement Submitted")){
					if(sectionName.contains("Liability")){
						coverName = "Liability";
					}
					if(sectionName.contains("Licence")){
						coverName = "Loss of Licence";
					}
					if(sectionName.contains("Frozen")){
						coverName = "Frozen Food";
					}
					if(sectionName.contains("Excess")){
						coverName = "Property Excess of Loss";
					}
					if((((String)common.Renewal_excel_data_map.get("CD_"+coverName.replaceAll(" ", ""))).equalsIgnoreCase("No"))){
						
						if(common.Renewal_Structure_of_InnerPagesMaps.get("Variable Tax Adjustment").get(l).get("VTA_SectionName").equalsIgnoreCase(sectionName) || 
								common.Renewal_Structure_of_InnerPagesMaps.get("Variable Tax Adjustment").get(l).get("Automation Key").contains("Endorsement")){
								Assert.assertTrue(k.Click("insuranceTaxAddAdjustmentButton"),"Unable to click on Add adustment button on Insurance Tax screen.");
								
								WebElement adjustmentTax = k.getObject("insuranceTaxAddAdjustmentTable");
								Select select = new Select(adjustmentTax.findElement(By.xpath("//*[contains(@name,'section')]")));
								String timeStamp = new SimpleDateFormat("ddMMyyyyHHmmss", Locale.US).format(new Date());
								String description = null;
								description = common.Renewal_Structure_of_InnerPagesMaps.get("Variable Tax Adjustment").get(l).get("VTA_Description");
								
								if(!description.contains("_")){
									description = common.Renewal_Structure_of_InnerPagesMaps.get("Variable Tax Adjustment").get(l).get("VTA_Description")+"_"+timeStamp;
									TestUtil.WriteDataToXl_innerSheet(code+"_"+event, "Variable Tax Adjustment", common.Renewal_Structure_of_InnerPagesMaps.get("Variable Tax Adjustment").get(l).get("Automation Key"), "VTA_Description", description, common.Renewal_Structure_of_InnerPagesMaps.get("Variable Tax Adjustment").get(l));
								}
								select.selectByVisibleText(common.Renewal_Structure_of_InnerPagesMaps.get("Variable Tax Adjustment").get(l).get("VTA_SectionName"));
								customAssert.assertTrue(k.Input("InsuranceTaxAdjustmentPremium", common.Renewal_Structure_of_InnerPagesMaps.get("Variable Tax Adjustment").get(l).get("VTA_Premium") ), "Unable to enter Premium on insurance Tax adjustment.");
								customAssert.assertTrue(k.Input("InsuranceTaxAdjustmentTaxRate", common.Renewal_Structure_of_InnerPagesMaps.get("Variable Tax Adjustment").get(l).get("VTA_TaxRate") ), "Unable to enter Premium on insurance Tax adjustment.");
								customAssert.assertTrue(k.Input("InsuranceTaxAdjustmentDescription", description ), "Unable to enter Premium on insurance Tax adjustment.");
								
								//System.out.println(variableTaxAdjustmentDataMaps);
								
								variableTaxAdjustmentDataMaps.put(common.Renewal_Structure_of_InnerPagesMaps.get("Variable Tax Adjustment").get(l).get("Automation Key")+"_Section Name", common.Renewal_Structure_of_InnerPagesMaps.get("Variable Tax Adjustment").get(l).get("VTA_SectionName"));
								variableTaxAdjustmentDataMaps.put(common.Renewal_Structure_of_InnerPagesMaps.get("Variable Tax Adjustment").get(l).get("Automation Key")+"_Premium", common.Renewal_Structure_of_InnerPagesMaps.get("Variable Tax Adjustment").get(l).get("VTA_Premium"));
								variableTaxAdjustmentDataMaps.put(common.Renewal_Structure_of_InnerPagesMaps.get("Variable Tax Adjustment").get(l).get("Automation Key")+"_Tax Rate", common.Renewal_Structure_of_InnerPagesMaps.get("Variable Tax Adjustment").get(l).get("VTA_TaxRate"));
								variableTaxAdjustmentDataMaps.put(common.Renewal_Structure_of_InnerPagesMaps.get("Variable Tax Adjustment").get(l).get("Automation Key")+"_Description", common.Renewal_Structure_of_InnerPagesMaps.get("Variable Tax Adjustment").get(l).get("VTA_Description"));
								
								headerNameStorage.add(common.Renewal_Structure_of_InnerPagesMaps.get("Variable Tax Adjustment").get(l).get("Automation Key"));
								//variableTaxAdjustmentVerificationMaps.put(common.NB_Structure_of_InnerPagesMaps.get("Variable Tax Adjustment").get(l).get("Automation Key"), variableTaxAdjustmentDataMaps);
								
								List<WebElement> listOfButtons = adjustmentTax.findElements(By.tagName("a"));
								//System.out.println("****************Total present button "+listOfButtons.size()+"********************");
								
								for(int k=0;k<listOfButtons.size();k++){
									String buttonName = listOfButtons.get(k).getText();
									if(buttonName.equalsIgnoreCase("Save")){
										listOfButtons.get(k).click();
										counter++;
										if(!validationOnAdjustedPremium(sectionName,l)){
											break;
										}
										adjustedPremium = adjustedPremium - Double.parseDouble(common.Renewal_Structure_of_InnerPagesMaps.get("Variable Tax Adjustment").get(l).get("VTA_Premium"));
										break;
									}
								}
							}
						}
					}
				if(policy_status_actual.contains("Rewind")){
					if(sectionName.contains("Liability")){
						coverName = "Liability";
					}
					if(sectionName.contains("Licence")){
						coverName = "Loss of Licence";
					}
					if(sectionName.contains("Frozen")){
						coverName = "Frozen Food";
					}
					if(sectionName.contains("Excess")){
						coverName = "Property Excess of Loss";
					}
					if((((String)common.Renewal_excel_data_map.get("CD_Add_"+coverName.replaceAll(" ", ""))).equalsIgnoreCase("Yes") ||
							((String)common.Renewal_excel_data_map.get("CD_"+coverName.replaceAll(" ", ""))).equalsIgnoreCase("Yes"))){
						
						if(common.Renewal_Structure_of_InnerPagesMaps.get("Variable Tax Adjustment").get(l).get("VTA_SectionName").equalsIgnoreCase(sectionName) && 
								common.Renewal_Structure_of_InnerPagesMaps.get("Variable Tax Adjustment").get(l).get("Automation Key").contains("Rewind")){
								Assert.assertTrue(k.Click("insuranceTaxAddAdjustmentButton"),"Unable to click on Add adustment button on Insurance Tax screen.");
								
								WebElement adjustmentTax = k.getObject("insuranceTaxAddAdjustmentTable");
								Select select = new Select(adjustmentTax.findElement(By.xpath("//*[contains(@name,'section')]")));
								String timeStamp = new SimpleDateFormat("ddMMyyyyHHmmss", Locale.US).format(new Date());
								String description = null;
								description = common.Renewal_Structure_of_InnerPagesMaps.get("Variable Tax Adjustment").get(l).get("VTA_Description");
								
								if(!description.contains("_")){
									description = common.Renewal_Structure_of_InnerPagesMaps.get("Variable Tax Adjustment").get(l).get("VTA_Description")+"_"+timeStamp;
									TestUtil.WriteDataToXl_innerSheet(code+"_"+event, "Variable Tax Adjustment", common.Renewal_Structure_of_InnerPagesMaps.get("Variable Tax Adjustment").get(l).get("Automation Key"), "VTA_Description", description, common.Renewal_Structure_of_InnerPagesMaps.get("Variable Tax Adjustment").get(l));
								}
								select.selectByVisibleText(common.Renewal_Structure_of_InnerPagesMaps.get("Variable Tax Adjustment").get(l).get("VTA_SectionName"));
								customAssert.assertTrue(k.Input("InsuranceTaxAdjustmentPremium", common.Renewal_Structure_of_InnerPagesMaps.get("Variable Tax Adjustment").get(l).get("VTA_Premium") ), "Unable to enter Premium on insurance Tax adjustment.");
								customAssert.assertTrue(k.Input("InsuranceTaxAdjustmentTaxRate", common.Renewal_Structure_of_InnerPagesMaps.get("Variable Tax Adjustment").get(l).get("VTA_TaxRate") ), "Unable to enter Premium on insurance Tax adjustment.");
								customAssert.assertTrue(k.Input("InsuranceTaxAdjustmentDescription", description ), "Unable to enter Premium on insurance Tax adjustment.");
								
								//System.out.println(variableTaxAdjustmentDataMaps);
								
								variableTaxAdjustmentDataMaps.put(common.Renewal_Structure_of_InnerPagesMaps.get("Variable Tax Adjustment").get(l).get("Automation Key")+"_Section Name", common.Renewal_Structure_of_InnerPagesMaps.get("Variable Tax Adjustment").get(l).get("VTA_SectionName"));
								variableTaxAdjustmentDataMaps.put(common.Renewal_Structure_of_InnerPagesMaps.get("Variable Tax Adjustment").get(l).get("Automation Key")+"_Premium", common.Renewal_Structure_of_InnerPagesMaps.get("Variable Tax Adjustment").get(l).get("VTA_Premium"));
								variableTaxAdjustmentDataMaps.put(common.Renewal_Structure_of_InnerPagesMaps.get("Variable Tax Adjustment").get(l).get("Automation Key")+"_Tax Rate", common.Renewal_Structure_of_InnerPagesMaps.get("Variable Tax Adjustment").get(l).get("VTA_TaxRate"));
								variableTaxAdjustmentDataMaps.put(common.Renewal_Structure_of_InnerPagesMaps.get("Variable Tax Adjustment").get(l).get("Automation Key")+"_Description", common.Renewal_Structure_of_InnerPagesMaps.get("Variable Tax Adjustment").get(l).get("VTA_Description"));
								
								headerNameStorage.add(common.Renewal_Structure_of_InnerPagesMaps.get("Variable Tax Adjustment").get(l).get("Automation Key"));
								//variableTaxAdjustmentVerificationMaps.put(common.NB_Structure_of_InnerPagesMaps.get("Variable Tax Adjustment").get(l).get("Automation Key"), variableTaxAdjustmentDataMaps);
								
								List<WebElement> listOfButtons = adjustmentTax.findElements(By.tagName("a"));
								//System.out.println("****************Total present button "+listOfButtons.size()+"********************");
								
								for(int k=0;k<listOfButtons.size();k++){
									String buttonName = listOfButtons.get(k).getText();
									if(buttonName.equalsIgnoreCase("Save")){
										listOfButtons.get(k).click();
										counter++;
										if(!validationOnAdjustedPremium_Renewal(sectionName,l)){
											break;
										}
										adjustedPremium = adjustedPremium - Double.parseDouble(common.Renewal_Structure_of_InnerPagesMaps.get("Variable Tax Adjustment").get(l).get("VTA_Premium"));
										break;
									}
								}
							}
						}
					}
				
			}
			variableTaxAdjustmentIDs.put(sectionName, counter);
			return true;
			
		}
		catch (Throwable t) {
			
			return false;
		}
	}
  
  @SuppressWarnings({ "static-access", "unused" })
	public static boolean verifyAdjustedTaxValues_Renewal(String sectionName,String code , String event){
		
		String coverName = sectionName;
		adjustedTotalTax = 0.0;
		adjustedTotalPremium = 0.0;
		unAdjustedTotalTax = 0.0;
		inputarraylist.clear();
		inputarraylistMTA.clear();
		
		try {
			taxTable_tBody = k.getObject("inssuranceTaxMainTableBODY");
			List<WebElement> list2 = taxTable_tBody.findElements(By.tagName("tr"));
			countOfTableRows = list2.size();
			//System.out.println("Rows in table unde tBody : "+list2.size());
			
			Outer:
			for(int j=0;j<countOfCovers-1;j++){
				if(taxTable_tBody.findElement(By.xpath("tr["+(j+1)+"]/td[1]")).getText().equalsIgnoreCase("Totals")){
					//break Outer;
					break Outer;
				}
				if(sectionName.contains("Property Excess of Loss")){
					sectionName = "Excess of Loss";
				}
				String policy_status_actual = k.getText("Policy_status_header");
				if(policy_status_actual.contains("Endorsement Submitted")){
					if(sectionName.contains("Liability")){
						coverName = "Liability";
					}
					if(sectionName.contains("Frozen")){
						coverName = "FrozenFood";
					}
					if(sectionName.contains("Licence")){
						coverName = "LossofLicence";
					}
					if((((String)common.Renewal_excel_data_map.get("CD_"+coverName.replaceAll(" ", ""))).equalsIgnoreCase("No"))){
						
						if(sectionName.equalsIgnoreCase(taxTable_tBody.findElement(By.xpath("tr["+(j+1)+"]/td[1]")).getText())){
							Inner :
							for(int m=0;m<=variableTaxAdjustmentIDs.get(sectionName)+1;m++){
								if(taxTable_tBody.findElement(By.xpath("tr["+(j+(m+1))+"]/td[1]")).getText().equalsIgnoreCase("Totals")){
									//break Outer;
									break Inner;
								}
								taxTable_tBody = k.getObject("inssuranceTaxMainTableBODY");
								//Verify Adjusted Values
								errorVal = errorVal + verifyAdjustedTaxCalculation_Renewal(sectionName,j,m);
							}
							
							//Verify Unadjusted Values
							errorVal = errorVal + verifyUnAdjustedTaxCalculation_Renewal(sectionName,j);
							//Verify Gross Tax values
							errorVal = errorVal + verifyGrossTaxCalculation_Renewal(sectionName,j,code,event);
							break;
						}
						
					}
				}
				if(policy_status_actual.contains("Rewind")){
					if(sectionName.contains("Liability")){
						coverName = "Liability";
					}
					if(sectionName.contains("Frozen")){
						coverName = "FrozenFood";
					}
					if(sectionName.contains("Licence")){
						coverName = "LossofLicence";
					}
					if((((String)common.Renewal_excel_data_map.get("CD_Add_"+coverName.replaceAll(" ", ""))).equalsIgnoreCase("Yes") ||
							((String)common.Renewal_excel_data_map.get("CD_"+coverName.replaceAll(" ", ""))).equalsIgnoreCase("Yes"))){
						
						if(sectionName.equalsIgnoreCase(taxTable_tBody.findElement(By.xpath("tr["+(j+1)+"]/td[1]")).getText())){
							Inner :
							for(int m=0;m<=variableTaxAdjustmentIDs.get(sectionName)+1;m++){
								if(taxTable_tBody.findElement(By.xpath("tr["+(j+(m+1))+"]/td[1]")).getText().equalsIgnoreCase("Totals")){
									//break Outer;
									break Inner;
								}
								taxTable_tBody = k.getObject("inssuranceTaxMainTableBODY");
								//Verify Adjusted Values
								errorVal = errorVal + verifyAdjustedTaxCalculation_Renewal(sectionName,j,m);
							}
							
							//Verify Unadjusted Values
							errorVal = errorVal + verifyUnAdjustedTaxCalculation_Renewal(sectionName,j);
							//Verify Gross Tax values
							errorVal = errorVal + verifyGrossTaxCalculation_Renewal(sectionName,j,code,event);
							break;
						}
						
					}
				}
			}
		} catch (Throwable t) {
			
			return false;
		} 
		
		return true;
	}
  
  public static int verifyAdjustedTaxCalculation_Renewal(String sectionName,int j,int m){
		
		try{
			String coverName = taxTable_tBody.findElement(By.xpath("tr["+(j+(m+1))+"]/td[1]")).getText();
			String adjustedPremium =  taxTable_tBody.findElement(By.xpath("tr["+(j+(m+1))+"]/td[3]")).getText();
			String iptRate =  taxTable_tBody.findElement(By.xpath("tr["+(j+(m+1))+"]/td[4]")).getText();
			String adjustedTax =  taxTable_tBody.findElement(By.xpath("tr["+(j+(m+1))+"]/td[6]")).getText();
			String description =  taxTable_tBody.findElement(By.xpath("tr["+(j+(m+1))+"]/td[7]")).getText();
			String adjustedBy =  taxTable_tBody.findElement(By.xpath("tr["+(j+(m+1))+"]/td[8]")).getText();
			
			int index = k.getText("BannerName").indexOf("\n");
			String adjustedByName = k.getText("BannerName").substring(0, index);
			//int count = 0;
			int noOfVariableTax = common.no_of_inner_data_sets.get("Variable Tax Adjustment");
			
			if((coverName==null || coverName.isEmpty() || coverName.equalsIgnoreCase("")) && !(description.equalsIgnoreCase("Unadjusted Premium"))){
				for(int p=0;p<variableTaxAdjustmentIDs.get(sectionName);p++){
					if(!inputarraylist.contains(p)){
						int count = 0;
						while(count < noOfVariableTax){
							//int columIndex = NB_Suite_TC_Xls.getColumnIndex("Variable Tax Adjustment",(String)headerNameStorage.get(p));
							//System.out.println("Index of "+(String)headerNameStorage.get(p)+"   is : : "+columIndex);
							
							if(description.equalsIgnoreCase((String) variableTaxAdjustmentDataMaps.get(headerNameStorage.get(p)+"_Description"))){
								if(common.Renewal_Structure_of_InnerPagesMaps.get("Variable Tax Adjustment").get(count).get("Automation Key").equalsIgnoreCase((String)headerNameStorage.get(p))){
									
									double adjustedPremium_calc = Double.parseDouble(common.Renewal_Structure_of_InnerPagesMaps.get("Variable Tax Adjustment").get(count).get("VTA_Premium"));
									double iptRate_calc = Double.parseDouble(common.Renewal_Structure_of_InnerPagesMaps.get("Variable Tax Adjustment").get(count).get("VTA_TaxRate"));
									String adjustedTax_calc = common.roundedOff(Double.toString((adjustedPremium_calc * iptRate_calc ) / 100.0));
									
									if(verification(common.roundedOff(adjustedPremium), common.roundedOff((String) variableTaxAdjustmentDataMaps.get(headerNameStorage.get(p)+"_Premium")), sectionName, "Adjusted Premium") &&
									   /*verification(common.roundedOff(iptRate), common.roundedOff((String) variableTaxAdjustmentDataMaps.get(headerNameStorage.get(p)+"_Tax Rate")), sectionName, "IPT Rate") &&*/
									   verification(common.roundedOff(adjustedTax), adjustedTax_calc, sectionName, "Adjusted Tax") &&
									   verification(description, (String) variableTaxAdjustmentDataMaps.get(headerNameStorage.get(p)+"_Description"), sectionName, "Description") &&
									   verification(adjustedBy, adjustedByName, sectionName, "Adjusted By")){
									   
										   inputarraylist.add(p);
										   adjustedTotalTax = adjustedTotalTax + Double.parseDouble(adjustedTax_calc);
										   adjustedTotalPremium = adjustedTotalPremium + adjustedPremium_calc;
										   return 0;
									
									}else{
									   return 1;
									}
								}
								
							}
							count++;
						}
						
					}
				}
			}
			return 0;
		}catch (Throwable t) {
			
			return 1;
		} 
	}
  
  
  public static int verifyUnAdjustedTaxCalculation_Renewal(String sectionName,int j){
		
		try{
			
			for(int m=0;m<=variableTaxAdjustmentIDs.get(sectionName)+1;m++){
				
				if(taxTable_tBody.findElement(By.xpath("tr["+(j+(m+1))+"]/td[1]")).getText().equalsIgnoreCase("Totals")){
					//break Outer;
					break;
				}
				
				String adjustedPremium =  taxTable_tBody.findElement(By.xpath("tr["+(j+(m+1))+"]/td[3]")).getText();
				String iptRate =  taxTable_tBody.findElement(By.xpath("tr["+(j+(m+1))+"]/td[4]")).getText();
				String adjustedTax =  taxTable_tBody.findElement(By.xpath("tr["+(j+(m+1))+"]/td[6]")).getText();
				String description =  taxTable_tBody.findElement(By.xpath("tr["+(j+(m+1))+"]/td[7]")).getText();
				String adjustedBy =  taxTable_tBody.findElement(By.xpath("tr["+(j+(m+1))+"]/td[8]")).getText();
				
				int index = k.getText("BannerName").indexOf("\n");
				String adjustedByName = k.getText("BannerName").substring(0, index);
				
				if(description.equalsIgnoreCase("Unadjusted Premium")){
					if(sectionName.contains("Excess of Loss")){
						sectionName = "Property Excess of Loss";
					}
					String unAdjustedPremium = common.roundedOff(Double.toString(Double.parseDouble((String)common.GrosspremSmryData.get("PS_"+sectionName.replaceAll(" ", "")+"_GP")) - adjustedTotalPremium));
					String iptRate_calc =  common.roundedOff(Double.toString(Double.parseDouble((String)common.Renewal_excel_data_map.get("PS_IPTRate"))));
					String adjustedTax_calc = common.roundedOff(Double.toString((Double.parseDouble(unAdjustedPremium) * Double.parseDouble(iptRate_calc) ) / 100.0));
					unAdjustedTotalTax = Double.parseDouble(adjustedTax_calc);
					
					if(verification(common.roundedOff(adjustedPremium), unAdjustedPremium, sectionName, "Un Adjusted Premium") &&
					   /*verification(common.roundedOff(iptRate), iptRate_calc, sectionName, "IPT Rate") &&*/
					   verification(common.roundedOff(adjustedTax), adjustedTax_calc, sectionName, "Un Adjusted Tax") &&
					   verification(description, "Unadjusted Premium", sectionName, "Description") &&
					   verification(adjustedByName, adjustedBy, sectionName, "Adjusted By")){
						
						return 0;
					
					}else{
						return 1;
					}
				}
			}
			return 0;
		}catch (Throwable t) {
			
			return 1;
		}
	}
  
  public static int verifyGrossTaxCalculation_Renewal(String sectionName,int j,String code , String event){
		
		
	   String grossPremium =  common.roundedOff(taxTable_tBody.findElement(By.xpath("tr["+(j+1)+"]/td[2]")).getText());
		String iptRate =  taxTable_tBody.findElement(By.xpath("tr["+(j+1)+"]/td[4]")).getText();
		String grossTax =  common.roundedOff(taxTable_tBody.findElement(By.xpath("tr["+(j+1)+"]/td[5]")).getText());
		String colName = (String)common.Renewal_excel_data_map.get("Automation Key");
		if(sectionName.contains("Excess of Loss")){
			sectionName = "Property Excess of Loss";
		}
		String trimmedSectionName = sectionName.replaceAll(" ", "");
		
		String finalGrossPremium = common.roundedOff((String)common.GrosspremSmryData.get("PS_"+trimmedSectionName+"_GP"));
		String finalGrossTax,finalIPTRate,finalNetPremiumTax = null;
		if(inputarraylist.size()!=0){
			finalGrossTax = common.roundedOff(Double.toString(unAdjustedTotalTax +  adjustedTotalTax));
			finalIPTRate = Double.toString(((Double.parseDouble(finalGrossTax) /Double.parseDouble(finalGrossPremium)) * 100.0 ));
		}else{
			finalGrossTax = common.roundedOff(Double.toString((Double.parseDouble((String)common.GrosspremSmryData.get("PS_"+trimmedSectionName+"_GP")) * ((Double.parseDouble((String)common.Renewal_excel_data_map.get("PS_IPTRate")) / 100.0)))));
			finalIPTRate = (String)common.Renewal_excel_data_map.get("PS_IPTRate");
		}
		
		common.totalGrossTax = common.totalGrossTax + Double.parseDouble(finalGrossTax);
		common.totalGrossPremium = common.totalGrossPremium + Double.parseDouble(finalGrossPremium);
		
		
		TestUtil.WriteDataToXl(code+"_"+event, "Premium Summary",colName, "PS_"+sectionName.replaceAll(" ", "")+"_GT", finalGrossTax, common.Renewal_excel_data_map);
		TestUtil.WriteDataToXl(code+"_"+event, "Premium Summary",colName, "PS_"+sectionName.replaceAll(" ", "")+"_IPT", finalIPTRate, common.Renewal_excel_data_map);
		
		finalNetPremiumTax = common.roundedOff(Double.toString((Double.parseDouble((String)common.Renewal_excel_data_map.get("PS_"+sectionName.replaceAll(" ", "")+"_NP")) * Double.parseDouble((String)common.Renewal_excel_data_map.get("PS_"+sectionName.replaceAll(" ", "")+"_IPT"))) / 100.0 ));
		
		common.totalNetPremiumTax = common.totalNetPremiumTax + Double.parseDouble(finalNetPremiumTax);
		TestUtil.WriteDataToXl(code+"_"+event, "Premium Summary",colName, "PS_"+sectionName.replaceAll(" ", "")+"_NPIPT", finalNetPremiumTax, common.Renewal_excel_data_map);
		
		grossTaxValues_Map.put(sectionName, Double.parseDouble(finalGrossTax));
		
		if(verification(grossPremium,finalGrossPremium,sectionName,"Gross Premium") && 
				verification(grossTax,finalGrossTax,sectionName,"Gross Tax") 
				/*&& verification(iptRate,finalIPTRate,sectionName,"IPT Rate")*/){
			TestUtil.reportStatus("[<b>  "+sectionName+"  </b>]  cover --- Verified Gross Premium is :  <b>[ "+finalGrossPremium+" ]</b> , IPT Rate is :  <b>[ "+finalIPTRate+" ]</b> , Gross Tax is :  <b>[ "+finalGrossTax+" ]</b> ", "PASS", false);
			return 0;
		}else{
			return 1;
		}
	}
  
  public static boolean PremiumSummarytableCalculation_Renewal(Hashtable<String,String> tabledata,String section ){
		//MaterialDamage_nipt, MaterialDamage_gprem, MaterialDamage_nprem, MaterialDamage_gipt, MaterialDamage_comm,MaterialDamage_comr
		try{ 	
		if(section.equals("Total")){ return true;}
			DecimalFormat f = new DecimalFormat("00.00");
			String secName = section.replaceAll(" ", "");
			String cSection = null;
			double grossPrem = Double.parseDouble(tabledata.get("PS_"+secName+"_GP"));
			double commisn   = Double.parseDouble(tabledata.get("PS_"+secName+"_GC")); 
			double commRate  = Double.parseDouble(tabledata.get("PS_"+secName+"_CR"));
			double netPrem 	 = Double.parseDouble(tabledata.get("PS_"+secName+"_NP"));
			double grossIPT  = Double.parseDouble(tabledata.get("PS_"+secName+"_GT"));
			double netIPT    = Double.parseDouble(tabledata.get("PS_"+secName+"_NPIPT"));
			
			
			if(secName.contains("Frozen")){
				cSection = "FrozenFoods";
			}else if(secName.contains("Licence")){
				cSection = "LossOfLicence";
			}else if(secName.contains("Total")){
				cSection = "Total";
			}else{
				cSection = secName.replaceAll(" ", "");
			}
			
			double IPT =  Double.parseDouble(TestUtil.getStringfromMap("PS_"+cSection+"_IPT",CommonFunction_VELA.businessEvent));
			TestUtil.reportStatus("Calculation for cover <b> "+section+"</b> as per IPT rate :"+IPT+" %", "Info", false);
			//System.out.println("\nCalculation Cover Name :"+section);// Added to the reporting & Logfile }
			//TestUtil.reportStatus("\nCalculation for Cover : <b>"+section, "Info", true);
			double denominator = (1.00-(commRate/100));
			double calcltdComm = (netPrem/denominator)*(commRate/100);
			//System.out.println("calculated Gross Commission :"+f.format(calcltdComm));// Added to the reporting & Logfile }
			TestUtil.reportStatus("Calculated Gross Commission :<b>"+f.format(calcltdComm), "Info", false);
			double calcltdGprem = calcltdComm + netPrem;
			//System.out.println("Calculated Gross Premium :"+f.format(calcltdGprem));// Added to the reporting & Logfile }
			TestUtil.reportStatus("Calculated Gross Premium :<b>"+f.format(calcltdGprem), "Info", false);
			double calcltdGIPT = calcltdGprem *(IPT/100);
			//System.out.println("Calculated Gross IPT :"+f.format(calcltdGIPT));// Added to the reporting & Logfile }
			TestUtil.reportStatus("Calculated Gross IPT :<b>"+f.format(calcltdGIPT), "Info", false);
			double calcltdNIPT = netPrem*(IPT/100);
			//System.out.println("Calculated Net IPT :"+f.format(calcltdNIPT));// Added to the reporting & Logfile }
			TestUtil.reportStatus("Calculated Net IPT :<b>"+f.format(calcltdNIPT), "Info", false);	
			customAssert.assertTrue(compareValues(calcltdGprem,grossPrem,"Gross Premium "),"Mismatched Gross Premium Values");
			customAssert.assertTrue(compareValues(calcltdComm,commisn,"Gross Commission "),"Mismatched Gross Commission Values");
			customAssert.assertTrue(compareValues(calcltdGIPT,grossIPT,"Gross IPT value "),"Mismatched Gross IPT Values");
			customAssert.assertTrue(compareValues(calcltdNIPT,netIPT,"Net IPT Values "),"Mimatched Net IPT Values");
			return true;
		}catch(Throwable t){
			return false;
		}
		}
  
  
  public static boolean validationOnAdjustedPremium_Renewal(String sectionName,int index){
		
		try {
			
			if(Double.parseDouble(common.Renewal_Structure_of_InnerPagesMaps.get("Variable Tax Adjustment").get(index).get("VTA_Premium")) > 0.0 && 
			   Double.parseDouble(common.Renewal_Structure_of_InnerPagesMaps.get("Variable Tax Adjustment").get(index).get("VTA_Premium")) <= adjustedPremium &&
			   Double.parseDouble(common.Renewal_Structure_of_InnerPagesMaps.get("Variable Tax Adjustment").get(index).get("VTA_TaxRate")) <= 100.0 &&
			   Double.parseDouble(common.Renewal_Structure_of_InnerPagesMaps.get("Variable Tax Adjustment").get(index).get("VTA_TaxRate")) >= 0.0
					){
				return true;
			}else{
				if(!(Double.parseDouble(common.Renewal_Structure_of_InnerPagesMaps.get("Variable Tax Adjustment").get(index).get("VTA_Premium")) > 0.0)){
					TestUtil.reportStatus("<p style='color:black'> Gross Premium should be <b> > 0.0 </b> .Entered Gross Premium is : <b>[  "+common.Renewal_Structure_of_InnerPagesMaps.get("Variable Tax Adjustment").get(index).get("VTA_Premium")+"  ]</b>. Skipped Tax adjustment for Data ID is : [<b>  "+common.Renewal_Structure_of_InnerPagesMaps.get("Variable Tax Adjustment").get(index).get("Automation Key")+"  </b>] AND Cover Name is :  <b>[  "+sectionName+"  ]</b> </p>", "Info", false);
				}else if(!(Double.parseDouble(common.Renewal_Structure_of_InnerPagesMaps.get("Variable Tax Adjustment").get(index).get("VTA_Premium")) <= adjustedPremium)){
					TestUtil.reportStatus("<p style='color:black'> Gross Premium limit is either completed or higher than Gross Premium. Available Gross Premium is : <b>[  "+adjustedPremium+"  ]</b> And Entered Gross Premium is : <b>[  "+common.Renewal_Structure_of_InnerPagesMaps.get("Variable Tax Adjustment").get(index).get("VTA_Premium")+"  ]</b>. Skipped Tax adjustment for Data ID is : [<b>  "+common.Renewal_Structure_of_InnerPagesMaps.get("Variable Tax Adjustment").get(index).get("Automation Key")+"  </b>] AND Cover Name is :  <b>[  "+sectionName+"  ]</b> </p>", "Info", false);
				}else if(!(Double.parseDouble(common.Renewal_Structure_of_InnerPagesMaps.get("Variable Tax Adjustment").get(index).get("VTA_TaxRate")) <= 100.0)){
					TestUtil.reportStatus("<p style='color:black'> Tax rate should be <b> <= 100.0 </b>. Entered Tax rate is : <b>[  "+common.Renewal_Structure_of_InnerPagesMaps.get("Variable Tax Adjustment").get(index).get("VTA_TaxRate")+"  ]</b>. Skipped Tax adjustment for Data ID is : [<b>  "+common.Renewal_Structure_of_InnerPagesMaps.get("Variable Tax Adjustment").get(index).get("Automation Key")+"  </b>] AND Cover Name is :  <b>[  "+sectionName+"  ]</b> </p>", "Info", false);
				}else if(!(Double.parseDouble(common.Renewal_Structure_of_InnerPagesMaps.get("Variable Tax Adjustment").get(index).get("VTA_TaxRate")) >= 0.0)){
					TestUtil.reportStatus("<p style='color:black'> Tax rate should be <b> >= 0.0 </b>.Entered Tax rate is : <b>[  "+common.Renewal_Structure_of_InnerPagesMaps.get("Variable Tax Adjustment").get(index).get("VTA_TaxRate")+"  ]</b> Skipped Tax adjustment for Data ID is : [<b>  "+common.Renewal_Structure_of_InnerPagesMaps.get("Variable Tax Adjustment").get(index).get("Automation Key")+"  </b>] AND Cover Name is :  <b>[  "+sectionName+"  ]</b> </p>", "Info", false);
				}
				
				@SuppressWarnings("static-access")
				WebElement adjustmentTax = k.getObject("insuranceTaxAddAdjustmentTable");
				customAssert.assertTrue(k.SelectBtnWebElement(adjustmentTax, "insuranceTaxAddAdjustmentSaveCancleButton", "Cancel"), "Unable to select Cancel button.");
				
				return false;
			}
			
		} catch (Throwable t) {
			
			return false;
		} 

	}
  
  
 
  public double calculateXOETS_RenewalRewind(String recipient,String account,int j, int td){
		try{
			double terrorAmount = 0.0;
			String PropertyExcessofLossGP = (String)common.Renewal_excel_data_map.get("PS_PropertyExcessofLoss_GP");
			String cedeCommission = (String)common.Renewal_excel_data_map.get("TER_CedeComm"); 	
			String PenGrossIPT = (String)common.Renewal_excel_data_map.get("PS_Total_GT"); 
			String TerrorisamNP = common.Renewal_excel_data_map.get("PS_Terrorism_NP").toString();
			String part1= "//*[@id='table0']/tbody";
			
			String actualXOEPremium= driver.findElement(By.xpath(part1+"/tr["+j+"]/td["+td+"]")).getText();
			String actualXOEIPT = driver.findElement(By.xpath(part1+"/tr["+j+"]/td["+(td+1)+"]")).getText();
			String actualXOEDue = driver.findElement(By.xpath(part1+"/tr["+j+"]/td["+(td+2)+"]")).getText();
			
			/*if(((String)common.NB_excel_data_map.get("CD_Terrorism")).equals("Yes"))
			{*/	
			if((String)common.Renewal_excel_data_map.get("CD_Terrorism")!= null && 
					((((((String)common.Renewal_excel_data_map.get("CD_Terrorism")).equals("Yes")) && !((String)common.Renewal_excel_data_map.get("CD_Add_Terrorism")).equals("No"))) || ((String)common.NB_excel_data_map.get("CD_Add_Terrorism")).equals("Yes")))
				{	
				
					if(cedeCommission.equalsIgnoreCase("No")){terrorAmount = (Double.parseDouble(TerrorisamNP) * 0.9);}
					else{terrorAmount = Double.parseDouble(TerrorisamNP);}
				}
			double GeneralAmount =  (Double.parseDouble(PropertyExcessofLossGP) * 0.64) + terrorAmount;
			compareValues(GeneralAmount, Double.parseDouble(actualXOEPremium), "XOE Amount ");
			compareValues(Double.parseDouble(PenGrossIPT), Double.parseDouble(actualXOEIPT), "XOE  IPT ");
			double XOEDue = GeneralAmount + Double.parseDouble(PenGrossIPT);
			compareValues(Double.parseDouble(actualXOEDue), Double.parseDouble(common.roundedOff(Double.toString(XOEDue))), "XOE Due Amount ");
			return Double.parseDouble(common.roundedOff(Double.toString(XOEDue)));	
		}catch(Throwable t) {
			String methodName = new Object(){}.getClass().getEnclosingMethod().getName();
			TestUtil.reportFunctionFailed("Failed in "+methodName+" function");    
			k.reportErr("Failed in "+methodName+" function", t);
			Assert.fail("Failed in Calculate Ammout for Marine Cargo. \n", t);
			return 0;
		}
	}
  
  
 
   public boolean ReinstatePolicy(Map<Object, Object> mdata)
  	{
  		boolean retvalue = true;

		try{

  			customAssert.assertTrue(common.funcMenuSelection("Tools", "Reinstate Policy"),"Unable to Navigate to Reinstate Policy Screen from Tools Menu.");
  			TestUtil.reportStatus("Navigated to <b>Reinstate Policy</b> page", "Info", false);
  			
  			/*Assert.assertTrue(common.funcNavigateTo("Reinstate Policy"), "Unable to navigate to Reinstate Policy Page ");
  			k.waitTwoSeconds();*/
  			customAssert.assertTrue(k.getText("ReinstatePolicyHeader").equalsIgnoreCase("Reinstate Policy"), "Reinstate Policy Page is not loaded");
  			
  			customAssert.assertTrue(k.Input("CCF_rewindTxtArea","Test Automation Re-instate"), "Unable to enter text in Reason for Rewind field");
  			customAssert.assertTrue(driver.findElement(OR.getLocator("CCF_reinstatePolicy_btn")).isEnabled(), "Reinstate Policy button is not Enabled . ");
  			customAssert.assertTrue(k.Click("CCF_reinstatePolicy_btn"), "Unable to Click on Reinstate Policy Button");
//  			k.waitTwoSeconds();
  			customAssert.assertTrue(k.getText("searchPoliciesPage_Header").equalsIgnoreCase("Search Policies"), "After Clicking on Reinstate Policy - Search Policies Page is not loaded");
  			customAssert.assertTrue(k.getText("comm_SearchedPolicyStatus").equalsIgnoreCase("On Cover"), "<p style='color:red'>After Reinstate Policy - Status of Policy is not <b>On Cover</b> .</p>");

  			TestUtil.reportStatus("Reinstate Successfully for Cancelled Policy with Status as <b> On Cover </b> as Expected . ","Pass", false);
  			

		} catch(Throwable t) {
			String methodName = new Object(){}.getClass().getEnclosingMethod().getName();
			TestUtil.reportFunctionFailed("Failed in "+methodName+" function");
			Assert.fail("Failed in Reinstate Policy Method\n",t);
			return false;
		}
		return retvalue;
	}
   public boolean funcPremiumSummary(Map<Object, Object> map_data,String code,String event){
		
		boolean r_value= true;
		Date currentDate = new Date();
		String testName = (String)map_data.get("Automation Key");
		String customPolicyDuration=null;
		SimpleDateFormat df1 = new SimpleDateFormat("dd/MM/yyyy");
		
		try{
			customAssert.assertTrue(common.funcPageNavigation("Premium Summary", ""),"Premium Summary page navigations issue(S)");
			//customAssert.assertTrue(common_HHAZ.verifyEndorsementONPremiumSummary(map_data),"Endorsement on Premium is having issue(S).");
		
		switch(common.currentRunningFlow){
		
		case "NB":
			
			int policy_Duration = Integer.parseInt((String)map_data.get("PS_Duration"));
	        policy_duration_Trans=policy_Duration;
			policy_Duration--;
			String Policy_End_Date = common.daysIncrementWithOutFormation(df1.format(currentDate), policy_Duration);
			String policy_Start_date = get_PolicyStartDate((String)map_data.get("PS_PolicyStartDate"));
			map_data.put("PS_PolicyStartDate", policy_Start_date);
			if(((String)map_data.get("PS_DefaultStartEndDate")).equals("No")){
				
				customAssert.assertTrue(k.Click("Policy_Start_Date"), "Unable to Click Policy_Start_Date date picker .");
				customAssert.assertTrue(k.Input("Policy_Start_Date", policy_Start_date),"Unable to Enter Policy_Start_Date .");
				customAssert.assertTrue(k.Click("calander_btn"), "Unable to click on done button in calander.");
				k.waitFiveSeconds();
				customAssert.assertTrue(k.Click("Policy_End_Date"), "Unable to Click Policy_End_Date date picker .");
				customAssert.assertTrue(k.Input("Policy_End_Date", Policy_End_Date),"Unable to Enter Policy_End_Date .");
			
				customAssert.assertTrue(k.Click("calander_btn"), "Unable to click on done button in calander.");
				
			}	
			driver.findElement(By.xpath("//*[contains(@name,'_admin_fee')]")).sendKeys(Keys.chord(Keys.CONTROL, "a"),(String)map_data.get("PS_AdminFee"));
			k.waitTwoSeconds();
			k.SelectRadioBtn("insuranceTaxExemptionRadioButton", (String)map_data.get("PS_TaxExempt"));
			if(((String)map_data.get("PS_TaxExempt")).equalsIgnoreCase("Yes")){
				customAssert.assertTrue(WriteDataToXl(code+"_"+common.currentRunningFlow, "Premium Summary", testName, "PS_InsuranceTaxButton", "Yes",map_data), "Error while writing Tax exemption value to excel .");
			}
			
			if(((String)map_data.get("PS_IsPolicyFinanced")).equals("Yes") && k.getText("PS_Broker_Name").contains("Arthur J.")){
				k.SelectRadioBtn("PS_IsPolicyFinanced","Yes");
				k.Input("PS_Finance_RefNumber", (String)map_data.get("PS_FinanceReferenceNumber"));
				k.DropDownSelection("PS_CreditProvider", (String)map_data.get("PS_CreditProvider"));
			}
			customAssert.assertTrue(k.SelectRadioBtn("Payment_Warranty_rules", (String)map_data.get("PS_PaymentWarrantyRules")),"Unable to Select Payment_Warranty_rules radio button . ");
			if(((String)map_data.get("PS_PaymentWarrantyRules")).equals("Yes")){
				
				customAssert.assertTrue(k.Click("Payment_Warranty_Due_Date"), "Unable to Click Payment_Warranty_Due_Date date picker .");
				customAssert.assertTrue(k.Input("Payment_Warranty_Due_Date", (String)map_data.get("PS_PaymentWarrantyDueDate")),"Unable to Enter Payment_Warranty_Due_Date .");
				customAssert.assertTrue(k.Click("calander_btn"), "Unable to click on done button in calander.");
			}
			
			k.waitTwoSeconds();
		break;	
		case "Rewind":
			
			policy_Duration = Integer.parseInt((String)map_data.get("PS_Duration"));
			policy_Duration--;
			Policy_End_Date = common.daysIncrementWithOutFormation(df1.format(currentDate), policy_Duration);
			policy_Start_date = get_PolicyStartDate((String)map_data.get("PS_PolicyStartDate"));
			map_data.put("PS_PolicyStartDate", policy_Start_date);
			if(((String)map_data.get("PS_DefaultStartEndDate")).equals("No")){
				
				customAssert.assertTrue(k.Click("Policy_Start_Date"), "Unable to Click Policy_Start_Date date picker .");
				customAssert.assertTrue(k.Input("Policy_Start_Date", policy_Start_date),"Unable to Enter Policy_Start_Date .");
				customAssert.assertTrue(k.Click("calander_btn"), "Unable to click on done button in calander.");
				k.waitFiveSeconds();
				customAssert.assertTrue(k.Click("Policy_End_Date"), "Unable to Click Policy_End_Date date picker .");
				customAssert.assertTrue(k.Input("Policy_End_Date", Policy_End_Date),"Unable to Enter Policy_End_Date .");
				
				customAssert.assertTrue(k.Click("calander_btn"), "Unable to click on done button in calander.");
				
			}	
			driver.findElement(By.xpath("//*[contains(@name,'_admin_fee')]")).sendKeys(Keys.chord(Keys.CONTROL, "a"),(String)map_data.get("PS_AdminFee"));
			k.waitTwoSeconds();
			k.SelectRadioBtn("insuranceTaxExemptionRadioButton", (String)map_data.get("PS_TaxExempt"));
			if(((String)map_data.get("PS_TaxExempt")).equalsIgnoreCase("Yes")){
				customAssert.assertTrue(WriteDataToXl(code+"_"+common.currentRunningFlow, "Premium Summary", testName, "PS_InsuranceTaxButton", "Yes",map_data), "Error while writing Tax exemption value to excel .");
			}
			
			if(((String)map_data.get("PS_IsPolicyFinanced")).equals("Yes") && k.getText("PS_Broker_Name").contains("Arthur J.")){
				k.SelectRadioBtn("PS_IsPolicyFinanced","Yes");
				k.Input("PS_Finance_RefNumber", (String)map_data.get("PS_FinanceReferenceNumber"));
				k.DropDownSelection("PS_CreditProvider", (String)map_data.get("PS_CreditProvider"));
			}
			k.waitTwoSeconds();
		break;	
		case "Requote":
			
			policy_Duration = Integer.parseInt((String)map_data.get("PS_Duration"));
			policy_Duration--;
			Policy_End_Date = common.daysIncrementWithOutFormation(df1.format(currentDate), policy_Duration);
			policy_Start_date = get_PolicyStartDate((String)map_data.get("PS_PolicyStartDate"));
			map_data.put("PS_PolicyStartDate", policy_Start_date);
			if(((String)map_data.get("PS_DefaultStartEndDate")).equals("No")){
				
				customAssert.assertTrue(k.Click("Policy_Start_Date"), "Unable to Click Policy_Start_Date date picker .");
				customAssert.assertTrue(k.Input("Policy_Start_Date", policy_Start_date),"Unable to Enter Policy_Start_Date .");
				customAssert.assertTrue(k.Click("calander_btn"), "Unable to click on done button in calander.");
				k.waitFiveSeconds();
				customAssert.assertTrue(k.Click("Policy_End_Date"), "Unable to Click Policy_End_Date date picker .");
				customAssert.assertTrue(k.Input("Policy_End_Date", Policy_End_Date),"Unable to Enter Policy_End_Date .");
				
				customAssert.assertTrue(k.Click("calander_btn"), "Unable to click on done button in calander.");
				
			}	
			driver.findElement(By.xpath("//*[contains(@name,'_admin_fee')]")).sendKeys(Keys.chord(Keys.CONTROL, "a"),(String)map_data.get("PS_AdminFee"));
			k.waitTwoSeconds();
			k.SelectRadioBtn("insuranceTaxExemptionRadioButton", (String)map_data.get("PS_TaxExempt"));
			if(((String)map_data.get("PS_TaxExempt")).equalsIgnoreCase("Yes")){
				customAssert.assertTrue(WriteDataToXl(code+"_"+common.currentRunningFlow, "Premium Summary", testName, "PS_InsuranceTaxButton", "Yes",map_data), "Error while writing Tax exemption value to excel .");
			}
			
			if(((String)map_data.get("PS_IsPolicyFinanced")).equals("Yes") && k.getText("PS_Broker_Name").contains("Arthur J.")){
				k.SelectRadioBtn("PS_IsPolicyFinanced","Yes");
				k.Input("PS_Finance_RefNumber", (String)map_data.get("PS_FinanceReferenceNumber"));
				k.DropDownSelection("PS_CreditProvider", (String)map_data.get("PS_CreditProvider"));
			}
			k.waitTwoSeconds();
		break;	
		case "MTA":
			driver.findElement(By.xpath("//*[contains(@name,'_admin_fee')]")).sendKeys(Keys.chord(Keys.CONTROL, "a"),(String)map_data.get("PS_AdminFee"));
			k.SelectRadioBtn("insuranceTaxExemptionRadioButton", (String)map_data.get("PS_TaxExempt"));
			if(((String)map_data.get("PS_TaxExempt")).equalsIgnoreCase("Yes")){
				customAssert.assertTrue(WriteDataToXl(code+"_"+common.currentRunningFlow, "Premium Summary", testName, "PS_InsuranceTaxButton", "Yes",map_data), "Error while writing Tax exemption value to excel .");
			}
			
			if(((String)map_data.get("PS_IsPolicyFinanced")).equals("Yes") && k.getText("PS_Broker_Name").contains("Arthur J.")){
				k.SelectRadioBtn("PS_IsPolicyFinanced","Yes");
				k.Input("PS_Finance_RefNumber", (String)map_data.get("PS_FinanceReferenceNumber"));
				k.DropDownSelection("PS_CreditProvider", (String)map_data.get("PS_CreditProvider"));
			}
			break;
		case "Renewal":
			driver.findElement(By.xpath("//*[contains(@name,'_admin_fee')]")).sendKeys(Keys.chord(Keys.CONTROL, "a"),(String)map_data.get("PS_AdminFee"));
			k.waitTwoSeconds();
			k.SelectRadioBtn("insuranceTaxExemptionRadioButton", (String)map_data.get("PS_TaxExempt"));
			if(((String)map_data.get("PS_TaxExempt")).equalsIgnoreCase("Yes")){
				customAssert.assertTrue(WriteDataToXl(code+"_"+common.currentRunningFlow, "Premium Summary", testName, "PS_InsuranceTaxButton", "Yes",map_data), "Error while writing Tax exemption value to excel .");
			}
			customAssert.assertTrue(k.Click("CCF_Btn_Save"), "Unable to click on Save Button on Premium Summary .");
			customAssert.assertTrue(funcGetPremiums(common.Renewal_excel_data_map),"Error while getting premium for renewals");
			break;
		}
		customAssert.assertTrue(k.Click("CCF_Btn_Save"), "Unable to click on Save Button on Premium Summary .");
		customPolicyDuration = k.getText("Policy_Duration");
		customAssert.assertTrue(WriteDataToXl(code+"_"+event, "Premium Summary", testName, "PS_Duration", customPolicyDuration,map_data),"Error while writing Policy Duration data to excel .");
		TestUtil.reportStatus("Policy Duration = "+customPolicyDuration+" Days . ", "Info", true);
		customAssert.assertTrue(Verify_premiumSummaryTable(), "Error while verifying Premium Summary table .");
		// Verification of insurance Tax.
		if(!TestBase.product.contains("LEA")){
			customAssert.assertTrue(insuranceTaxAdjustmentHandling(code, event),"Error while doing insurance Tax Adjustment ");
			TestUtil.reportStatus("Verifying Premium Summary Table after Tax Adjustment", "Info", true);
			customAssert.assertTrue(Verify_premiumSummaryTable(), "Error while verifying Premium Summary table after insurance Tax Adjustment .");
		}
		PremiumFlag = false;
			
		if(Integer.parseInt(customPolicyDuration)!=365){
				customAssert.assertTrue(funcTransactionPremiumTable(code, event), "Error while verifying Transaction Premium table on premium Summary page .");
			}
		
	
		 
		TestUtil.reportStatus("Premium Summary details are filled and Verified sucessfully . ", "Info", true);
		return r_value;
	}catch(Throwable t){
			PremiumFlag = false;
			return false;
		}
	}

	public boolean Verify_premiumSummaryTable(){
		err_count = 0;
		final String code = TestBase.product;
		final String event = TestBase.businessEvent;
		String testName = null;
		Map<Object,Object> data_map = null;
		
		switch(common.currentRunningFlow){
			case "NB":
				testName = (String)common.NB_excel_data_map.get("Automation Key");
				data_map = common.NB_excel_data_map;
			break;
			case "Renewal":
				testName = (String)common.Renewal_excel_data_map.get("Automation Key");
				data_map = common.Renewal_excel_data_map;
			break;
			case "MTA":
				testName = (String)common.MTA_excel_data_map.get("Automation Key");
				data_map = common.MTA_excel_data_map;
			break;
			case "Rewind":
				testName = (String)common.Rewind_excel_data_map.get("Automation Key");
				data_map = common.Rewind_excel_data_map;
			break;
			case "Requote":
				testName = (String)common.Requote_excel_data_map.get("Automation Key");
				data_map = common.Requote_excel_data_map;
			break;
		}
		
		final Map<String,String> locator_map = new HashMap<>();
		locator_map.put("PenComm", "pencom");
		locator_map.put("NetPremium", "nprem");
		locator_map.put("BrokerComm", "comm");
		locator_map.put("GrossPremium", "gprem");
		locator_map.put("InsuranceTax", "gipt");
		
		final Map<String,String> section_map = new HashMap<>();
		if(common.product.contains("XOC") ||common.product.contains("XOQ") )
			section_map.put("Public&ProductsLiability", "pl");
		else
			section_map.put("Public&ProductsLiability", "pl_pr");
		
		section_map.put("EmployersLiability", "el");
		section_map.put("AnnualWorks", "acw");
		section_map.put("SingleProject", "pcw");
		section_map.put("OwnPlant", "op");
		section_map.put("HireCoverPlus", "hcp");
		section_map.put("HiredInPlant", "hp");
		section_map.put("JCT6.5.1", "jc");
		section_map.put("Terrorism", "ter");
		section_map.put("PropertyOwnersLiability", "po");
		section_map.put("LegalExpenses", "lea");
		section_map.put("Total", "tot");
		section_map.put("CombinedLiability","cl");
		section_map.put("ThirdPartyMotorLiability", "tp");
		
		
		
		double exp_Premium = 0.0;
		
		try{
		
			String annualTble_xpath = "html/body/div[3]/form/div/table[2]";
			String policy_status_actual = k.getText("Policy_status_header");
			int trans_tble_Rows = driver.findElements(By.xpath(annualTble_xpath+"/tbody/tr")).size();
			int trans_tble_Cols = driver.findElements(By.xpath(annualTble_xpath+"/thead/tr/th")).size();
			String sectionName = null;
			
			if(!PremiumFlag)
			for(int i =1;i<=trans_tble_Rows-1;i++){
				String annualTblXpath2 = "/tbody/tr["+i+"]/td[1]";
				sectionName = driver.findElement(By.xpath(annualTble_xpath+annualTblXpath2)).getText().replaceAll(" ", "");
				if(sectionName.contains("AbbeyLegalExpenses")){
					sectionName = "LegalExpenses";}
				else if(sectionName.contains("Totals")){
					sectionName = "Total";
				}
				customAssert.assertTrue(funcAddInput_PremiumSummary(sectionName,section_map.get(sectionName),data_map),"Add Premium Summary Input function having issues for "+sectionName);
				if(((String)data_map.get("PS_TaxExempt")).equalsIgnoreCase("Yes")){
					data_map.put("PS_"+sectionName+"_IPT", "0.0");
				}else{
					data_map.put("PS_"+sectionName+"_IPT", "12");
				}
			}
			PremiumFlag = true;		
			customAssert.assertTrue(k.Click("CCF_Btn_Save"), "Unable to click on Save Button on Premium Summary .");
			
			for(int i =1;i<=trans_tble_Rows-1;i++){
				String annualTblXpath2 = "/tbody/tr["+i+"]/td[1]";
				sectionName = driver.findElement(By.xpath(annualTble_xpath+annualTblXpath2)).getText().replaceAll(" ", "");
				if(sectionName.contains("AbbeyLegalExpenses")){
					sectionName = "LegalExpenses";}
				else if(sectionName.contains("Totals")){
					sectionName = "Total";}
				if(TestBase.product.equalsIgnoreCase("LEA"))
					err_count = err_count + func_PremiumSummaryCalculation_LEA(section_map.get(sectionName),sectionName,locator_map);
				else
					err_count = err_count + func_PremiumSummaryCalculation(section_map.get(sectionName),sectionName,locator_map);
 				exp_Premium = exp_Premium + Double.parseDouble((String)data_map.get("PS_"+sectionName+"_TotalPremium"));
			}
			
			double Total_GP = 00.00;
			double Total_GT = 00.00;
			double Total_NetNetPemium = 00.00,Total_PenComm = 00.00,Total_NetPremium=00.00 ,Total_BrokComm = 00.00, Total_InsTax = 0.00;
			
			for(int i =1;i<=trans_tble_Rows-1;i++){
				String annualTblXpath2 = "/tbody/tr["+i+"]/td[1]";
				sectionName = driver.findElement(By.xpath(annualTble_xpath+annualTblXpath2)).getText().replaceAll(" ", "");
				if(sectionName.contains("AbbeyLegalExpenses")){
					sectionName = "LegalExpenses";}
				else if(sectionName.contains("Totals")){
					sectionName = "Total";}
				Total_GP = Total_GP + Double.parseDouble((String)data_map.get("PS_"+sectionName+"_GP"));
				Total_GT = Total_GT + Double.parseDouble((String)data_map.get("PS_"+sectionName+"_GT"));
				Total_NetNetPemium = Total_NetNetPemium + Double.parseDouble((String)data_map.get("PS_"+sectionName+"_NetNetPremium"));
				Total_PenComm = Total_PenComm + Double.parseDouble((String)data_map.get("PS_"+sectionName+"_PenComm"));
				Total_BrokComm = Total_BrokComm + Double.parseDouble((String)data_map.get("PS_"+sectionName+"_BrokerComm"));
				Total_NetPremium = Total_NetPremium + Double.parseDouble((String)data_map.get("PS_"+sectionName+"_NetPremium"));
			}
			
			data_map.put("PS_Total_GT", f.format(Total_GT));
			data_map.put("PS_Total_GP", f.format(Total_GP));
			data_map.put("PS_TotalPremium", f.format(exp_Premium));
			data_map.put("PS_NetNetPemiumTotal", f.format(Total_NetNetPemium));
			data_map.put("PS_BrokerCommissionTotal", f.format(Total_BrokComm));
			data_map.put("PS_PenCommTotal", f.format(Total_PenComm));
			
	
			String exp_Total_Premium = common.roundedOff(Double.toString(exp_Premium));
			String act_Total_Premium = k.getAttribute("SPI_Total_Premium", "value");
			act_Total_Premium = act_Total_Premium.replaceAll(",", "");
			
			if((common.product.equalsIgnoreCase("COB")) && common.currentRunningFlow.equalsIgnoreCase("MTA")){
				double val[] =funcTransactionDetailsTable_Verification_New_MTA(sectionName,common.transaction_Details_Premium_Values);
				exp_Total_Premium = Double.toString(val[0]);
				Total_InsTax = val[1];
				
				act_Total_Premium=	driver.findElement(By.xpath("//*[@id='table0']/tbody/tr[1]/td[3]")).getText().replaceAll(",", "").replaceAll("","");
				
			}		
			TestUtil.reportStatus("---------------Total Premium-----------------","Info",false);
			
			CommonFunction.compareValues(Double.parseDouble(exp_Total_Premium),Double.parseDouble(act_Total_Premium),"Total Premium.");
			
			if(Integer.parseInt((String)data_map.get("PS_Duration")) == 365){
				//Toal Premium With Admin Fees
				double total_premium_with_admin_fee = Double.parseDouble(exp_Total_Premium) + Double.parseDouble((String)data_map.get("PS_TotalAdminFee")) + Total_InsTax;
				
				String exp_Total_Premium_with_Admin_fee = common.roundedOff(Double.toString(total_premium_with_admin_fee));
				k.waitTwoSeconds(); 
				customAssert.assertTrue(k.Click("CCF_Btn_Save"), "Unable to click on Save Button on Premium Summary .");
				String xPath = "//table[@id='table0']//*//td[text()='Total']//following-sibling::td";
				String act_Total_Premium_with_Admin_fee = k.getTextByXpath(xPath);
				
				act_Total_Premium_with_Admin_fee = act_Total_Premium_with_Admin_fee.replaceAll(",", "");
				
				TestUtil.reportStatus("---------------Total Premium with Admin Fees-----------------","Info",false);
				
				CommonFunction.compareValues(Double.parseDouble(exp_Total_Premium_with_Admin_fee),Double.parseDouble(act_Total_Premium_with_Admin_fee),"Total Premium.");
			}
			return true;
		  
		}catch(Throwable t){
					return false;
			
		}
	}
	
	public boolean Verify_premiumSummaryTable_MTA(){
		err_count = 0;
		final String code = TestBase.product;
		final String event = TestBase.businessEvent;
		String testName = null;
		Map<Object,Object> data_map = null;
		
		switch(common.currentRunningFlow){
			case "NB":
				testName = (String)common.NB_excel_data_map.get("Automation Key");
				data_map = common.NB_excel_data_map;
			break;
			case "Renewal":
				testName = (String)common.Renewal_excel_data_map.get("Automation Key");
				data_map = common.Renewal_excel_data_map;
			break;
			case "MTA":
				testName = (String)common.MTA_excel_data_map.get("Automation Key");
				data_map = common.MTA_excel_data_map;
			break;
			case "Rewind":
				testName = (String)common.Rewind_excel_data_map.get("Automation Key");
				data_map = common.Rewind_excel_data_map;
			break;
		}
		
		final Map<String,String> locator_map = new HashMap<>();
		locator_map.put("PenComm", "pencom");
		locator_map.put("NetPremium", "nprem");
		locator_map.put("BrokerComm", "comm");
		locator_map.put("GrossPremium", "gprem");
		locator_map.put("InsuranceTax", "gipt");
		
		final Map<String,String> section_map = new HashMap<>();
		if(common.product.contains("XOC") ||common.product.contains("XOQ") )
			section_map.put("Public&ProductsLiability", "pl");
		else
			section_map.put("Public&ProductsLiability", "pl_pr");
		
		section_map.put("EmployersLiability", "el");
		section_map.put("AnnualWorks", "acw");
		section_map.put("SingleProject", "pcw");
		section_map.put("OwnPlant", "op");
		section_map.put("HireCoverPlus", "hcp");
		section_map.put("HiredInPlant", "hp");
		section_map.put("JCT6.5.1", "jc");
		section_map.put("Terrorism", "ter");
		section_map.put("PropertyOwnersLiability", "po");
		section_map.put("LegalExpenses", "lea");
		section_map.put("Total", "tot");
		section_map.put("CombinedLiability","cl");
		section_map.put("ThirdPartyMotorLiability", "tp");
		
		
		
		double exp_Premium = 0.0;
		
		try{
		
			String annualTble_xpath = "html/body/div[3]/form/div/table[2]";
			String policy_status_actual = k.getText("Policy_status_header");
			int trans_tble_Rows = driver.findElements(By.xpath(annualTble_xpath+"/tbody/tr")).size();
			int trans_tble_Cols = driver.findElements(By.xpath(annualTble_xpath+"/thead/tr/th")).size();
			String sectionName = null;
			
			if(common.currentRunningFlow.equalsIgnoreCase("Rewind") && TestBase.businessEvent.equalsIgnoreCase("MTA")){
				
				if(!PremiumFlag)
				for(int i =1;i<=trans_tble_Rows-1;i++){
					String annualTblXpath2 = "/tbody/tr["+i+"]/td[1]";
					sectionName = driver.findElement(By.xpath(annualTble_xpath+annualTblXpath2)).getText().replaceAll(" ", "");
					if(sectionName.contains("Totals"))
						sectionName = "Total";
					if(sectionName.contains("BusinesssInterruption"))
						sectionName = "BusinessInterruption";
					if(sectionName.equalsIgnoreCase("AbbeyLegalExpenses")){
						sectionName = "LegalExpenses";
					}
					if(sectionName.equalsIgnoreCase("GoodsinTransit")){
						sectionName = "GoodsInTransit";
					}
					if(((String)common.NB_excel_data_map.get("CD_"+sectionName)).equals("No") && ((String)common.MTA_excel_data_map.get("CD_"+sectionName)).equals("No") && ((String)common.Rewind_excel_data_map.get("CD_"+sectionName)).equals("Yes")){
						if(sectionName.contains("PersonalAccident")){
							sectionName="PersonalAccident";
						}
						if(sectionName.contains("GoodsInTransit")){
							sectionName="GoodsinTransit";
						}
					
						customAssert.assertTrue(funcAddInput_PremiumSummary(sectionName,section_map.get(sectionName),data_map),"Add Premium Summary Input function having issues for "+sectionName);
						if(((String)data_map.get("PS_TaxExempt")).equalsIgnoreCase("Yes")){
							data_map.put("PS_"+sectionName+"_IPT", "0.0");
						}else{
							data_map.put("PS_"+sectionName+"_IPT", "12");
						}
					}else{
						if(sectionName.contains("GoodsInTransit")){
							sectionName="GoodsinTransit";
						}
						String cover_name = section_map.get(sectionName);
						String PencCommXpath , BrokerCommXpath;
						if(cover_name.contains("md")){
							PencCommXpath = "//*[@name='md_ccc"+"_penr']";
							BrokerCommXpath ="//*[@name='md_ccc"+"_comr']" ;
						}else if(cover_name.contains("el")){
							PencCommXpath = "//*[@name='el_ccc"+"_penr']";
							BrokerCommXpath ="//*[@name='el_ccc"+"_comr']" ;
						}else{
							 PencCommXpath = "//*[contains(@id,'_"+cover_name+"_penr')]";
							 BrokerCommXpath ="//*[contains(@id,'_"+cover_name+"_comr')]";
						}
						
						String penComm = driver.findElement(By.xpath(PencCommXpath)).getAttribute("value");
						String BrokComm = driver.findElement(By.xpath(BrokerCommXpath)).getAttribute("value");
						common.Rewind_excel_data_map.put("PS_"+sectionName+"_PenComm_rate", penComm);
						common.Rewind_excel_data_map.put("PS_"+sectionName+"_BrokerComm_rate", BrokComm);
					}
				}
			}
			if(common.currentRunningFlow.equalsIgnoreCase("Rewind") && TestBase.businessEvent.equalsIgnoreCase("Rewind")){
				
				if(!PremiumFlag)
					for(int i =1;i<=trans_tble_Rows-1;i++){
						String annualTblXpath2 = "/tbody/tr["+i+"]/td[1]";
						sectionName = driver.findElement(By.xpath(annualTble_xpath+annualTblXpath2)).getText().replaceAll(" ", "");
						if(sectionName.contains("Totals"))
							sectionName = "Total";
						if(sectionName.contains("BusinesssInterruption"))
							sectionName = "BusinessInterruption";
						if(sectionName.contains("AbbeyLegalExpenses"))
							sectionName = "LegalExpenses";
					
						customAssert.assertTrue(funcAddInput_PremiumSummary(sectionName,section_map.get(sectionName),data_map),"Add Premium Summary Input function having issues for "+sectionName);
						if(((String)data_map.get("PS_TaxExempt")).equalsIgnoreCase("Yes")){
							data_map.put("PS_"+sectionName+"_IPT", "0.0");
						}else{
							data_map.put("PS_"+sectionName+"_IPT", "12");
						}
					}
			}
			if(common.currentRunningFlow.equalsIgnoreCase("Rewind") && TestBase.businessEvent.equalsIgnoreCase("Renewal")){
				
				if(!PremiumFlag)
					for(int i =1;i<=trans_tble_Rows-1;i++){
						String annualTblXpath2 = "/tbody/tr["+i+"]/td[1]";
						sectionName = driver.findElement(By.xpath(annualTble_xpath+annualTblXpath2)).getText().replaceAll(" ", "");
						if(sectionName.contains("Totals"))
							sectionName = "Total";
						if(sectionName.contains("BusinesssInterruption"))
							sectionName = "BusinessInterruption";
					
						customAssert.assertTrue(funcAddInput_PremiumSummary(sectionName,section_map.get(sectionName),data_map),"Add Premium Summary Input function having issues for "+sectionName);
						if(((String)data_map.get("PS_TaxExempt")).equalsIgnoreCase("Yes")){
							data_map.put("PS_"+sectionName+"_IPT", "0.0");
						}else{
							data_map.put("PS_"+sectionName+"_IPT", "12");
						}
					}
			}
			
			if(common.currentRunningFlow.equalsIgnoreCase("Requote")){
				
				if(!PremiumFlag)
				for(int i =1;i<=trans_tble_Rows-1;i++){
					String annualTblXpath2 = "/tbody/tr["+i+"]/td[1]";
					sectionName = driver.findElement(By.xpath(annualTble_xpath+annualTblXpath2)).getText().replaceAll(" ", "");
					if(sectionName.contains("Totals"))
						sectionName = "Total";
					if(sectionName.contains("BusinesssInterruption"))
						sectionName = "BusinessInterruption";
				
					customAssert.assertTrue(funcAddInput_PremiumSummary(sectionName,section_map.get(sectionName),data_map),"Add Premium Summary Input function having issues for "+sectionName);
					if(((String)data_map.get("PS_TaxExempt")).equalsIgnoreCase("Yes")){
						data_map.put("PS_"+sectionName+"_IPT", "0.0");
					}else{
						data_map.put("PS_"+sectionName+"_IPT", "12");
					}
				}
			
			}
			
			if(common.currentRunningFlow.equalsIgnoreCase("MTA")){
				
				//if(!PremiumFlag)
				for(int i =1;i<=trans_tble_Rows-1;i++){
					String annualTblXpath2 = "/tbody/tr["+i+"]/td[1]";
					sectionName = driver.findElement(By.xpath(annualTble_xpath+annualTblXpath2)).getText().replaceAll(" ", "");
					
					switch(sectionName){
					
					
					case "BusinesssInterruption":
						//code = "BusinessInterruption";
						sectionName = "BusinessInterruption";
						break;
					
					
					case "PersonalAccident":
						//code = "PersonalAccidentStandard";
						sectionName = "PersonalAccidentStandard";
						break;
					
					case "GoodsinTransit":
						//code = "GoodsInTransit";
						sectionName = "GoodsInTransit";
					case "AbbeyLegalExpenses":
						//code = "GoodsInTransit";
						sectionName = "LegalExpenses";
						break;
					
					
					}
					if(sectionName.contains("Totals"))
						sectionName = "Total";
					if(CommonFunction.businessEvent.equalsIgnoreCase("Renewal") && common.currentRunningFlow.equalsIgnoreCase("MTA")){
						if(((String)common.Renewal_excel_data_map.get("CD_"+sectionName)).equals("No") && ((String)common.MTA_excel_data_map.get("CD_"+sectionName)).equals("Yes")){
							if(sectionName.contains("PersonalAccident")){
								sectionName="PersonalAccident";
							}
							if(sectionName.contains("GoodsInTransit")){
								sectionName="GoodsinTransit";
							}
							customAssert.assertTrue(funcAddInput_PremiumSummary(sectionName,section_map.get(sectionName),data_map),"Add Premium Summary Input function having issues for "+sectionName);
							if(((String)data_map.get("PS_TaxExempt")).equalsIgnoreCase("Yes")){
								data_map.put("PS_"+sectionName+"_IPT", "0.0");
							}else{
								data_map.put("PS_"+sectionName+"_IPT", "12");
							}
						}else{
							String cover_name = section_map.get(sectionName);
							String PencCommXpath , BrokerCommXpath;
							if(cover_name.contains("md")){
								PencCommXpath = "//*[@name='md_ccc"+"_penr']";
								BrokerCommXpath ="//*[@name='md_ccc"+"_comr']" ;
							}else if(cover_name.contains("el")){
								PencCommXpath = "//*[@name='el_ccc"+"_penr']";
								BrokerCommXpath ="//*[@name='el_ccc"+"_comr']" ;
							}else{
								 PencCommXpath = "//*[contains(@id,'_"+cover_name+"_penr')]";
								 BrokerCommXpath ="//*[contains(@id,'_"+cover_name+"_comr')]";
							}
							
							String penComm = driver.findElement(By.xpath(PencCommXpath)).getAttribute("value");
							String BrokComm = driver.findElement(By.xpath(BrokerCommXpath)).getAttribute("value");
							common.MTA_excel_data_map.put("PS_"+sectionName+"_PenComm_rate", penComm);
							common.MTA_excel_data_map.put("PS_"+sectionName+"_BrokerComm_rate", BrokComm);
									
							
						}
					}else{
						
						if(((String)common.NB_excel_data_map.get("CD_"+sectionName)).equals("No") && ((String)common.MTA_excel_data_map.get("CD_"+sectionName)).equals("Yes")){
							if(sectionName.contains("PersonalAccident")){
								sectionName="PersonalAccident";
							}
							if(sectionName.contains("GoodsInTransit")){
								sectionName="GoodsinTransit";
							}
							if(sectionName.contains("AbbeyLegalExpenses")){
								sectionName = "LegalExpenses";
							}
							customAssert.assertTrue(funcAddInput_PremiumSummary(sectionName,section_map.get(sectionName),data_map),"Add Premium Summary Input function having issues for "+sectionName);
							if(((String)data_map.get("PS_TaxExempt")).equalsIgnoreCase("Yes")){
								data_map.put("PS_"+sectionName+"_IPT", "0.0");
							}else{
								data_map.put("PS_"+sectionName+"_IPT", "12");
							}
						}else{
							
							if(sectionName.contains("PersonalAccident")){
								sectionName="PersonalAccident";
							}
							
							if(sectionName.contains("GoodsInTransit")){
								sectionName="GoodsinTransit";
							}
							if(sectionName.contains("AbbeyLegalExpenses")){
								sectionName = "LegalExpenses";
							}
							
							String cover_name = section_map.get(sectionName);
							String PencCommXpath , BrokerCommXpath;
							if(cover_name.contains("md")){
								PencCommXpath = "//*[@name='md_ccc"+"_penr']";
								BrokerCommXpath ="//*[@name='md_ccc"+"_comr']" ;
							}else if(cover_name.contains("el")){
								PencCommXpath = "//*[@name='el_ccc"+"_penr']";
								BrokerCommXpath ="//*[@name='el_ccc"+"_comr']" ;
							}else{
								 PencCommXpath = "//*[contains(@id,'_"+cover_name+"_penr')]";
								 BrokerCommXpath ="//*[contains(@id,'_"+cover_name+"_comr')]";
							}
							if(TestBase.product.equals("XOQ")||TestBase.product.equals("XOC")){
								PencCommXpath = "//*[contains(@id,'_"+cover_name+"_sec_penr')]";
								 BrokerCommXpath ="//*[contains(@id,'_"+cover_name+"_sec_comr')]";
								
							}
							String penComm = driver.findElement(By.xpath(PencCommXpath)).getAttribute("value");
							String BrokComm = driver.findElement(By.xpath(BrokerCommXpath)).getAttribute("value");
							common.MTA_excel_data_map.put("PS_"+sectionName+"_PenComm_rate", penComm);
							common.MTA_excel_data_map.put("PS_"+sectionName+"_BrokerComm_rate", BrokComm);
						}
					}
				}
			}
			
			PremiumFlag = true;		
			customAssert.assertTrue(k.Click("CCF_Btn_Save"), "Unable to click on Save Button on Premium Summary .");
			
			//if(((String)data_map.get("CD_SolicitorsPI")).equals("Yes")){
				
			for(int i =1;i<=trans_tble_Rows-1;i++){
				String annualTblXpath2 = "/tbody/tr["+i+"]/td[1]";
				sectionName = driver.findElement(By.xpath(annualTble_xpath+annualTblXpath2)).getText().replaceAll(" ", "");
				if(sectionName.contains("AbbeyLegalExpenses")){
					sectionName = "LegalExpenses";}
				else if(sectionName.contains("Totals")){
					sectionName = "Total";
				}
				err_count = err_count + func_PremiumSummaryCalculation_MTA(section_map.get(sectionName),sectionName,locator_map);
				exp_Premium = exp_Premium + Double.parseDouble((String)data_map.get("PS_"+sectionName+"_TotalPremium"));
			}
			
			double Total_GP = 00.00;
			double Total_GT = 00.00;
			double Total_NetNetPemium = 00.00,Total_PenComm = 00.00,Total_NetPremium=00.00 ,Total_BrokComm = 00.00, Total_InsTax = 0.00;
			
			for(int i =1;i<=trans_tble_Rows-1;i++){
				String annualTblXpath2 = "/tbody/tr["+i+"]/td[1]";
				sectionName = driver.findElement(By.xpath(annualTble_xpath+annualTblXpath2)).getText().replaceAll(" ", "");
				if(sectionName.contains("AbbeyLegalExpenses")){
					sectionName = "LegalExpenses";}
				else if(sectionName.contains("Totals")){
					sectionName = "Total";}
				Total_GP = Total_GP + Double.parseDouble((String)data_map.get("PS_"+sectionName+"_GP"));
				Total_GT = Total_GT + Double.parseDouble((String)data_map.get("PS_"+sectionName+"_GT"));
				Total_NetNetPemium = Total_NetNetPemium + Double.parseDouble((String)data_map.get("PS_"+sectionName+"_NetNetPremium"));
				Total_PenComm = Total_PenComm + Double.parseDouble((String)data_map.get("PS_"+sectionName+"_PenComm"));
				Total_BrokComm = Total_BrokComm + Double.parseDouble((String)data_map.get("PS_"+sectionName+"_BrokerComm"));
				Total_NetPremium = Total_NetPremium + Double.parseDouble((String)data_map.get("PS_"+sectionName+"_NetPremium"));
			}
			
			data_map.put("PS_Total_GT", f.format(Total_GT));
			data_map.put("PS_Total_GP", f.format(Total_GP));
			data_map.put("PS_TotalPremium", f.format(exp_Premium));
			data_map.put("PS_NetNetPemiumTotal", f.format(Total_NetNetPemium));
			data_map.put("PS_BrokerCommissionTotal", f.format(Total_BrokComm));
			data_map.put("PS_PenCommTotal", f.format(Total_PenComm));
			
	
			String exp_Total_Premium = common.roundedOff(Double.toString(exp_Premium));
			String act_Total_Premium = k.getAttribute("SPI_Total_Premium", "value");
			act_Total_Premium = act_Total_Premium.replaceAll(",", "");
			
			TestUtil.reportStatus("---------------Total Premium-----------------","Info",false);
			
			CommonFunction.compareValues(Double.parseDouble(exp_Total_Premium),Double.parseDouble(act_Total_Premium),"Total Premium.");
			
			return true;
		  
		}catch(Throwable t){
					return false;
			
		}
	}

	public boolean funcAddInput_PremiumSummary(String code, String cover_name,Map<Object,Object> data_map) {
		boolean retvalue=true;
		try{
			//cob_pl_pr_penr
			String PencCommXpath =null;
			String BrokerCommXpath =null;
			
			if(TestBase.product.contains("XOC")|| TestBase.product.contains("XOQ")){
				PencCommXpath = "//*[@name='xoc_"+cover_name+"_sec_penr']";
				BrokerCommXpath ="//*[@name='xoc_"+cover_name+"_sec_comr']" ;
			}else if(TestBase.product.contains("LEA")){
				PencCommXpath = "//*[@name='"+cover_name+"_penr']";
				BrokerCommXpath ="//*[@name='"+cover_name+"_comr']" ;
			}else{
				 PencCommXpath = "//*[contains(@id,'_"+cover_name+"_penr')]";
				 BrokerCommXpath ="//*[contains(@id,'_"+cover_name+"_comr')]";
			}
			customAssert.assertTrue(k.InputByXpath(PencCommXpath, (String)data_map.get("PS_"+code+"_PenComm_rate")), "Unable to enter value of Pen Commission for "+cover_name+".");
			customAssert.assertTrue(k.InputByXpath(BrokerCommXpath, (String)data_map.get("PS_"+code+"_BrokerComm_rate")), "Unable to enter value of Broker Commission for "+cover_name+".");
			return retvalue;
			
		}catch(Throwable t) {
	        String methodName = new Object(){}.getClass().getEnclosingMethod().getName();
	        TestUtil.reportFunctionFailed("Failed in "+methodName+" function");
	        Assert.fail("Premium Summary Add Input function is having issue(S). \n", t);
	        return false;
	 }
	}
	
	public int func_PremiumSummaryCalculation_MTA(String code,String covername,Map<String,String> premium_loc) {
		
		Map<Object,Object> map_data = null;
		Map<Object,Object> Tax_map_data = new HashMap<>();
		
		String event=null;
		
		
		switch(TestBase.businessEvent){
			case "NB":
				map_data = common.NB_excel_data_map;
				Tax_map_data = common.NB_excel_data_map;
			break;
			case "Rewind":
				if(common.currentRunningFlow.equals("NB")){
					map_data = common.NB_excel_data_map;
					Tax_map_data = common.NB_excel_data_map;
					event = "NB";
					}
				else{
					map_data = common.Rewind_excel_data_map;
					Tax_map_data = common.Rewind_excel_data_map;
					event = "Rewind";
					
				}
			break;
			case "Requote":
				if(common.currentRunningFlow.equals("NB")){
					map_data = common.NB_excel_data_map;
					Tax_map_data = common.NB_excel_data_map;
					event = "NB";
					}
				else{
					map_data = common.Requote_excel_data_map;
					Tax_map_data = common.Requote_excel_data_map;
					event = "Requote";
					
				}
			break;
			case "MTA":
				if(common.currentRunningFlow.equals("NB")){
					map_data = common.NB_excel_data_map;
					Tax_map_data = common.NB_excel_data_map;
					event = "NB";
					}
				else if(CommonFunction.businessEvent.equalsIgnoreCase("MTA") && common.currentRunningFlow.equalsIgnoreCase("Rewind")){
					map_data = common.Rewind_excel_data_map;
					Tax_map_data = common.MTA_excel_data_map;
					event = "Rewind";
				}
				else{
					map_data = common.MTA_excel_data_map;
					Tax_map_data = common.NB_excel_data_map;
					event = "MTA";
					
				}
				break;	
			case "Renewal":
				if(CommonFunction.businessEvent.equalsIgnoreCase("Renewal") && common.currentRunningFlow.equalsIgnoreCase("MTA")){
					map_data = common.MTA_excel_data_map;
					Tax_map_data = common.Renewal_excel_data_map;
					event = "MTA";
				}else if(CommonFunction.businessEvent.equalsIgnoreCase("Renewal") && common.currentRunningFlow.equalsIgnoreCase("Rewind")){
					map_data = common.Rewind_excel_data_map;
					Tax_map_data = common.Renewal_excel_data_map;
					event = "Rewind";
				}else{
					map_data = common.Renewal_excel_data_map;
					Tax_map_data = common.Renewal_excel_data_map;
					event = "Renewal";
				}
				break;
			case "CAN":
				if(common.currentRunningFlow.equals("NB")){
					map_data = common.NB_excel_data_map;
					Tax_map_data = common.NB_excel_data_map;
					event = "NB";
					}
				else{
					map_data = common.CAN_excel_data_map;
					Tax_map_data = common.CAN_excel_data_map;
					event = "CAN";				
				}
				
			break;	
			
		}
			String testName = (String)map_data.get("Automation Key");
			
			double NetNet_Premium = Double.parseDouble((String)map_data.get("PS_"+covername+"_NetNetPremium"));
			
		try{
				
				TestUtil.reportStatus("---------------"+covername+"-----------------","Info",false);
				//SPI Pen commission Calculation : 
				double pen_comm = ((NetNet_Premium / (1-((Double.parseDouble((String)map_data.get("PS_"+covername+"_PenComm_rate")) + Double.parseDouble((String)map_data.get("PS_"+covername+"_BrokerComm_rate")))/100)))*((Double.parseDouble((String)map_data.get("PS_"+covername+"_PenComm_rate"))/100)));
				String pc_expected = common.roundedOff(Double.toString(pen_comm));
				if(code.contains("md"))
					code = "md_ccc_";
				else if(TestBase.product.equals("XOC")||TestBase.product.equals("XOQ")){
					code="_"+code+"_sec_";
				}
				else
				code="_"+code+"_";
				
				
									
				String pc_actual = k.getAttributeByXpath("//*[contains(@id,'"+code+premium_loc.get("PenComm")+"')]", "value");
				CommonFunction.compareValues(Double.parseDouble(pc_expected),Double.parseDouble(pc_actual),"Pen Commission");
				map_data.put("PS_"+covername+"_PenComm",pc_expected);
				
				// Net Premium verification : 
				double netP = Double.parseDouble(pc_expected) + NetNet_Premium;
				String netP_expected = common.roundedOff(Double.toString(netP));
				String netP_actual = k.getAttributeByXpath("//*[contains(@id,'"+code+premium_loc.get("NetPremium")+"')]", "value");
				CommonFunction.compareValues(Double.parseDouble(netP_expected),Double.parseDouble(netP_actual),"Net Premium");
				map_data.put("PS_"+covername+"_NetPremium",netP_expected);
				
				// Broker commission Calculation : 
				double broker_comm = ((NetNet_Premium / (1-((Double.parseDouble((String)map_data.get("PS_"+covername+"_PenComm_rate")) + Double.parseDouble((String)map_data.get("PS_"+covername+"_BrokerComm_rate")))/100)))*((Double.parseDouble((String)map_data.get("PS_"+covername+"_BrokerComm_rate"))/100)));
				String bc_expected = common.roundedOff(Double.toString(broker_comm));
				String bc_actual =  k.getAttributeByXpath("//*[contains(@id,'"+code+premium_loc.get("BrokerComm")+"')]", "value");
				CommonFunction.compareValues(Double.parseDouble(bc_expected),Double.parseDouble(bc_actual),"Broker Commission");
				map_data.put("PS_"+covername+"_BrokerComm",bc_expected);
				
				// GrossPremium verification :  
				double grossP = Double.parseDouble(netP_expected) + Double.parseDouble(bc_expected);
				
				if(!covername.contains("Terrorism") && !covername.contains("PersonalAccidentOptional")){
					PremiumExcTerrDocExp = PremiumExcTerrDocExp + grossP;
				}else if(!covername.contains("Terrorism") ){
					TerPremDocExp = grossP;
				}
				
				String grossP_actual = k.getAttributeByXpath("//*[contains(@id,'"+code+premium_loc.get("GrossPremium")+"')]", "value");
				
				if(!covername.contains("Terrorism") && !covername.contains("PersonalAccidentOptional")){
					PremiumExcTerrDocAct = PremiumExcTerrDocAct + Double.parseDouble(grossP_actual);
				}else if(covername.contains("Terrorism")){
					TerPremDocAct = Double.parseDouble(grossP_actual);
				}
		
				
				CommonFunction.compareValues(grossP,Double.parseDouble(grossP_actual),"Gross Premium");
				map_data.put("PS_"+covername+"_GP",(grossP_actual));
				
				if(!common_CCD.isGrossPremiumReferralCheckDone){
					//Section minimum  Premium Referral Messages - For MD, BI, El, PL, Money , GIT
					if(!covername.contains("PersonalAccident") && !covername.contains("LegalExpenses") && !covername.contains("Terrorism")){
						customAssert.assertTrue(common_CCD.func_Check_Section_Minimum_Gross_Premium(covername,grossP), "Error while verifying section minimum gross premium . ");
					}
				}
				
				if(common.currentRunningFlow.equals("MTA")){
					if(((String)map_data.get("PS_TaxExempt")).equalsIgnoreCase("Yes"))
						Tax_map_data.put("PS_"+covername+"_IPT", "0.0");
					
				}
					
				if(!common.currentRunningFlow.equalsIgnoreCase("NB")){
					String InsuranceTax = k.getAttributeByXpath("//*[contains(@id,'"+code+premium_loc.get("InsuranceTax")+"')]", "value");
					double IPT = (Double.parseDouble(InsuranceTax) / grossP) * 100.0;
					TestUtil.WriteDataToXl(TestBase.product+"_"+event, "Premium Summary",(String)map_data.get("Automation Key"), "PS_"+covername+"_IPT", common_HHAZ.roundedOff(Double.toString(IPT)), map_data);
				}
				
				double InsuranceTax = (grossP * Double.parseDouble((String)map_data.get("PS_"+covername+"_IPT")))/100.0;
				//InsuranceTax = Double.parseDouble(common.roundedOff(Double.toString(InsuranceTax)));
				String InsuranceTax_actual = k.getAttributeByXpath("//*[contains(@id,'"+code+premium_loc.get("InsuranceTax")+"')]", "value");
				
				if(covername.contains("Terrorism")){
					InsTaxTerrDoc = Double.parseDouble(InsuranceTax_actual);
				}
				if(!covername.contains("Terrorism") && !covername.contains("PersonalAccidentOptional")){
				InsTaxDocAct = InsTaxDocAct + Double.parseDouble(InsuranceTax_actual);
				InsTaxDocExp = InsTaxDocExp + InsuranceTax;
				}
				
				CommonFunction.compareValues(InsuranceTax,Double.parseDouble(InsuranceTax_actual),"Insurance Tax");
				map_data.put("PS_"+covername+"_GT",Double.toString(InsuranceTax));
				
				//SPI Total Premium verification : 
				double Premium = grossP + InsuranceTax;
				String p_expected = common.roundedOff(Double.toString(Premium));
				
				String p_actual = common.roundedOff(k.getAttributeByXpath("//*[contains(@id,'"+code+"tot')]", "value"));
				
				TotalPremiumWithAdminDocAct = TotalPremiumWithAdminDocAct + Double.parseDouble(p_actual);
				TotalPremiumWithAdminDocExp = TotalPremiumWithAdminDocExp + Double.parseDouble(p_expected);
				
				double premium_diff = Double.parseDouble(common.roundedOff(Double.toString(Double.parseDouble(p_expected) - Double.parseDouble(p_actual))));
				
				if(premium_diff<=0.20 && premium_diff>=-0.20){
					TestUtil.reportStatus("Total Premium [<b> "+p_expected+" </b>] matches with actual total premium [<b> "+p_actual+" </b>]as expected for "+covername+" on premium summary page.", "Pass", false);
					map_data.put("PS_"+covername+"_TotalPremium", p_expected);
					return 0;
					
				}else{
					TestUtil.reportStatus("<p style='color:red'> Mismatch in Expected Premium [<b> "+p_expected+"</b>] and Actual Premium [<b> "+p_actual+"</b>] for "+code+" on premium summary page. </p>", "Fail", true);
					map_data.put("PS_"+covername+"_TotalPremium", p_expected);
					return 1;
				}
					
		}catch(Throwable t) { 
	        String methodName = new Object(){}.getClass().getEnclosingMethod().getName();
	        TestUtil.reportFunctionFailed("Failed in "+methodName+" function");
	        Assert.fail("Insured Properties function is having issue(S). \n", t);
	        return 0;
	 }
		
	}
	
	
	//Reusable for both NB and MTA
	public int func_PremiumSummaryCalculation(String code,String covername,Map<String,String> premium_loc) {
		
		Map<Object,Object> map_data = null;
		
		String event=null;
		
		
		switch(TestBase.businessEvent){
			case "NB":
				map_data = common.NB_excel_data_map;
			break;
			case "MTA":
				if(common.currentRunningFlow.equals("NB")){
					map_data = common.NB_excel_data_map;
					event = "NB";
					}
				else if(common.currentRunningFlow.equals("Rewind")){
					map_data = common.Rewind_excel_data_map;
					event = "Rewind";
				}else{
					map_data = common.MTA_excel_data_map;
					event = "MTA";
					
				}
				break;	
			case "Rewind":
				if(common.currentRunningFlow.equals("NB")){
					map_data = common.NB_excel_data_map;
					event = "NB";
					}
				else{
					map_data = common.Rewind_excel_data_map;
					event = "Rewind";
					
				}
				break;	
			case "Renewal":
				if(common.currentRunningFlow.equals("Rewind")){
					map_data = common.Rewind_excel_data_map;
					event = "Rewind";
					}
				else{
					map_data = common.Renewal_excel_data_map;
					event = "Renewal";				
				}
				
				break;
			case "CAN":
				if(common.currentRunningFlow.equals("NB")){
					map_data = common.NB_excel_data_map;
					event = "NB";
					}
				else{
					map_data = common.CAN_excel_data_map;
					event = "CAN";				
				}
			case "Requote":
				if(common.currentRunningFlow.equals("NB")){
					map_data = common.NB_excel_data_map;
					event = "NB";
					}
				else{
					map_data = common.Requote_excel_data_map;
					event = "Requote";
					
				}
			break;
						
		}
			String testName = (String)map_data.get("Automation Key");
			double NetNet_Premium = Double.parseDouble((String)map_data.get("PS_"+covername+"_NetNetPremium"));
			if(common.currentRunningFlow.equalsIgnoreCase("MTA")){
			if(((String)common.NB_excel_data_map.get("CD_"+covername)).equals("Yes") && ((String)common.MTA_excel_data_map.get("CD_"+covername)).equals("No")){
				NetNet_Premium = Double.parseDouble((String)common.NB_excel_data_map.get("PS_"+covername+"_NetNetPremium"));
				map_data = common.NB_excel_data_map;
			}
			}
			
		try{
				
				TestUtil.reportStatus("---------------"+covername+"-----------------","Info",false);
				//SPI Pen commission Calculation : 
				double pen_comm = ((NetNet_Premium / (1-((Double.parseDouble((String)map_data.get("PS_"+covername+"_PenComm_rate")) + Double.parseDouble((String)map_data.get("PS_"+covername+"_BrokerComm_rate")))/100)))*((Double.parseDouble((String)map_data.get("PS_"+covername+"_PenComm_rate"))/100)));
				String pc_expected = common.roundedOff(Double.toString(pen_comm));
				if(TestBase.product.contains("XOC")|| TestBase.product.contains("XOQ")){
					code = code+"_sec";}
					
				String pc_actual = k.getAttributeByXpath("//*[contains(@id,'_"+code+"_"+premium_loc.get("PenComm")+"')]", "value");
				//String pc_actual = driver.findElement(By.xpath("//*[contains(@id,'_"+val_cover+"_"+premium_loc.get("PenComm")+"')]"))
				CommonFunction.compareValues(Double.parseDouble(pc_expected),Double.parseDouble(pc_actual),"Pen Commission");
				//customAssert.assertTrue(WriteDataToXl(TestBase.product+"_"+common.currentRunningFlow,"Premium Summary",testName,"PS_"+covername+"_PenComm",pc_expected,map_data),"Error while writing Pen Commission for cover "+covername+" to excel .");
				map_data.put("PS_"+covername+"_PenComm",pc_expected);
				
				// Net Premium verification : 
				double netP = Double.parseDouble(pc_expected) + NetNet_Premium;
				String netP_expected = common.roundedOff(Double.toString(netP));
				String netP_actual = k.getAttributeByXpath("//*[contains(@id,'_"+code+"_"+premium_loc.get("NetPremium")+"')]", "value");
				CommonFunction.compareValues(Double.parseDouble(netP_expected),Double.parseDouble(netP_actual),"Net Premium");
				//customAssert.assertTrue(WriteDataToXl(TestBase.product+"_"+common.currentRunningFlow, "Premium Summary", testName, "PS_"+covername+"_NetPremium",netP_expected,map_data),"Error while writing Net Premium for cover "+code+" to excel .");
				map_data.put("PS_"+covername+"_NetPremium",netP_expected);
				
				// Broker commission Calculation : 
				double broker_comm = ((NetNet_Premium / (1-((Double.parseDouble((String)map_data.get("PS_"+covername+"_PenComm_rate")) + Double.parseDouble((String)map_data.get("PS_"+covername+"_BrokerComm_rate")))/100)))*((Double.parseDouble((String)map_data.get("PS_"+covername+"_BrokerComm_rate"))/100)));
				String bc_expected = common.roundedOff(Double.toString(broker_comm));
				String bc_actual =  k.getAttributeByXpath("//*[contains(@id,'_"+code+"_"+premium_loc.get("BrokerComm")+"')]", "value");
				CommonFunction.compareValues(Double.parseDouble(bc_expected),Double.parseDouble(bc_actual),"Broker Commission");
				//customAssert.assertTrue(WriteDataToXl(TestBase.product+"_"+common.currentRunningFlow, "Premium Summary", testName, "PS_"+covername+"_BrokerComm",bc_expected,map_data),"Error while writing Broker Commission for cover "+code+" to excel .");
				map_data.put("PS_"+covername+"_BrokerComm",bc_expected);
				
				// GrossPremium verification :  
				double grossP = Double.parseDouble(netP_expected) + Double.parseDouble(bc_expected);
				String grossP_actual = k.getAttributeByXpath("//*[contains(@id,'_"+code+"_"+premium_loc.get("GrossPremium")+"')]", "value");
				if(code.equals("PI"))
					PI_pdf_GrossPremium = Double.parseDouble(grossP_actual);
				else
					SEL_pdf_GrossPremium = Double.parseDouble(grossP_actual);
				CommonFunction.compareValues(grossP,Double.parseDouble(grossP_actual),"Gross Premium");
				//customAssert.assertTrue(WriteDataToXl(TestBase.product+"_"+common.currentRunningFlow, "Premium Summary", testName, "PS_"+covername+"_GP",(grossP_actual),map_data),"Error while writing Gross Premium for cover "+covername+" to excel .");
				map_data.put("PS_"+covername+"_GP",(grossP_actual));
				
				/*double InsuranceTax = (grossP * Double.parseDouble((String)map_data.get("PS_"+covername+"_IPT")))/100.0;
				//InsuranceTax = Double.parseDouble(common.roundedOff(Double.toString(InsuranceTax)));
				String InsuranceTax_actual = k.getAttributeByXpath("//*[contains(@id,'_"+code+"_"+premium_loc.get("InsuranceTax")+"')]", "value");
				if(code.equals("PI"))
					PI_pdf_InsuranceTax = Double.parseDouble(InsuranceTax_actual);
				else
					SEL_pdf_InsuranceTax = Double.parseDouble(InsuranceTax_actual);
				//CommonFunction.compareValues(InsuranceTax,Double.parseDouble(InsuranceTax_actual),"Insurance Tax");
				//customAssert.assertTrue(WriteDataToXl(TestBase.product+"_"+common.currentRunningFlow, "Premium Summary", testName, "PS_"+covername+"_GT",Double.toString(InsuranceTax),map_data),"Error while writing Total Premium for cover "+covername+" to excel .");
				map_data.put("PS_"+covername+"_GT",Double.toString(InsuranceTax));*/
				
				//Insurance tax verification : 
				double InsuranceTax1 = 0.0;
				if(!common.currentRunningFlow.equalsIgnoreCase("NB")){
					
					String InsuranceTax = k.getAttributeByXpath("//*[contains(@id,'"+code+"_"+premium_loc.get("InsuranceTax")+"')]", "value");
					
					if(grossP == 0.00 || InsuranceTax.equals("0.00")){
						InsuranceTax1 = 0.00;
					}else{
						double IPT = (Double.parseDouble(InsuranceTax) / grossP) * 100.0;
						InsuranceTax1 = (grossP * IPT)/100.0;
					}
					
					}else{
					InsuranceTax1 = (grossP * Double.parseDouble((String)map_data.get("PS_"+covername+"_IPT")))/100.0;
				}
				
				String InsuranceTax_actual = k.getAttributeByXpath("//*[contains(@id,'"+code+"_"+premium_loc.get("InsuranceTax")+"')]", "value");
			    CommonFunction.compareValues(InsuranceTax1,Double.parseDouble(InsuranceTax_actual),"Insurance Tax");
				map_data.put("PS_"+covername+"_GT",Double.toString(InsuranceTax1));
				
				//SPI Total Premium verification : 
				double Premium = grossP + InsuranceTax1;
				String p_expected = common.roundedOff(Double.toString(Premium));
				
				String p_actual = common.roundedOff(k.getAttributeByXpath("//*[contains(@id,'_"+code+"_"+"tot')]", "value"));
				
				double premium_diff = Double.parseDouble(common.roundedOff(Double.toString(Double.parseDouble(p_expected) - Double.parseDouble(p_actual))));
				
				if(premium_diff<=0.20 && premium_diff>=-0.20){
					TestUtil.reportStatus("Total Premium [<b> "+p_expected+" </b>] matches with actual total premium [<b> "+p_actual+" </b>]as expected for "+covername+" on premium summary page.", "Pass", false);
					//customAssert.assertTrue(WriteDataToXl(TestBase.product+"_"+common.currentRunningFlow, "Premium Summary", testName, "PS_"+covername+"_TotalPremium", p_expected,map_data),"Error while writing Total Premium for cover "+code+" to excel .");
					map_data.put("PS_"+covername+"_TotalPremium", p_expected);
					return 0;
				}else{
					TestUtil.reportStatus("<p style='color:red'> Mismatch in Expected Premium [<b> "+p_expected+"</b>] and Actual Premium [<b> "+p_actual+"</b>] for "+code+" on premium summary page. </p>", "Fail", true);
					//customAssert.assertTrue(WriteDataToXl(TestBase.product+"_"+common.currentRunningFlow, "Premium Summary", testName, "PS_"+covername+"_TotalPremium", p_expected,map_data),"Error while writing Total Premium for cover "+code+" to excel .");
					map_data.put("PS_"+covername+"_TotalPremium", p_expected);
					return 1;
				}
					
		}catch(Throwable t) { 
	        String methodName = new Object(){}.getClass().getEnclosingMethod().getName();
	        TestUtil.reportFunctionFailed("Failed in "+methodName+" function");
	        Assert.fail("Insured Properties function is having issue(S). \n", t);
	        return 0;
	 }
		
	}
	public double[] funcTransactionDetailsTable_Verification_New_MTA(String sectionName,Map<String,Map<String,Double>> transactionDetails_Premium_Values){

		Map<Object,Object> map_data = common.MTA_excel_data_map;
		Map<Object,Object> NB_map_data = common.NB_excel_data_map;
		transaction_Details_Premium_Values = new HashMap<>();
//		transaction_Details_Premium_Values =null; 
		//String testName = (String)map_data.get("Automation Key");
		double NB_PI_NNP = 0.0;
		double totalGrossPremium = 0.00, totalInsTax=0.00;
		
		double NB_SEL_NNP = 0.0,MTA_SEL_NNP=0.0;
		double totalNetNetPremium = 0.0,totalPenComm = 0.0, totalNetPremium= 0.00;
		double totalBroakerComm = 0.0,totalTotalPremium=0.0,final_trans_NNP=0.0;
		String code=null;
		int p_NB_Duration = 0,p_MTA_Remaining_Duration=0;
		if(Integer.parseInt((String)common.NB_excel_data_map.get("PS_Duration"))!=365)
			p_NB_Duration = 365;
		else
			p_NB_Duration = Integer.parseInt((String)common.NB_excel_data_map.get("PS_Duration"));
		
		p_MTA_Remaining_Duration = Integer.parseInt((String)common.MTA_excel_data_map.get("MTA_EndorsementPeriod"));
		try{
		List<WebElement> row = driver.findElements(By.xpath("html/body/div[3]/form/div/table[4]/tbody/tr"));
		//System.out.println(row.size());
		int rcount1 = row.size();
		String Trax_table = "html/body/div[3]/form/div/table[4]";
		String tXpath =Trax_table+"/tbody/tr";
		for(int i =1;i<=rcount1;i++){
			String sectionXpath = tXpath+"["+i+"]/td[1]";
			String sec_name = driver.findElement(By.xpath(sectionXpath)).getText();
			Map<String,Double> transaction_Section_Vals = new HashMap<>();
		switch(sec_name){
		case "Public & ProductsLiability":
			code = "ppl";
			sec_name = "Public&ProductsLiability";
			break;
		case "Public & Products Liability":
			code = "ppl";
			sec_name = "Public&ProductsLiability";
			break;
		case "Employers Liability":
			code = "el";
			sec_name = "EmployersLiability";
			break;
		case "Annual Works":
			code = "acw";
			sec_name = "AnnualWorks"; 
			break;
		case "Single Project":
			code = "pcw";
			sec_name = "SingleProject";
			break;
		case "Own Plant":
			code = "op";
			sec_name = "OwnPlant";
			break;
		case "Hire Cover Plus":
			code = "hcp";
			sec_name = "OwnPlant";
			break;
		case "Hired In Plant":
			code = "hp";
			sec_name = "HiredInPlant";
			break;
		case "JCT 6.5.1":
			code = "jc";
			sec_name = "JCT6.5.1";
			break;
		case "Terrorism":
			code = "ter";
			sec_name = "Terrorism";
			break;
		case "Property Owners Liability":
			code = "pol";
			sec_name = "PropertyOwnersLiability";
			break;
		case "Abbey Legal Expenses":
			code = "le";
			sec_name = "LegalExpenses";
			break;	
		case "Third Party Motor Liability":
			code = "tp";
			sec_name = "ThirdPartyMotorLiability";
			break;	
		case "Totals":
			code = "le";
			sec_name = "Totals";
			break;	
		default:
				System.out.println("**Cover Name is not in Scope for COB**");
			break;
		}	
		TestUtil.reportStatus("---------------"+sec_name+"-----------------","Info",false);
		sectionName = sec_name;
		if(sec_name.equalsIgnoreCase("Totals"))
				{
			        transaction_Section_Vals.put("Net Net Premium",totalNetNetPremium);
			        transaction_Section_Vals.put("Pen Comm",totalPenComm);
			        transaction_Section_Vals.put("Net Premium",totalNetPremium);
			        transaction_Section_Vals.put("Broaker Comm",totalBroakerComm);
			        transaction_Section_Vals.put("Gross Premium",totalGrossPremium);
			        transaction_Section_Vals.put("Insurance Tax",totalInsTax);
			        transaction_Section_Vals.put("Total Premium",totalTotalPremium);
			        
				}else{
					
					if(common_COB.MTARewindFlow.equalsIgnoreCase("Yes") || common_COA.MTARewindFlow.equalsIgnoreCase("Yes") ){
						if(((String)common.NB_excel_data_map.get("CD_"+sec_name.replaceAll("\\s",""))).equals("Yes") && ((String)common.MTA_excel_data_map.get("CD_"+sec_name.replaceAll("\\s",""))).equals("Yes") && ((String)common.MTA_excel_data_map.get("CD_Add_"+sec_name.replaceAll("\\s",""))).equals("Yes"))
						{
							NB_SEL_NNP = Double.parseDouble((String)common.NB_excel_data_map.get("PS_"+sec_name+"_NetNetPremium"));
							MTA_SEL_NNP = Double.parseDouble((String)common.MTA_excel_data_map.get("PS_"+sec_name+"_NetNetPremium"));
							map_data = common.MTA_excel_data_map;
						}else if(((String)common.NB_excel_data_map.get("CD_"+sec_name.replaceAll("\\s",""))).equals("Yes") && ((String)common.MTA_excel_data_map.get("CD_"+sec_name.replaceAll("\\s",""))).equals("No") && ((String)common.MTA_excel_data_map.get("CD_Add_"+sec_name.replaceAll("\\s",""))).equals("Yes")){
							NB_SEL_NNP = Double.parseDouble((String)common.NB_excel_data_map.get("PS_"+sec_name+"_NetNetPremium"));
							MTA_SEL_NNP = Double.parseDouble((String)common.MTA_excel_data_map.get("PS_"+sec_name+"_NetNetPremium"));
							map_data = common.MTA_excel_data_map;
						}else if(((String)common.NB_excel_data_map.get("CD_"+sec_name.replaceAll("\\s",""))).equals("Yes") && ((String)common.MTA_excel_data_map.get("CD_"+sec_name.replaceAll("\\s",""))).equals("Yes") && ((String)common.MTA_excel_data_map.get("CD_Add_"+sec_name.replaceAll("\\s",""))).equals("No")){
							NB_SEL_NNP = Double.parseDouble((String)common.NB_excel_data_map.get("PS_"+sec_name+"_NetNetPremium"));
							MTA_SEL_NNP = 0.00;
							map_data = common.MTA_excel_data_map;
						}else if(((String)common.NB_excel_data_map.get("CD_"+sec_name.replaceAll("\\s",""))).equals("Yes") && ((String)common.MTA_excel_data_map.get("CD_"+sec_name.replaceAll("\\s",""))).equals("No") && ((String)common.MTA_excel_data_map.get("CD_Add_"+sec_name.replaceAll("\\s",""))).equals("No")){
							NB_SEL_NNP = Double.parseDouble((String)common.NB_excel_data_map.get("PS_"+sec_name+"_NetNetPremium"));
							MTA_SEL_NNP = 0.00;
							map_data = common.NB_excel_data_map;
						}else if(((String)common.NB_excel_data_map.get("CD_"+sec_name.replaceAll("\\s",""))).equals("No") && ((String)common.MTA_excel_data_map.get("CD_"+sec_name.replaceAll("\\s",""))).equals("Yes") && ((String)common.MTA_excel_data_map.get("CD_Add_"+sec_name.replaceAll("\\s",""))).equals("Yes")){
							NB_SEL_NNP = 0.00;
							MTA_SEL_NNP = Double.parseDouble((String)common.MTA_excel_data_map.get("PS_"+sec_name+"_NetNetPremium"));
							map_data = common.MTA_excel_data_map;
						}else if(((String)common.NB_excel_data_map.get("CD_"+sec_name.replaceAll("\\s",""))).equals("No") && ((String)common.MTA_excel_data_map.get("CD_"+sec_name.replaceAll("\\s",""))).equals("No") && ((String)common.MTA_excel_data_map.get("CD_Add_"+sec_name.replaceAll("\\s",""))).equals("Yes")){
							map_data = common.MTA_excel_data_map;
							NB_SEL_NNP = 0.00;
							MTA_SEL_NNP = Double.parseDouble((String)common.MTA_excel_data_map.get("PS_"+sec_name+"_NetNetPremium"));
						} if(((String)common.NB_excel_data_map.get("CD_"+sec_name.replaceAll("\\s",""))).equals("No") && ((String)common.MTA_excel_data_map.get("CD_"+sec_name.replaceAll("\\s",""))).equals("Yes") && ((String)common.MTA_excel_data_map.get("CD_Add_"+sec_name.replaceAll("\\s",""))).equals("No")){
							NB_SEL_NNP = 0.00;
							MTA_SEL_NNP = Double.parseDouble((String)common.MTA_excel_data_map.get("PS_"+sec_name+"_NetNetPremium"));
							map_data = common.MTA_excel_data_map;
						}
					}else{
						if(((String)common.NB_excel_data_map.get("CD_"+sec_name.replaceAll("\\s",""))).equals("Yes") && ((String)common.MTA_excel_data_map.get("CD_"+sec_name.replaceAll("\\s",""))).equals("No"))
						{
							NB_SEL_NNP = Double.parseDouble((String)common.NB_excel_data_map.get("PS_"+sec_name+"_NetNetPremium"));
							MTA_SEL_NNP = 0.0;
						}else if(((String)common.NB_excel_data_map.get("CD_"+sec_name.replaceAll("\\s",""))).equals("No") && ((String)common.MTA_excel_data_map.get("CD_"+sec_name.replaceAll("\\s",""))).equals("Yes")){
							NB_SEL_NNP = 0.0;
							MTA_SEL_NNP = Double.parseDouble((String)common.MTA_excel_data_map.get("PS_"+sec_name+"_NetNetPremium"));
						}else{
							NB_SEL_NNP = Double.parseDouble((String)common.NB_excel_data_map.get("PS_"+sec_name+"_NetNetPremium"));
							MTA_SEL_NNP = Double.parseDouble((String)common.MTA_excel_data_map.get("PS_"+sec_name+"_NetNetPremium"));
						}
					}
					
					
						
						final_trans_NNP = ((MTA_SEL_NNP - NB_SEL_NNP)/p_NB_Duration)*
								((Integer.parseInt((String)common.NB_excel_data_map.get("PS_Duration")) - Integer.parseInt((String)common.MTA_excel_data_map.get("MTA_EndorsementPeriod"))));

			String t_NetNetP_actual = driver.findElement(By.xpath(tXpath+"["+i+"]/td[2]")).getText();
			CommonFunction.compareValues(Double.parseDouble(t_NetNetP_actual),final_trans_NNP," Net Net Premium");
			transaction_Section_Vals.put("Net Net Premium", final_trans_NNP);
			totalNetNetPremium= totalNetNetPremium + final_trans_NNP;
			//common_VELA.transaction_Details_Premium_Values.put("PS_"+sec_name+"NetNetPremium", final_trans_NNP);
			
			
			double t_pen_comm = (( Double.parseDouble(t_NetNetP_actual) / (1-((Double.parseDouble((String)map_data.get("PS_"+sec_name+"_PenComm_rate")) + Double.parseDouble((String)map_data.get("PS_"+sec_name+"_BrokerComm_rate")))/100)))*((Double.parseDouble((String)map_data.get("PS_"+sec_name+"_PenComm_rate"))/100)));
			String t_pc_expected = common.roundedOff(Double.toString(t_pen_comm));
			String t_pc_actual = driver.findElement(By.xpath(tXpath+"["+i+"]/td[4]")).getText();
			CommonFunction.compareValues(Double.parseDouble(t_pc_expected),Double.parseDouble(t_pc_actual)," Pen Commission");
			totalPenComm =totalPenComm + t_pen_comm;
			transaction_Section_Vals.put("Pen Commission", t_pen_comm);
			
			double t_netP = Double.parseDouble(t_pc_expected) + (final_trans_NNP);
			String t_netP_expected = common.roundedOff(Double.toString(t_netP));
			String t_netP_actual = driver.findElement(By.xpath(tXpath+"["+i+"]/td[5]")).getText();
			CommonFunction.compareValues(Double.parseDouble(t_netP_expected),Double.parseDouble(t_netP_actual),"Net Premium");
			totalNetPremium = totalNetPremium + t_netP;
			transaction_Section_Vals.put("Net Premium", t_netP);
			
			double t_broker_comm = (((final_trans_NNP) / (1-((Double.parseDouble((String)map_data.get("PS_"+sec_name+"_PenComm_rate")) + Double.parseDouble((String)map_data.get("PS_"+sec_name+"_BrokerComm_rate")))/100)))*((Double.parseDouble((String)map_data.get("PS_"+sec_name+"_BrokerComm_rate"))/100)));
			String t_bc_expected = common.roundedOff(Double.toString(t_broker_comm));
			String t_bc_actual =  driver.findElement(By.xpath(tXpath+"["+i+"]/td[7]")).getText();
			CommonFunction.compareValues(Double.parseDouble(t_bc_expected),Double.parseDouble(t_bc_actual),"Broker Commission");
			totalBroakerComm =totalBroakerComm + t_broker_comm;
			transaction_Section_Vals.put("Broker Commission", t_broker_comm);
				
			double t_grossP = Double.parseDouble(t_netP_expected) + Double.parseDouble(t_bc_expected);
			String t_grossP_actual = driver.findElement(By.xpath(tXpath+"["+i+"]/td[9]")).getText();
			CommonFunction.compareValues(t_grossP,Double.parseDouble(t_grossP_actual)," Gross Premium");
			totalGrossPremium = totalGrossPremium + t_grossP;
			transaction_Section_Vals.put("Gross Premium", t_grossP);
			
			double t_InsuranceTax = (t_grossP * Double.parseDouble((String)map_data.get("PS_"+sec_name+"_IPT")))/100.0;
			t_InsuranceTax = Double.parseDouble(common.roundedOff(Double.toString(t_InsuranceTax)));
			String t_InsuranceTax_actual = driver.findElement(By.xpath(tXpath+"["+i+"]/td[11]")).getText();
			CommonFunction.compareValues(t_InsuranceTax,Double.parseDouble(t_InsuranceTax_actual),"Insurance Tax");
			totalInsTax = totalInsTax + t_InsuranceTax;
			transaction_Section_Vals.put("Insurance Tax", t_InsuranceTax);
			 
			double totalPremium = t_grossP + t_InsuranceTax;
			String t_TotalgrossPremium = driver.findElement(By.xpath(tXpath+"["+i+"]/td[12]")).getText();
			CommonFunction.compareValues(totalPremium,Double.parseDouble(t_TotalgrossPremium),"Total Gross Premium");
			transaction_Section_Vals.put("Total Premium", totalPremium);
			totalTotalPremium = totalTotalPremium + totalPremium;
			
			}
			common_VELA.transaction_Details_Premium_Values.put(sec_name, transaction_Section_Vals);
		}
			//Transaction Total Premium verification : 
			double t_Premium = totalGrossPremium + totalInsTax + Double.parseDouble((String)common.MTA_excel_data_map.get("PS_AdminFee"));
			String t_p_expected = common.roundedOff(Double.toString(t_Premium));
			
			String t_p_actual = driver.findElement(By.xpath("//*[@id='table0']/tbody/tr[5]/td[3]")).getText().replaceAll(",", "").replaceAll("", "");
			
			double premium_diff = Double.parseDouble(t_p_expected) - Double.parseDouble(t_p_actual);
	//		transaction_Section_Vals.put("Total Premium", Double.parseDouble(t_p_expected));
		//	common_VELA.transaction_Details_Premium_Values.put("Total", new Hashmap<"Total Premium", Double.parseDouble(t_p_expected)>);
			
			if(premium_diff<0.09 && premium_diff>-0.09){
				TestUtil.reportStatus("Total Premium [<b> "+t_p_expected+" </b>] matches with actual total premium [<b> "+t_p_actual+" </b>]as expected for "+sectionName+" in Transaction Details table .", "Pass", false);
				//customAssert.assertTrue(WriteDataToXl(TestBase.product+"_"+TestBase.businessEvent, "Premium Summary", testName, "PS_"+code+"_TotalPremium", p_expected,common.NB_excel_data_map),"Error while writing Total Premium for cover "+code+" to excel .");
				return new double[] {totalGrossPremium,totalInsTax };
			}else{
				TestUtil.reportStatus("<p style='color:red'> Mismatch in Expected Premium [<b> "+t_p_expected+"</b>] and Actual Premium [<b> "+t_p_actual+"</b>] for "+sectionName+" in Transaction Details table . </p>", "Fail", true);
				//customAssert.assertTrue(WriteDataToXl(TestBase.product+"_"+TestBase.businessEvent, "Premium Summary", testName, "PS_"+code+"_TotalPremium", p_expected,common.NB_excel_data_map),"Error while writing Total Premium for cover "+code+" to excel .");
				return new double[] {totalGrossPremium,totalInsTax};
			}	
	}catch(Throwable t) {
	    String methodName = new Object(){}.getClass().getEnclosingMethod().getName();
	    TestUtil.reportFunctionFailed("Failed in "+methodName+" function");
	    Assert.fail("Transaction Premium verification issue.  \n", t);
		return new double[] {0, 0};
	}
		
	}


public int func_TransactionDetailsCalculation(String code,String covername,Map<String,String> premium_loc) {
		
		Map<Object,Object> map_data = null;
		
		String event=null;
		
		
		switch(TestBase.businessEvent){
			case "NB":
				map_data = common.NB_excel_data_map;
			break;
			case "MTA":
				if(common.currentRunningFlow.equals("NB")){
					map_data = common.NB_excel_data_map;
					event = "NB";
					}
				else{
					map_data = common.MTA_excel_data_map;
					event = "MTA";
					
				}
				break;	
			case "Renewal":
				map_data = common.Renewal_excel_data_map;
				break;
			case "CAN":
				if(common.currentRunningFlow.equals("NB")){
					map_data = common.NB_excel_data_map;
					event = "NB";
					}
				else{
					map_data = common.CAN_excel_data_map;
					event = "CAN";				
				}
				
			break;	
			
		}
			String testName = (String)map_data.get("Automation Key");
			double NetNet_Premium = Double.parseDouble((String)map_data.get("PS_"+covername+"_NetNetPremium"));
		try{
				
				TestUtil.reportStatus("---------------"+covername+"-----------------","Info",false);
				//SPI Pen commission Calculation : 
				double pen_comm = ((NetNet_Premium / (1-((Double.parseDouble((String)map_data.get("PS_"+covername+"_PenComm_rate")) + Double.parseDouble((String)map_data.get("PS_"+covername+"_BrokerComm_rate")))/100)))*((Double.parseDouble((String)map_data.get("PS_"+covername+"_PenComm_rate"))/100)));
				String pc_expected = common.roundedOff(Double.toString(pen_comm));
				if(TestBase.product.contains("XOC")|| TestBase.product.contains("XOQ")){
					code = code+"_sec";}
					
				String pc_actual = k.getAttributeByXpath("//p[text()=' Transaction Premium']//following-sibling:://*[contains(@id,'_"+code+"_"+premium_loc.get("PenComm")+"')]", "value");
				//String pc_actual = driver.findElement(By.xpath("//*[contains(@id,'_"+val_cover+"_"+premium_loc.get("PenComm")+"')]"))
				CommonFunction.compareValues(Double.parseDouble(pc_expected),Double.parseDouble(pc_actual),"Pen Commission");
				//customAssert.assertTrue(WriteDataToXl(TestBase.product+"_"+common.currentRunningFlow,"Premium Summary",testName,"PS_"+covername+"_PenComm",pc_expected,map_data),"Error while writing Pen Commission for cover "+covername+" to excel .");
				map_data.put("PS_"+covername+"_PenComm",pc_expected);
				
				// Net Premium verification : 
				double netP = Double.parseDouble(pc_expected) + NetNet_Premium;
				String netP_expected = common.roundedOff(Double.toString(netP));
				String netP_actual = k.getAttributeByXpath("//*[contains(@id,'_"+code+"_"+premium_loc.get("NetPremium")+"')]", "value");
				CommonFunction.compareValues(Double.parseDouble(netP_expected),Double.parseDouble(netP_actual),"Net Premium");
				//customAssert.assertTrue(WriteDataToXl(TestBase.product+"_"+common.currentRunningFlow, "Premium Summary", testName, "PS_"+covername+"_NetPremium",netP_expected,map_data),"Error while writing Net Premium for cover "+code+" to excel .");
				map_data.put("PS_"+covername+"_NetPremium",netP_expected);
				
				// Broker commission Calculation : 
				double broker_comm = ((NetNet_Premium / (1-((Double.parseDouble((String)map_data.get("PS_"+covername+"_PenComm_rate")) + Double.parseDouble((String)map_data.get("PS_"+covername+"_BrokerComm_rate")))/100)))*((Double.parseDouble((String)map_data.get("PS_"+covername+"_BrokerComm_rate"))/100)));
				String bc_expected = common.roundedOff(Double.toString(broker_comm));
				String bc_actual =  k.getAttributeByXpath("//*[contains(@id,'_"+code+"_"+premium_loc.get("BrokerComm")+"')]", "value");
				CommonFunction.compareValues(Double.parseDouble(bc_expected),Double.parseDouble(bc_actual),"Broker Commission");
				//customAssert.assertTrue(WriteDataToXl(TestBase.product+"_"+common.currentRunningFlow, "Premium Summary", testName, "PS_"+covername+"_BrokerComm",bc_expected,map_data),"Error while writing Broker Commission for cover "+code+" to excel .");
				map_data.put("PS_"+covername+"_BrokerComm",bc_expected);
				
				// GrossPremium verification :  
				double grossP = Double.parseDouble(netP_expected) + Double.parseDouble(bc_expected);
				String grossP_actual = k.getAttributeByXpath("//*[contains(@id,'_"+code+"_"+premium_loc.get("GrossPremium")+"')]", "value");
				if(code.equals("PI"))
					PI_pdf_GrossPremium = Double.parseDouble(grossP_actual);
				else
					SEL_pdf_GrossPremium = Double.parseDouble(grossP_actual);
				CommonFunction.compareValues(grossP,Double.parseDouble(grossP_actual),"Gross Premium");
				//customAssert.assertTrue(WriteDataToXl(TestBase.product+"_"+common.currentRunningFlow, "Premium Summary", testName, "PS_"+covername+"_GP",(grossP_actual),map_data),"Error while writing Gross Premium for cover "+covername+" to excel .");
				map_data.put("PS_"+covername+"_GP",(grossP_actual));
				
				double InsuranceTax = (grossP * Double.parseDouble((String)map_data.get("PS_"+covername+"_IPT")))/100.0;
				//InsuranceTax = Double.parseDouble(common.roundedOff(Double.toString(InsuranceTax)));
				String InsuranceTax_actual = k.getAttributeByXpath("//*[contains(@id,'_"+code+"_"+premium_loc.get("InsuranceTax")+"')]", "value");
				if(code.equals("PI"))
					PI_pdf_InsuranceTax = Double.parseDouble(InsuranceTax_actual);
				else
					SEL_pdf_InsuranceTax = Double.parseDouble(InsuranceTax_actual);
				//CommonFunction.compareValues(InsuranceTax,Double.parseDouble(InsuranceTax_actual),"Insurance Tax");
				//customAssert.assertTrue(WriteDataToXl(TestBase.product+"_"+common.currentRunningFlow, "Premium Summary", testName, "PS_"+covername+"_GT",Double.toString(InsuranceTax),map_data),"Error while writing Total Premium for cover "+covername+" to excel .");
				map_data.put("PS_"+covername+"_GT",Double.toString(InsuranceTax));
				
				//SPI Total Premium verification : 
				double Premium = grossP + InsuranceTax;
				String p_expected = common.roundedOff(Double.toString(Premium));
				
				String p_actual = common.roundedOff(k.getAttributeByXpath("//*[contains(@id,'_"+code+"_"+"tot')]", "value"));
				
				double premium_diff = Double.parseDouble(common.roundedOff(Double.toString(Double.parseDouble(p_expected) - Double.parseDouble(p_actual))));
				
				if(premium_diff<=0.20 && premium_diff>=-0.20){
					TestUtil.reportStatus("Total Premium [<b> "+p_expected+" </b>] matches with actual total premium [<b> "+p_actual+" </b>]as expected for "+covername+" on premium summary page.", "Pass", false);
					//customAssert.assertTrue(WriteDataToXl(TestBase.product+"_"+common.currentRunningFlow, "Premium Summary", testName, "PS_"+covername+"_TotalPremium", p_expected,map_data),"Error while writing Total Premium for cover "+code+" to excel .");
					map_data.put("PS_"+covername+"_TotalPremium", p_expected);
					return 0;
				}else{
					TestUtil.reportStatus("<p style='color:red'> Mismatch in Expected Premium [<b> "+p_expected+"</b>] and Actual Premium [<b> "+p_actual+"</b>] for "+code+" on premium summary page. </p>", "Fail", true);
					//customAssert.assertTrue(WriteDataToXl(TestBase.product+"_"+common.currentRunningFlow, "Premium Summary", testName, "PS_"+covername+"_TotalPremium", p_expected,map_data),"Error while writing Total Premium for cover "+code+" to excel .");
					map_data.put("PS_"+covername+"_TotalPremium", p_expected);
					return 1;
				}
					
		}catch(Throwable t) { 
	        String methodName = new Object(){}.getClass().getEnclosingMethod().getName();
	        TestUtil.reportFunctionFailed("Failed in "+methodName+" function");
	        Assert.fail("Insured Properties function is having issue(S). \n", t);
	        return 0;
	 }
		
	}
	
	//Reusable for both NB and MTA
		public int func_PremiumSummaryCalculation_LEA(String code,String covername,Map<String,String> premium_loc) {
			
			Map<Object,Object> map_data = null;
			
			String event=null;
			
			
			switch(TestBase.businessEvent){
				case "NB":
					map_data = common.NB_excel_data_map;
				break;
				case "MTA":
					if(common_SPI.currentFlow.equals("NB")){
						map_data = common.NB_excel_data_map;
						event = "NB";
						}
					else{
						map_data = common.MTA_excel_data_map;
						event = "MTA";
						
					}
					break;	
				case "Rewind":
					if(common.currentRunningFlow.equals("NB")){
						map_data = common.NB_excel_data_map;
						event = "NB";
						}
					else{
						map_data = common.Rewind_excel_data_map;
						event = "Rewind";
						
					}
					break;	
				case "Renewal":
					map_data = common.Renewal_excel_data_map;
					break;
				case "CAN":
					if(common.currentRunningFlow.equals("NB")){
						map_data = common.NB_excel_data_map;
						event = "NB";
						}
					else{
						map_data = common.CAN_excel_data_map;
						event = "CAN";				
					}
				break;
				case "Requote":
					if(common.currentRunningFlow.equals("NB")){
						map_data = common.NB_excel_data_map;
						event = "NB";
						}
					else{
						map_data = common.Requote_excel_data_map;
						event = "Requote";
						
					}
				break;	
				
			}
				String testName = (String)map_data.get("Automation Key");
				double NetNet_Premium = Double.parseDouble((String)map_data.get("PS_"+covername+"_NetNetPremium"));
				
				//String val_cover = null;
//				switch(code){
//				case "PI":
//					val_cover = "pi";
//					break;
//				case "SEL":
//					val_cover = "el";
//					break;
//				default:
//						System.out.println("**Cover Name is not in Scope for SPI**");
//					break;
//				
//				}
				//val_cover = code;
				
//				if(code.equals("SEL") && common.currentRunningFlow.equals("MTA") && ((String)map_data.get("Automation Key")).contains("MTA_02")){
//					
//					try{
//					String SEL_penComm_type = k.getAttributeByXpath("//*[contains(@id,'_"+val_cover+"_"+premium_loc.get("PenComm")+"')]", "type");
//					if(SEL_penComm_type.equals("text")){
//					
//						TestUtil.reportStatus("Solicitors Excess Layers's Pen/Broker commission should not be editable on premium Summary page . ", "Fail", true);
//						ErrorUtil.addVerificationFailure(new Throwable("Solicitors Excess Layers's Pen/Broker commission editability issue on premium Summary page"));
//					}
//					}catch(Throwable t){
//						String isSEL_penComm_readOnly = k.getAttributeByXpath("//*[contains(@id,'_"+val_cover+"_"+premium_loc.get("PenComm")+"')]", "readonly");
//						if(!isSEL_penComm_readOnly.equals("true")){
//							TestUtil.reportStatus("Solicitors Excess Layers's Pen/Broker commission should not be editable on premium Summary page . ", "Fail", true);
//							ErrorUtil.addVerificationFailure(new Throwable("Solicitors Excess Layers's Pen/Broker commission editability issue on premium Summary page"));
//						}
//					}
//					
//				}
				
			try{
					
					TestUtil.reportStatus("---------------"+covername+"-----------------","Info",false);
					//SPI Pen commission Calculation : 
					double pen_comm = ((NetNet_Premium / (1-((Double.parseDouble((String)map_data.get("PS_"+covername+"_PenComm_rate")) + Double.parseDouble((String)map_data.get("PS_"+covername+"_BrokerComm_rate")))/100)))*((Double.parseDouble((String)map_data.get("PS_"+covername+"_PenComm_rate"))/100)));
					String pc_expected = common.roundedOff(Double.toString(pen_comm));
					if(TestBase.product.contains("XOC")|| TestBase.product.contains("XOQ")){
						code = code+"_sec";}
						
					String pc_actual = k.getAttributeByXpath("//*[contains(@id,'"+code+"_"+premium_loc.get("PenComm")+"')]", "value");
					//String pc_actual = driver.findElement(By.xpath("//*[contains(@id,'_"+val_cover+"_"+premium_loc.get("PenComm")+"')]"))
					CommonFunction.compareValues(Double.parseDouble(pc_expected),Double.parseDouble(pc_actual),"Pen Commission");
					//customAssert.assertTrue(WriteDataToXl(TestBase.product+"_"+common.currentRunningFlow,"Premium Summary",testName,"PS_"+covername+"_PenComm",pc_expected,map_data),"Error while writing Pen Commission for cover "+covername+" to excel .");
					map_data.put("PS_"+covername+"_PenComm",pc_expected);
					
					// Net Premium verification : 
					double netP = Double.parseDouble(pc_expected) + NetNet_Premium;
					String netP_expected = common.roundedOff(Double.toString(netP));
					String netP_actual = k.getAttributeByXpath("//*[contains(@id,'"+code+"_"+premium_loc.get("NetPremium")+"')]", "value");
					CommonFunction.compareValues(Double.parseDouble(netP_expected),Double.parseDouble(netP_actual),"Net Premium");
					//customAssert.assertTrue(WriteDataToXl(TestBase.product+"_"+common.currentRunningFlow, "Premium Summary", testName, "PS_"+covername+"_NetPremium",netP_expected,map_data),"Error while writing Net Premium for cover "+code+" to excel .");
					map_data.put("PS_"+covername+"_NetPremium",netP_expected);
					
					// Broker commission Calculation : 
					double broker_comm = ((NetNet_Premium / (1-((Double.parseDouble((String)map_data.get("PS_"+covername+"_PenComm_rate")) + Double.parseDouble((String)map_data.get("PS_"+covername+"_BrokerComm_rate")))/100)))*((Double.parseDouble((String)map_data.get("PS_"+covername+"_BrokerComm_rate"))/100)));
					String bc_expected = common.roundedOff(Double.toString(broker_comm));
					String bc_actual =  k.getAttributeByXpath("//*[contains(@id,'"+code+"_"+premium_loc.get("BrokerComm")+"')]", "value");
					CommonFunction.compareValues(Double.parseDouble(bc_expected),Double.parseDouble(bc_actual),"Broker Commission");
					//customAssert.assertTrue(WriteDataToXl(TestBase.product+"_"+common.currentRunningFlow, "Premium Summary", testName, "PS_"+covername+"_BrokerComm",bc_expected,map_data),"Error while writing Broker Commission for cover "+code+" to excel .");
					map_data.put("PS_"+covername+"_BrokerComm",bc_expected);
					
					// GrossPremium verification :  
					double grossP = Double.parseDouble(netP_expected) + Double.parseDouble(bc_expected);
					String grossP_actual = k.getAttributeByXpath("//*[contains(@id,'"+code+"_"+premium_loc.get("GrossPremium")+"')]", "value");
					if(code.equals("PI"))
						PI_pdf_GrossPremium = Double.parseDouble(grossP_actual);
					else
						SEL_pdf_GrossPremium = Double.parseDouble(grossP_actual);
					CommonFunction.compareValues(grossP,Double.parseDouble(grossP_actual),"Gross Premium");
					//customAssert.assertTrue(WriteDataToXl(TestBase.product+"_"+common.currentRunningFlow, "Premium Summary", testName, "PS_"+covername+"_GP",(grossP_actual),map_data),"Error while writing Gross Premium for cover "+covername+" to excel .");
					map_data.put("PS_"+covername+"_GP",(grossP_actual));
					
					double InsuranceTax = (grossP * Double.parseDouble((String)map_data.get("PS_"+covername+"_IPT")))/100.0;
					InsuranceTax = Double.parseDouble(common.roundedOff(Double.toString(InsuranceTax)));
					String InsuranceTax_actual = k.getAttributeByXpath("//*[contains(@id,'"+code+"_"+premium_loc.get("InsuranceTax")+"')]", "value");
					if(code.equals("PI"))
						PI_pdf_InsuranceTax = Double.parseDouble(InsuranceTax_actual);
					else
						SEL_pdf_InsuranceTax = Double.parseDouble(InsuranceTax_actual);
					CommonFunction.compareValues(InsuranceTax,Double.parseDouble(InsuranceTax_actual),"Insurance Tax");
					//customAssert.assertTrue(WriteDataToXl(TestBase.product+"_"+common.currentRunningFlow, "Premium Summary", testName, "PS_"+covername+"_GT",Double.toString(InsuranceTax),map_data),"Error while writing Total Premium for cover "+covername+" to excel .");
					map_data.put("PS_"+covername+"_GT",Double.toString(InsuranceTax));
					
					//SPI Total Premium verification : 
					double Premium = grossP + InsuranceTax;
					String p_expected = common.roundedOff(Double.toString(Premium));
					
					String p_actual = common.roundedOff(k.getAttributeByXpath("//*[contains(@id,'"+code+"_"+"tot')]", "value"));
					
					double premium_diff = Double.parseDouble(common.roundedOff(Double.toString(Double.parseDouble(p_expected) - Double.parseDouble(p_actual))));
					
					if(premium_diff<=0.20 && premium_diff>=-0.20){
						TestUtil.reportStatus("Total Premium [<b> "+p_expected+" </b>] matches with actual total premium [<b> "+p_actual+" </b>]as expected for "+covername+" on premium summary page.", "Pass", false);
						//customAssert.assertTrue(WriteDataToXl(TestBase.product+"_"+common.currentRunningFlow, "Premium Summary", testName, "PS_"+covername+"_TotalPremium", p_expected,map_data),"Error while writing Total Premium for cover "+code+" to excel .");
						map_data.put("PS_"+covername+"_TotalPremium", p_expected);
						return 0;
						
					}else{
						TestUtil.reportStatus("<p style='color:red'> Mismatch in Expected Premium [<b> "+p_expected+"</b>] and Actual Premium [<b> "+p_actual+"</b>] for "+code+" on premium summary page. </p>", "Fail", true);
						//customAssert.assertTrue(WriteDataToXl(TestBase.product+"_"+common.currentRunningFlow, "Premium Summary", testName, "PS_"+covername+"_TotalPremium", p_expected,map_data),"Error while writing Total Premium for cover "+code+" to excel .");
						map_data.put("PS_"+covername+"_TotalPremium", p_expected);
						return 1;
					}
						
			}catch(Throwable t) { 
		        String methodName = new Object(){}.getClass().getEnclosingMethod().getName();
		        TestUtil.reportFunctionFailed("Failed in "+methodName+" function");
		        Assert.fail("Insured Properties function is having issue(S). \n", t);
		        return 0;
		 }
			
		}

	public boolean func_SPI_Write_Total_PremiumSummary_Values(){
		
		boolean r_value=true;
		String val_total = null,event=null;
		Map<Object,Object> data_map = null;
		
		switch(TestBase.businessEvent){
			case "NB":
				data_map = common.NB_excel_data_map;
			break;
			case "MTA":
				if(common_SPI.currentFlow.equals("NB")){
					data_map = common.NB_excel_data_map;
					
					}
				else{
					data_map = common.MTA_excel_data_map;
					
					
				}
			break;
			case "Renewal":
				
					data_map = common.Renewal_excel_data_map;
				
			break;
			case "CAN":
				if(common_SPI.currentFlow.equals("NB")){
					data_map = common.NB_excel_data_map;				
					}
				else{
					data_map = common.CAN_excel_data_map;
				}
			break;
			
		}
		
		
		
		String testName = (String)data_map.get("Automation Key");
		
		try{
			
		val_total = k.getAttributeByXpath("//*[contains(@name,'_admin_fee')]","value");
		customAssert.assertTrue(WriteDataToXl(TestBase.product+"_"+common.currentRunningFlow, "Premium Summary", testName,"PS_TotalAdminFee",val_total,data_map),"Error while writing Total Admin Fee to excel .");
		
		val_total = k.getAttribute("SPI_Total_NNPremium", "value");
		val_total = val_total.replaceAll(",","");
		customAssert.assertTrue(WriteDataToXl(TestBase.product+"_"+common.currentRunningFlow, "Premium Summary", testName,"PS_NetNetPemiumTotal",val_total,data_map),"Error while writing Total NN Premium to excel .");
		
		val_total = k.getAttribute("SPI_Total_PenComm", "value");
		val_total = val_total.replaceAll(",","");
		customAssert.assertTrue(WriteDataToXl(TestBase.product+"_"+common.currentRunningFlow, "Premium Summary", testName,"PS_PenCommTotal",val_total,data_map),"Error while writing Total Pen Comm. to excel .");
		
		val_total = k.getAttribute("SPI_Total_NPremium", "value");
		val_total = val_total.replaceAll(",","");
		customAssert.assertTrue(WriteDataToXl(TestBase.product+"_"+common.currentRunningFlow, "Premium Summary", testName,"PS_NetPremiumTotal",val_total,data_map),"Error while writing Total Net Premium to excel .");
		
		val_total = k.getAttribute("SPI_Total_BrokerComm", "value");
		val_total = val_total.replaceAll(",","");
		customAssert.assertTrue(WriteDataToXl(TestBase.product+"_"+common.currentRunningFlow, "Premium Summary", testName,"PS_BrokerCommissionTotal",val_total,data_map),"Error while writing Total Broker Comm to excel .");
		
		val_total = k.getAttribute("SPI_Total_GrossPremium", "value");
		val_total = val_total.replaceAll(",","");
		customAssert.assertTrue(WriteDataToXl(TestBase.product+"_"+common.currentRunningFlow, "Premium Summary", testName,"PS_Total_GP",val_total,data_map),"Error while writing Total Gross Premium to excel .");
		
		val_total = k.getAttribute("SPI_Total_InsuranceTax", "value");
		val_total = val_total.replaceAll(",","");
		customAssert.assertTrue(WriteDataToXl(TestBase.product+"_"+common.currentRunningFlow, "Premium Summary", testName,"PS_Total_GT",val_total,data_map),"Error while writing Total IPT to excel .");
		
		return r_value;
		
		}catch(Throwable t){
			
			return false;
			
		}
		
		
	}
	public boolean funcTransactionPremiumTable(String code, String event){
		//Transaction Premium Table
		
		
		Map<Object,Object> data_map = null;
		
			switch(common.currentRunningFlow){
				case "NB":
					data_map = common.NB_excel_data_map;
					break;
				case "Renewal":
					data_map = common.Renewal_excel_data_map;
					break;
				case "MTA":
					data_map = common.MTA_excel_data_map;
					break;
					
			}
		
		
			try{
				String testName = (String)data_map.get("Automation Key");
				k.pressDownKeyonPage();
				customAssert.assertTrue(common.funcPageNavigation("Premium Summary", ""),"Premium Summary page navigations issue(S)");
				
				int policy_Duration = Integer.parseInt((String)data_map.get("PS_Duration"));
				String transactionTble_xpath = "//p[text()=' Transaction Premium']//following-sibling::table[@id='table0']";
				WebElement transaction_Table = driver.findElement(By.xpath(transactionTble_xpath));
				
				List<WebElement> colms = transaction_Table.findElements(By.tagName("th"));
					//Map<SPI,MAP<NNP,12345.67>>
				
				int trans_tble_Rows = transaction_Table.findElements(By.tagName("tr")).size();
				int trans_tble_Cols = colms.size();
				
				List<String> sectionNames = new ArrayList<>();
				String sectionName = null;
				String sectionValue = null;
				String headerName = null;
				
				if(transaction_Table.isDisplayed()){
					
					TestUtil.reportStatus("Transaction Premium Table exist on premium summary page . ", "Info", true);
				
					//For Each Cover Row
					for(int row = 1; row < trans_tble_Rows ;row ++){
						
						WebElement sec_Name = driver.findElement(By.xpath(transactionTble_xpath+"//tbody//tr["+row+"]//td["+1+"]"));
						sectionName = sec_Name.getText();
						
						switch(sectionName){
						
						case "Totals":
							Map<String,Double> transaction_Section_Vals_Total = new HashMap<>();
							//For Each Cols
							for(int col = 2; col <= trans_tble_Cols ;col ++){
						
								////p[text()=' Transaction Premium']//following-sibling::table[@id='table0']//thead//th[2]
								WebElement header_Name = driver.findElement(By.xpath(transactionTble_xpath+"//thead//th["+col+"]"));
								headerName = header_Name.getText();
							
								if(!headerName.contains("Pen Comm %") && !headerName.contains("Broker Comm %") && !headerName.contains("Gross Comm %")
										&& !headerName.contains("Insurance Tax Rate") ){
									WebElement sec_Val = driver.findElement(By.xpath(transactionTble_xpath+"//tbody//tr["+row+"]//td["+col+"]"));
									sectionValue = sec_Val.getText();
									sectionValue = sectionValue.replaceAll(",", "");
									transaction_Section_Vals_Total.put(headerName, Double.parseDouble(sectionValue));
									
								}else{
									continue;
								}
								transaction_Premium_Values.put(sectionName, transaction_Section_Vals_Total);
						}
						
						break;
						
						default:
							Map<String,Double> transaction_Section_Vals = new HashMap<>();
							//For Each Cols
							for(int col = 2; col <= trans_tble_Cols ;col ++){
						
								////p[text()=' Transaction Premium']//following-sibling::table[@id='table0']//thead//th[2]
								WebElement header_Name = driver.findElement(By.xpath(transactionTble_xpath+"//thead//th["+col+"]"));
								headerName = header_Name.getText();
							
								WebElement sec_Val = driver.findElement(By.xpath(transactionTble_xpath+"//tbody//tr["+row+"]//td["+col+"]"));
								sectionValue = sec_Val.getText();
							
								transaction_Section_Vals.put(headerName, Double.parseDouble(sectionValue));
						}
							transaction_Premium_Values.put(sectionName, transaction_Section_Vals);
						
						break;
						
						}
						
					}
					//System.out.println(transaction_Premium_Values);
					
					TestUtil.reportStatus("---------------Transaction Premium table Verification-----------------","Info",false);
					//Transaction table Verification
					for(int row = 1; row < trans_tble_Rows ;row ++){
						WebElement sec_Name = driver.findElement(By.xpath(transactionTble_xpath+"//tbody//tr["+row+"]//td["+1+"]"));
						sectionNames.add(sec_Name.getText());
					}
					for(String s_Name : sectionNames){
						if(s_Name.equals("Totals"))
							trans_error_val = trans_error_val + transactionPremiumTable_Verification_Total(sectionNames,transaction_Premium_Values);
						else
							trans_error_val = trans_error_val + transactionPremiumTable_Verification(policy_Duration,s_Name,transaction_Premium_Values);
						
				
					}
					
					 TestUtil.reportStatus("Transaction Premium table has been verified suceesfully . ", "info", true);
					
				}
				
				if(Integer.parseInt((String)data_map.get("PS_Duration")) != 365){
					//Toal Premium With Admin Fees
					double total_premium_with_admin_fee = transaction_Premium_Values.get("Totals").get("Gross Premium") + 
							transaction_Premium_Values.get("Totals").get("Insurance Tax") +
							Double.parseDouble((String)data_map.get("PS_TotalAdminFee"));
					
					
					
					String exp_Total_Premium_with_Admin_fee = common.roundedOff(Double.toString(total_premium_with_admin_fee));
					k.waitTwoSeconds();
					
					String xPath = "//table[@id='table0']//*//td[text()='Total']//following-sibling::td";
					String act_Total_Premium_with_Admin_fee = k.getTextByXpath(xPath);
					
					act_Total_Premium_with_Admin_fee = act_Total_Premium_with_Admin_fee.replaceAll(",", "");
					double premium_diff = Double.parseDouble(common.roundedOff(Double.toString(Double.parseDouble(exp_Total_Premium_with_Admin_fee) - Double.parseDouble(act_Total_Premium_with_Admin_fee))));
					
					TestUtil.reportStatus("---------------Total Premium with Admin Fees-----------------","Info",false);
					
					if(Math.abs(premium_diff)<=0.20){
						TestUtil.reportStatus("Total Premium with Admin Fees :[<b> "+exp_Total_Premium_with_Admin_fee+" </b>] matches with actual premium [<b> "+act_Total_Premium_with_Admin_fee+"</b>]as expected with some difference upto '0.05' on premium summary page.", "Pass", false);
						customAssert.assertTrue(WriteDataToXl(code+"_"+event, "Premium Summary", testName, "PS_TotalFinalPremium", exp_Total_Premium_with_Admin_fee,data_map),"Error while writing Total Final Premium data to excel .");
					}else{
						TestUtil.reportStatus("Mismatch in Expected Total Premium with Admin Fees [<b> "+exp_Total_Premium_with_Admin_fee+"</b>] and Actual Premium [<b> "+act_Total_Premium_with_Admin_fee+"</b>] on premium summary page.", "Fail", false);
						customAssert.assertTrue(WriteDataToXl(code+"_"+event, "Premium Summary", testName, "PS_TotalFinalPremium", exp_Total_Premium_with_Admin_fee,data_map),"Error while writing Total Final Premium data to excel .");
					}
					}
				
			}catch(Throwable t ){
				return false;
			}
			
			return true;
	}
  
	public int transactionPremiumTable_Verification_Total(List<String> sectionNames,Map<String,Map<String,Double>> transaction_Premium_Values){
		
		try{
		
		
		TestUtil.reportStatus("---------------Totals-----------------","Info",false);
		double exp_value = 0.0;
		for(String section : sectionNames){
			if(!section.contains("Total"))
				exp_value = exp_value + transaction_Premium_Values.get(section).get("Net Net Premium");
		}
		String t_NetNetP_actual = Double.toString(transaction_Premium_Values.get("Totals").get("Net Net Premium"));
		CommonFunction.compareValues(exp_value,Double.parseDouble(t_NetNetP_actual)," Net Net Premium");

		exp_value = 0.0;
		for(String section : sectionNames){
			if(!section.contains("Total"))
				exp_value = exp_value + transaction_Premium_Values.get(section).get("Pen Comm");
		}
		String t_pc_actual = Double.toString(transaction_Premium_Values.get("Totals").get("Pen Comm"));
		CommonFunction.compareValues(exp_value,Double.parseDouble(t_pc_actual)," Pen Commission");
		
		exp_value = 0.0;
		for(String section : sectionNames){
			if(!section.contains("Total"))
				exp_value = exp_value + transaction_Premium_Values.get(section).get("Net Premium");
		}
		String t_netP_actual = Double.toString(transaction_Premium_Values.get("Totals").get("Net Premium"));
		CommonFunction.compareValues(exp_value,Double.parseDouble(t_netP_actual),"Net Premium");
		
		exp_value = 0.0;
		for(String section : sectionNames){
			if(!section.contains("Total"))
				exp_value = exp_value + transaction_Premium_Values.get(section).get("Broker Commission");
		}
		String t_bc_actual =  Double.toString(transaction_Premium_Values.get("Totals").get("Broker Commission"));
		CommonFunction.compareValues(exp_value,Double.parseDouble(t_bc_actual),"Broker Commission");
		
		exp_value = 0.0;
		for(String section : sectionNames){
			if(!section.contains("Total"))
				exp_value = exp_value + transaction_Premium_Values.get(section).get("Gross Premium");
		}
		String t_grossP_actual = Double.toString(transaction_Premium_Values.get("Totals").get("Gross Premium"));
		CommonFunction.compareValues(exp_value,Double.parseDouble(t_grossP_actual)," Gross Premium");
		
		
		exp_value = 0.0;
		for(String section : sectionNames){
			if(!section.contains("Total"))
				exp_value = exp_value + transaction_Premium_Values.get(section).get("Insurance Tax");
		}
		String t_InsuranceTax_actual = Double.toString(transaction_Premium_Values.get("Totals").get("Insurance Tax"));
		CommonFunction.compareValues(exp_value,Double.parseDouble(t_InsuranceTax_actual),"Insurance Tax");
		
		exp_value = 0.0;
		for(String section : sectionNames){
			if(!section.contains("Total"))
				exp_value = exp_value + transaction_Premium_Values.get(section).get("Total Premium");
		}
		String t_p_actual = Double.toString(transaction_Premium_Values.get("Totals").get("Total Premium"));
		double premium_diff = exp_value - Double.parseDouble(t_p_actual);
		
		if(premium_diff<0.05 && premium_diff>-0.05){
			TestUtil.reportStatus("Total Premium [<b> "+exp_value+" </b>] matches with actual total premium [<b> "+t_p_actual+" </b>]as expected for Totals in Transaction Premium table .", "Pass", false);
			return 0;
			
		}else{
			TestUtil.reportStatus("<p style='color:red'> Mismatch in Expected Premium [<b> "+exp_value+"</b>] and Actual Premium [<b> "+t_p_actual+"</b>] for Totals in Transaction Premium table . </p>", "Fail", true);
			return 1;
		}
		
	}catch(Throwable t) {
	    String methodName = new Object(){}.getClass().getEnclosingMethod().getName();
	    TestUtil.reportFunctionFailed("Failed in "+methodName+" function");
	    Assert.fail("Transaction Premium total Section verification issue.  \n", t);
	    return 1;
	}
	}
	public int transactionPremiumTable_Verification(int policy_Duration,String sectionNames,Map<String,Map<String,Double>> transaction_Premium_Values){

		Map<Object,Object> map_data = common.NB_excel_data_map;
		//String testName = (String)map_data.get("Automation Key");
		String code=null;
		if(sectionNames.contains("Legal Expenses")){
			code="LegalExpenses";
		}else{
			code=sectionNames.replace(" ", "");
		}
		
		
		
	try{
			
			TestUtil.reportStatus("---------------"+sectionNames+"-----------------","Info",false);
			
			double annual_NetNetP = Double.parseDouble((String)map_data.get("PS_"+code+"_NetNetPremium"));
			String t_NetNetP_expected = common.roundedOff(Double.toString((annual_NetNetP/365)*policy_Duration));
			String t_NetNetP_actual = Double.toString(transaction_Premium_Values.get(sectionNames).get("Net Net Premium"));
			customAssert.assertTrue(CommonFunction.compareValues(Double.parseDouble(t_NetNetP_expected),Double.parseDouble(t_NetNetP_actual)," Net Net Premium"),"Mismatched Net Net Premium");
			//customAssert.assertTrue(WriteDataToXl(TestBase.product+"_"+TestBase.businessEvent,"Premium Summary",testName,"PS_"+code+"_PenComm",pc_expected,common.NB_excel_data_map),"Error while writing Pen Commission for cover "+code+" to excel .");
			
			// Transaction Pen commission Calculation : 
			double t_pen_comm = (( Double.parseDouble(t_NetNetP_expected) / (1-((Double.parseDouble((String)map_data.get("PS_"+code+"_PenComm_rate")) + Double.parseDouble((String)map_data.get("PS_"+code+"_BrokerComm_rate")))/100)))*((Double.parseDouble((String)map_data.get("PS_"+code+"_PenComm_rate"))/100)));
			String t_pc_expected = common.roundedOff(Double.toString(t_pen_comm));
			String t_pc_actual = Double.toString(transaction_Premium_Values.get(sectionNames).get("Pen Comm"));
			customAssert.assertTrue(CommonFunction.compareValues(Double.parseDouble(t_pc_expected),Double.parseDouble(t_pc_actual)," Pen Commission"),"Mismatched Pen Commission Values");
			//customAssert.assertTrue(WriteDataToXl(TestBase.product+"_"+TestBase.businessEvent,"Premium Summary",testName,"PS_"+code+"_PenComm",pc_expected,common.NB_excel_data_map),"Error while writing Pen Commission for cover "+code+" to excel .");
			
			
			// Transaction Net Premium verification : 
			double t_netP = Double.parseDouble(t_pc_expected) + Double.parseDouble(t_NetNetP_expected);
			String t_netP_expected = common.roundedOff(Double.toString(t_netP));
			String t_netP_actual = Double.toString(transaction_Premium_Values.get(sectionNames).get("Net Premium"));
			customAssert.assertTrue(CommonFunction.compareValues(Double.parseDouble(t_netP_expected),Double.parseDouble(t_netP_actual),"Net Premium"),"Mismatched Net Premium Values");
			//customAssert.assertTrue(WriteDataToXl(TestBase.product+"_"+TestBase.businessEvent, "Premium Summary", testName, "PS_"+code+"_NetPremium",netP_expected,common.NB_excel_data_map),"Error while writing Net Premium for cover "+code+" to excel .");
			
			
			// Transaction Broker commission Calculation : 
			double t_broker_comm = ((Double.parseDouble(t_NetNetP_expected) / (1-((Double.parseDouble((String)map_data.get("PS_"+code+"_PenComm_rate")) + Double.parseDouble((String)map_data.get("PS_"+code+"_BrokerComm_rate")))/100)))*((Double.parseDouble((String)map_data.get("PS_"+code+"_BrokerComm_rate"))/100)));
			String t_bc_expected = common.roundedOff(Double.toString(t_broker_comm));
			String t_bc_actual =  Double.toString(transaction_Premium_Values.get(sectionNames).get("Broker Commission"));
			customAssert.assertTrue(CommonFunction.compareValues(Double.parseDouble(t_bc_expected),Double.parseDouble(t_bc_actual),"Broker Commission"),"Mismatched Broker Commission Values");
			//customAssert.assertTrue(WriteDataToXl(TestBase.product+"_"+TestBase.businessEvent, "Premium Summary", testName, "PS_"+code+"_BrokerComm",bc_expected,common.NB_excel_data_map),"Error while writing Broker Commission for cover "+code+" to excel .");
			
			
			// Transaction GrossPremium verification : 
			double t_grossP = Double.parseDouble(t_netP_expected) + Double.parseDouble(t_bc_expected);
			String t_grossP_actual = Double.toString(transaction_Premium_Values.get(sectionNames).get("Gross Premium"));
			customAssert.assertTrue(CommonFunction.compareValues(t_grossP,Double.parseDouble(t_grossP_actual),sectionNames+" Transaction Gross Premium"),"Mismatched Gross Premium Values");
			//customAssert.assertTrue(WriteDataToXl(TestBase.product+"_"+TestBase.businessEvent, "Premium Summary", testName, "PS_"+code+"_GrossPremium",Double.toString(grossP),common.NB_excel_data_map),"Error while writing Gross Premium for cover "+code+" to excel .");
			
			
			double t_InsuranceTax = (t_grossP * Double.parseDouble((String)map_data.get("PS_"+code+"_IPT")))/100.0;
			t_InsuranceTax = Double.parseDouble(common.roundedOff(Double.toString(t_InsuranceTax)));
			String t_InsuranceTax_actual = Double.toString(transaction_Premium_Values.get(sectionNames).get("Insurance Tax"));
			customAssert.assertTrue(CommonFunction.compareValues(t_InsuranceTax,Double.parseDouble(t_InsuranceTax_actual),"Insurance Tax"),"Mismatched Insurance Tax Values");
			//customAssert.assertTrue(WriteDataToXl(TestBase.product+"_"+TestBase.businessEvent, "Premium Summary", testName, "PS_"+code+"_InsuranceTax",Double.toString(InsuranceTax),common.NB_excel_data_map),"Error while writing Total Premium for cover "+code+" to excel .");
			
			//  Transaction Total Premium verification : 
			double t_Premium = t_grossP + t_InsuranceTax;
			String t_p_expected = common.roundedOff(Double.toString(t_Premium));
			
			String t_p_actual = Double.toString(transaction_Premium_Values.get(sectionNames).get("Total Premium"));
			
			double premium_diff = Double.parseDouble(t_p_expected) - Double.parseDouble(t_p_actual);
			
			if(premium_diff<0.09 && premium_diff>-0.09){
				TestUtil.reportStatus("Total Premium [<b> "+t_p_expected+" </b>] matches with actual total premium [<b> "+t_p_actual+" </b>]as expected for "+sectionNames+" in Transaction Premium table .", "Pass", false);
				//customAssert.assertTrue(WriteDataToXl(TestBase.product+"_"+TestBase.businessEvent, "Premium Summary", testName, "PS_"+code+"_TotalPremium", p_expected,common.NB_excel_data_map),"Error while writing Total Premium for cover "+code+" to excel .");
				return 0;
				
			}else{
				TestUtil.reportStatus("<p style='color:red'> Mismatch in Expected Premium [<b> "+t_p_expected+"</b>] and Actual Premium [<b> "+t_p_actual+"</b>] for "+sectionNames+" in Transaction Premium table . </p>", "Fail", true);
				//customAssert.assertTrue(WriteDataToXl(TestBase.product+"_"+TestBase.businessEvent, "Premium Summary", testName, "PS_"+code+"_TotalPremium", p_expected,common.NB_excel_data_map),"Error while writing Total Premium for cover "+code+" to excel .");
				return 1;
			}
				
	}catch(Throwable t) {
	    String methodName = new Object(){}.getClass().getEnclosingMethod().getName();
	    TestUtil.reportFunctionFailed("Failed in "+methodName+" function");
	    Assert.fail("Transaction Premium verification issue.  \n", t);
	    return 1;
	}
		
	}
	
	//This function is to check " if Rate charged is less than Minimum Rate " referral rule
	public boolean func_Referral_Rating_minimum_Premium(String coverName,String activityName,double adjustedRate){
		
		boolean r_value=false;
		Properties VELA_CPRS_Rater = OR.getORProperties();
		String activity=null,fullcoverName=null;
		double net_Min_Rate=0.0;
		
		try{
			
			switch(coverName){
			case "PL":
				fullcoverName = "Public & Products Liability";
				break;
			case "EL":
				fullcoverName = "Employers Liability";
				break;
			case "Annual Works":
				fullcoverName = "Annual Works";
				break;
			case "Single Project":
				fullcoverName = "Single Project";
				break;
			case "Own Plant":
				fullcoverName = "Own Plant";
				break;
			case "Hired In Plant":
				fullcoverName = "Hired In Plant";
				break;
			}
			
			
			if(activityName.contains("Work Away")){
				activity = activityName.substring("Work Away - ".length());
			}else {	
				activity = activityName;
			}
			net_Min_Rate = get_Net_Minimum_Rate(activity,coverName);
			
			if(adjustedRate < net_Min_Rate){
				common_VELA.referrals_list.add(fullcoverName+"_"+coverName+" rate charged for "+activity+" is below the minimum rate of "+net_Min_Rate+"%");
			}
				
			r_value=true;
		}catch(Throwable t){
			System.out.println("Error in func_Referral_Rating_minimum_Premium "+t.getMessage());
			return false;
		}
		return r_value;
	}
	
	//This function is to check " if Rate charged is less than Minimum Rate " referral rule
		public boolean func_Referral_Rating_minimum_Premium_Plant(String coverName,String activityName,double adjustedRate){
			
			boolean r_value=false;
			Properties VELA_CPRS_Rater = OR.getORProperties();
			String activity=null,fullcoverName=null;
			double net_Min_Rate=0.0;
			
			try{
				
				switch(coverName){
				
				case "Own Plant":
					fullcoverName = "Own Plant";
					break;
				case "Hired In Plant":
					fullcoverName = "Hired In Plant";
					break;
				}
			
				activity = activityName;
				
				net_Min_Rate = get_Net_Minimum_Rate_Plant(activity,coverName);
				
				if(adjustedRate < net_Min_Rate){
					common_VELA.referrals_list.add(fullcoverName+"_"+coverName+" rate charged for "+activity+" is below the minimum rate of "+net_Min_Rate+"%");
				}
					
				r_value=true;
			}catch(Throwable t){
				System.out.println("Error in func_Referral_Rating_minimum_Premium "+t.getMessage());
				return false;
			}
			return r_value;
		}
	
	public double get_Net_Minimum_Rate(String trade_Activity,String cover){
		
		double r_value=0.0;
		DecimalFormat formatter = new DecimalFormat("###.####");
		Properties PLEL_Rater;
		PLEL_Rater = OR.getORProperties();
		String t_activity =null;
		try{
			
			if(cover.equals("Annual Works"))
				cover = "Works";
			
			if(trade_Activity.contains("Bona Fide")){
				t_activity = "Bona_Fide_Sub_Contractors_cent_of_PL_rate_PL_NMR";
			}else{
				t_activity = trade_Activity.replaceAll(" -", "").replaceAll(" ", "_").replaceAll(",", "");
				t_activity = t_activity + "_"+cover + "_NMR";
			}
			
			r_value = Double.parseDouble(PLEL_Rater.getProperty(t_activity));
			r_value = Double.valueOf(formatter.format(r_value));
		
		}catch(Throwable t ){
			//System.out.println("Error while getting Net Minimum Rate for activity > "+trade_Activity+" < "+t.getMessage());
		}
		return r_value;
			
	}
public double get_Net_Minimum_Rate_Plant(String trade_Activity,String cover){
		
		double r_value=0.0;
		DecimalFormat formatter = new DecimalFormat("###.####");
		Properties PLEL_Rater;
		PLEL_Rater = OR.getORProperties();
		String t_activity =null;
		try{
			
			
				t_activity = trade_Activity.replaceAll(" -", "").replaceAll(" ", "_").replaceAll(",", "");
				t_activity = t_activity + "_MIN_RATE";
			
			
			r_value = Double.parseDouble(PLEL_Rater.getProperty(t_activity));
			r_value = Double.valueOf(formatter.format(r_value));
		
		}catch(Throwable t ){
			System.out.println("Error while getting Net Minimum Rate for activity > "+trade_Activity+" < "+t.getMessage());
		}
		return r_value;
			
	}
	
	/**
	 * 
	 * This method verifies Referral Rules on Quote Check screen."
	 * 
	 *
	 */
	
public boolean func_Verify_Referral_Rules(){
	
	boolean r_value=false;
	
	try{
		
		Map<Object,Object> data_map = null;
		switch(common.currentRunningFlow){
			case "NB":
				data_map = common.NB_excel_data_map;
				break;
			case "Renewal":
				data_map = common.Renewal_excel_data_map;
				break;
			}
			try{
				k.ImplicitWaitOff();
				if(driver.findElement(By.xpath("//*[text()='This quote has been checked and no issues were found.']")).isDisplayed()){
					return true;
				}
			}catch(Throwable t){
				return true;
			}
		
			String referralRulesTbl_xpath = "//*[text()='Referral Rules']//following::table[1]";
			WebElement referralRules_Table = driver.findElement(By.xpath(referralRulesTbl_xpath));
			k.ScrollInVewWebElement(referralRules_Table);
			
			int referrel_tble_Rows = referralRules_Table.findElements(By.tagName("tr")).size();
			int Description_col_index = 2,Section_col_index=1;
			
			if(referralRules_Table.isDisplayed()){
				
				TestUtil.reportStatus("Referral verification started on quote check screen . ","Info",false);
				
				//int total_referral_messages = common_VELA.referrals_list.size();
				String referral_msg_section=null,referral_Txt=null;
				WebElement w_referral_Row = null,w_referralSection_Row=null;
				boolean isReferralFound=false;
				
				if((referrel_tble_Rows-1) <= common_VELA.referrals_list.size()){
				//For each referral message
				for(String referral_msg : common_VELA.referrals_list){
					isReferralFound=false;
				//for(int message = 1; message <= total_referral_messages ;message ++){
					referral_msg_section = referral_msg.split("_")[0];
					referral_Txt = referral_msg.split("_")[1];
					
					for(int row = 1; row < referrel_tble_Rows ;row ++){
						
						
						//Referral Text
						w_referral_Row = driver.findElement(By.xpath(referralRulesTbl_xpath+"//tbody//tr["+row+"]//td["+Description_col_index+"]"));
						if(w_referral_Row.getText().equals(referral_Txt)){
							isReferralFound = true;
							TestUtil.reportStatus("Referral  >><b>"+referral_Txt+"</b><< verified sucessfully . ","Pass",false);
							
							//Referral Section
							w_referralSection_Row = driver.findElement(By.xpath(referralRulesTbl_xpath+"//tbody//tr["+row+"]//td["+Section_col_index+"]"));
							if(!w_referralSection_Row.getText().equals(referral_msg_section)){
								TestUtil.reportStatus("<p style='color:red'> Referral Section is incorrect for referral - >><b>"+referral_Txt+"</b><<  Expexted: <b>"+referral_msg_section+"</b> and Actual: </b>"+w_referralSection_Row.getText()+"</b> . </p>", "Fail", true);
								ErrorUtil.addVerificationFailure(new Throwable("Referral Section is incorrect for referral - >><b>"+referral_Txt+"</b><<  Expexted: <b>"+referral_msg_section+"</b> and Actual: "));
								
							}
							break;
						}else
							continue;
						
					}
					
					if(!isReferralFound){
						TestUtil.reportStatus("<p style='color:red'> Referral  >><b>"+referral_Txt+"</b><< not generated on quote check screen . </p>", "Fail", true);
						ErrorUtil.addVerificationFailure(new Throwable("Referral  >><b>"+referral_Txt+"</b><< not generated on quote check screen . "));
						
					}
				}// referral message for loop end
				
				}else if((referrel_tble_Rows-1) > common_VELA.referrals_list.size()){
					for(int r_row = 1; r_row < referrel_tble_Rows ;r_row ++){
						isReferralFound=false;
					//for(int message = 1; message <= total_referral_messages ;message ++){
						w_referral_Row = driver.findElement(By.xpath(referralRulesTbl_xpath+"//tbody//tr["+r_row+"]//td["+Description_col_index+"]"));
						w_referralSection_Row = driver.findElement(By.xpath(referralRulesTbl_xpath+"//tbody//tr["+r_row+"]//td["+Section_col_index+"]"));
						
					
						for(String referral_msg : common_VELA.referrals_list){
							
							referral_msg_section = referral_msg.split("_")[0];
							referral_Txt = referral_msg.split("_")[1];
							
							//Referral Text
							if(w_referral_Row.getText().equals(referral_Txt)){
								isReferralFound = true;
								TestUtil.reportStatus("Referral  >><b>"+referral_Txt+"</b><< verified sucessfully . ","Pass",false);
								
								//Referral Section
								if(!w_referralSection_Row.getText().equals(referral_msg_section)){
									TestUtil.reportStatus("<p style='color:red'> Referral Section is incorrect for referral - >><b>"+referral_Txt+"</b><<  Expexted: <b>"+referral_msg_section+"</b> and Actual: </b>"+w_referralSection_Row.getText()+"</b> . </p>", "Fail", true);
									ErrorUtil.addVerificationFailure(new Throwable(" Referral Section is incorrect for referral - >><b>"+referral_Txt+"</b><<  Expexted: <b>"+referral_msg_section+"</b> and Actual: "));
									
								}
								break;
							}else
								continue;
							
						}
						
						if(!isReferralFound){
							TestUtil.reportStatus("<p style='color:red'> Referral  >><b>"+w_referral_Row.getText()+"</b><< should not generate on quote check screen . </p>", "Fail", true);
							ErrorUtil.addVerificationFailure(new Throwable("Referral  >><b>"+w_referral_Row.getText()+"</b><< should not generate on quote check screen . "));
							
						}
				}
			} //else if
					
			}else{
				TestUtil.reportStatus("Referral Rules table not exist on quote check screen . ", "Fail", true);
				
			}
			TestUtil.reportStatus("Referral verification successfully completed on quote check screen . ","Info",false);
			r_value=true;
	}catch(Throwable t){
		System.out.println("Error while verifying referral rules "+t.getMessage());
		k.ImplicitWaitOn();
		return false;
	}
	finally {
		k.ImplicitWaitOn();
	}
	return r_value;
}

public double calculateThirdPartyMotorLiabilityTS(String fileName,Map<Object, Object> data_map ,String code ,int j,int td){
	try{
		String TPML_Premium = null;
		String TPML_IPT = null;
		
if(common.currentRunningFlow.equals("CAN")){
			
			String productName = TestBase.product;
			try{
			
			switch(productName){
			
				case "XOC":
					TPML_Premium = Double.toString(common_XOC.CAN_XOC_ReturnP_Values_Map.get("Third Party Motor Liability").get("Net Net Premium"));
					TPML_IPT = Double.toString(common_XOC.CAN_XOC_ReturnP_Values_Map.get("Third Party Motor Liability").get("Insurance Tax"));
				break;
				
				}	
			}catch(NullPointerException npe){
				TPML_Premium = "0.0";
				TPML_IPT = "0.0";
			}
		}
		
		
        if(common.currentRunningFlow.equals("MTA")){
			
			try{
				TPML_Premium = Double.toString(common_VELA.transaction_Details_Premium_Values.get("Third Party Motor Liability").get("Net Net Premium"));
				TPML_IPT = Double.toString(common_VELA.transaction_Details_Premium_Values.get("Third Party Motor Liability").get("Insurance Tax"));
			}catch(NullPointerException npe){
				TPML_Premium = "0.0";
				TPML_IPT = "0.0";
			}
			}
			if(common.currentRunningFlow.equals("NB") || common.currentRunningFlow.equals("Rewind") || common.currentRunningFlow.equals("Requote")){
				TPML_Premium = (String)data_map.get("PS_ThirdPartyMotorLiability_NetNetPremium");
				TPML_IPT = (String)data_map.get("PS_ThirdPartyMotorLiability_GT");
			}
		String part1= "//*[@id='table0']/tbody";
		String actualAnnualContractPremium = driver.findElement(By.xpath(part1+"/tr["+j+"]/td["+td+"]")).getText();
		String actualAnnualContractIPT = driver.findElement(By.xpath(part1+"/tr["+j+"]/td["+(td+1)+"]")).getText();
		String actualAnnualContractDue = driver.findElement(By.xpath(part1+"/tr["+j+"]/td["+(td+2)+"]")).getText();
		compareValues(Double.parseDouble(TPML_Premium), Double.parseDouble(actualAnnualContractPremium), "Third Party Motor Liability Amount");
		compareValues(Double.parseDouble(TPML_IPT), Double.parseDouble(actualAnnualContractIPT), "Third Party Motor Liability IPT");
		double AnnualContractDue = Double.parseDouble(TPML_Premium)+ Double.parseDouble(TPML_IPT);
		String AnnualContractDueamt= common.roundedOff(Double.toString(AnnualContractDue)) ;
		compareValues(Double.parseDouble(AnnualContractDueamt), Double.parseDouble(actualAnnualContractDue), "Third Party Motor Liability Due ");
		return AnnualContractDue;
	
	}catch(Throwable t) {
		String methodName = new Object(){}.getClass().getEnclosingMethod().getName();
		TestUtil.reportFunctionFailed("Failed in "+methodName+" function");    
		k.reportErr("Failed in "+methodName+" function", t);
		Assert.fail("Failed in Calculate Third Party Motor Liability ammount.  \n", t);
		return 0;
	}
}
	

public double calculateLegalExpenseTS_LEACover(String fileName,Map<Object, Object> data_map ,String code ,int j,int td){
	try{
		String TPML_Premium = null;
		String TPML_IPT = null;
        if(common.currentRunningFlow.equals("MTA")){
			
			try{
				TPML_Premium = Double.toString(common_VELA.transaction_Details_Premium_Values.get("Legal Expenses").get("Net Net Premium"));
				TPML_IPT = Double.toString(common_VELA.transaction_Details_Premium_Values.get("Legal Expenses").get("Insurance Tax"));
			}catch(NullPointerException npe){
				TPML_Premium = "0.0";
				TPML_IPT = "0.0";
			}
			}
			if(common.currentRunningFlow.equals("NB")){
				TPML_Premium = (String)data_map.get("PS_ThirdPartyMotorLiability_NetNetPremium");
				TPML_IPT = (String)data_map.get("PS_ThirdPartyMotorLiability_GT");
			}
		String part1= "//*[@id='table0']/tbody";
		String actualAnnualContractPremium = driver.findElement(By.xpath(part1+"/tr["+j+"]/td["+td+"]")).getText();
		String actualAnnualContractIPT = driver.findElement(By.xpath(part1+"/tr["+j+"]/td["+(td+1)+"]")).getText();
		String actualAnnualContractDue = driver.findElement(By.xpath(part1+"/tr["+j+"]/td["+(td+2)+"]")).getText();
		compareValues(Double.parseDouble(TPML_Premium), Double.parseDouble(actualAnnualContractPremium), "Third Party Motor Liability Amount");
		compareValues(Double.parseDouble(TPML_IPT), Double.parseDouble(actualAnnualContractIPT), "Third Party Motor Liability IPT");
		double AnnualContractDue = Double.parseDouble(TPML_Premium)+ Double.parseDouble(TPML_IPT);
		String AnnualContractDueamt= common.roundedOff(Double.toString(AnnualContractDue)) ;
		compareValues(Double.parseDouble(AnnualContractDueamt), Double.parseDouble(actualAnnualContractDue), "Third Party Motor Liability Due ");
		return AnnualContractDue;
	
	}catch(Throwable t) {
		String methodName = new Object(){}.getClass().getEnclosingMethod().getName();
		TestUtil.reportFunctionFailed("Failed in "+methodName+" function");    
		k.reportErr("Failed in "+methodName+" function", t);
		Assert.fail("Failed in Calculate Third Party Motor Liability ammount.  \n", t);
		return 0;
	}
}

//calculateCombinedLiabilityTS
public double calculateCombinedLiabilityTS(String fileName,Map<Object, Object> data_map ,String code ,int j,int td){
	try{
		String CombinedLiabilitytPremium = null;
		String CombinedLiabilityIPT = null;
		
		if(common.currentRunningFlow.equals("CAN")){
			
			try{
				String minusSign = "-";
				CombinedLiabilitytPremium = minusSign.concat(Double.toString(common_COB.CAN_COB_ReturnP_Values_Map.get("Totals").get("Net Net Premium")));
				CombinedLiabilityIPT = minusSign.concat(Double.toString(common_COB.CAN_COB_ReturnP_Values_Map.get("Totals").get("Insurance Tax")));
				
					
			}catch(NullPointerException npe){
				CombinedLiabilitytPremium = "0.0";
				CombinedLiabilityIPT = "0.0";
			}
		}
		
		if(common.currentRunningFlow.equals("NB") ||common.currentRunningFlow.equals("Renewal")|| common.currentRunningFlow.equals("Rewind") || common.currentRunningFlow.equals("Requote")){
			
			if((policy_duration_Trans)!=365){
				CombinedLiabilitytPremium = Double.toString(common_VELA.transaction_Premium_Values.get("Totals").get("Net Net Premium"));
				CombinedLiabilityIPT = Double.toString(common_VELA.transaction_Premium_Values.get("Totals").get("Insurance Tax"));
			
			}else{
			CombinedLiabilitytPremium = (String)data_map.get("PS_NetNetPemiumTotal");
			CombinedLiabilityIPT = (String)data_map.get("PS_Total_GT");
			}
			}
		
        if(common.currentRunningFlow.equals("MTA")||(TestBase.businessEvent.equals("MTA")&&common.currentRunningFlow.equals("Rewind"))){
			
			try{
				if(common_COB.MTARewindFlow.equalsIgnoreCase("Yes")){
					CombinedLiabilitytPremium = Double.toString(common_VELA.transaction_Details_Premium_Values.get("Totals").get("Net Net Premium"));
					CombinedLiabilityIPT = Double.toString(common_VELA.transaction_Details_Premium_Values.get("Totals").get("Insurance Tax"));
				}else{
					CombinedLiabilitytPremium = Double.toString(common_VELA.transaction_Details_Premium_Values.get("Totals").get("Net Net Premium"));
					CombinedLiabilityIPT = Double.toString(common_VELA.transaction_Details_Premium_Values.get("Totals").get("Insurance Tax"));
				}
				
				
			}catch(NullPointerException npe){
				CombinedLiabilitytPremium = "0.0";
				CombinedLiabilityIPT = "0.0";
			}
			}
			
		String part1= "//*[@id='table0']/tbody";
		String actualAnnualContractPremium = driver.findElement(By.xpath(part1+"/tr["+j+"]/td["+td+"]")).getText();
		String actualAnnualContractIPT = driver.findElement(By.xpath(part1+"/tr["+j+"]/td["+(td+1)+"]")).getText();
		String actualAnnualContractDue = driver.findElement(By.xpath(part1+"/tr["+j+"]/td["+(td+2)+"]")).getText();
		compareValues(Double.parseDouble(CombinedLiabilitytPremium), Double.parseDouble(actualAnnualContractPremium), "Cover Specific Net Net Premium");
		compareValues(Double.parseDouble(CombinedLiabilityIPT), Double.parseDouble(actualAnnualContractIPT), "Cover Specific IPT");
		double AnnualContractDue = Double.parseDouble(CombinedLiabilitytPremium)+ Double.parseDouble(CombinedLiabilityIPT);
		String AnnualContractDueamt= common.roundedOff(Double.toString(AnnualContractDue)) ;
		compareValues(Double.parseDouble(AnnualContractDueamt), Double.parseDouble(actualAnnualContractDue), "Cover Specific Due amount");
		return AnnualContractDue;
	
	}catch(Throwable t) {
		String methodName = new Object(){}.getClass().getEnclosingMethod().getName();
		TestUtil.reportFunctionFailed("Failed in "+methodName+" function");    
		k.reportErr("Failed in "+methodName+" function", t);
		Assert.fail("Failed in Cover Specific ammount.  \n", t);
		return 0;
	}

}

public String materialFactsQuestions(String product , int questionNum){
	try{
		List<String> MFDQuestions = new ArrayList<>();
		switch(product){
		case "COB" :
			MFDQuestions.add("You are a member of or will apply and become a member of the CPA within 90 days of the inception of this policy");
			MFDQuestions.add("In the last 5 years has the proposer, director or partner of the Trade or Business or its Subsidiary Companies, either personally or in any business capacity, suffered any loss, made any claims or been involved in any incident or circumstances which may give rise to a claim in respect of the risks proposed?");
			MFDQuestions.add("Has any proposer, director or partner of the Trade or Business or its Subsidiary Companies ever, either personally or in any business capacity, had a proposal refused or declined or claim repudiated or ever had an insurance cancelled, renewal refused or had special terms imposed? ");
			MFDQuestions.add("Has any proposer, director or partner of the Trade or Business or its Subsidiary Companies ever, either personally or in any business capacity had any convictions, criminal offences or prosecutions pending other than motor offences?");
			MFDQuestions.add("Has any proposer, director or partner of the Trade or Business or its Subsidiary Companies ever, either personally or in any business capacity been declared bankrupt or insolvent or been the subject of bankruptcy proceedings or receivership/ insolvency proceedings?");
			MFDQuestions.add("Has any proposer, director or partner of the Trade or Business or its Subsidiary Companies ever been disqualified from holding company directorship? ");
			MFDQuestions.add("Has any proposer, director or partner of the Trade or Business or its Subsidiary Companies ever, either personally or in any business capacity been the subject of an individual voluntary arrangement with creditors, voluntary liquidation, a winding up or administrative order, or administrative receivership proceedings? ");
			MFDQuestions.add("Has any proposer, director or partner of the Trade or Business or its Subsidiary Companies ever, either personally or in any business capacity had a county court judgement awarded against them? ");
			MFDQuestions.add("Has any proposer, director or partner of the Trade or Business or its Subsidiary Companies ever, either personally or in any business capacity been subject to trade and economic sanctions of the UN, EU, US, UK and any other relevant jurisdiction?");
			MFDQuestions.add("In the last 5 years has the proposer, director or partner of the Trade or Business or its Subsidiary Companies ever, either personally or in any business capacity received a HSE prosecution or prohibition notice or improvement order?");
			MFDQuestions.add("Are any products supplied to hazardous industries?");
			MFDQuestions.add("Do you source products from outside of the EU?");
			MFDQuestions.add("Do you have full rights of recourse from the manufacturer of any products?");
			MFDQuestions.add("Ever been subject to customs and excise investigations?");
			MFDQuestions.add("Does the Insured have a written health & safety policy?");
			MFDQuestions.add("Are the Insured's health & safety systems audited internally or is external organisation used to provide Health & Safety advice and training?");
			MFDQuestions.add("Do all new staff undertake a Health & Safety induction course?");
			MFDQuestions.add("Do all employees have a training & development log?");
			MFDQuestions.add("Does the Insured carry out & record risk assessments & method statements of the main workplace/contract sites including health hazards?");
			MFDQuestions.add("Does the Insured undertake weekly inspections of each contract site to identify & rectify any Health & Safety hazards?");
			MFDQuestions.add("Does the Insured undertake post incident reviews following injuries/losses or near misses?");
			MFDQuestions.add("Is Personal Protective Equipment (PPE) provided & signed for?");
			MFDQuestions.add("Do you undertake RIDDOR reporting? ");
			MFDQuestions.add("Work with silica, asbestos, or substances containing asbestos?");
			MFDQuestions.add("Will work stop and a licensed sub-contractor be employed to deal with any such material?");
			MFDQuestions.add("Will a licensed sub-contractor be employed to deal with any such material that does not require a license?");
			MFDQuestions.add("Will the Insured check that the licensed sub-contractor has PL insurance including an indemnity to principal clause and no asbestos exclusions or restrictions?");
			MFDQuestions.add("Work with acids, gases, chemicals, explosives, radioactive or similar dangerous liquids or substances? ");
			MFDQuestions.add("Work on power stations, nuclear installations or establishments?");
			MFDQuestions.add("Work on refineries, bulk storage, or premises in oil, gas or chemical industries?");
			MFDQuestions.add("Work airside or on aircraft, hovercraft, aerospace systems, watercraft, railway, underground, quarries, underwater at docks, harbours or piers?");
			MFDQuestions.add("Work in or on computer suites or on computers?");
			MFDQuestions.add("Work on Bridges, viaducts, towers, steeples, chimney shafts or blast furnaces?");
			MFDQuestions.add("Work with any fixed powered woodworking machinery?");
			MFDQuestions.add("Is the Insured familiar with the Joint Code of Practice for the prevention of fires on construction sites?");
			MFDQuestions.add("Does the Insured have a fire evacuation procedure?");
			MFDQuestions.add("Does any of the work involve the application of heat?");
			MFDQuestions.add("When appointing Bona Fide Sub-Contractors is a check made that they have EL & PL insurance?");
			MFDQuestions.add("Are there any other material facts that you wish to disclose that may affect your policy?");
			MFDQuestions.add("Have you been involved in any disputes or legal proceedings during the last 5 years? (whether they formed part of a Legal Expenses Insurance claim or not)");
		break;
		case "XOC":
		case "XOQ":
			MFDQuestions.add("In the last 5 years has the proposer, director or partner of the Trade or Business or its Subsidiary Companies, either personally or in any business capacity, suffered any loss, made any claims or been involved in any incident or circumstances which may give rise to a claim in respect of the risks proposed?");
			MFDQuestions.add("Has any proposer, director or partner of the Trade or Business or its Subsidiary Companies ever, either personally or in any business capacity, had a proposal refused or declined or claim repudiated or ever had an insurance cancelled, renewal refused or had special terms imposed? ");
			MFDQuestions.add("Has any proposer, director or partner of the Trade or Business or its Subsidiary Companies ever, either personally or in any business capacity had any convictions, criminal offences or prosecutions pending other than motor offences?");
			MFDQuestions.add("Has any proposer, director or partner of the Trade or Business or its Subsidiary Companies ever, either personally or in any business capacity been declared bankrupt or insolvent or been the subject of bankruptcy proceedings or receivership/ insolvency proceedings?");
			MFDQuestions.add("Has any proposer, director or partner of the Trade or Business or its Subsidiary Companies ever been disqualified from holding company directorship? ");
			MFDQuestions.add("Has any proposer, director or partner of the Trade or Business or its Subsidiary Companies ever, either personally or in any business capacity been the subject of an individual voluntary arrangement with creditors, voluntary liquidation, a winding up or administrative order, or administrative receivership proceedings? ");
			MFDQuestions.add("Has any proposer, director or partner of the Trade or Business or its Subsidiary Companies ever, either personally or in any business capacity had a county court judgement awarded against them? ");
			MFDQuestions.add("Has any proposer, director or partner of the Trade or Business or its Subsidiary Companies ever, either personally or in any business capacity been subject to trade and economic sanctions of the UN, EU, US, UK and any other relevant jurisdiction?");
			MFDQuestions.add("In the last 5 years has the proposer, director or partner of the Trade or Business or its Subsidiary Companies ever, either personally or in any business capacity received a HSE prosecution or prohibition notice or improvement order?");
			MFDQuestions.add("Are any products supplied to hazardous industries?");
			MFDQuestions.add("Do you source products from outside of the EU?");
			MFDQuestions.add("Do you have full rights of recourse from the manufacturer of any products?");
			MFDQuestions.add("Ever been subject to customs and excise investigations?");
			MFDQuestions.add("Work with silica, asbestos, or substances containing asbestos?");
			MFDQuestions.add("Work with acids, gases, chemicals, explosives, radioactive or similar dangerous liquids or substances? ");
			MFDQuestions.add("Work on power stations, nuclear installations or establishments?");
			MFDQuestions.add("Work on refineries, bulk storage, or premises in oil, gas or chemical industries?");
			MFDQuestions.add("Work airside or on aircraft, hovercraft, aerospace systems, watercraft, railway, underground, quarries, underwater at docks, harbours or piers?");
			MFDQuestions.add("Work in or on computer suites or on computers?");
			MFDQuestions.add("Work on Bridges, viaducts, towers, steeples, chimney shafts or blast furnaces?");
			MFDQuestions.add("Does any of the work involve the application of heat?");
			MFDQuestions.add("Do you operate a 'Hot work' permit system?");
			MFDQuestions.add("Are there any other material facts that you wish to disclose that may affect your policy?");
			
		}
		
		return MFDQuestions.get(questionNum+1);
	}catch(Throwable t){
		String methodName = new Object(){}.getClass().getEnclosingMethod().getName();
		TestUtil.reportFunctionFailed("Failed in "+methodName+" function");    
		k.reportErr("Failed in "+methodName+" function", t);
		Assert.fail("Failed in Material Facts questions Function.  \n", t);
		return "";
	}
}

/**
 * 
 * PDF Verifications Functions for REWIND Flow.
 * 
 * 
 * 
 */


public boolean funcPDFdocumentVerification_Rewind(String docType){
	boolean retvalue = true;
	int doc_fail_count = 0;
	err_count=0;
	Map<Object,Object> mdata =  null;
	switch (common.currentRunningFlow) {
	case "Renewal":
		mdata = common.Renewal_excel_data_map;
	break;
	default:
		mdata=common.NB_excel_data_map;
	break;

	}
	
	try{
		if(((String)mdata.get("DocumentVerification")).equals("No")){
			TestUtil.reportStatus("<b> PDF document verification is 'No' hence skipped verification . ", "Info", false);
			TestUtil.reportStatus("<b> Total count of document verification is : [ 0 ]</b>", "Info", false);
		}else{
			customAssert.assertTrue(common.funcButtonSelection(docType) , "Unable to click on <b>[  "+docType+"  ]</b>.");
			doc_fail_count = doc_fail_count + iteratePDFDocuments_Rewind(docType);
			customAssert.SoftAssertEquals(doc_fail_count, 0,"Verification failure in "+docType);
			final_err_pdf_count = final_err_pdf_count + doc_fail_count;
			TestUtil.reportStatus(docType+" verification is Completed .", "Info", true);
			customAssert.assertTrue(k.Click("Tax_adj_BackBtn"), "Unable to click on back button.");
		}
		
		
		return retvalue;
	}
	catch(Throwable t) {
	    String methodName = new Object(){}.getClass().getEnclosingMethod().getName();
	    TestUtil.reportFunctionFailed("Failed in "+methodName+" function");
	    Assert.fail("Unable to do verification for documents. \n", t);
	    return false;
	}

}
		
/*
* PDF verification related functions:
* 
*  @Param docType - Either "Draft Documents" OR "Documents"
*  @Variable o - Number of documents
*  @Variable count - Documents data verification failure count
*  @Variable counter - incremental count for downloading same file (Used in PDFFileHandling method)
*/

public int iteratePDFDocuments_Rewind(String docType) throws ParseException, IOException, InterruptedException{
try{
	Map<Object,Object> mdata =  null;
	switch (common.currentRunningFlow) {
	case "Renewal":
		mdata = common.Renewal_excel_data_map;
	break;
	default:
		mdata=common.NB_excel_data_map;
	break;
	}
	List<WebElement> l_row = driver.findElements(By.xpath("html/body/div[3]/form/div/div[2]/table/tbody/tr/td/a/span"));
	int row_size = l_row.size();
	if(row_size>0){
		for(int r=0;r<row_size;r++){
			String doc_name = l_row.get(r).getText();
			if((String)mdata.get("pdf_"+doc_name)!=null && ((String)mdata.get("pdf_"+doc_name)).equals("Yes")){
				l_row.get(r).click();
				k.waitFiveSeconds();
				TestUtil.reportStatus("Document -"+doc_name+" is present.", "info", true);
				counter = 0;
				pdf_count++;
				err_count = err_count + PDFFileHandling_Rewind(doc_name,docType);
			
				l_row = driver.findElements(By.xpath("html/body/div[3]/form/div/div[2]/table/tbody/tr"));
			}else{
				continue;
			}
		}
	}
	TestUtil.reportStatus("Total count of <b>[  "+docType+" is : "+pdf_count+"  ]</b>", "Info", false);
	}catch(Throwable t)
	{
		String methodName = new Object(){}.getClass().getEnclosingMethod().getName();
		TestUtil.reportFunctionFailed("Failed in "+methodName+" function");   
		TestUtil.reportStatus("<p style='color:red'> Error in iteratePDFDocuments Method </p>", "Fail", true);
	 	return 1;
	}
	return err_count;
}
	
public int PDFFileHandling_Rewind(String fileName,String docType) throws IOException, ParseException, InterruptedException{
String file_Name=null;
String PDFCodePath = null;
String fileCode=null;
int dataVerificationFailureCount = 0;
String code = CommonFunction_VELA.product;
try{
	//TestUtil.reportStatus(fileName+" document verification is started for product - [<b>"+code+"</b>] ", "Info", false);
	String PDFPath= workDir+"\\src\\com\\selenium\\Execution_Report\\Report\\PDF";
	PDFCodePath = PDFPath+"\\"+code;
	File pdfFldr = new File(PDFPath);
	File pdfCodeFldr=new File(PDFCodePath);
	if(!pdfFldr.exists() && !pdfFldr.isDirectory()){
		pdfFldr.mkdir();
		}
	if(!pdfCodeFldr.exists() && !pdfCodeFldr.isDirectory()){
		pdfCodeFldr.mkdir();
		
	}
	
	//fileCode = downloadPDF(code,fileName);
	Thread.sleep(4000);
	file_Name = PDFCodePath+"\\"+fileCode+".pdf";
	//System.out.println(file_Name);
	
	File file = new File(file_Name);
	FileInputStream fis = new FileInputStream(file);
	TestUtil.reportStatus(fileName+" file is downloaded to the specified folder and ready for verification.", "Info", false);
	
	dataVerificationFailureCount = dataVerificationFailureCount + PDFDataVerification_Rewind(fis,fileName,docType);
	TestUtil.reportStatus("<b> Total count of document verification is : [ "+pdf_count+" ]</b>", "Info", false);
	
	}
	
	// Below code will handle PDF failure up to 3 chance.
	catch(FileNotFoundException fnf)
	{
		
		if(counter==3){
			TestUtil.reportStatus("<b>Due to some reason , Not able to downalod -[  "+fileName+"  ]. 3 times tried to download his file .</b>", "Info", false);
		}else{
			counter++;
			TestUtil.reportStatus("Due to some reason , Not able to downalod - "+fileName+" . Retried downloading.", "Info", false);
			//PDFFileHandling(fileName,docType);
		}
	return 0;
	}
	catch(NullPointerException npe)
	{
				TestUtil.reportStatus("Data Issue while verification . ", "Fail", false);
				return 1;
	}
		
	
	catch(Exception ex)
	{
		if(counter==3){
			TestUtil.reportStatus("<b>Due to some reason , Not able to downalod -[  "+fileName+"  ]. 3 times tried to download his file .</b>", "Info", false);
	}else{
		counter++;
		TestUtil.reportStatus("Due to some reason , Not able to downalod - "+fileName+" . Retried downloading.", "Info", false);
		//PDFFileHandling(fileName,docType);
	}
    return 0;
	}

customAssert.assertTrue(fileDeletion(PDFCodePath) , "Unable to delete extra pdf files from folder : "+PDFCodePath);

return dataVerificationFailureCount;
	
}
	
/**
* @param code
* @param fileName
* @return
* @throws InterruptedException
* @throws IOException
*//*
public String downloadPDF(String code,String fileName) throws InterruptedException, IOException {

String timeStamp = new SimpleDateFormat("ddMMyyyyHHmmss", Locale.US).format(new Date());
try{
 
	WebDriverWait wait = new WebDriverWait(driver, 50); 
	WebElement menuItem = wait.until(ExpectedConditions.presenceOfElementLocated(By.xpath("//*[@id='mainpanel']/div[3]/object")));  // until this submenu is found
 
     if(menuItem!=null && menuItem.isDisplayed()){
           
           driver.findElement(By.xpath("//*[@id='mainpanel']/div[3]/object")).click();
           Actions action = new Actions(driver);
           Thread.sleep(10000);
           action.keyDown(Keys.SHIFT).sendKeys(Keys.TAB).keyUp(Keys.SHIFT).perform();
           action.keyDown(Keys.SHIFT).sendKeys(Keys.TAB).keyUp(Keys.SHIFT).perform();
           action.keyDown(Keys.SHIFT).sendKeys(Keys.TAB).keyUp(Keys.SHIFT).perform();
           action.keyDown(Keys.SHIFT).sendKeys(Keys.TAB).keyUp(Keys.SHIFT).perform();
           action.keyDown(Keys.SHIFT).sendKeys(Keys.TAB).keyUp(Keys.SHIFT).perform();
           action.sendKeys(Keys.ENTER).perform();
           k.waitTenSeconds();
           
           String fileCode = code+"_"+fileName+"_"+timeStamp;
           
           String[] parms = {"wscript", workDir+"\\src\\BatFiles\\CloseDialog.vbs", workDir+"\\src\\com\\selenium\\Execution_Report\\Report\\PDF\\"+code+"\\"+fileCode};
           Runtime.getRuntime().exec(parms);
           return fileCode;
     }else{
           
           return "";
     }
}catch(Exception e){
       String methodName = new Object(){}.getClass().getEnclosingMethod().getName();
       TestUtil.reportFunctionFailed("Failed in "+methodName+" function");    
       TestUtil.reportStatus("<p style='color:red'> PDF Document is not visible for download </p>", "Fail", true);
       return "";
}
}*/
	
/**
* @param fis - Downloaded file referance
* @param fileName - e.g. Policy Schedule
* @param docType - Draft Documents/Documents
*/

	@SuppressWarnings("rawtypes")
	public int PDFDataVerification_Rewind(FileInputStream fis,String fileName,String docType) throws IOException, ParseException, InterruptedException {
	
	String parsedText=null;
	int fail_count=0;
	PDFParser parser = new PDFParser(fis);
	parser.parse();
	COSDocument cosDoc = parser.getDocument();
	PDDocument pdDoc = new PDDocument(cosDoc);
	PDFTextStripper pdfStripper = new PDFTextStripper();
	
	parsedText = pdfStripper.getText(pdDoc);
	int count = pdDoc.getNumberOfPages();
	pdfStripper.setStartPage(1);
	pdfStripper.setEndPage(count);
	Map<Object,Object> mdata =  null;
	
	switch (common.currentRunningFlow) {
		case "Renewal":
			mdata = common.Renewal_excel_data_map;
		break;
		default:
			mdata=common.NB_excel_data_map;
		break;
	
	}
	//System.out.println(parsedText);
	switch(fileName){

	case "Policy Schedule":
	
		DecimalFormat formatter = new DecimalFormat("#,###,###.##");
		int incrementalDays = Integer.parseInt(CONFIG.getProperty("DaysIncrementNumber"));
		int policyDuration = Integer.parseInt((String)mdata.get("PS_Duration"));
		fail_count=0;
				
		if(docType.contains("Draft")){
			fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("QUOTATION SCHEDULE"), "Document : QUOTATION SCHEDULE", fileName);
		}else{
			fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("POLICY SCHEDULE"), "Document : POLICY SCHEDULE", fileName);
		}
		if(common.currentRunningFlow.equals("Renewal")){
			fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("INSURED NAME - "+(String)common.Renewal_excel_data_map.get(common.currentRunningFlow+"_ClientName")), "Insured Name : "+(String)common.Renewal_excel_data_map.get(common.currentRunningFlow+"_ClientName") , fileName);
		}else{
			fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("INSURED NAME - "+(String)mdata.get("NB_ClientName")), "Insured Name : "+(String)mdata.get("NB_ClientName") , fileName);
		}
		fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains((String)mdata.get("QC_AgencyName")), "BROKER NAME - "+(String)mdata.get("QC_AgencyName") , fileName);
	
		if(docType.contains("Draft")){
			if(!common.currentRunningFlow.equalsIgnoreCase("Renewal")){
				fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("Quote Reference: "+(String)mdata.get("NB_QuoteNumber")) ,"Quote Reference : "+mdata.get("NB_QuoteNumber"),fileName);
				fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("Quotation Date: "+common.daysIncrement((String)mdata.get("QC_InceptionDate"), -incrementalDays)) ,"Quote Date : "+common.daysIncrement((String)mdata.get("QC_InceptionDate"), -incrementalDays),fileName);
			}else{
				fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("Quote Reference: "+(String)common.Renewal_excel_data_map.get(common.currentRunningFlow+"_QuoteNumber")) ,"Quote Reference : "+common.Renewal_excel_data_map.get(common.currentRunningFlow+"_QuoteNumber"),fileName);
			}
		}else{
			if(!common.currentRunningFlow.equalsIgnoreCase("Renewal")){
				fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("Policy Number: "+(String)mdata.get("NB_PolicyNumber")) ,"Policy Number : "+mdata.get("NB_PolicyNumber"),fileName);
			}else{
				fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("Policy Number: "+(String)mdata.get(common.currentRunningFlow+"_PolicyNumber")) ,"Policy Number : "+mdata.get(common.currentRunningFlow+"_PolicyNumber"),fileName);
			}
			if(((String)mdata.get("PS_DefaultStartEndDate")).equals("No")){
				if(common.currentRunningFlow.equals("MTA")||(TestBase.businessEvent.equals("MTA")&&common.currentRunningFlow.equals("Rewind"))){
					fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("Effective Date: "+common.daysIncrement((String)common.MTA_excel_data_map.get("MTA_EffectiveDate"), 0)) ,"Effective Date : "+common.daysIncrement((String)common.MTA_excel_data_map.get("MTA_EffectiveDate"),0),fileName);
				}else{
					fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("Effective Date: "+common.daysIncrement((String)mdata.get("PS_PolicyStartDate"), 0)) ,"Effective Date : "+common.daysIncrement((String)mdata.get("PS_PolicyStartDate"), 0),fileName);
				}
			}else{
				if(common.currentRunningFlow.equals("MTA")){
					fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("Effective Date: "+common.daysIncrement((String)common.MTA_excel_data_map.get("MTA_EffectiveDate"), 0)) ,"Effective Date : "+common.daysIncrement((String)common.MTA_excel_data_map.get("MTA_EffectiveDate"),0),fileName);
				}else{
					fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("Effective Date: "+common.daysIncrement((String)mdata.get("PS_PolicyStartDate"), 0)) ,"Effective Date : "+common.daysIncrement((String)mdata.get("PS_PolicyStartDate"), 0),fileName);
				}
			}
			
		}
		
		switch (CommonFunction_VELA.product) {
		case "COA":
			if(((((String)mdata.get("CD_EmployersLiability")).equals("Yes") && !((String)mdata.get("CD_Add_EmployersLiability")).equals("No"))  || ((String)mdata.get("CD_Add_EmployersLiability")).equals("Yes"))){
				fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("Employers Liability Operative"), "Employers Liability Operative" , fileName);
				fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("EMPLOYERS LIABILITY SECTION"), "EMPLOYERS LIABILITY SECTION" , fileName);
				String EL_LOI = (String)mdata.get("EL_LOI");
				String Section_Pemium =  formatter.format(Double.parseDouble((String)mdata.get("PS_EmployersLiability_GP")));
				fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("Section Premium "+Section_Pemium), "Section Premium  "+Section_Pemium, fileName);				
				fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("Limit of Indemnity - Any One Occurrence "+EL_LOI), "Limit of Indemnity - Any One Occurrence "+EL_LOI , fileName);
//				double rate = funcRateCalculatorPDF("Employers Liability",(String)mdata.get("EL_LOI"));
//				fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains(Double.toString(rate)), Double.toString(rate), fileName);
				
			}else{
				fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("Employers Liability Not Operative"), "Employers Liability Not Operative" , fileName);
			}
			
			if(((((String)mdata.get("CD_Public&ProductsLiability")).equals("Yes") && !((String)mdata.get("CD_Add_Public&ProductsLiability")).equals("No"))  || ((String)mdata.get("CD_Add_Public&ProductsLiability")).equals("Yes"))){
				fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("PUBLIC AND PRODUCTS LIABILITY SECTION"), "PUBLIC AND PRODUCTS LIABILITY SECTION" , fileName);
				fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("Public & Products Liability Operative"), "APPENDIX TO LIABILITY SECTION" , fileName);
				String PPL_LOI = (String)mdata.get("PPL_LOI_PPLiability");
				String Section_Pemium =  formatter.format(Double.parseDouble((String)mdata.get("PS_Public&ProductsLiability_GP")));
				fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("Section Premium "+Section_Pemium), "Section Premium  "+Section_Pemium, fileName);				
				fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("Limit of Indemnity Any One Occurrence for all claims other than arising out of Pollution "+PPL_LOI), "Limit of Indemnity Any One Occurrence for all claims other than arising out of Pollution "+PPL_LOI , fileName);
//				double rate = funcRateCalculatorPDF("Public & Products Liability",(String)mdata.get("EL_LOI"));
//				fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains(Double.toString(rate)), Double.toString(rate), fileName);
				if(((String)mdata.get("PPL_RetroactiveDate"))==null)
				{
					fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("Cyber Liability "+((String)mdata.get("QC_InceptionDate"))) ,"Professional Negligence "+((String)mdata.get("QC_InceptionDate")),fileName);
					fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("Professional Negligence "+((String)mdata.get("QC_InceptionDate"))) ,"Professional Negligence "+((String)mdata.get("QC_InceptionDate")),fileName);
				}else{
					fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("Professional Negligence "+((String)mdata.get("PPL_RetroactiveDate"))) ,"Professional Negligence "+((String)mdata.get("PPL_RetroactiveDate")),fileName);
					fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("Cyber Liability "+((String)mdata.get("PPL_RetroactiveDate"))) ,"Cyber Liability "+((String)mdata.get("PPL_RetroactiveDate")),fileName);
				}
			}else{
				fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("Public & Products Liability Not Operative"), "Public & Products Liability Not Operative" , fileName);
			}
			
			if(((((String)mdata.get("CD_AnnualWorks")).equals("Yes") && !((String)mdata.get("CD_Add_AnnualWorks")).equals("No"))  || ((String)mdata.get("CD_Add_AnnualWorks")).equals("Yes"))){
				fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("Contract Works Operative"), "Contract Works Operative" , fileName);
				fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("CONTRACT WORKS SECTION"), "CONTRACT WORKS SECTION" , fileName);
				String AW_LOI = (String)mdata.get("AW_LOI");
				fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("Limit of Indemnity - Any One Occurrence "+AW_LOI), "Limit of Indemnity - Any One Occurrence "+AW_LOI , fileName);
				String Section_Pemium =  formatter.format(Double.parseDouble((String)mdata.get("PS_AnnualWorks_GP")));
				fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("Section Premium "+Section_Pemium), "Section Premium  "+Section_Pemium, fileName);				
//				double rate = funcRateCalculatorPDF("Annual Works",(String)mdata.get("EL_LOI"));
//				fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains(Double.toString(rate)), Double.toString(rate), fileName);
				}else{
				fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("Contract Works Not Operative"), "Cyber & Data Security Not Operative" , fileName);
			}
			
			if(((((String)mdata.get("CD_OwnPlant")).equals("Yes") && !((String)mdata.get("CD_Add_OwnPlant")).equals("No"))  || ((String)mdata.get("CD_Add_OwnPlant")).equals("Yes"))){
				fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("Own Plant Operative"), "Own Plant Operative" , fileName);
				fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("OWN PLANT SECTION"), "OWN PLANT SECTION" , fileName);
				String OP_LOI = (String)mdata.get("OP_LOI");
				//fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("Property Insured Limit of Indemnity - Any One Occurrence "+OP_LOI), "Property Insured Limit of Indemnity - Any One Occurrence "+OP_LOI , fileName);				
				
				String Section_Pemium =  formatter.format(Double.parseDouble((String)mdata.get("PS_OwnPlant_GP")));
				fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("Section Premium "+Section_Pemium), "Section Premium  "+Section_Pemium, fileName);				
//				double rate = funcRateCalculatorPDF("Own Plant",(String)mdata.get("EL_LOI"));
//				fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains(Double.toString(rate)), Double.toString(rate), fileName);
			}else{
				fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("Own Plant Not Operative"), "Own Plant Not Operative" , fileName);
			}
			
			if(((((String)mdata.get("CD_HiredInPlant")).equals("Yes") && !((String)mdata.get("CD_Add_HiredInPlant")).equals("No"))  || ((String)mdata.get("CD_Add_HiredInPlant")).equals("Yes"))){
				fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("Hired in Plant Operative"), "Hired in Plant Operative" , fileName);
				fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("HIRED IN PLANT SECTION"), "HIRED IN PLANT SECTION" , fileName);
				String HIP_LOI = (String)mdata.get("HIP_LOI");
				fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("Limit of Indemnity - Any One Occurrence "+HIP_LOI), "Limit of Indemnity - Any One Occurrence "+HIP_LOI , fileName);				
				String Section_Pemium =  formatter.format(Double.parseDouble((String)mdata.get("PS_HiredInPlant_GP")));
				fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("Section Premium "+Section_Pemium), "Section Premium  "+Section_Pemium, fileName);				
//				double rate = funcRateCalculatorPDF("Hired In Plant",(String)mdata.get("EL_LOI"));
//				fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains(Double.toString(rate)), Double.toString(rate), fileName);
			}else{
				fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("Hired in Plant Not Operative"), "Legal Expenses Not Operative" , fileName);
			}
			if(((((String)mdata.get("CD_JCT6.5.1")).equals("Yes") && !((String)mdata.get("CD_Add_JCT6.5.1")).equals("No"))  || ((String)mdata.get("CD_Add_JCT6.5.1")).equals("Yes"))){
				fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("JCT Clause 6.5.1 Insurance (or equivalent) Operative"), "JCT Clause 6.5.1 Insurance (or equivalent) Operative" , fileName);
				fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("JCT CLAUSE 6.5.1 (or equivalent) SECTION"), "JCT CLAUSE 6.5.1 (or equivalent) SECTION" , fileName);
				
				String JCT_LOI = (String)common.NB_excel_data_map.get("JCT_LOI_Required");
				fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("Limit of Indemnity - Any One Occurrence "+JCT_LOI), "Limit of Indemnity - Any One Occurrence "+JCT_LOI , fileName);
				String Section_Pemium =  formatter.format(Double.parseDouble((String)mdata.get("PS_JCT6.5.1_GP")));
				fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("Section Premium "+Section_Pemium), "Section Premium  "+Section_Pemium, fileName);
//				double rate = funcRateCalculatorPDF("JCT 6.5.1",(String)mdata.get("EL_LOI"));
//				fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains(Double.toString(rate)), Double.toString(rate), fileName);

			}else{
				fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("JCT Clause 6.5.1 Insurance (or equivalent) Not Operative"), "JCT Clause 6.5.1 Not Operative" , fileName);
			}
			if(((((String)mdata.get("CD_PropertyOwnersLiability")).equals("Yes") && !((String)mdata.get("CD_Add_PropertyOwnersLiability")).equals("No"))  || ((String)mdata.get("CD_Add_PropertyOwnersLiability")).equals("Yes"))){
				fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("Property Owners Liability Operative"), "Property Owners Liability Operative" , fileName);
				fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("PROPERTY OWNERS LIABILITY SECTION"), "PROPERTY OWNERS LIABILITY SECTION" , fileName);
				
				String POL_LOI = (String)common.NB_excel_data_map.get("POL_LOI");
				fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("Limit of Indemnity - Any One Occurrence "+POL_LOI), "Limit of Indemnity - Any One Occurrence "+POL_LOI , fileName);
				String Section_Pemium =  formatter.format(Double.parseDouble((String)mdata.get("PS_PropertyOwnersLiability_GP")));
				fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("Section Premium "+Section_Pemium), "Section Premium  "+Section_Pemium, fileName);
//				double rate = funcRateCalculatorPDF("Property Owners Liability",(String)mdata.get("EL_LOI"));
//				fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains(Double.toString(rate)), Double.toString(rate), fileName);
			}else{
				fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("Property Owners Liability Not Operative"), "Property Owners Liability Not Operative" , fileName);
			}
			if(((((String)mdata.get("CD_LegalExpenses")).equals("Yes") && !((String)mdata.get("CD_Add_LegalExpenses")).equals("No"))  || ((String)mdata.get("CD_Add_LegalExpenses")).equals("Yes"))){
				fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("Legal Expenses Operative"), "Legal Expenses Operative" , fileName);
				fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("LEGAL EXPENSES SECTION"), "LEGAL EXPENSES SECTION" , fileName);
				
//				String LE_LimitOfLiability = (String)common.NB_excel_data_map.get("LE_LimitOfLiability");
//				fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("Limit of Liability "+LE_LimitOfLiability), "Limit of Liability &pound;"+LE_LimitOfLiability , fileName);
				String Section_Pemium =  formatter.format(Double.parseDouble((String)mdata.get("PS_LegalExpenses_GP")));
				fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("Section Premium "+Section_Pemium), "Section Premium  "+Section_Pemium, fileName);
//				double rate = funcRateCalculatorPDF("Legal Expenses",(String)mdata.get("EL_LOI"));
//				fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains(Double.toString(rate)), Double.toString(rate), fileName);

			}else{
				fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("Legal Expenses Not Operative"), "Legal Expenses Not Operative" , fileName);
			}
			if(((((String)mdata.get("CD_Terrorism")).equals("Yes") && !((String)mdata.get("CD_Add_Terrorism")).equals("No"))  || ((String)mdata.get("CD_Add_Terrorism")).equals("Yes"))){
				fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("Terrorism Operative"), "Terrorism Operative" , fileName);
				fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("TERRORISM SECTION"), "TERRORISM SECTION" , fileName);
				String Section_Pemium =  formatter.format(Double.parseDouble((String)mdata.get("PS_Terrorism_GP")));
				fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("Section Premium "+Section_Pemium), "Section Premium  "+Section_Pemium, fileName);
//				double rate = funcRateCalculatorPDF("Terrorism",(String)mdata.get("EL_LOI"));
//				fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains(Double.toString(rate)), Double.toString(rate), fileName);

			}else{
				fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("Terrorism Not Operative"), "Terrorism Not Operative" , fileName);
			}
			break;
		case "COB":
			
			DecimalFormat f = new DecimalFormat("00");
			String sVal = (String)common.MTA_excel_data_map.get("CD_Add_EmployersLiability");
			if(sVal.equals("Yes")){
				fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("Employers Liability Operative"), "Employers Liability Operative" , fileName);
				fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("EMPLOYERS LIABILITY SECTION"), "EMPLOYERS LIABILITY SECTION" , fileName);
				String EL_LOI = (String)mdata.get("EL_LOI");
				String Section_Pemium =  formatter.format(common_VELA.transaction_Details_Premium_Values.get("EmployersLiability").get("Total Premium"));
				Section_Pemium = String.valueOf(f.format(Double.parseDouble(Section_Pemium)));
				fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("Section Premium "+Section_Pemium), "Section Premium  "+Section_Pemium, fileName);			
			}
			
			sVal = (String)common.MTA_excel_data_map.get("CD_Add_Public&ProductsLiability");
			if(sVal.equals("Yes")){
				fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("PUBLIC AND PRODUCTS LIABILITY SECTION"), "PUBLIC AND PRODUCTS LIABILITY SECTION" , fileName);
				fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("Public & Products Liability Operative"), "APPENDIX TO LIABILITY SECTION" , fileName);
				String PPL_LOI = (String)mdata.get("PPL_LOI_PPLiability");
				String Section_Pemium =  formatter.format(common_VELA.transaction_Details_Premium_Values.get("Public&ProductsLiability").get("Total Premium"));
				Section_Pemium = String.valueOf(f.format(Double.parseDouble(Section_Pemium)));
				fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("Section Premium "+Section_Pemium), "Section Premium  "+Section_Pemium, fileName);				
				
				if(common.currentRunningFlow.contains("MTA")){
					fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("Cyber Liability "+common_COB.Endorse_Date) ,"Cyber Liability "+common_COB.Endorse_Date,fileName);
					fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("Professional Negligence "+common_COB.Endorse_Date) ,"Professional Negligence "+common_COB.Endorse_Date,fileName);
				}else{
					if(((String)mdata.get("PPL_RetroactiveDate"))==null)
					{					
						fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("Cyber Liability "+((String)mdata.get("QC_InceptionDate"))) ,"Cyber Liability "+((String)mdata.get("QC_InceptionDate")),fileName);
						fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("Professional Negligence "+((String)mdata.get("QC_InceptionDate"))) ,"Professional Negligence "+((String)mdata.get("QC_InceptionDate")),fileName);
					}else{
						fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("Professional Negligence "+((String)mdata.get("PPL_RetroactiveDate"))) ,"Professional Negligence "+((String)mdata.get("PPL_RetroactiveDate")),fileName);
						fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("Cyber Liability "+((String)mdata.get("PPL_RetroactiveDate"))) ,"Cyber Liability "+((String)mdata.get("PPL_RetroactiveDate")),fileName);
					}
				}
				
			}
			
			sVal = (String)common.MTA_excel_data_map.get("CD_Add_AnnualWorks");
			if(sVal.equals("Yes")){
				fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("Contract Works Operative"), "Contract Works Operative" , fileName);
				fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("CONTRACT WORKS SECTION"), "CONTRACT WORKS SECTION" , fileName);
				String AW_LOI = (String)mdata.get("AW_LOI");
				fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("Limit of Indemnity - Any One Occurrence "+AW_LOI), "Limit of Indemnity - Any One Occurrence "+AW_LOI , fileName);
				String Section_Pemium = formatter.format(common_VELA.transaction_Details_Premium_Values.get("AnnualWorks").get("Total Premium"));
				Section_Pemium = String.valueOf(f.format(Double.parseDouble(Section_Pemium)));
				fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("Section Premium "+Section_Pemium), "Section Premium  "+Section_Pemium, fileName);				
			}
			
			sVal = (String)common.MTA_excel_data_map.get("CD_Add_OwnPlant");
			if(sVal.equals("Yes")){
				fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("Own Plant Operative"), "Own Plant Operative" , fileName);
				fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("OWN PLANT SECTION"), "OWN PLANT SECTION" , fileName);
				String OP_LOI = (String)mdata.get("OP_LOI");
								
				
				double GP = 0.0;
				if(common.currentRunningFlow.contains("MTA")){
					GP = common_VELA.transaction_Details_Premium_Values.get("OwnPlant").get("Total Premium");
				}else{
					if(!((String)mdata.get("PS_Duration")).equalsIgnoreCase("365")){
						GP = transaction_Premium_Values.get("Own Plant").get("Gross Premium");
					}else{
						GP = Double.parseDouble((String)mdata.get("PS_OwnPlant_GP"));
					}
				}
				
				
				String Section_Pemium =  formatter.format((int) Math.floor(GP));
				Section_Pemium = String.valueOf(f.format(Double.parseDouble(Section_Pemium)));
			
				fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("Section Premium "+Section_Pemium), "Section Premium  "+Section_Pemium, fileName);				
			}
			
			sVal = (String)common.MTA_excel_data_map.get("CD_Add_HiredInPlant");
			if(sVal.equals("Yes")){
				fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("Hired in Plant Operative"), "Hired in Plant Operative" , fileName);
				fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("HIRED IN PLANT SECTION"), "HIRED IN PLANT SECTION" , fileName);
				String HIP_LOI = (String)mdata.get("HIP_LOI");
				fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("Limit of Indemnity - Any One Occurrence "+HIP_LOI), "Limit of Indemnity - Any One Occurrence "+HIP_LOI , fileName);				
				String Section_Pemium =  formatter.format(common_VELA.transaction_Details_Premium_Values.get("HiredInPlant").get("Total Premium"));
				Section_Pemium = String.valueOf(f.format(Double.parseDouble(Section_Pemium)));
				fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("Section Premium "+Section_Pemium), "Section Premium  "+Section_Pemium, fileName);				
			}
			
			sVal = (String)common.MTA_excel_data_map.get("CD_Add_JCT6.5.1");
			if(sVal.equals("Yes")){
				fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("JCT Clause 6.5.1 Insurance (or equivalent) Operative"), "JCT Clause 6.5.1 Insurance (or equivalent) Operative" , fileName);
				fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("JCT CLAUSE 6.5.1 (or equivalent) SECTION"), "JCT CLAUSE 6.5.1 (or equivalent) SECTION" , fileName);
				
				String JCT_LOI = (String)common.NB_excel_data_map.get("JCT_LOI_Required");
				fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("Limit of Indemnity - Any One Occurrence "+JCT_LOI), "Limit of Indemnity - Any One Occurrence "+JCT_LOI , fileName);
				String Section_Pemium =  formatter.format(common_VELA.transaction_Details_Premium_Values.get("JCT6.5.1").get("Total Premium"));
				Section_Pemium = String.valueOf(f.format(Double.parseDouble(Section_Pemium)));
				fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("Section Premium "+Section_Pemium), "Section Premium  "+Section_Pemium, fileName);
			}
			
			sVal = (String)common.MTA_excel_data_map.get("CD_Add_PropertyOwnersLiability");
			if(sVal.equals("Yes") ){
				fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("Property Owners Liability Operative"), "Property Owners Liability Operative" , fileName);
				fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("PROPERTY OWNERS LIABILITY SECTION"), "PROPERTY OWNERS LIABILITY SECTION" , fileName);
				
				String POL_LOI = (String)common.NB_excel_data_map.get("POL_LOI");
				fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("Limit of Indemnity - Any One Occurrence "+POL_LOI), "Limit of Indemnity - Any One Occurrence "+POL_LOI , fileName);
				String Section_Pemium =  formatter.format(common_VELA.transaction_Details_Premium_Values.get("PropertyOwnersLiability").get("Total Premium"));
				Section_Pemium = String.valueOf(f.format(Double.parseDouble(Section_Pemium)));Section_Pemium = String.valueOf(f.format(Double.parseDouble(Section_Pemium)));
				fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("Section Premium "+Section_Pemium), "Section Premium  "+Section_Pemium, fileName);
			}
			
			sVal = (String)common.MTA_excel_data_map.get("CD_Add_LegalExpenses");
			if(sVal.equals("Yes")){
				fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("Legal Expenses Operative"), "Legal Expenses Operative" , fileName);
				fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("LEGAL EXPENSES SECTION"), "LEGAL EXPENSES SECTION" , fileName);
				String Section_Pemium =  formatter.format(common_VELA.transaction_Details_Premium_Values.get("LegalExpenses").get("Total Premium"));
				Section_Pemium = String.valueOf(f.format(Double.parseDouble(Section_Pemium)));
				fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("Section Premium "+Section_Pemium), "Section Premium  "+Section_Pemium, fileName);
			}
			
			sVal = (String)common.MTA_excel_data_map.get("CD_Add_Terrorism");
			if(sVal.equals("Yes")){
				fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("Terrorism Operative"), "Terrorism Operative" , fileName);
				fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("TERRORISM SECTION"), "TERRORISM SECTION" , fileName);
				String Section_Pemium =   formatter.format(common_VELA.transaction_Details_Premium_Values.get("Terrorism").get("Total Premium"));
				Section_Pemium = String.valueOf(f.format(Double.parseDouble(Section_Pemium)));
				fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("Section Premium "+Section_Pemium), "Section Premium  "+Section_Pemium, fileName);
			}
			
			break;
		default:
			break;
		}
		//This will verify endorsement in Section Endorsements.
		String flag="true";
		Iterator collectiveDataIT = common.EndorsementCollectiveData.entrySet().iterator();
		while(collectiveDataIT.hasNext()){
			Map.Entry collectiveDataMapValue = (Map.Entry)collectiveDataIT.next();
			String collectiveEndorsementCode = collectiveDataMapValue.getKey().toString();
			
			Iterator individualDataIT = common.EndorsementCollectiveData.get(collectiveEndorsementCode).entrySet().iterator();
			while(individualDataIT.hasNext()){
				Map.Entry individualDataMapValue = (Map.Entry)individualDataIT.next();
				String individualEndorsementSection = individualDataMapValue.getValue().toString();
				if(individualEndorsementSection.contains("Contract Lift")){
					individualEndorsementSection = "CPA Contract Lift Cover (Lifted Goods)";
				}
				if(individualEndorsementSection.contains("Offshore Work")){
					individualEndorsementSection = "Offshore Work And Visits";
				}
				if(individualEndorsementSection.contains("Contract Works")){
					individualEndorsementSection = "Contract Works";
				}
				String mergedEndorsementText = null;
				if(common.EndorsementCollectiveData.get(collectiveEndorsementCode).containsValue("Policy")){
					mergedEndorsementText = collectiveEndorsementCode + " " + individualEndorsementSection;
				}else{
					mergedEndorsementText = individualEndorsementSection + " " +collectiveEndorsementCode;
				}
				
				if(parsedText.contains(mergedEndorsementText)){
					TestUtil.reportStatus("Verified Endorsement : [<b> "+collectiveEndorsementCode+" -- "+individualEndorsementSection+"</b>] in "+fileName+" document.", "Pass", false);
					//TestUtil.reportStatus("Applied Endorsement <b> [ "+collectiveEndorsementCode+" </b> with title as <b> "+individualEndorsementSection+" ] </b> is present on premium summary page.", "Info", false);
					fail_count = fail_count + 0;
					flag = "true";
					break;
				}else{
					flag="false";
				}
			}
			if(flag.equalsIgnoreCase("false")){
				TestUtil.reportStatus("<p style='color:red'> PDF Document: "+fileName+" does not contain [<b> "+collectiveEndorsementCode+" </b>] </p>", "Fail", false);
				//TestUtil.reportStatus("<p style='color:red'> Endorsement <b> [ "+collectiveEndorsementCode+" ] </b> is not present on premium summary page.</p>", "Info", false);
				fail_count = fail_count + 1;
			}
		}
		
		//Validate extra endorsement present on Endorsement screen should not be present on Premium Screen.
		Iterator extraEndorsementDetailsIT = common.ExtraEndorsementList.entrySet().iterator();
		while(extraEndorsementDetailsIT.hasNext()){
			Map.Entry extraEdnorsementValue = (Map.Entry)extraEndorsementDetailsIT.next();
			String extraEDCode = extraEdnorsementValue.getValue().toString();
			
			if(parsedText.contains(extraEDCode)){
				TestUtil.reportStatus("<p style='color:red'> PDF Document: "+fileName+" does not contain [<b> "+extraEDCode+" </b>] </p>", "Fail", false);
				//TestUtil.reportStatus("<p style='color:red'> Endorsement <b> [ "+collectiveEndorsementCode+" ] </b> is not present on premium summary page.</p>", "Info", false);
				fail_count = fail_count + 1;
				//TestUtil.reportStatus("<p style='color:red'> Extra endorsement <b> [ "+extraEDCode+" ] </b> is getting displayed on Premium Summary screen which should not be present. </p>", "Info", true);
			}
		}
		
		//This will verify endorsements presents below "Sections Endorsements" table.
		flag="true";
		collectiveDataIT = common.EndorsementCollectiveData.entrySet().iterator();
		while(collectiveDataIT.hasNext()){
			Map.Entry collectiveDataMapValue = (Map.Entry)collectiveDataIT.next();
			String collectiveEndorsementCode = collectiveDataMapValue.getKey().toString();
			
			Iterator individualDataIT = common.EndorsementCollectiveData.get(collectiveEndorsementCode).entrySet().iterator();
			while(individualDataIT.hasNext()){
				Map.Entry individualDataMapValue = (Map.Entry)individualDataIT.next();
				String individualEndorsementTitle = individualDataMapValue.getValue().toString();
				if(individualEndorsementTitle.contains("Contract Lift")){
					individualEndorsementTitle = "CPA Contract Lift Cover (Lifted Goods)";
				}
				if(individualEndorsementTitle.contains("Offshore Work")){
					individualEndorsementTitle = "Offshore Work And Visits";
				}
				String mergedEndorsementText = collectiveEndorsementCode+" - "+individualEndorsementTitle;
				if(parsedText.contains(mergedEndorsementText)){
					//TestUtil.reportStatus("Verified Endorsement : [<b> "+collectiveEndorsementCode+" - "+individualEndorsementTitle+"</b>] in "+fileName+" document.", "Pass", false);
					//TestUtil.reportStatus("Applied Endorsement <b> [ "+collectiveEndorsementCode+" </b> with title as <b> "+individualEndorsementSection+" ] </b> is present on premium summary page.", "Info", false);
					fail_count = fail_count + 0;
					flag = "true";
					break;
				}else{
					flag="false";
				}
			}
			if(flag.equalsIgnoreCase("false")){
				TestUtil.reportStatus("<p style='color:red'> PDF Document: "+fileName+" does not contain [<b> "+collectiveEndorsementCode+" </b>] </p>", "Fail", false);
				//TestUtil.reportStatus("<p style='color:red'> Endorsement <b> [ "+collectiveEndorsementCode+" ] </b> is not present on premium summary page.</p>", "Info", false);
				fail_count = fail_count + 1;
			}
		}
		
		//Validate extra endorsement present on Endorsement screen should not be present on Premium Screen.
		extraEndorsementDetailsIT = common.ExtraEndorsementList.entrySet().iterator();
		while(extraEndorsementDetailsIT.hasNext()){
			Map.Entry extraEdnorsementValue = (Map.Entry)extraEndorsementDetailsIT.next();
			String extraEDCode = extraEdnorsementValue.getValue().toString();
			
			if(parsedText.contains(extraEDCode)){
				TestUtil.reportStatus("<p style='color:red'> PDF Document: "+fileName+" does not contain [<b> "+extraEDCode+" </b>] </p>", "Fail", false);
				//TestUtil.reportStatus("<p style='color:red'> Endorsement <b> [ "+collectiveEndorsementCode+" ] </b> is not present on premium summary page.</p>", "Info", false);
				fail_count = fail_count + 1;
				//TestUtil.reportStatus("<p style='color:red'> Extra endorsement <b> [ "+extraEDCode+" ] </b> is getting displayed on Premium Summary screen which should not be present. </p>", "Info", true);
			}
		}	
			
		if(!common.currentRunningFlow.contains("MTA")){
			if(!((String)mdata.get("PS_Duration")).equalsIgnoreCase("365")){
				
				double total_Gross_Premium = transaction_Premium_Values.get("Totals").get("Gross Premium");
				String formated_G_premium = formatter.format((int) Math.floor(total_Gross_Premium));
				fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("Premium "+formated_G_premium), "Premium = &pound;"+formated_G_premium , fileName);
				
				String total_policy_fee = (String)mdata.get("PS_TotalAdminFee");
				String formated_policy_fee = formatter.format((int) Math.floor(Double.parseDouble(total_policy_fee)));
				
				fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("Policy Fee "+formated_policy_fee), "Policy Fee &pound;"+formated_policy_fee , fileName);
				
				double total_I_tax = transaction_Premium_Values.get("Totals").get("Insurance Tax");
				String formated_I_tax = formatter.format((int) Math.floor(total_I_tax));
				
				fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("Insurance Premium Tax "+formated_I_tax), "Insurance Premium Tax = &pound;"+formated_I_tax , fileName);
				double total_p=(transaction_Premium_Values.get("Totals").get("Gross Premium")) + (transaction_Premium_Values.get("Totals").get("Insurance Tax")) + Double.parseDouble((String)mdata.get("PS_TotalAdminFee"));
				String formated_total_Premium = formatter.format((int) Math.floor(total_p));
				
				fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("TOTAL "+formated_total_Premium), "TOTAL &pound;"+formated_total_Premium , fileName);
				
			}else{
				String total_Gross_Premium = (String)mdata.get("PS_Total_GP");
				String formated_G_premium = formatter.format((int) Math.floor(Double.parseDouble(total_Gross_Premium)));
				fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("Premium "+formated_G_premium), "Premium = &pound;"+formated_G_premium , fileName);
				
				String total_policy_fee = (String)mdata.get("PS_TotalAdminFee");
				String formated_policy_fee = formatter.format((int) Math.floor(Double.parseDouble(total_policy_fee)));
				
				fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("Policy Fee "+formated_policy_fee), "Policy Fee &pound;"+formated_policy_fee , fileName);
				
				String total_I_tax = (String)mdata.get("PS_Total_GT"); 
				String formated_I_tax = formatter.format((int) Math.floor(Double.parseDouble(total_I_tax)));
				
				fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("Insurance Premium Tax "+formated_I_tax), "Insurance Premium Tax = &pound;"+formated_I_tax , fileName);
				double total_p=(Double.parseDouble((String)mdata.get("PS_Total_GP"))) + (Double.parseDouble((String)mdata.get("PS_Total_GT"))) + Double.parseDouble((String)mdata.get("PS_TotalAdminFee"));
				
				String formated_total_Premium = formatter.format((int) Math.floor(total_p));
				
				fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("TOTAL "+formated_total_Premium), "TOTAL &pound;"+formated_total_Premium , fileName);
				
			}
		}
		
		break;
		
		case "Statement of Fact":
			
			fail_count=0;
			formatter = new DecimalFormat("#,###,###.##");
			String formated_turnover = null;
			incrementalDays = Integer.parseInt(CONFIG.getProperty("DaysIncrementNumber"));
			//fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains((String)mdata.get("pdf_ProductName")), "Product name :"+(String)mdata.get("pdf_ProductName") , fileName);
			if(common.currentRunningFlow.contains("NB") || common.currentRunningFlow.contains("MTA")){
				fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("INSURED NAME - "+(String)common.NB_excel_data_map.get("NB_ClientName")), "Insured Name : "+(String)common.NB_excel_data_map.get("NB_ClientName") , fileName);
				fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("BROKER NAME - "+(String)common.NB_excel_data_map.get("QC_AgencyName")), "BROKER NAME - "+(String)common.NB_excel_data_map.get("QC_AgencyName") , fileName);
			}else{
				fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("BROKER NAME - "+(String)mdata.get("QC_AgencyName")), "BROKER NAME - "+(String)mdata.get("QC_AgencyName") , fileName);
			}
			
			
		
			if(docType.contains("Draft")){
				if(!common.currentRunningFlow.equalsIgnoreCase("Renewal")){
					fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("Quote Reference: "+(String)mdata.get("NB_QuoteNumber")) ,"Quote Reference : "+mdata.get("NB_QuoteNumber"),fileName);
					fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("Quotation Date: "+common.daysIncrement((String)mdata.get("QC_InceptionDate"), -incrementalDays)) ,"Quote Date : "+common.daysIncrement((String)mdata.get("QC_InceptionDate"), -incrementalDays),fileName);
				}else{
					fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("Quote Reference: "+(String)common.Renewal_excel_data_map.get(common.currentRunningFlow+"_QuoteNumber")) ,"Quote Reference : "+common.Renewal_excel_data_map.get(common.currentRunningFlow+"_QuoteNumber"),fileName);
			}
			}
			fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("Registered Address: "+(String)mdata.get("CC_Address")), "Registered Address: "+(String)mdata.get("CC_Address") , fileName);
			fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("Postcode / City: "+(String)mdata.get("CC_Postcode")), "Postcode / City: "+(String)mdata.get("CC_Postcode") , fileName);
			//fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("County / Country: "+(String)mdata.get("CC_Country")), "County / Country: "+(String)mdata.get("CC_Country") , fileName);
			if((String)mdata.get("CC_County")==null || ((String)mdata.get("CC_County")).equalsIgnoreCase("")){
				fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("County / Country: "+(String)mdata.get("CC_Country")), "County / Country: "+(String)mdata.get("CC_Country") , fileName);
			}else{
				fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("County / Country: "+(String)mdata.get("CC_County")+", "+(String)mdata.get("CC_Country")), "County / Country: "+(String)mdata.get("CC_County")+", "+(String)mdata.get("CC_Country") , fileName);
			}
			
			
			fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("Year Established: "+(String)mdata.get("PG_YearEstablished")), "Year Established: "+(String)mdata.get("PG_YearEstablished") , fileName);
//			fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("Geographic Limit of Proposers Business: "+(String)mdata.get("PG_GeoLimit")), "Geographic Limit of Proposers Business: "+(String)mdata.get("PG_GeoLimit") , fileName);
			String[] substring = null;
			String[] substringParsedText = null;
			
			if(!TestBase.product.equalsIgnoreCase("LEA")){
				if((((((String)mdata.get("CD_Public&ProductsLiability")).equals("Yes") && !((String)mdata.get("CD_Add_Public&ProductsLiability")).equals("No"))  || ((String)mdata.get("CD_Add_Public&ProductsLiability")).equals("Yes"))) && (((((String)mdata.get("CD_AnnualWorks")).equals("Yes") && !((String)mdata.get("CD_Add_AnnualWorks")).equals("No"))  || ((String)mdata.get("CD_Add_AnnualWorks")).equals("Yes")))){
					if(((((String)mdata.get("CD_LegalExpenses")).equals("Yes") && !((String)mdata.get("CD_Add_LegalExpenses")).equals("No"))  || ((String)mdata.get("CD_Add_LegalExpenses")).equals("Yes"))){
						formated_turnover = formatter.format(Double.parseDouble((String)mdata.get("LE_Turnover")));
						fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("Turnover "+formated_turnover), "Turnover &pound;"+formated_turnover , fileName);
					}					
				}
				substring = parsedText.split("Operative Sections");
				substringParsedText = substring[1].split("Employee Wages Breakdown");
			}
			
			switch (CommonFunction_VELA.product) {
			case "COB":
				if(common.currentRunningFlow.contains("MTA")){
					if(((String)common.MTA_excel_data_map.get("CD_Add_EmployersLiability")).equals("Yes")){
						fail_count = fail_count + CommonFunction_VELA.verification(substringParsedText[0].contains("Employers Liability"), "Employers Liability " , fileName);
					}
				}else{
					if(((((String)mdata.get("CD_EmployersLiability")).equals("Yes") && !((String)mdata.get("CD_Add_EmployersLiability")).equals("No"))  || ((String)mdata.get("CD_Add_EmployersLiability")).equals("Yes"))){
						fail_count = fail_count + CommonFunction_VELA.verification(substringParsedText[0].contains("Employers Liability"), "Employers Liability " , fileName);
					}else{
						fail_count = fail_count + CommonFunction_VELA.verification(!substringParsedText[0].contains("Employers Liability"), "Employers Liability" , fileName);
					}
				}
				
				if(common.currentRunningFlow.contains("MTA")){
					if(((String)common.MTA_excel_data_map.get("CD_Add_Public&ProductsLiability")).equals("Yes")){
						fail_count = fail_count + CommonFunction_VELA.verification(substringParsedText[0].contains("Public & Products Liability"), "Public & Products Liability" , fileName);
					}
				}else{
					if(((((String)mdata.get("CD_Public&ProductsLiability")).equals("Yes") && !((String)mdata.get("CD_Add_Public&ProductsLiability")).equals("No"))  || ((String)mdata.get("CD_Add_Public&ProductsLiability")).equals("Yes"))){
						fail_count = fail_count + CommonFunction_VELA.verification(substringParsedText[0].contains("Public & Products Liability"), "Public & Products Liability" , fileName);
					}else{
						fail_count = fail_count + CommonFunction_VELA.verification(!substringParsedText[0].contains("Public & Products Liability"), "Public & Products Liability" , fileName);
					}
				}
				
				if(common.currentRunningFlow.contains("MTA")){
					if(((String)common.MTA_excel_data_map.get("CD_Add_AnnualWorks")).equals("Yes")){
						fail_count = fail_count + CommonFunction_VELA.verification(substringParsedText[0].contains("Annual Works"), "Annual Works" , fileName);
					}
				}else{
					if(((((String)mdata.get("CD_AnnualWorks")).equals("Yes") && !((String)mdata.get("CD_Add_AnnualWorks")).equals("No"))  || ((String)mdata.get("CD_Add_AnnualWorks")).equals("Yes"))){
						fail_count = fail_count + CommonFunction_VELA.verification(substringParsedText[0].contains("Annual Works"), "Annual Works" , fileName);
						
					}else{
						fail_count = fail_count + CommonFunction_VELA.verification(!substringParsedText[0].contains("Annual Works"), "Annual Works" , fileName);
					}
				}
				
				if(common.currentRunningFlow.contains("MTA")){
					if(((String)common.MTA_excel_data_map.get("CD_Add_OwnPlant")).equals("Yes")){
						fail_count = fail_count + CommonFunction_VELA.verification(substringParsedText[0].contains("Own Plant"), "Own Plant" , fileName);
					}
				}else{
					if(((((String)mdata.get("CD_OwnPlant")).equals("Yes") && !((String)mdata.get("CD_Add_OwnPlant")).equals("No"))  || ((String)mdata.get("CD_Add_OwnPlant")).equals("Yes"))){
//						String formated_OPmarketvalue = formatter.format(Double.parseDouble((String)mdata.get("OP_CurrentMarketValue")));
						fail_count = fail_count + CommonFunction_VELA.verification(substringParsedText[0].contains("Own Plant"), "Own Plant" , fileName);
//						fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("Own Plant - Market Value &pound;"+formated_OPmarketvalue), "Own Plant - Market Value &pound;"+formated_OPmarketvalue , fileName);
						
					}else{
						fail_count = fail_count + CommonFunction_VELA.verification(!substringParsedText[0].contains("Own Plant"), "Own Plant" , fileName);
					}
				}
				
				if(common.currentRunningFlow.contains("MTA")){
					if(((String)common.MTA_excel_data_map.get("CD_Add_HiredInPlant")).equals("Yes")){
						fail_count = fail_count + CommonFunction_VELA.verification(substringParsedText[0].contains("Hired In Plant"), "Hired In Plant" , fileName);
					}
				}else{
					if(((((String)mdata.get("CD_HiredInPlant")).equals("Yes") && !((String)mdata.get("CD_Add_HiredInPlant")).equals("No"))  || ((String)mdata.get("CD_Add_HiredInPlant")).equals("Yes"))){
						fail_count = fail_count + CommonFunction_VELA.verification(substringParsedText[0].contains("Hired In Plant"), "Hired In Plant" , fileName);
					}else{
						fail_count = fail_count + CommonFunction_VELA.verification(!substringParsedText[0].contains("Hired In Plant"), "Hired In Plant" , fileName);
					}
				}
				
				if(common.currentRunningFlow.contains("MTA")){
					if(((String)common.MTA_excel_data_map.get("CD_Add_JCT6.5.1")).equals("Yes")){
						fail_count = fail_count + CommonFunction_VELA.verification(substringParsedText[0].contains("JCT 6.5.1"), "JCT 6.5.1" , fileName);
					}
				}else{
					if(((((String)mdata.get("CD_JCT6.5.1")).equals("Yes") && !((String)mdata.get("CD_Add_JCT6.5.1")).equals("No"))  || ((String)mdata.get("CD_Add_JCT6.5.1")).equals("Yes"))){
						fail_count = fail_count + CommonFunction_VELA.verification(substringParsedText[0].contains("JCT 6.5.1"), "JCT 6.5.1" , fileName);
					}else{
						fail_count = fail_count + CommonFunction_VELA.verification(!substringParsedText[0].contains("JCT 6.5.1"), "JCT 6.5.1" , fileName);
					}
				}
				
				if(common.currentRunningFlow.contains("MTA")){
					if(((String)common.MTA_excel_data_map.get("CD_Add_PropertyOwnersLiability")).equals("Yes")){
						fail_count = fail_count + CommonFunction_VELA.verification(substringParsedText[0].contains("Property Owners Liability"), "Property Owners Liability" , fileName);
					}
				}else{
					if(((((String)mdata.get("CD_PropertyOwnersLiability")).equals("Yes") && !((String)mdata.get("CD_Add_PropertyOwnersLiability")).equals("No"))  || ((String)mdata.get("CD_Add_PropertyOwnersLiability")).equals("Yes"))){
						fail_count = fail_count + CommonFunction_VELA.verification(substringParsedText[0].contains("Property Owners Liability"), "Property Owners Liability" , fileName);
					}else{
						fail_count = fail_count + CommonFunction_VELA.verification(!substringParsedText[0].contains("Property Owners Liability"), "Property Owners Liability" , fileName);
					}
				}
				
				if(common.currentRunningFlow.contains("MTA")){
					if(((String)common.MTA_excel_data_map.get("CD_Add_LegalExpenses")).equals("Yes")){
						fail_count = fail_count + CommonFunction_VELA.verification(substringParsedText[0].contains("Legal Expenses"), "Legal Expenses" , fileName);
					}
				}else{
					if(((((String)mdata.get("CD_LegalExpenses")).equals("Yes") && !((String)mdata.get("CD_Add_LegalExpenses")).equals("No"))  || ((String)mdata.get("CD_Add_LegalExpenses")).equals("Yes"))){
						fail_count = fail_count + CommonFunction_VELA.verification(substringParsedText[0].contains("Legal Expenses"), "Legal Expenses" , fileName);
					}else{
						fail_count = fail_count + CommonFunction_VELA.verification(!substringParsedText[0].contains("Legal Expenses"), "Legal Expenses" , fileName);
					}
				}
				
				if(common.currentRunningFlow.contains("MTA")){
					if(((String)common.MTA_excel_data_map.get("CD_Add_Terrorism")).equals("Yes")){
						fail_count = fail_count + CommonFunction_VELA.verification(substringParsedText[0].contains("Terrorism"), "Terrorism" , fileName);
					}
				}
				else{
					if(((((String)mdata.get("CD_Terrorism")).equals("Yes") && !((String)mdata.get("CD_Add_Terrorism")).equals("No"))  || ((String)mdata.get("CD_Add_Terrorism")).equals("Yes"))){
						fail_count = fail_count + CommonFunction_VELA.verification(substringParsedText[0].contains("Terrorism"), "Terrorism" , fileName);
					}else{
						fail_count = fail_count + CommonFunction_VELA.verification(!substringParsedText[0].contains("Terrorism"), "Terrorism" , fileName);
					}
				}
				
				
				// Material Facts question verification started
	/*			fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("CPA within 90 days of the\r\ninception of this policy "+(String)mdata.get("MFD_Q1")), "Question 1" , fileName);
				fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("rise to a claim in respect of the\r\nrisks proposed?\r\n"+(String)mdata.get("MFD_Q2")), "Question 2" , fileName);
				fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("renewal refused or had special terms imposed?\r\n"+(String)mdata.get("MFD_Q3")), "Question 3" , fileName);
				fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("pending other than motor offences?\r\n"+(String)mdata.get("MFD_Q4")), "Question 4" , fileName);
				fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("proceedings or receivership/ insolvency proceedings?\r\n"+(String)mdata.get("MFD_Q5")), "Question 5" , fileName);
				fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("disqualified from holding company directorship? "+(String)mdata.get("MFD_Q6")), "Question 6" , fileName);
				fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("or\r\nadministrative receivership proceedings?\r\n"+(String)mdata.get("MFD_Q7")), "Question 7" , fileName);
				fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("capacity had a county court judgement awarded against\r\nthem?\r\n"+(String)mdata.get("MFD_Q8")), "Question 8" , fileName);
				fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("the\r\nUN, EU, US, UK and any other relevant jurisdiction?\r\n"+(String)mdata.get("MFD_Q9")), "Question 9" , fileName);
				fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("Are any products supplied to hazardous industries? "+(String)mdata.get("MFD_Q11")), "Question 11" , fileName);
				fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("Do you source products from outside of the EU? "+(String)mdata.get("MFD_Q12")), "Question 12" , fileName);
				fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("Do you have full rights of recourse from the manufacturer of any products? "+(String)mdata.get("MFD_Q13")), "Question 13" , fileName);
				fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("Does the Insured have a written health & safety policy? "+(String)mdata.get("MFD_Q14")), "Question 14" , fileName);
				fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("to\r\nprovide Health & Safety advice and training? "+(String)mdata.get("MFD_Q15")), "Question 15" , fileName);
				fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("Do all new staff undertake a Health & Safety induction course? "+(String)mdata.get("MD_S_Q15")), "Question 15S" , fileName);
				fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("Do all employees have a training & development log? "+(String)mdata.get("MD_SS_Q15")), "Question 15SS" , fileName);
				fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("main\r\nworkplace/contract sites including health hazards? "+(String)mdata.get("MFD_Q16")), "Question 16" , fileName);
				fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("identify & rectify any\r\nHealth & Safety hazards? "+(String)mdata.get("MFD_Q17")), "Question 17" , fileName);
				fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("Does the Insured undertake post incident reviews following injuries/losses or near misses? "+(String)mdata.get("MFD_Q18")), "Question 18" , fileName);
				fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("Is Personal Protective Equipment (PPE) provided & signed for? "+(String)mdata.get("MFD_Q19")), "Question 19" , fileName);
				fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("Do you undertake RIDDOR reporting? "+(String)mdata.get("MFD_Q20")), "Question 20" , fileName);
				fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("Work with silica, asbestos, or substances containing asbestos? "+(String)mdata.get("MFD_Q21")), "Question 21" , fileName);
				fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("Will work stop and a licensed sub-contractor be employed to deal with any such material? "+(String)mdata.get("MFD_Q22")), "Question 22" , fileName);
				fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("Will a licensed sub-contractor be employed to deal with any such material that does not require\r\na license? "+(String)mdata.get("MFD_Q23")), "Question 23" , fileName);
				fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("\r\nto principal clause and no asbestos exclusions or restrictions? "+(String)mdata.get("MFD_Q24")), "Question 24" , fileName);
				fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("Work with acids, gases, chemicals, explosives, radioactive or similar dangerous liquids or\r\nsubstances? "+(String)mdata.get("MFD_Q25")), "Question 25" , fileName);
				fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("Work on power stations, nuclear installations or establishments? "+(String)mdata.get("MFD_Q26")), "Question 26" , fileName);
				fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("Work on refineries, bulk storage, or premises in oil, gas or chemical industries? "+(String)mdata.get("MFD_Q27")), "Question 27" , fileName);
				fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("underground,\r\nquarries, underwater at docks, harbours or piers? "+(String)mdata.get("MFD_Q28")), "Question 28" , fileName);
				fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("Work in or on computer suites or on computers? "+(String)mdata.get("MFD_Q29")), "Question 29" , fileName);
				fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("Work on Bridges, viaducts, towers, steeples, chimney shafts or blast furnaces? "+(String)mdata.get("MFD_Q30")), "Question 30" , fileName);
				fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("Work with any fixed powered woodworking machinery? "+(String)mdata.get("MFD_Q31")), "Question 31" , fileName);
				fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("Joint Code of Practice for the prevention of fires on construction\r\nsites? "+(String)mdata.get("MFD_Q32")), "Question 32" , fileName);
				fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("Does the Insured have a fire evacuation procedure? "+(String)mdata.get("MFD_Q33")), "Question 33" , fileName);
				fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("Does any of the work involve the application of heat? "+(String)mdata.get("MFD_Q34")), "Question 34" , fileName);
				fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("When appointing Bona Fide Sub-Contractors is a check made that they have EL & PL insurance? "+(String)mdata.get("MFD_Q35")), "Question 35" , fileName);
				fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("Are there any other material facts that you wish to disclose that may affect your policy? "+(String)mdata.get("MFD_Q36")), "Question 36" , fileName);
		*/		
				break;
			case "XOC":
			case "XOQ":
				if(((String)mdata.get("CD_CombinedLiability")).equals("Yes")){
					
					fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("Public & Products Liability"), "Public & Products Liability" , fileName);
					fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("Employers Liability"), "Employers Liability " , fileName);
				}
				if(((String)mdata.get("CD_EmployersLiability")).equals("Yes")){
					fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("Employers Liability"), "Employers Liability " , fileName);
				}
				if(((String)mdata.get("CD_Public&ProductsLiability")).equals("Yes")){
					fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("Public & Products Liability"), "Public & Products Liability" , fileName);
				}
				if(((String)mdata.get("CD_JCT6.5.1")).equals("Yes")){
					fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("JCT 6.5.1"), "JCT 6.5.1" , fileName);
				}
				
				if(((String)mdata.get("CD_ThirdPartyMotorLiability")).equals("Yes")){
					fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("Property Owners Liability"), "Property Owners Liability" , fileName);
				}
				
				
				// Material Facts question verification started
				fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("been involved in any incident or circumstances which may give rise to a claim in respect of the\nrisks proposed?"+(String)mdata.get("MFD_Q1")), "Question 1" , fileName);
				fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("repudiated or ever had an insurance cancelled, renewal refused or had special terms imposed?"+(String)mdata.get("MFD_Q2")), "Question 2" , fileName);
				fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("prosecutions pending other than motor offences?"+(String)mdata.get("MFD_Q3")), "Question 3" , fileName);
				fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("subject of bankruptcy proceedings or receivership/ insolvency proceedings?"+(String)mdata.get("MFD_Q4")), "Question 4" , fileName);
			//	fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("subject of bankruptcy proceedings or receivership/ insolvency proceedings?"+(String)mdata.get("MFD_Q5")), "Question 5" , fileName);
				fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("been disqualified from holding company directorship? "+(String)mdata.get("MFD_Q5")), "Question 5" , fileName);
				fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("administrative receivership proceedings?"+(String)mdata.get("MFD_Q6")), "Question 6" , fileName);
				fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("in any business capacity had a county court judgement awarded against them?"+(String)mdata.get("MFD_Q7")), "Question 7" , fileName);
				fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("UN, EU, US, UK and any other relevant jurisdiction?"+(String)mdata.get("MFD_Q8")), "Question 8" , fileName);
				fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("prosecution or prohibition notice or improvement order?"+(String)mdata.get("MFD_Q9")), "Question 9" , fileName);
				fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("Are there any other material facts that you wish to disclose that may affect your policy? *"+(String)mdata.get("MFD_Q27")), "Question 27" , fileName);
				//fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("CPA within 90 days of the inception of this policy "+(String)mdata.get("MFD_Q37")), "Question 37" , fileName);
				
				break;
			default:
				break;
			}
			
			break;
			
		case "Policy Wording":
			
			TestUtil.reportStatus(fileName+" Verification Not in Scope . ", "Info", true);
			break;
			
		case "Employers Liability Certificate":
			
			fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("Policy Number: "+(String)mdata.get("NB_PolicyNumber")), "Policy Number: "+(String)mdata.get("NB_PolicyNumber") , fileName);
			fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("Name of Insured: "+(String)mdata.get("NB_ClientName")), "Name of Insured: "+(String)mdata.get("NB_ClientName") , fileName);
			fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("Date of Commencement of Insurance: "+common.daysIncrement((String)mdata.get("QC_InceptionDate"), 0)), "Date of Commencement of Insurance: "+common.daysIncrement((String)mdata.get("QC_InceptionDate"), 0) , fileName);
			fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("Date of Expiry of Insurance: "+common.daysIncrement((String)mdata.get("QC_DeadlineDate"), 0)), "Date of Expiry of Insurance: "+common.daysIncrement((String)mdata.get("QC_DeadlineDate"), 0) , fileName);
			
			break;
		case "Invoice":
			formatter = new DecimalFormat("#,###,###.##");
			//fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("Payment Due Date: On or before "+common.advanceMonthByOffSet((String)mdata.get("QC_InceptionDate"), 1)), "Payment Due Date: On or before "+common.advanceMonthByOffSet((String)mdata.get("QC_InceptionDate"), 1) , fileName);
			fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("Policy No: "+(String)mdata.get("NB_PolicyNumber")), "Policy No: "+(String)mdata.get("NB_PolicyNumber") , fileName);	
			fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains((String)mdata.get("NB_ClientName")), (String)mdata.get("NB_ClientName"), fileName);
			//fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("Invoice Date: "+(String)mdata.get("QC_InceptionDate")), "Invoice Date: "+(String)mdata.get("QC_InceptionDate") , fileName);
			//fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("Period: "+(String)mdata.get("QC_InceptionDate")+" to "+common.daysIncrementWithOutFormation((String)mdata.get("QC_InceptionDate"), Integer.parseInt((String)mdata.get("PS_Duration"))-1)), "Period: "+(String)mdata.get("QC_InceptionDate")+" to "+common.daysIncrementWithOutFormation((String)mdata.get("QC_InceptionDate"), Integer.parseInt((String)mdata.get("PS_Duration"))-1) , fileName);
			
			if(common.currentRunningFlow.contains("MTA")){
				double total_Gross_Premium = transaction_Details_Premium_Values.get("Totals").get("Gross Premium");
				String formated_G_premium = formatter.format((int) Math.floor(total_Gross_Premium));
				fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("Premium "+formated_G_premium), "Premium = &pound;"+formated_G_premium , fileName);
				
				String total_policy_fee = (String)mdata.get("PS_TotalAdminFee");
				String formated_policy_fee = formatter.format((int) Math.floor(Double.parseDouble(total_policy_fee)));
				
				fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("Policy Fee "+formated_policy_fee), "Policy Fee &pound;"+formated_policy_fee , fileName);
				
				double total_I_tax = transaction_Details_Premium_Values.get("Totals").get("Insurance Tax");
				String formated_I_tax = formatter.format((int) Math.floor(total_I_tax));
				
				fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("Tax "+formated_I_tax), "Insurance Premium Tax = &pound;"+formated_I_tax , fileName);
				double total_p=(transaction_Details_Premium_Values.get("Totals").get("Gross Premium")) + (transaction_Details_Premium_Values.get("Totals").get("Insurance Tax")) + Double.parseDouble((String)mdata.get("PS_TotalAdminFee"))  - (transaction_Details_Premium_Values.get("Totals").get("Broker Commission"));
				String formated_total_Premium = formatter.format((int) Math.floor(total_p));
				
				fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("Total "+formated_total_Premium), "Total &pound;"+formated_total_Premium , fileName);			

			}else{
				if(!((String)mdata.get("PS_Duration")).equalsIgnoreCase("365")){
					
					double total_Gross_Premium = transaction_Premium_Values.get("Totals").get("Gross Premium");
					String formated_G_premium = formatter.format((int) Math.floor(total_Gross_Premium));
					fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("Premium "+formated_G_premium), "Premium = &pound;"+formated_G_premium , fileName);
					
					String total_policy_fee = (String)mdata.get("PS_TotalAdminFee");
					String formated_policy_fee = formatter.format((int) Math.floor(Double.parseDouble(total_policy_fee)));
					
					fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("Policy Fee "+formated_policy_fee), "Policy Fee &pound;"+formated_policy_fee , fileName);
					
					double total_I_tax = transaction_Premium_Values.get("Totals").get("Insurance Tax");
					String formated_I_tax = formatter.format((int) Math.floor(total_I_tax));
					
					fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("Tax "+formated_I_tax), "Insurance Premium Tax = &pound;"+formated_I_tax , fileName);
					double total_p=(transaction_Premium_Values.get("Totals").get("Gross Premium")) + (transaction_Premium_Values.get("Totals").get("Insurance Tax")) + Double.parseDouble((String)mdata.get("PS_TotalAdminFee"))  - (transaction_Premium_Values.get("Totals").get("Broker Commission"));
					String formated_total_Premium = formatter.format((int) Math.floor(total_p));
					
					fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("Total "+formated_total_Premium), "Total &pound;"+formated_total_Premium , fileName);

				}else{
					String total_Gross_Premium = (String)mdata.get("PS_Total_GP");
					String formated_G_premium = formatter.format((int) Math.floor(Double.parseDouble(total_Gross_Premium)));
					fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("Premium "+formated_G_premium), "Premium = &pound;"+formated_G_premium , fileName);
					
					String total_policy_fee = (String)mdata.get("PS_TotalAdminFee");
					String formated_policy_fee = formatter.format((int) Math.floor(Double.parseDouble(total_policy_fee)));
					
					fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("Policy Fee "+formated_policy_fee), "Policy Fee &pound;"+formated_policy_fee , fileName);
					
					String total_I_tax = (String)mdata.get("PS_Total_GT"); 
					String formated_I_tax = formatter.format((int) Math.floor(Double.parseDouble(total_I_tax)));
					
					fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("Tax "+formated_I_tax), "Insurance Premium Tax = &pound;"+formated_I_tax , fileName);
					double total_p=(Double.parseDouble((String)mdata.get("PS_Total_GP"))) + (Double.parseDouble((String)mdata.get("PS_Total_GT"))) + Double.parseDouble((String)mdata.get("PS_TotalAdminFee"))  - Double.parseDouble((String)mdata.get("PS_BrokerCommissionTotal"));
					
					String formated_total_Premium = formatter.format((int) Math.floor(total_p));
					
					fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("Total "+formated_total_Premium), "Total &pound;"+formated_total_Premium , fileName);
					
				}
			}
			
			
			/*formatter = new DecimalFormat("#,###,###.##");
			fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("Payment Due Date: On or before "+common.advanceMonthByOffSet((String)mdata.get("QC_InceptionDate"), 1)), "Payment Due Date: On or before "+common.advanceMonthByOffSet((String)mdata.get("QC_InceptionDate"), 1) , fileName);
			fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("Policy No: "+(String)mdata.get("NB_PolicyNumber")), "Policy No: "+(String)mdata.get("NB_PolicyNumber") , fileName);	
			fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains((String)mdata.get("NB_ClientName")), (String)mdata.get("NB_ClientName"), fileName);
			fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("Invoice Date: "+(String)mdata.get("QC_InceptionDate")), "Invoice Date: "+(String)mdata.get("QC_InceptionDate") , fileName);
			fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("Period: "+(String)mdata.get("QC_InceptionDate")+" to "+common.daysIncrement((String)mdata.get("QC_InceptionDate"), Integer.parseInt((String)mdata.get("PS_Duration")))), "Period: "+(String)mdata.get("QC_InceptionDate")+" to "+common.daysIncrement((String)mdata.get("QC_InceptionDate"), Integer.parseInt((String)mdata.get("PS_Duration"))) , fileName);
			 total_Gross_Premium = (String)mdata.get("PS_Total_GP");
			formated_G_premium = formatter.format(Double.parseDouble(total_Gross_Premium));
			
			fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("Premium "+formated_G_premium), "Premium = &pound;"+formated_G_premium , fileName);
			
			 total_policy_fee = (String)mdata.get("PS_TotalAdminFee");
			formated_policy_fee = formatter.format(Double.parseDouble(total_policy_fee));
			
			fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("Policy Fee "+formated_policy_fee), "Policy Fee &pound;"+formated_policy_fee , fileName);
			
			total_I_tax = (String)mdata.get("PS_Total_GT"); 
			formated_I_tax = formatter.format(Double.parseDouble(total_I_tax));
			
			fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("Insurance Premium Tax "+formated_I_tax), "Insurance Premium Tax = &pound;"+formated_I_tax , fileName);
			total_p=(Double.parseDouble((String)mdata.get("PS_Total_GP"))) + (Double.parseDouble((String)mdata.get("PS_Total_GT"))) + Double.parseDouble((String)mdata.get("PS_TotalAdminFee"));
			
			total_Premium = formatter.format(total_p);
			final_total_Premium = total_Premium.replaceAll(",", "");
			formated_total_Premium = formatter.format(Double.parseDouble(final_total_Premium));
			
			fail_count = fail_count + CommonFunction_VELA.verification(parsedText.contains("TOTAL "+formated_total_Premium), "TOTAL &pound;"+formated_total_Premium , fileName);
			*/
			break;
		
		//SPI
	}

return fail_count;

}


public double calculateBrokeageAmountTS_Rewind(String code, Map<Object, Object> data_map, String trasacSummaryType,int j,int td){
	double PublicProductsLiabilityPC = 0.00, EmployersLiabiliyPC=0.00, AnnualWorksPC=0.00, OwnPlantPC=0.00, generalPremium;
	double HiredInPlantPC =0.00, JCTPC=0.00, terrorismPC=0.00, PropertyOwnersLiabilityPC=0.00, LegalExpensesPC=0.00;
	double SingleProjectPC=0.00, HireCoverPlusPC=0.00, ThirdPartyMotorLiabilityPC=0.00, CombinedLiabilityPC=0.00;
	
	
	String part1= "//*[@id='table0']/tbody";
	try{
		String type = driver.findElement(By.xpath(part1+"/tr["+j+"]/td[7]")).getText();
		String brokerageAccount= driver.findElement(By.xpath(part1+"/tr["+j+"]/td["+td+"]")).getText();
		if(type.equalsIgnoreCase("FEE")){
			if(common.product.equals("COB")||common.product.equals("COA")||common.product.equals("XOC")||common.product.equals("XOQ")||common.product.equals("LEA")){
				String recipient = driver.findElement(By.xpath(part1+"/tr["+j+"]/td[3]")).getText();
				if(recipient.equalsIgnoreCase("PENFEE")){
					 TestUtil.reportStatus("Expected Recipient PEN FEE verified with Actual Recipient "+recipient, "Pass", false);
				}else{
					 TestUtil.reportStatus("Expected Recipient PEN FEE does not match with Actual Recipient "+recipient, "Fail", false);
				}
			}
			generalPremium	=Double.parseDouble((String)data_map.get("PS_TotalAdminFee"));
		}else if(type.equalsIgnoreCase("T001")){
			if(!((String)data_map.get("PS_Duration")).equalsIgnoreCase("365")){
				generalPremium = transaction_Premium_Values.get("Totals").get("Net Net Premium");
			}else{
				generalPremium = Double.parseDouble((String)data_map.get("PS_NetNetPemiumTotal"));
			}
		}else if(type.equalsIgnoreCase("MGA_COM") && TestBase.product.equalsIgnoreCase("LEA")){
			if(!((String)data_map.get("PS_Duration")).equalsIgnoreCase("365")){
				generalPremium = transaction_Premium_Values.get("Totals").get("Pen Commission");
			}else{
				generalPremium = Double.parseDouble((String)data_map.get("PS_PenCommTotal"));
			}
			//generalPremium	=Double.parseDouble((String)data_map.get("PS_BrokerCommissionTotal"));
		}else if(type.equalsIgnoreCase("MGA_COM") && TestBase.product.equalsIgnoreCase("XOQ")){
				generalPremium =Double.parseDouble((String)data_map.get("PS_PenCommTotal"));
		}else if(type.equalsIgnoreCase("MGA_COM") && TestBase.product.equalsIgnoreCase("COA")){
			generalPremium =Double.parseDouble((String)data_map.get("PS_PenCommTotal"));
		}else{
		
		if((String)common.NB_excel_data_map.get("CD_Public&ProductsLiability")!= null && 
				((((((String)common.NB_excel_data_map.get("CD_Public&ProductsLiability")).equals("Yes"))  && !((String)common.NB_excel_data_map.get("CD_Add_Public&ProductsLiability")).equals("No"))) || ((String)common.NB_excel_data_map.get("CD_Add_Public&ProductsLiability")).equals("Yes")))
		{	
							 
			PublicProductsLiabilityPC = Double.parseDouble((String)data_map.get("PS_Public&ProductsLiability_PenComm"));
		}
		if((String)common.NB_excel_data_map.get("CD_EmployersLiability")!= null && 
				((((((String)common.NB_excel_data_map.get("CD_EmployersLiability")).equals("Yes"))  && !((String)common.NB_excel_data_map.get("CD_Add_EmployersLiability")).equals("No"))) || ((String)common.NB_excel_data_map.get("CD_Add_EmployersLiability")).equals("Yes")))
		{					 
			EmployersLiabiliyPC = Double.parseDouble((String)data_map.get("PS_EmployersLiability_PenComm"));
										
		}
		if((String)common.NB_excel_data_map.get("CD_AnnualWorks")!= null && 
				((((((String)common.NB_excel_data_map.get("CD_AnnualWorks")).equals("Yes"))  && !((String)common.NB_excel_data_map.get("CD_Add_AnnualWorks")).equals("No"))) || ((String)common.NB_excel_data_map.get("CD_Add_AnnualWorks")).equals("Yes")))
		{					
			AnnualWorksPC = Double.parseDouble((String)data_map.get("PS_AnnualWorks_PenComm"));
											
		}
		if((String)common.NB_excel_data_map.get("CD_OwnPlant")!= null && 
				((((((String)common.NB_excel_data_map.get("CD_OwnPlant")).equals("Yes"))  && !((String)common.NB_excel_data_map.get("CD_Add_OwnPlant")).equals("No"))) || ((String)common.NB_excel_data_map.get("CD_Add_OwnPlant")).equals("Yes")))
		{					
			 OwnPlantPC = Double.parseDouble((String)data_map.get("PS_OwnPlant_PenComm"));
																
		}
		if((String)common.NB_excel_data_map.get("CD_SingleProject")!= null && 
				((((((String)common.NB_excel_data_map.get("CD_SingleProject")).equals("Yes"))  && !((String)common.NB_excel_data_map.get("CD_Add_SingleProject")).equals("No"))) || ((String)common.NB_excel_data_map.get("CD_Add_SingleProject")).equals("Yes")))
		{
			 SingleProjectPC = Double.parseDouble((String)data_map.get("PS_SingleProject_PenComm"));
														
		}	
		if((String)common.NB_excel_data_map.get("CD_HiredInPlant")!= null && 
				((((((String)common.NB_excel_data_map.get("CD_HiredInPlant")).equals("Yes"))  && !((String)common.NB_excel_data_map.get("CD_Add_HiredInPlant")).equals("No"))) || ((String)common.NB_excel_data_map.get("CD_Add_HiredInPlant")).equals("Yes")))
		{					
			 HiredInPlantPC = Double.parseDouble((String)data_map.get("PS_HiredInPlant_PenComm"));
																
		}
		String agency_Name = driver.findElement(By.xpath("html/body/div[3]/form/table/tbody/tr[2]/td[2]")).getText();
		if(agency_Name.equals("M722")){
			if((String)common.NB_excel_data_map.get("CD_HireCoverPlus")!= null && 
					((((((String)common.NB_excel_data_map.get("CD_HireCoverPlus")).equals("Yes"))  && !((String)common.NB_excel_data_map.get("CD_Add_HireCoverPlus")).equals("No"))) || ((String)common.NB_excel_data_map.get("CD_Add_HireCoverPlus")).equals("Yes")))
			{
				HireCoverPlusPC = Double.parseDouble((String)data_map.get("PS_HireCoverPlus_PenComm"));
												
			}
		}
		
		if((String)common.NB_excel_data_map.get("CD_JCT6.5.1")!= null && 
				((((((String)common.NB_excel_data_map.get("CD_JCT6.5.1")).equals("Yes"))  && !((String)common.NB_excel_data_map.get("CD_Add_JCT6.5.1")).equals("No"))) || ((String)common.NB_excel_data_map.get("CD_Add_JCT6.5.1")).equals("Yes")))
		{
			 JCTPC = Double.parseDouble((String)data_map.get("PS_JCT6.5.1_PenComm"));
											
		}
		if((String)common.NB_excel_data_map.get("CD_Terrorism")!= null && 
				((((((String)common.NB_excel_data_map.get("CD_Terrorism")).equals("Yes"))  && !((String)common.NB_excel_data_map.get("CD_Add_Terrorism")).equals("No"))) || ((String)common.NB_excel_data_map.get("CD_Add_Terrorism")).equals("Yes")))
		{
			 terrorismPC = Double.parseDouble((String)data_map.get("PS_Terrorism_PenComm"));
																	
		}
		if((String)common.NB_excel_data_map.get("CD_PropertyOwnersLiability")!= null && 
				((((((String)common.NB_excel_data_map.get("CD_PropertyOwnersLiability")).equals("Yes"))  && !((String)common.NB_excel_data_map.get("CD_Add_PropertyOwnersLiability")).equals("No"))) || ((String)common.NB_excel_data_map.get("CD_Add_PropertyOwnersLiability")).equals("Yes")))
		{
			 PropertyOwnersLiabilityPC = Double.parseDouble((String)data_map.get("PS_PropertyOwnersLiability_PenComm"));
																	
		}
		if((String)common.NB_excel_data_map.get("CD_LegalExpenses")!= null && 
				((((((String)common.NB_excel_data_map.get("CD_LegalExpenses")).equals("Yes"))  && !((String)common.NB_excel_data_map.get("CD_Add_LegalExpenses")).equals("No"))) || ((String)common.NB_excel_data_map.get("CD_Add_LegalExpenses")).equals("Yes")))
		{
			 LegalExpensesPC = Double.parseDouble((String)data_map.get("PS_LegalExpenses_PenComm"));
														
		}	
		if((String)data_map.get("CD_ThirdPartyMotorLiability")!= null && ((String)data_map.get("CD_ThirdPartyMotorLiability")).equals("Yes"))
		{
			ThirdPartyMotorLiabilityPC = Double.parseDouble((String)data_map.get("PS_ThirdPartyMotorLiability_PenComm"));
														
		}	
		if((String)data_map.get("CD_CombinedLiability")!= null && ((String)data_map.get("CD_CombinedLiability")).equals("Yes"))
		{
			CombinedLiabilityPC = Double.parseDouble((String)data_map.get("PS_CombinedLiability_PenComm"));
														
		}	
		generalPremium= PublicProductsLiabilityPC + EmployersLiabiliyPC + AnnualWorksPC + OwnPlantPC + HiredInPlantPC 
				+ JCTPC + terrorismPC + PropertyOwnersLiabilityPC + LegalExpensesPC + SingleProjectPC + HireCoverPlusPC + CombinedLiabilityPC
				+ ThirdPartyMotorLiabilityPC;
		}
			String generalammount = decim.format(generalPremium);
	
		
			compareValues(Double.parseDouble(generalammount), Double.parseDouble(brokerageAccount), "General Brokerage Amount ");
			return Double.parseDouble(generalammount);
	}catch(Throwable t) {
		String methodName = new Object(){}.getClass().getEnclosingMethod().getName();
		TestUtil.reportFunctionFailed("Failed in "+methodName+" function");     k.reportErr("Failed in "+methodName+" function", t);
		Assert.fail("Failed in Calculate Brokerage ammout. \n", t);
		return 0;
	}
}


/**
 * 
 * 
 * 
 *  END of PDF verifications functions for Rewind flows.
 * 
 * 
 */

/**
 * 
 * This method verifies Validation Rules on Quote Check screen."
 * 
 *
 */

public boolean func_Verify_Validation_Rules(){

boolean r_value=false;

try{
	
	Map<Object,Object> data_map = null;
	switch(common.currentRunningFlow){
		case "NB":
			data_map = common.NB_excel_data_map;
			break;
		case "Renewal":
			data_map = common.Renewal_excel_data_map;
			break;
		}
		try{
			k.ImplicitWaitOff();
			if(driver.findElement(By.xpath("//*[text()='This quote has been checked and no issues were found.']")).isDisplayed()){
				return true;
			}
		}catch(Throwable t){
			
		}
	
		String validationRulesTbl_xpath = "//*[text()='Validation Rules']//following::table[1]";
		WebElement validationRules_Table = driver.findElement(By.xpath(validationRulesTbl_xpath));
		k.ScrollInVewWebElement(validationRules_Table);
		
		int validation_tble_Rows = validationRules_Table.findElements(By.tagName("tr")).size();
		int Description_col_index = 2,Section_col_index=1;
		
		if(validationRules_Table.isDisplayed()){
			
			TestUtil.reportStatus("Validation Rule verification started on quote check screen . ","Info",false);
			
			//int total_referral_messages = common_VELA.referrals_list.size();
			String validation_msg_section=null,validation_Txt=null;
			WebElement w_validation_Row = null,w_validationSection_Row=null;
			boolean isValidationFound=false;
			
			//if((validation_tble_Rows-1) <= common_VELA.quote_validations_list.size()){
			//For each referral message
			for(String validation_msg : common_VELA.quote_validations_list){
				isValidationFound=false;
			//for(int message = 1; message <= total_referral_messages ;message ++){
				validation_msg_section = validation_msg.split("_")[0];
				validation_Txt = validation_msg.split("_")[1];
				
				for(int row = 1; row < validation_tble_Rows ;row ++){
					
					
					//Referral Text
					w_validation_Row = driver.findElement(By.xpath(validationRulesTbl_xpath+"//tbody//tr["+row+"]//td["+Description_col_index+"]"));
					if(w_validation_Row.getText().equals(validation_Txt)){
						isValidationFound = true;
						TestUtil.reportStatus("Validation  >><b>"+validation_Txt+"</b><< verified sucessfully . ","Pass",false);
						
						/*//Referral Section
						w_validationSection_Row = driver.findElement(By.xpath(referralRulesTbl_xpath+"//tbody//tr["+row+"]//td["+Section_col_index+"]"));
						if(!w_referralSection_Row.getText().equals(referral_msg_section)){
							TestUtil.reportStatus("<p style='color:red'> Referral Section is incorrect for referral - >><b>"+referral_Txt+"</b><<  Expexted: <b>"+referral_msg_section+"</b> and Actual: </b>"+w_referralSection_Row.getText()+"</b> . </p>", "Fail", true);
							ErrorUtil.addVerificationFailure(new Throwable("Referral Section is incorrect for referral - >><b>"+referral_Txt+"</b><<  Expexted: <b>"+referral_msg_section+"</b> and Actual: "));
							
						}*/
						break;
					}else
						continue;
					
				}
				
				if(!isValidationFound){
					TestUtil.reportStatus("<p style='color:red'> Validation  >><b>"+validation_Txt+"</b><< not generated on quote check screen . </p>", "Fail", true);
					ErrorUtil.addVerificationFailure(new Throwable("Validation  >><b>"+validation_Txt+"</b><< not generated on quote check screen . "));
					
				}
			}// validation message for loop end
			
			//} //else if
				
		}else{
			TestUtil.reportStatus("Validation Rules table not exist on quote check screen . ", "Fail", true);
			
		}
		TestUtil.reportStatus("Validation verification successfully completed on quote check screen . ","Info",false);
		r_value=true;
}catch(Throwable t){
	System.out.println("Error while verifying Validation rules "+t.getMessage());
	return false;
}
return r_value;
}


public boolean funcGetPremiumValues(String code,String covername,Map<String,String> premium_loc) {
	
	Map<Object,Object> map_data = null;
	
	switch(TestBase.businessEvent){
		case "Renewal":
			map_data = common.Renewal_excel_data_map;
		break;
	}
		
	try{
		if(TestBase.product.equals("XOC")|| TestBase.product.equals("XOQ")){
			code = code + "_sec";
		}
			
		TestUtil.reportStatus("---------------"+covername+"-----------------","Info",false);
		//SPI Pen commission Calculation : 
		String pc_actual = k.getAttributeByXpath("//*[contains(@id,'_"+code+"_"+premium_loc.get("PenComm")+"')]", "value").replaceAll(",", "");
		//customAssert.assertTrue(WriteDataToXl(TestBase.product+"_"+common.currentRunningFlow,"Premium Summary",(String)common.Renewal_excel_data_map.get("Automation Key"),"PS_"+covername+"_PenComm",pc_actual,map_data),"Error while writing Pen Commission for cover "+covername+" to excel .");
		map_data.put("PS_"+covername+"_PenComm",pc_actual);
		
		String netNetP_actual = k.getAttributeByXpath("//*[contains(@id,'_"+code+"_"+premium_loc.get("NetNetPremium")+"')]", "value").replaceAll(",", "");
		//customAssert.assertTrue(WriteDataToXl(TestBase.product+"_"+common.currentRunningFlow,"Premium Summary",(String)common.Renewal_excel_data_map.get("Automation Key"),"PS_"+covername+"_NetNetPremium",netNetP_actual,map_data),"Error while writing Pen Commission for cover "+covername+" to excel .");
		map_data.put("PS_"+covername+"_NetNetPremium",netNetP_actual);
		
		// Net Premium verification : 
		String netP_actual = k.getAttributeByXpath("//*[contains(@id,'_"+code+"_"+premium_loc.get("NetPremium")+"')]", "value").replaceAll(",", "");
		//customAssert.assertTrue(WriteDataToXl(TestBase.product+"_"+common.currentRunningFlow, "Premium Summary", (String)common.Renewal_excel_data_map.get("Automation Key"), "PS_"+covername+"_NetPremium",netP_actual,map_data),"Error while writing Net Premium for cover "+code+" to excel .");
		map_data.put("PS_"+covername+"_NetPremium",netP_actual);
		
		// Broker commission Calculation : 
		String bc_actual =  k.getAttributeByXpath("//*[contains(@id,'_"+code+"_"+premium_loc.get("BrokerComm")+"')]", "value").replaceAll(",", "");
		//customAssert.assertTrue(WriteDataToXl(TestBase.product+"_"+common.currentRunningFlow, "Premium Summary", (String)common.Renewal_excel_data_map.get("Automation Key"), "PS_"+covername+"_BrokerComm",bc_actual,map_data),"Error while writing Broker Commission for cover "+code+" to excel .");
		map_data.put("PS_"+covername+"_BrokerComm",bc_actual);
		
		// GrossPremium verification :  
		String grossP_actual = k.getAttributeByXpath("//*[contains(@id,'_"+code+"_"+premium_loc.get("GrossPremium")+"')]", "value").replaceAll(",", "");
		//customAssert.assertTrue(WriteDataToXl(TestBase.product+"_"+common.currentRunningFlow, "Premium Summary", (String)common.Renewal_excel_data_map.get("Automation Key"), "PS_"+covername+"_GP",(grossP_actual),map_data),"Error while writing Gross Premium for cover "+covername+" to excel .");
		map_data.put("PS_"+covername+"_GP",(grossP_actual));
		
		String InsuranceTax_actual = k.getAttributeByXpath("//*[contains(@id,'_"+code+"_"+premium_loc.get("InsuranceTax")+"')]", "value").replaceAll(",", "");
		//customAssert.assertTrue(WriteDataToXl(TestBase.product+"_"+common.currentRunningFlow, "Premium Summary", (String)common.Renewal_excel_data_map.get("Automation Key"), "PS_"+covername+"_GT",InsuranceTax_actual,map_data),"Error while writing Total Premium for cover "+covername+" to excel .");
		map_data.put("PS_"+covername+"_GT",InsuranceTax_actual);
		
		String IPTRate_actual = k.getAttributeByXpath("//*[contains(@id,'_"+code+"_"+premium_loc.get("IPTRate")+"')]", "value").replaceAll(",", "");
		//customAssert.assertTrue(WriteDataToXl(TestBase.product+"_"+common.currentRunningFlow, "Premium Summary", (String)common.Renewal_excel_data_map.get("Automation Key"), "PS_"+covername+"_IPT",IPTRate_actual,map_data),"Error while writing Total Premium for cover "+covername+" to excel .");
		map_data.put("PS_"+covername+"_IPT",IPTRate_actual);
		
		//SPI Total Premium verification : 
		
		String p_actual = common.roundedOff(k.getAttributeByXpath("//*[contains(@id,'_"+code+"_"+"tot')]", "value")).replaceAll(",", "");
		//customAssert.assertTrue(WriteDataToXl(TestBase.product+"_"+common.currentRunningFlow, "Premium Summary", (String)common.Renewal_excel_data_map.get("Automation Key"), "PS_"+covername+"_TotalPremium", p_actual,map_data),"Error while writing Total Premium for cover "+code+" to excel .");
		map_data.put("PS_"+covername+"_TotalPremium", p_actual);
	
	}catch(Throwable t) { 
        return false;
	}
	return true;
	
}

/**
 * 
 * This method return date based on below current date and date provided in data sheet
 * 
 */

public String get_PolicyStartDate(String date) {
	
	String policy_Start_date=null;
	SimpleDateFormat sdf = new SimpleDateFormat("dd/MM/yyyy");
	Date todaysDate = null;
	Date _start_date = null;
	try {
		_start_date = sdf.parse(date);
		todaysDate = sdf.parse(sdf.format(new Date()));
		
		if(_start_date.compareTo(todaysDate) < 0 ){
			policy_Start_date = sdf.format(todaysDate);
		}else{
			policy_Start_date = sdf.format(_start_date);
		}
		
	} catch (ParseException e) {
		
		System.out.println("Parse exception while getting Policy Start Date. ");
	}catch (Throwable t) {
		
		System.out.println("Error while getting Policy Start Date. ");
	}
	
	return policy_Start_date;
	
	
}



/******
 * 
 *  New Premium Summary for COA MTA
 * 
 * 
 */

public boolean funcPremiumSummary_MTA(Map<Object, Object> map_data,String code,String event) {
	
	boolean r_value= true;
	Date currentDate = new Date();
	String testName = (String)map_data.get("Automation Key");
	String customPolicyDuration=null;
	SimpleDateFormat df1 = new SimpleDateFormat("dd/MM/yyyy");
	
	try{
		customAssert.assertTrue(common.funcPageNavigation("Premium Summary", ""),"Premium Summary page navigations issue(S)");
		//customAssert.assertTrue(common_HHAZ.verifyEndorsementONPremiumSummary(map_data),"Endorsement on Premium is having issue(S).");
		int policy_Duration = 0;
		String Policy_End_Date = "" , policy_Start_date="";
	
	switch(common.currentRunningFlow){
	case "Rewind":
		policy_Duration = Integer.parseInt((String)map_data.get("PS_Duration"));
		policy_Duration--;
		if(TestBase.businessEvent.equalsIgnoreCase("MTA")){
			policy_Start_date = k.getTextByXpath("//*[contains(text(),'Policy Start Date')]//following::div[1]");
		}else{
			policy_Start_date = driver.findElement(By.xpath("//*[contains(text(),'Policy Start Date')]//following::*[@name=\"start_date\"]")).getAttribute("value");
		}
		
		map_data.put("PS_PolicyStartDate", policy_Start_date);
		Policy_End_Date = common.daysIncrementWithOutFormation((String)map_data.get("PS_PolicyStartDate"), policy_Duration);
		map_data.put("PS_PolicyEndDate", Policy_End_Date);
		if(((String)map_data.get("PS_DefaultStartEndDate")).equals("No")){
			customAssert.assertTrue(k.Click("Policy_End_Date"), "Unable to Click Policy_End_Date date picker .");
			customAssert.assertTrue(k.Input("Policy_End_Date", Policy_End_Date),"Unable to Enter Policy_End_Date .");
			customAssert.assertTrue(k.Click("calander_btn"), "Unable to click on done button in calander.");
		}	
		driver.findElement(By.xpath("//*[contains(@name,'_admin_fee')]")).sendKeys(Keys.chord(Keys.CONTROL, "a"),(String)map_data.get("PS_AdminFee"));
		k.waitTwoSeconds();
		k.SelectRadioBtn("insuranceTaxExemptionRadioButton", (String)map_data.get("PS_TaxExempt"));
		if(((String)map_data.get("PS_TaxExempt")).equalsIgnoreCase("Yes")){
			customAssert.assertTrue(WriteDataToXl(code+"_"+common.currentRunningFlow, "Premium Summary", testName, "PS_InsuranceTaxButton", "Yes",map_data), "Error while writing Tax exemption value to excel .");
		}
		
		if(((String)map_data.get("PS_IsPolicyFinanced")).equals("Yes") && k.getText("PS_Broker_Name").contains("Arthur J.")){
			k.SelectRadioBtn("PS_IsPolicyFinanced","Yes");
			k.Input("PS_Finance_RefNumber", (String)map_data.get("PS_FinanceReferenceNumber"));
			k.DropDownSelection("PS_CreditProvider", (String)map_data.get("PS_CreditProvider"));
		}
		k.waitTwoSeconds();
		break;
	case "MTA":
		
		policy_Duration = Integer.parseInt((String)map_data.get("PS_Duration"));
		policy_Duration--;
		policy_Start_date = k.getTextByXpath("//*[contains(text(),'Policy Start Date')]//following::div[1]");
		map_data.put("PS_PolicyStartDate", policy_Start_date);
		Policy_End_Date = common.daysIncrementWithOutFormation((String)map_data.get("PS_PolicyStartDate"), policy_Duration);
		map_data.put("PS_PolicyEndDate", Policy_End_Date);
		if(((String)map_data.get("PS_DefaultStartEndDate")).equals("No")){
			customAssert.assertTrue(k.Click("Policy_End_Date"), "Unable to Click Policy_End_Date date picker .");
			customAssert.assertTrue(k.Input("Policy_End_Date", Policy_End_Date),"Unable to Enter Policy_End_Date .");
			customAssert.assertTrue(k.Click("calander_btn"), "Unable to click on done button in calander.");
		}	
		driver.findElement(By.xpath("//*[contains(@name,'_admin_fee')]")).sendKeys(Keys.chord(Keys.CONTROL, "a"),(String)map_data.get("PS_AdminFee"));
		k.waitTwoSeconds();
		k.SelectRadioBtn("insuranceTaxExemptionRadioButton", (String)map_data.get("PS_TaxExempt"));
		if(((String)map_data.get("PS_TaxExempt")).equalsIgnoreCase("Yes")){
			customAssert.assertTrue(WriteDataToXl(code+"_"+common.currentRunningFlow, "Premium Summary", testName, "PS_InsuranceTaxButton", "Yes",map_data), "Error while writing Tax exemption value to excel .");
		}
		
		if(((String)map_data.get("PS_IsPolicyFinanced")).equals("Yes") && k.getText("PS_Broker_Name").contains("Arthur J.")){
			k.SelectRadioBtn("PS_IsPolicyFinanced","Yes");
			k.Input("PS_Finance_RefNumber", (String)map_data.get("PS_FinanceReferenceNumber"));
			k.DropDownSelection("PS_CreditProvider", (String)map_data.get("PS_CreditProvider"));
		}
		k.waitTwoSeconds();
	break;
	
	}
	k.waitTwoSeconds();
	customAssert.assertTrue(k.Click("CCF_Btn_Save"), "Unable to click on Save Button on Premium Summary .");
	customPolicyDuration = k.getText("Policy_Duration");
	customAssert.assertTrue(WriteDataToXl(code+"_"+event, "Premium Summary", testName, "PS_Duration", customPolicyDuration,map_data),"Error while writing Policy Duration data to excel .");
	if(common.currentRunningFlow.equalsIgnoreCase("Rewind"))
		TestUtil.reportStatus("MTA Rewind Policy Duration = "+customPolicyDuration+" Days . ", "Info", true);
	else
		TestUtil.reportStatus("MTA Policy Duration = "+customPolicyDuration+" Days . ", "Info", true);
	
	customAssert.assertTrue(Verify_premiumSummaryTable_MTA(), "Error while verifying Premium Summary table in MTA  .");
	customAssert.assertTrue(common_COA.insuranceTaxAdjustmentHandling(code,event), "Premium Summary function is having issue(S) . ");
	customAssert.assertTrue(Verify_premiumSummaryTable_MTA(), "Error while verifying Premium Summary table in MTA  .");
	if(TestBase.businessEvent.equals("MTA") || TestBase.businessEvent.equals("Renewal")){
		if(!common_CCD.isMTARewindStarted){
			customAssert.assertTrue(common_VELA.func_Flat_Premiums_(common.MTA_excel_data_map,common.MTA_Structure_of_InnerPagesMaps), "Error while verifying Flat Premium table in MTA  .");
		}
	customAssert.assertTrue(func_MTATransactionDetailsPremiumTable(code, event), "Error while verifying Transaction Details Premium table on premium Summary page .");
	customAssert.assertTrue(funcTransactionDetailsMessage_MTA());
	}
	TestUtil.reportStatus("Premium Summary details are filled and Verified sucessfully . ", "Info", true);
	return r_value;
}catch(Throwable t){
		
		return false;
	}
}


public boolean funcTransactionDetailsMessage_MTA(){
	
	try{
	// Amendment Effective From : 22/06/2017, Period: 355 days.
		String t_Act_Message = null,t_Exp_Message = null;
	int MTA_duration = Integer.parseInt((String)common.MTA_excel_data_map.get("PS_Duration")) - Integer.parseInt((String)common.MTA_excel_data_map.get("MTA_EndorsementPeriod"));
	String Amend_Eff_Date = (String)common.MTA_excel_data_map.get("MTA_EffectiveDate");
	
	String transactionDetailsMsg_xpath = "//p[text()=' Transaction Details ']//following-sibling::p";
	WebElement transactionDetails_Msg = driver.findElement(By.xpath(transactionDetailsMsg_xpath));
	
	t_Act_Message = transactionDetails_Msg.getText();
	
	t_Exp_Message = "Amendment Effective From : "+Amend_Eff_Date+", Period: "+MTA_duration+" days.";
	
	customAssert.assertEquals(t_Act_Message, t_Exp_Message,"Mismatch in Transaction Details table Message: Expected: "+t_Exp_Message+" and Actual: "+t_Act_Message+" . ");
	
	TestUtil.reportStatus(t_Exp_Message, "Pass", false);
	
	}catch(Throwable t){
		return false;
	}
	return true;
	
		
}

public boolean func_MTATransactionDetailsPremiumTable(String code, String event){
	//Transaction Premium Table
	
		try{
			
			boolean isMTARewindFPEntries=false;
			String testName = (String)common.MTA_excel_data_map.get("Automation Key");
			k.pressDownKeyonPage();
			customAssert.assertTrue(common.funcPageNavigation("Premium Summary", ""),"Premium Summary page navigations issue(S)");
			
			if(TestBase.businessEvent.equalsIgnoreCase("Renewal")){
				int policy_Duration = Integer.parseInt((String)common.Renewal_excel_data_map.get("PS_Duration"));
			}else{
				int policy_Duration = Integer.parseInt((String)common.NB_excel_data_map.get("PS_Duration"));
			}
			
			
			String transactionDetailsTble_xpath = "//p[text()=' Transaction Details ']//following-sibling::table[@id='table0']";
			WebElement transactionDetails_Table = driver.findElement(By.xpath(transactionDetailsTble_xpath));
			
			List<WebElement> colms = transactionDetails_Table.findElements(By.tagName("th"));
				//Map<SPI,MAP<NNP,12345.67>>
			
			int trans_tble_Rows = transactionDetails_Table.findElements(By.tagName("tr")).size();
			int trans_tble_Cols = colms.size();
			
			List<String> sectionNames = new ArrayList<>();
			String sectionName = null;
			String sectionValue = null;
			String headerName = null;
			String isFP_Text = "No";boolean FP_Entry=false;
			
			if(transactionDetails_Table.isDisplayed()){
				
				if(common_VELA.isMTARewindFlow)
					TestUtil.reportStatus("Verification Started for Transaction Details table on premium summary page after Endorsement(MTA) Rewind . ", "Info", true);
				else
					TestUtil.reportStatus("Verification Started for Transaction Details table on premium summary page after Endorsement(MTA) . ", "Info", true);
				//For Each Cover Row
				For:
				for(int row = 1; row < trans_tble_Rows ;row ++){
					
					WebElement sec_Name = driver.findElement(By.xpath(transactionDetailsTble_xpath+"//tbody//tr["+row+"]//td["+1+"]"));
					sectionName = sec_Name.getText();
					
					if(sectionName.equalsIgnoreCase("Totals")){
						Map<String,Double> transaction_Section_Vals_Total = new HashMap<>();
						//For Each Cols
						for(int col = 2; col <= trans_tble_Cols ;col ++){
					
							////p[text()=' Transaction Premium']//following-sibling::table[@id='table0']//thead//th[2]
							WebElement header_Name = driver.findElement(By.xpath(transactionDetailsTble_xpath+"//thead//th["+col+"]"));
							headerName = header_Name.getText();
						
							if(!headerName.contains("Pen Comm %") && !headerName.contains("Broker Comm %") && !headerName.contains("Gross Comm %")
									&& !headerName.contains("Insurance Tax Rate") ){
								WebElement sec_Val = driver.findElement(By.xpath(transactionDetailsTble_xpath+"//tbody//tr["+row+"]//td["+col+"]"));
								sectionValue = sec_Val.getText();
								sectionValue = sectionValue.replaceAll(",", "");
								transaction_Section_Vals_Total.put(headerName, Double.parseDouble(sectionValue));
								
							}else{
								continue;
							}
							if(common_VELA.isMTARewindFlow){
								//common.transaction_Details_Premium_Values.clear();
								common_VELA.transaction_Details_Premium_Values.remove(sectionName);
							}
							common_VELA.transaction_Details_Premium_Values.put(sectionName, transaction_Section_Vals_Total);
					}
					}else if(!FP_Entry && !sectionName.contains("Flat")){
						
						Map<String,Double> transaction_Section_Vals = new HashMap<>();
						//For Each Cols
						for(int col = 2; col <= trans_tble_Cols ;col ++){
					
							////p[text()=' Transaction Premium']//following-sibling::table[@id='table0']//thead//th[2]
							WebElement header_Name = driver.findElement(By.xpath(transactionDetailsTble_xpath+"//thead//th["+col+"]"));
							headerName = header_Name.getText();
						
							WebElement sec_Val = driver.findElement(By.xpath(transactionDetailsTble_xpath+"//tbody//tr["+row+"]//td["+col+"]"));
							sectionValue = sec_Val.getText();
						
							transaction_Section_Vals.put(headerName, Double.parseDouble(sectionValue));
					}
						
						if(common_VELA.isMTARewindFlow){
							//common.transaction_Details_Premium_Values.clear();
							common_VELA.transaction_Details_Premium_Values.remove(sectionName);
						}
						common_VELA.transaction_Details_Premium_Values.put(sectionName, transaction_Section_Vals);
					
						
					}else if(sectionName.contains("Flat")){
						FP_Entry=true;
					}else if(FP_Entry){
						continue;
					}
					
					
					
				}
				//System.out.println(transaction_Premium_Values);
				
				if(common_VELA.isMTARewindFlow){
					TestUtil.reportStatus("---------------Transaction Details table Verification after Rewind Endorsement(MTA)-----------------","Info",false);
				}else{
					TestUtil.reportStatus("---------------Transaction Details table Verification in MTA-----------------","Info",false);
				}
				//Transaction table Verification
				
				// Check if Flat premium is added or not :
				
				String flatPremium = (String)common.MTA_excel_data_map.get("FP_isFlatPremium");
				String flatPremiumEntries = null; 
									
				if(flatPremium.contains("Yes")){
					flatPremiumEntries = (String)common.MTA_excel_data_map.get("FP_FlatPremium_Entries");
				}			
				String[] arrF_Premium = null;
				
				if(flatPremiumEntries != null){
					
						arrF_Premium = flatPremiumEntries.split(";");
				
						for(int i = 0; i < arrF_Premium.length; i ++){
					
						if(i == 0){
							FP_Covers = (String)common.MTA_Structure_of_InnerPagesMaps.get("Flat-Premiums").get(i).get("FP_Section");
						}else{
							FP_Covers = FP_Covers + ","+ (String)common.MTA_Structure_of_InnerPagesMaps.get("Flat-Premiums").get(i).get("FP_Section");
						}					
					}
				}
				
				for(int row = 1; row < trans_tble_Rows ;row ++){
					WebElement sec_Name = driver.findElement(By.xpath(transactionDetailsTble_xpath+"//tbody//tr["+row+"]//td["+1+"]"));
					sectionNames.add(sec_Name.getText());
				}
				for(String s_Name : sectionNames){
					
					isFP_Text = "No";
					//FP Entries
					if(s_Name.contains("Flat")){
						common_VELA.isFPEntries = true;isFP_Text="Yes";
						
						if(common_VELA.isMTARewindFlow){
							isMTARewindFPEntries=true;}
					}
					
					if(common_VELA.isFPEntries && isFP_Text.equalsIgnoreCase("No") && !s_Name.equals("Totals")){
						
						trans_error_val = trans_error_val + func_FP_Entries_Transaction_Details_Verification_MTA(s_Name,common.MTA_Structure_of_InnerPagesMaps);
						
						
					}else{
						if(s_Name.equals("Totals"))
							trans_error_val = trans_error_val + funcTransactionDetailsTable_Verification_Total_MTA(sectionNames,common_VELA.transaction_Details_Premium_Values);
						else if(!s_Name.contains("Flat"))
							trans_error_val = trans_error_val + funcTransactionDetailsTable_Verification_MTA(s_Name,common_VELA.transaction_Details_Premium_Values);
						
					}			
				}
				if(common_VELA.isMTARewindFlow){
					
					if(flatPremium.equalsIgnoreCase("Yes") && arrF_Premium.length > 0){
						if(!isMTARewindFPEntries){
							TestUtil.reportStatus("<p style='color:red'> Flat Premium Entries added in MTA Flow are not present while doing MTA Rewind in Transaction Details table . </p>", "Fail", true);
							ErrorUtil.addVerificationFailure(new Throwable("Flat Premium Entries added in MTA Flow are not present while doing MTA Rewind in Transaction Details table . "));
						}
					}
					
					TestUtil.reportStatus("Transaction Details table has been verified suceesfully after Rewind Endorsement . ", "info", true);
				}else{
					TestUtil.reportStatus("Transaction Details table has been verified suceesfully . ", "info", true);
				}
				
			}
			
		
				//Total Premium With Admin Fees
				double total_premium_with_admin_fee = common_VELA.transaction_Details_Premium_Values.get("Totals").get("Gross Premium") + 
						common_VELA.transaction_Details_Premium_Values.get("Totals").get("Insurance Tax") + Double.parseDouble((String)common.MTA_excel_data_map.get("PS_TotalAdminFee"));
				
				
				String exp_Total_Premium_with_Admin_fee = common.roundedOff(Double.toString(total_premium_with_admin_fee));
				k.waitTwoSeconds();
				
				String xPath = "//table[@id='table0']//*//td[text()='Total']//following-sibling::td";
				String act_Total_Premium_with_Admin_fee = k.getTextByXpath(xPath);
				
				act_Total_Premium_with_Admin_fee = act_Total_Premium_with_Admin_fee.replaceAll(",", "");
				double premium_diff = Double.parseDouble(common.roundedOff(Double.toString(Double.parseDouble(exp_Total_Premium_with_Admin_fee) - Double.parseDouble(act_Total_Premium_with_Admin_fee))));
				
				TestUtil.reportStatus("---------------Endorsement Premium Summary with Admin Fees-----------------","Info",false);
				
				if(Math.abs(premium_diff)<=0.09){
					TestUtil.reportStatus("Total Premium with Admin Fees :[<b> "+exp_Total_Premium_with_Admin_fee+" </b>] matches with actual premium [<b> "+act_Total_Premium_with_Admin_fee+"</b>]as expected with some difference upto '0.05' on premium summary page.", "Pass", false);
					customAssert.assertTrue(WriteDataToXl(code+"_"+event, "Premium Summary", testName, "PS_TotalFinalPremium", exp_Total_Premium_with_Admin_fee,common.MTA_excel_data_map),"Error while writing Total Final Premium data to excel .");
				}else{
					TestUtil.reportStatus("Mismatch in Expected Total Premium with Admin Fees [<b> "+exp_Total_Premium_with_Admin_fee+"</b>] and Actual Premium [<b> "+act_Total_Premium_with_Admin_fee+"</b>] on premium summary page.", "Fail", false);
					customAssert.assertTrue(WriteDataToXl(code+"_"+event, "Premium Summary", testName, "PS_TotalFinalPremium", exp_Total_Premium_with_Admin_fee,common.MTA_excel_data_map),"Error while writing Total Final Premium data to excel .");
				}
			
			
		}catch(Throwable t ){
			return false;
		}
		
		return true;
}

public int funcTransactionDetailsTable_Verification_Total_MTA(List<String> sectionNames,Map<String,Map<String,Double>> transaction_Premium_Values){
	
	try{
		
	Map<String,Double> trans_details_values = new HashMap<>();
	boolean Start_Fp = false;
	
	TestUtil.reportStatus("---------------Totals In Transaction Details Table-----------------","Info",false);
	double exp_value = 0.0;
	outer:
	for(String section : sectionNames){
		
		if(section.contains("Flat")){
			Start_Fp = true;
			continue;
		}
		
		if(!section.contains("Total") && !section.contains("Flat") && !Start_Fp){
			try{
				exp_value = exp_value + transaction_Premium_Values.get(section).get("Net Net Premium");
			}catch(Throwable t){
				continue;
			}
		}else if(Start_Fp && !section.contains("Total")){
		//for(String _section : sectionNames){
			if(common_VELA.isFPEntries && !section.contains("Flat")){
				try{
					if(section.equalsIgnoreCase("Property Owners Liabilities"))
						section = "Liabilities - POL";
					if(section.equalsIgnoreCase("Businesss Interruption"))
						section = "Business Interruption";
					if(section.equalsIgnoreCase("Goods in Transit")){
						section = "Goods In Transit";
					}
				exp_value = exp_value + common_VELA.transaction_Details_Premium_Values.get(section+"_FP").get("Net Net Premium");
			}catch(Throwable t){
				continue;
			}
			}
			//}
		//break outer;
		}
	}
	
	String t_NetNetP_actual = Double.toString(transaction_Premium_Values.get("Totals").get("Net Net Premium"));
	CommonFunction.compareValues(exp_value,Double.parseDouble(t_NetNetP_actual)," Net Net Premium");
	trans_details_values.put("Net Net Premium",exp_value);

	exp_value = 0.0;Start_Fp = false;
	for(String section : sectionNames){
		
		if(section.contains("Flat")){
			Start_Fp = true;
			continue;
		}
		
		if(!section.contains("Total") && !section.contains("Flat") && !Start_Fp){
			try{
				exp_value = exp_value + transaction_Premium_Values.get(section).get("Pen Comm");
			}catch(Throwable t){
				continue;
			}
		}else if(Start_Fp && !section.contains("Total")){
		//for(String _section : sectionNames){
			if(common_VELA.isFPEntries && !section.contains("Flat")){
				try{
					if(section.equalsIgnoreCase("Property Owners Liabilities"))
						section = "Liabilities - POL";
					if(section.equalsIgnoreCase("Businesss Interruption"))
						section = "Business Interruption";
					if(section.equalsIgnoreCase("Goods in Transit")){
						section = "Goods In Transit";
					}
				exp_value = exp_value + common_VELA.transaction_Details_Premium_Values.get(section+"_FP").get("Pen Comm");
			}catch(Throwable t){
				continue;
			}
			}
	}
	}
	String t_pc_actual = Double.toString(transaction_Premium_Values.get("Totals").get("Pen Comm"));
	CommonFunction.compareValues(exp_value,Double.parseDouble(t_pc_actual)," Pen Commission");
	trans_details_values.put("Pen Comm",exp_value);
	
	exp_value = 0.0;Start_Fp = false;
	for(String section : sectionNames){

		if(section.contains("Flat")){
			Start_Fp = true;
			continue;
		}
		
		if(!section.contains("Total") && !section.contains("Flat") && !Start_Fp){
			try{
			exp_value = exp_value + transaction_Premium_Values.get(section).get("Net Premium");
			}catch(Throwable t){
				continue;
			}
		}else if(Start_Fp && !section.contains("Total")){
		//for(String _section : sectionNames){
			if(common_VELA.isFPEntries && !section.contains("Flat")){
				try{
					if(section.equalsIgnoreCase("Property Owners Liabilities"))
						section = "Liabilities - POL";
					if(section.equalsIgnoreCase("Businesss Interruption"))
						section = "Business Interruption";
					if(section.equalsIgnoreCase("Goods in Transit")){
						section = "Goods In Transit";
					}
				exp_value = exp_value + common_VELA.transaction_Details_Premium_Values.get(section+"_FP").get("Net Premium");
			}catch(Throwable t){
				continue;
			}
			}
	}
	}
	String t_netP_actual = Double.toString(transaction_Premium_Values.get("Totals").get("Net Premium"));
	CommonFunction.compareValues(exp_value,Double.parseDouble(t_netP_actual),"Net Premium");
	trans_details_values.put("Net Premium",exp_value);
	
	exp_value = 0.0;Start_Fp = false;
	for(String section : sectionNames){
		
		if(section.contains("Flat")){
			Start_Fp = true;
			continue;
		}
		
		if(!section.contains("Total") && !section.contains("Flat") && !Start_Fp){
			try{
			exp_value = exp_value + transaction_Premium_Values.get(section).get("Broker Commission");
			}catch(Throwable t){
				continue;
			}
		}else if(Start_Fp && !section.contains("Total")){
		//for(String _section : sectionNames){
			if(common_VELA.isFPEntries && !section.contains("Flat")){
				try{
					if(section.equalsIgnoreCase("Property Owners Liabilities"))
						section = "Liabilities - POL";
					if(section.equalsIgnoreCase("Businesss Interruption"))
						section = "Business Interruption";
					if(section.equalsIgnoreCase("Goods in Transit")){
						section = "Goods In Transit";
					}
				exp_value = exp_value + common_VELA.transaction_Details_Premium_Values.get(section+"_FP").get("Broker Commission");
			}catch(Throwable t){
				continue;
			}
			}
	}
	}
	String t_bc_actual =  Double.toString(transaction_Premium_Values.get("Totals").get("Broker Commission"));
	CommonFunction.compareValues(exp_value,Double.parseDouble(t_bc_actual),"Broker Commission");
	trans_details_values.put("Broker Commission",exp_value);
	
	exp_value = 0.0;Start_Fp = false;
	for(String section : sectionNames){
		
		if(section.contains("Flat")){
			Start_Fp = true;
			continue;
		}
		
		if(!section.contains("Total") && !section.contains("Flat") && !Start_Fp){
			try{
			exp_value = exp_value + transaction_Premium_Values.get(section).get("Gross Premium");
			}catch(Throwable t){
				continue;
			}
		}else if(Start_Fp && !section.contains("Total")){
		//for(String _section : sectionNames){
			if(common_VELA.isFPEntries && !section.contains("Flat")){
				try{
					if(section.equalsIgnoreCase("Property Owners Liabilities"))
						section = "Liabilities - POL";
					if(section.equalsIgnoreCase("Businesss Interruption"))
						section = "Business Interruption";
					if(section.equalsIgnoreCase("Goods in Transit")){
						section = "Goods In Transit";
					}
				exp_value = exp_value + common_VELA.transaction_Details_Premium_Values.get(section+"_FP").get("Gross Premium");
			}catch(Throwable t){
				continue;
			}
			}
	}
	}
	String t_grossP_actual = Double.toString(transaction_Premium_Values.get("Totals").get("Gross Premium"));
	CommonFunction.compareValues(exp_value,Double.parseDouble(t_grossP_actual)," Gross Premium");
	trans_details_values.put("Gross Premium",exp_value);
	
	exp_value = 0.0;Start_Fp = false;
	for(String section : sectionNames){
		
		if(section.contains("Flat")){
			Start_Fp = true;
			continue;
		}
		
		if(!section.contains("Total") && !section.contains("Flat") && !Start_Fp){
			try{
			exp_value = exp_value + transaction_Premium_Values.get(section).get("Insurance Tax");
			}catch(Throwable t){
				continue;
			}
		}else if(Start_Fp && !section.contains("Total")){
		//for(String _section : sectionNames){
			if(common_VELA.isFPEntries && !section.contains("Flat")){
				try{
					if(section.equalsIgnoreCase("Property Owners Liabilities"))
						section = "Liabilities - POL";
					if(section.equalsIgnoreCase("Businesss Interruption"))
						section = "Business Interruption";
					if(section.equalsIgnoreCase("Goods in Transit")){
						section = "Goods In Transit";
					}
				exp_value = exp_value + common_VELA.transaction_Details_Premium_Values.get(section+"_FP").get("Insurance Tax");
			}catch(Throwable t){
				continue;
			}
			}
	}
		
	}
	String t_InsuranceTax_actual = Double.toString(transaction_Premium_Values.get("Totals").get("Insurance Tax"));
	CommonFunction.compareValues(exp_value,Double.parseDouble(t_InsuranceTax_actual),"Insurance Tax");
	trans_details_values.put("Insurance Tax",exp_value);
	
	exp_value = 0.0;Start_Fp = false;
	for(String section : sectionNames){
		
		if(section.contains("Flat")){
			Start_Fp = true;
			continue;
		}
		
		if(!section.contains("Total") && !section.contains("Flat") && !Start_Fp){
			try{
			exp_value = exp_value + transaction_Premium_Values.get(section).get("Total Premium");
			}catch(Throwable t){
				continue;
			}
		}else if(Start_Fp && !section.contains("Total")){
		//for(String _section : sectionNames){
			if(common_VELA.isFPEntries && !section.contains("Flat")){
				try{
					if(section.equalsIgnoreCase("Property Owners Liabilities"))
						section = "Liabilities - POL";
					if(section.equalsIgnoreCase("Businesss Interruption"))
						section = "Business Interruption";
					if(section.equalsIgnoreCase("Goods in Transit")){
						section = "Goods In Transit";
					}
				exp_value = exp_value + common_VELA.transaction_Details_Premium_Values.get(section+"_FP").get("Total Premium");
			}catch(Throwable t){
				continue;
			}
			}
	}
		
	}
	String t_p_actual = Double.toString(transaction_Premium_Values.get("Totals").get("Total Premium"));
	
	trans_details_values.put("Total Premium",exp_value);
	
	common_VELA.transaction_Details_Premium_Values.put("Totals", trans_details_values);
	
	double premium_diff = exp_value - Double.parseDouble(t_p_actual);
	
	if(premium_diff<0.06 && premium_diff>-0.06){
		TestUtil.reportStatus("Total Premium [<b> "+exp_value+" </b>] matches with actual total premium [<b> "+t_p_actual+" </b>]as expected for Totals in Transaction Details table .", "Pass", false);
		return 0;
		
	}else{
		TestUtil.reportStatus("<p style='color:red'> Mismatch in Expected Premium [<b> "+exp_value+"</b>] and Actual Premium [<b> "+t_p_actual+"</b>] for Totals in Transaction Details table . </p>", "Fail", true);
		return 1;
	}
	
}catch(Throwable t) {
    String methodName = new Object(){}.getClass().getEnclosingMethod().getName();
    TestUtil.reportFunctionFailed("Failed in "+methodName+" function");
    Assert.fail("Transaction Details Premium total Section verification issue.  \n", t);
    return 1;
}
}

public int funcTransactionDetailsTable_Verification_MTA(String sectionName,Map<String,Map<String,Double>> transactionDetails_Premium_Values){

	Map<Object,Object> map_data = common.MTA_excel_data_map;
	
	Map<Object, Object> data_map = null;
	Map<Object,Object> Tax_map_data = new HashMap<>();
	
	double NB_NNP = 0.0;
	double MTA_NNP=0.0;
	double trans_NetNetP = 0.0,previous_mta=0.0,annualize_mta=0.0,_annualize_mta=0.0,final_trans_NNP=0.0;
	String code=null,cover_code=null;
	int p_NB_Duration = 0,p_MTA_Remaining_Duration=0 , p_MTA_Duration = 0;
	Map<String,Double> trans_details_values = new HashMap<>();
	
	switch (TestBase.businessEvent) {
	case "Renewal":
		data_map = common.Renewal_excel_data_map;
		break;
	case "MTA":
		if(common.currentRunningFlow.equalsIgnoreCase("Rewind")){
			data_map = common.Rewind_excel_data_map;
			Tax_map_data = common.MTA_excel_data_map;
			
		}else{
			data_map = common.NB_excel_data_map;
			Tax_map_data = common.NB_excel_data_map;
		}
		break;
	default:
		break;
	}
	
	
	if(Integer.parseInt((String)data_map.get("PS_Duration"))!=365)
		p_NB_Duration = 365;
	else
		p_NB_Duration = Integer.parseInt((String)data_map.get("PS_Duration"));
	
	
	
	p_MTA_Remaining_Duration = Integer.parseInt((String)common.MTA_excel_data_map.get("MTA_EndorsementPeriod"));
	p_MTA_Duration = Integer.parseInt((String)common.MTA_excel_data_map.get("PS_Duration"));
	switch(sectionName){
	
	case "Employers Liability":
		code = "EmployersLiability";
		cover_code = "EmployersLiability";
		break;
	case "Public & Products Liability":
		code = "Public&ProductsLiability";
		cover_code = "Public&ProductsLiability";
		break;
	case "Annual Works":
		code = "AnnualWorks";
		cover_code = "AnnualWorks";
		break;
	case "Single Project":
		code = "SingleProject";
		cover_code = "SingleProject";
		break;
	case "Own Plant":
		code = "OwnPlant";
		cover_code = "OwnPlant";
		break;
	case "Hired In Plant":
		code = "HiredInPlant";
		cover_code = "HiredInPlant";
		break;
	case "Abbey Legal Expenses":
		code = "LegalExpenses";
		cover_code = "LegalExpenses";
		break;
	case "JCT 6.5.1":
		code = "JCT6.5.1";
		cover_code = "JCT6.5.1";
		break;
	case "Property Owners Liability":
		code = "PropertyOwnersLiability";
		cover_code = "PropertyOwnersLiability";
		break;
	case "Terrorism":
		code = "Terrorism";
		cover_code = "Terrorism";
		break;
		
	case "Combined Liability":
		code ="CombinedLiability";
		cover_code="CombinedLiability";
		break;
		
	case "Third Party Motor Liability":
		code ="ThirdPartyMotorLiability";
		cover_code="ThirdPartyMotorLiability";
		break;
		
	
	default:
			System.out.println("**Cover Name is not in Scope for POF**");
		break;
	
	}
	
try{
		
		TestUtil.reportStatus("---------------"+sectionName+"-----------------","Info",false);
		
		if(common_CCD.isMTARewindFlow){ // MTA Rewind Flow
			
			if(Integer.parseInt((String)common.NB_excel_data_map.get("PS_Duration"))!=Integer.parseInt((String)common.MTA_excel_data_map.get("PS_Duration"))){
				
				
				//if(sectionName.contains("PI")){
					
					if(((String)common.NB_excel_data_map.get("CD_"+cover_code)).equals("Yes") && ((String)common.Rewind_excel_data_map.get("CD_"+cover_code)).equals("No"))
					{
						NB_NNP = Double.parseDouble((String)common.NB_excel_data_map.get("PS_"+code+"_NetNetPremium"));
						MTA_NNP = 0.0;
						map_data = common.NB_excel_data_map;
							
					}else if(((String)common.NB_excel_data_map.get("CD_"+cover_code)).equals("No") && ((String)common.Rewind_excel_data_map.get("CD_"+cover_code)).equals("Yes")){
						NB_NNP = 0.0;
						MTA_NNP = Double.parseDouble((String)common.Rewind_excel_data_map.get("PS_"+code+"_NetNetPremium"));
						map_data = common.Rewind_excel_data_map;
					}else{
						NB_NNP = Double.parseDouble((String)common.NB_excel_data_map.get("PS_"+code+"_NetNetPremium"));
						MTA_NNP = Double.parseDouble((String)common.Rewind_excel_data_map.get("PS_"+code+"_NetNetPremium"));
						map_data = common.NB_excel_data_map;
					}
					//Previous Premium MTA Calculation
					
					final_trans_NNP = ((MTA_NNP - NB_NNP)/p_NB_Duration)*
							((Integer.parseInt((String)common.MTA_excel_data_map.get("PS_Duration")) - Integer.parseInt((String)common.MTA_excel_data_map.get("MTA_EndorsementPeriod"))));
						
			
			}else{
				
				//if(sectionName.contains("PI")){
					if(((String)common.NB_excel_data_map.get("CD_"+cover_code)).equals("Yes") && (((String)common.Rewind_excel_data_map.get("CD_"+cover_code)).equals("No")))
					{
						NB_NNP = Double.parseDouble((String)common.NB_excel_data_map.get("PS_"+code+"_NetNetPremium"));
						MTA_NNP = 0.0;
						map_data = common.NB_excel_data_map;
							
					}else if(((String)common.NB_excel_data_map.get("CD_"+cover_code)).equals("No") && ((String)common.Rewind_excel_data_map.get("CD_"+cover_code)).equals("Yes")){
						NB_NNP = 0.0;
						MTA_NNP = Double.parseDouble((String)common.Rewind_excel_data_map.get("PS_"+code+"_NetNetPremium"));
						map_data = common.Rewind_excel_data_map;
					}else{
						NB_NNP = Double.parseDouble((String)common.NB_excel_data_map.get("PS_"+code+"_NetNetPremium"));
						MTA_NNP = Double.parseDouble((String)common.Rewind_excel_data_map.get("PS_"+code+"_NetNetPremium"));
						map_data = common.NB_excel_data_map;
					}
					
					final_trans_NNP = ((MTA_NNP - NB_NNP)/p_NB_Duration)*
							((Integer.parseInt((String)common.NB_excel_data_map.get("PS_Duration")) - Integer.parseInt((String)common.MTA_excel_data_map.get("MTA_EndorsementPeriod"))));
					
			
			}
			}
		
			else{
				if(Integer.parseInt((String)data_map.get("PS_Duration"))!=Integer.parseInt((String)common.MTA_excel_data_map.get("PS_Duration"))){
					
					
					//if(sectionName.contains("PI")){
						
						if(((String)data_map.get("CD_"+cover_code)).equals("Yes") && ((String)common.MTA_excel_data_map.get("CD_"+cover_code)).equals("No"))
						{
							NB_NNP = Double.parseDouble((String)data_map.get("PS_"+code+"_NetNetPremium"));
							MTA_NNP = 0.0;
								
						}else if(((String)data_map.get("CD_"+cover_code)).equals("No") && ((String)common.MTA_excel_data_map.get("CD_"+cover_code)).equals("Yes")){
							NB_NNP = 0.0;
							MTA_NNP = Double.parseDouble((String)common.MTA_excel_data_map.get("PS_"+code+"_NetNetPremium"));
						}else{
							NB_NNP = Double.parseDouble((String)data_map.get("PS_"+code+"_NetNetPremium"));
							MTA_NNP = Double.parseDouble((String)common.MTA_excel_data_map.get("PS_"+code+"_NetNetPremium"));
						}
						//Previous Premium MTA Calculation
						
						final_trans_NNP = ((MTA_NNP - NB_NNP)/p_NB_Duration)*
								((Integer.parseInt((String)common.MTA_excel_data_map.get("PS_Duration")) - Integer.parseInt((String)common.MTA_excel_data_map.get("MTA_EndorsementPeriod"))));
						
						/*trans_NetNetP = ((NB_NNP)/p_NB_Duration)*p_MTA_Remaining_Duration;
						previous_mta = NB_NNP - trans_NetNetP;
						annualize_mta = ((Double.parseDouble((String)common.MTA_excel_data_map.get("PS_"+code+"_NetNetPremium")) * (Integer.parseInt((String)common.MTA_excel_data_map.get("PS_Duration")) ))/(Integer.parseInt((String)data_map.get("PS_Duration"))));
						_annualize_mta = (annualize_mta/Double.parseDouble((String)common.MTA_excel_data_map.get("PS_Duration"))) * ((Integer.parseInt((String)common.MTA_excel_data_map.get("PS_Duration")) - p_MTA_Remaining_Duration));
						final_trans_NNP = _annualize_mta - previous_mta;
						*/
				
				}else{
					
					//if(sectionName.contains("PI")){
						if(((String)data_map.get("CD_"+cover_code)).equals("Yes") && ((String)common.MTA_excel_data_map.get("CD_"+cover_code)).equals("No"))
						{
							NB_NNP = Double.parseDouble((String)data_map.get("PS_"+code+"_NetNetPremium"));
							MTA_NNP = 0.0;
							if(TestBase.businessEvent.equals("Renewal")){
								map_data = common.Renewal_excel_data_map;
							}else{
							map_data = common.NB_excel_data_map;}
							map_data.put("PS_TaxExempt", common.MTA_excel_data_map.get("PS_TaxExempt"));
							map_data.put("PS_InsuranceTaxButton", common.MTA_excel_data_map.get("PS_InsuranceTaxButton"));
								
						}else if(((String)data_map.get("CD_"+cover_code)).equals("No") && ((String)common.MTA_excel_data_map.get("CD_"+cover_code)).equals("Yes")){
							NB_NNP = 0.0;
							MTA_NNP = Double.parseDouble((String)common.MTA_excel_data_map.get("PS_"+code+"_NetNetPremium"));
						}else{
							NB_NNP = Double.parseDouble((String)data_map.get("PS_"+code+"_NetNetPremium"));
							MTA_NNP = Double.parseDouble((String)common.MTA_excel_data_map.get("PS_"+code+"_NetNetPremium"));
							map_data = common.NB_excel_data_map;
						}
						
						final_trans_NNP = ((MTA_NNP - NB_NNP)/p_NB_Duration)*
								((Integer.parseInt((String)data_map.get("PS_Duration")) - Integer.parseInt((String)common.MTA_excel_data_map.get("MTA_EndorsementPeriod"))));
						
					
				}
		}
		if(TestBase.businessEvent.equalsIgnoreCase("Renewal")){
			
			if(((String)data_map.get("CD_"+cover_code)).equals("No") && ((String)common.MTA_excel_data_map.get("CD_"+cover_code)).equals("Yes"))
			{
				data_map = common.MTA_excel_data_map;
			}
			
			
			String t_NetNetP_expected = common.roundedOff(Double.toString(final_trans_NNP));
			String t_NetNetP_actual = Double.toString(transactionDetails_Premium_Values.get(sectionName).get("Net Net Premium"));
			CommonFunction.compareValues(Double.parseDouble(t_NetNetP_expected),Double.parseDouble(t_NetNetP_actual)," Net Net Premium");
			trans_details_values.put("Net Net Premium", Double.parseDouble(t_NetNetP_expected));
			
			double t_pen_comm = (( Double.parseDouble(t_NetNetP_expected) / (1-((Double.parseDouble((String)data_map.get("PS_"+code+"_PenComm_rate")) + Double.parseDouble((String)data_map.get("PS_"+code+"_BrokerComm_rate")))/100)))*((Double.parseDouble((String)data_map.get("PS_"+code+"_PenComm_rate"))/100)));
			String t_pc_expected = common.roundedOff(Double.toString(t_pen_comm));
			String t_pc_actual = Double.toString(transactionDetails_Premium_Values.get(sectionName).get("Pen Comm"));
			CommonFunction.compareValues(Double.parseDouble(t_pc_expected),Double.parseDouble(t_pc_actual)," Pen Commission");
			trans_details_values.put("Pen Comm", Double.parseDouble(t_pc_expected));
			
			
			double t_netP = Double.parseDouble(t_pc_expected) + Double.parseDouble(t_NetNetP_expected);
			String t_netP_expected = common.roundedOff(Double.toString(t_netP));
			String t_netP_actual = Double.toString(transactionDetails_Premium_Values.get(sectionName).get("Net Premium"));
			CommonFunction.compareValues(Double.parseDouble(t_netP_expected),Double.parseDouble(t_netP_actual),"Net Premium");
			trans_details_values.put("Net Premium", Double.parseDouble(t_netP_expected));
			
			
			double t_broker_comm = ((Double.parseDouble(t_NetNetP_expected) / (1-((Double.parseDouble((String)data_map.get("PS_"+code+"_PenComm_rate")) + Double.parseDouble((String)data_map.get("PS_"+code+"_BrokerComm_rate")))/100)))*((Double.parseDouble((String)data_map.get("PS_"+code+"_BrokerComm_rate"))/100)));
			String t_bc_expected = common.roundedOff(Double.toString(t_broker_comm));
			String t_bc_actual =  Double.toString(transactionDetails_Premium_Values.get(sectionName).get("Broker Commission"));
			CommonFunction.compareValues(Double.parseDouble(t_bc_expected),Double.parseDouble(t_bc_actual),"Broker Commission");
			trans_details_values.put("Broker Commission", Double.parseDouble(t_bc_expected));
			
			
			double t_grossP = Double.parseDouble(t_netP_expected) + Double.parseDouble(t_bc_expected);
			String t_grossP_actual = Double.toString(transactionDetails_Premium_Values.get(sectionName).get("Gross Premium"));
			CommonFunction.compareValues(t_grossP,Double.parseDouble(t_grossP_actual)," Gross Premium");
			trans_details_values.put("Gross Premium", t_grossP);
			
			String nbStatus = (String)map_data.get("MTA_Status");
					
			if(!sectionName.contains("Terrorism")){
				AdditionalExcTerrDocAct = AdditionalExcTerrDocAct + Double.parseDouble(t_grossP_actual);
			}else{
				AdditionalTerPDocAct = Double.parseDouble(t_grossP_actual);
			}
			
			map_data = common.MTA_excel_data_map;
			
			double t_InsuranceTax = 0.0;
			if(((String)map_data.get("PS_TaxExempt")).equalsIgnoreCase("Yes") || ((String)map_data.get("PS_InsuranceTaxButton")).equalsIgnoreCase("Yes")){
				t_InsuranceTax = (t_grossP * 0.0)/100.0;
			}else{
				t_InsuranceTax = (t_grossP * Double.parseDouble((String)map_data.get("PS_"+code+"_IPT")))/100.0;
			}
				
			t_InsuranceTax = Double.parseDouble(common.roundedOff(Double.toString(t_InsuranceTax)));
			String t_InsuranceTax_actual = Double.toString(transactionDetails_Premium_Values.get(sectionName).get("Insurance Tax"));
			CommonFunction.compareValues(t_InsuranceTax,Double.parseDouble(t_InsuranceTax_actual),"Insurance Tax");
			trans_details_values.put("Insurance Tax", t_InsuranceTax);
			
		
			
			if(sectionName.contains("Terrorism")){
				AddTaxTerrDoc = Double.parseDouble(t_InsuranceTax_actual);
				if(common_POF.isMTARewindStarted){
					rewindMTADoc_AddTaxTer = Double.parseDouble(t_InsuranceTax_actual);	
				}			
			}
			
			String Nb_Status = (String)map_data.get("MTA_Status");
			if(common_POF.isMTARewindStarted){
				
				String newCover = "";
				if(sectionName.contains("PropertyOwnersLiabilities")){
					newCover = "Liabilities-POL";
				}else if(sectionName.contains("EmployersLiability")) {
					newCover = "Liabilities-EL";
				}else{
					newCover = sectionName;
				}
				
				String sCover = (String)map_data.get("CD_Add_"+newCover);
				
				if(sCover.contains("Yes")){
					rewindDoc_InsPTax  = rewindDoc_InsPTax + Double.parseDouble(t_InsuranceTax_actual);
					if(!sectionName.contains("Terrorism")){
						rewindMTADoc_Premium   = rewindMTADoc_Premium  + Double.parseDouble(t_grossP_actual);
					}else{
						rewindMTADoc_TerP   = Double.parseDouble(t_grossP_actual);
					}
				}
				
			}
			
			AdditionalInsTaxDocAct = AdditionalInsTaxDocAct + Double.parseDouble(t_InsuranceTax_actual);
			
			//SPI  Transaction Total Premium verification : 
			double t_Premium = t_grossP + t_InsuranceTax;
			String t_p_expected = common.roundedOff(Double.toString(t_Premium));
			trans_details_values.put("Total Premium", Double.parseDouble(t_p_expected));
			
			String t_p_actual = Double.toString(transactionDetails_Premium_Values.get(sectionName).get("Total Premium"));
			
			common.transaction_Details_Premium_Values.put(sectionName, trans_details_values);
			
			double premium_diff = Double.parseDouble(t_p_expected) - Double.parseDouble(t_p_actual);
			
			if(premium_diff<0.05 && premium_diff>-0.05){
				TestUtil.reportStatus("Total Premium [<b> "+t_p_expected+" </b>] matches with actual total premium [<b> "+t_p_actual+" </b>]as expected for "+sectionName+" in Transaction Details table .", "Pass", false);
				//customAssert.assertTrue(WriteDataToXl(TestBase.product+"_"+TestBase.businessEvent, "Premium Summary", testName, "PS_"+code+"_TotalPremium", p_expected,common.NB_excel_data_map),"Error while writing Total Premium for cover "+code+" to excel .");
				return 0;
			}else{
				TestUtil.reportStatus("<p style='color:red'> Mismatch in Expected Premium [<b> "+t_p_expected+"</b>] and Actual Premium [<b> "+t_p_actual+"</b>] for "+sectionName+" in Transaction Details table . </p>", "Fail", true);
				//customAssert.assertTrue(WriteDataToXl(TestBase.product+"_"+TestBase.businessEvent, "Premium Summary", testName, "PS_"+code+"_TotalPremium", p_expected,common.NB_excel_data_map),"Error while writing Total Premium for cover "+code+" to excel .");
				return 1;
			}
			
		}else{
			String t_NetNetP_expected = common.roundedOff(Double.toString(final_trans_NNP));
			String t_NetNetP_actual = Double.toString(transactionDetails_Premium_Values.get(sectionName).get("Net Net Premium"));
			CommonFunction.compareValues(Double.parseDouble(t_NetNetP_expected),Double.parseDouble(t_NetNetP_actual)," Net Net Premium");
			trans_details_values.put("Net Net Premium", Double.parseDouble(t_NetNetP_expected));
			
			double t_pen_comm = (( Double.parseDouble(t_NetNetP_expected) / (1-((Double.parseDouble((String)map_data.get("PS_"+code+"_PenComm_rate")) + Double.parseDouble((String)map_data.get("PS_"+code+"_BrokerComm_rate")))/100)))*((Double.parseDouble((String)map_data.get("PS_"+code+"_PenComm_rate"))/100)));
			String t_pc_expected = common.roundedOff(Double.toString(t_pen_comm));
			String t_pc_actual = Double.toString(transactionDetails_Premium_Values.get(sectionName).get("Pen Comm"));
			CommonFunction.compareValues(Double.parseDouble(t_pc_expected),Double.parseDouble(t_pc_actual)," Pen Commission");
			trans_details_values.put("Pen Comm", Double.parseDouble(t_pc_expected));
			
			
			double t_netP = Double.parseDouble(t_pc_expected) + Double.parseDouble(t_NetNetP_expected);
			String t_netP_expected = common.roundedOff(Double.toString(t_netP));
			String t_netP_actual = Double.toString(transactionDetails_Premium_Values.get(sectionName).get("Net Premium"));
			CommonFunction.compareValues(Double.parseDouble(t_netP_expected),Double.parseDouble(t_netP_actual),"Net Premium");
			trans_details_values.put("Net Premium", Double.parseDouble(t_netP_expected));
			
			
			double t_broker_comm = ((Double.parseDouble(t_NetNetP_expected) / (1-((Double.parseDouble((String)map_data.get("PS_"+code+"_PenComm_rate")) + Double.parseDouble((String)map_data.get("PS_"+code+"_BrokerComm_rate")))/100)))*((Double.parseDouble((String)map_data.get("PS_"+code+"_BrokerComm_rate"))/100)));
			String t_bc_expected = common.roundedOff(Double.toString(t_broker_comm));
			String t_bc_actual =  Double.toString(transactionDetails_Premium_Values.get(sectionName).get("Broker Commission"));
			CommonFunction.compareValues(Double.parseDouble(t_bc_expected),Double.parseDouble(t_bc_actual),"Broker Commission");
			trans_details_values.put("Broker Commission", Double.parseDouble(t_bc_expected));
			
			
			double t_grossP = Double.parseDouble(t_netP_expected) + Double.parseDouble(t_bc_expected);
			String t_grossP_actual = Double.toString(transactionDetails_Premium_Values.get(sectionName).get("Gross Premium"));
			CommonFunction.compareValues(t_grossP,Double.parseDouble(t_grossP_actual)," Gross Premium");
			trans_details_values.put("Gross Premium", t_grossP);
			
			String Nb_Status = (String)common.MTA_excel_data_map.get("MTA_Status");
			if(Nb_Status.contains("Endorsement Rewind")){
				if(!sectionName.contains("Terrorism")){
						rewindMTADoc_Premium  =  Double.parseDouble(t_grossP_actual);
				}else{
						rewindMTADoc_TerP  = Double.parseDouble(t_grossP_actual);
				}
			}
			
			if(!sectionName.contains("Terrorism")){
					AdditionalExcTerrDocAct = AdditionalExcTerrDocAct + Double.parseDouble(t_grossP_actual);
				}else{
					AdditionalTerPDocAct = Double.parseDouble(t_grossP_actual);
			}
			
			double t_InsuranceTax = 0.0;
			if(((String)common.MTA_excel_data_map.get("PS_TaxExempt")).equalsIgnoreCase("Yes") || ((String)common.MTA_excel_data_map.get("PS_InsuranceTaxButton")).equalsIgnoreCase("Yes")){
				t_InsuranceTax = (t_grossP * 0.0)/100.0;
			}else{
				t_InsuranceTax = (t_grossP * Double.parseDouble((String)common.MTA_excel_data_map.get("PS_"+code+"_IPT")))/100.0;
			}
			
			t_InsuranceTax = Double.parseDouble(common.roundedOff(Double.toString(t_InsuranceTax)));
			String t_InsuranceTax_actual = Double.toString(transactionDetails_Premium_Values.get(sectionName).get("Insurance Tax"));
			CommonFunction.compareValues(t_InsuranceTax,Double.parseDouble(t_InsuranceTax_actual),"Insurance Tax");
			trans_details_values.put("Insurance Tax", t_InsuranceTax);
			
			if(sectionName.contains("Terrorism")){
				if(Nb_Status.contains("Endorsement Rewind")){
					rewindMTADoc_AddTaxTer  = Double.parseDouble(t_InsuranceTax_actual);
				}
				
				AddTaxTerrDoc = Double.parseDouble(t_InsuranceTax_actual);
						
			}
			
			AdditionalInsTaxDocAct = AdditionalInsTaxDocAct + Double.parseDouble(t_InsuranceTax_actual);
			
			//SPI  Transaction Total Premium verification : 
			double t_Premium = t_grossP + t_InsuranceTax;
			String t_p_expected = common.roundedOff(Double.toString(t_Premium));
			trans_details_values.put("Total Premium", Double.parseDouble(t_p_expected));
			
			String t_p_actual = Double.toString(transactionDetails_Premium_Values.get(sectionName).get("Total Premium"));
			
			common.transaction_Details_Premium_Values.put(sectionName, trans_details_values);
			
			double premium_diff = Double.parseDouble(t_p_expected) - Double.parseDouble(t_p_actual);
			
			if(premium_diff<0.05 && premium_diff>-0.05){
				TestUtil.reportStatus("Total Premium [<b> "+t_p_expected+" </b>] matches with actual total premium [<b> "+t_p_actual+" </b>]as expected for "+sectionName+" in Transaction Details table .", "Pass", false);
				//customAssert.assertTrue(WriteDataToXl(TestBase.product+"_"+TestBase.businessEvent, "Premium Summary", testName, "PS_"+code+"_TotalPremium", p_expected,common.NB_excel_data_map),"Error while writing Total Premium for cover "+code+" to excel .");
				return 0;
			}else{
				TestUtil.reportStatus("<p style='color:red'> Mismatch in Expected Premium [<b> "+t_p_expected+"</b>] and Actual Premium [<b> "+t_p_actual+"</b>] for "+sectionName+" in Transaction Details table . </p>", "Fail", true);
				//customAssert.assertTrue(WriteDataToXl(TestBase.product+"_"+TestBase.businessEvent, "Premium Summary", testName, "PS_"+code+"_TotalPremium", p_expected,common.NB_excel_data_map),"Error while writing Total Premium for cover "+code+" to excel .");
				return 1;
			}
			
		}
		
			
}catch(Throwable t) {
    String methodName = new Object(){}.getClass().getEnclosingMethod().getName();
    TestUtil.reportFunctionFailed("Failed in "+methodName+" function");
    Assert.fail("Transaction Details table verification issue.  \n", t);
    return 1;
}

	
}

public int func_FP_Entries_Transaction_Details_Verification_MTA(String sectionName,Map<String, List<Map<String, String>>> internal_data_map){

	Map<Object,Object> map_data = common.MTA_excel_data_map;
	Map<Object,Object> NB_map_data = common.NB_excel_data_map;
	Map<Object, Object> data_map = null;
	
	
	double final_fp_NNP=0.0;
	String code=null,cover_code=null;
	String flat_section=null;
	
	Map<String,Double> fp_details_values = new HashMap<>();
	
	switch (TestBase.businessEvent) {
	case "Renewal":
		data_map = common.Renewal_excel_data_map;
		break;
	case "MTA":
		data_map = common.NB_excel_data_map;
		break;
	default:
		break;
	}
	
	
	
		
	switch(sectionName){
	
	case "Employers Liability":
		code = "EmployersLiability";
		cover_code = "EmployersLiability";
		flat_section = sectionName;
		break;
	case "Public & Products Liability":
		code = "Public&ProductsLiability";
		cover_code = "Public&ProductsLiability";
		flat_section = sectionName;
		break;
	case "Annual Works":
		code = "AnnualWorks";
		cover_code = "AnnualWorks";
		flat_section = sectionName;
		break;
	case "Own Plant":
		code = "OwnPlant";
		cover_code = "OwnPlant";
		flat_section = sectionName;
		break;
	case "Hired In Plant":
		code = "HiredInPlant";
		cover_code = "HiredInPlant";
		flat_section = sectionName;
		break;
	case "Abbey Legal Expenses":
		code = "LegalExpenses";
		cover_code = "LegalExpenses";
		flat_section = sectionName;
		break;
	case "JCT 6.5.1":
		code = "JCT6.5.1";
		cover_code = "JCT6.5.1";
		flat_section = sectionName;
		break;
	case "Property Owners Liability":
		code = "PropertyOwnersLiability";
		cover_code = "PropertyOwnersLiability";
		flat_section = sectionName;
		break;
	case "Terrorism":
		code = "Terrorism";
		cover_code = "Terrorism";
		flat_section = sectionName;
		break;
	case "Third Party Motor Liability":
		code = "ThirdPartyMotorLiability";
		cover_code = "ThirdPartyMotorLiability";
		flat_section = sectionName;
		break;
	case "Combined Liability":
		code = "CombinedLiability";
		cover_code = "CombinedLiability";
		flat_section = sectionName;
		break;	
		
		
	default:
			System.out.println("**Cover Name is not in Scope for POF**");
		break;
	
	}
	
try{
		
			TestUtil.reportStatus("---------------"+sectionName+" in Flat Premium Section-----------------","Info",false);
		
			//final_fp_NNP = Double.parseDouble(internal_data_map.get("Flat-Premiums").get(count-1).get("FP_Premium"));
		
			//final_fp_NNP = common.transaction_Details_Premium_Values.get(sectionName+"_FP").get("Net Net Premium");
			final_fp_NNP = (Double)map_data.get(flat_section+"_FP");
		
			String t_NetNetP_expected = common.roundedOff(Double.toString(final_fp_NNP));
			String t_NetNetP_actual = Double.toString(common_VELA.transaction_Details_Premium_Values.get(flat_section+"_FP").get("Net Net Premium"));
			CommonFunction.compareValues(Double.parseDouble(t_NetNetP_expected),Double.parseDouble(t_NetNetP_actual)," Net Net Premium");
			//fp_details_values.put("Net Net Premium", Double.parseDouble(t_NetNetP_expected));
			
			double t_pen_comm = (( Double.parseDouble(t_NetNetP_expected) / (1-((Double.parseDouble((String)map_data.get("PS_"+code+"_PenComm_rate")) + Double.parseDouble((String)map_data.get("PS_"+code+"_BrokerComm_rate")))/100)))*((Double.parseDouble((String)map_data.get("PS_"+code+"_PenComm_rate"))/100)));
			String t_pc_expected = common.roundedOff(Double.toString(t_pen_comm));
			String t_pc_actual = Double.toString(common_VELA.transaction_Details_Premium_Values.get(flat_section+"_FP").get("Pen Comm"));
			CommonFunction.compareValues(Double.parseDouble(t_pc_expected),Double.parseDouble(t_pc_actual)," Pen Commission");
			//fp_details_values.put("Pen Comm", Double.parseDouble(t_pc_expected));
			
			
			double t_netP = Double.parseDouble(t_pc_expected) + Double.parseDouble(t_NetNetP_expected);
			String t_netP_expected = common.roundedOff(Double.toString(t_netP));
			String t_netP_actual = Double.toString(common_VELA.transaction_Details_Premium_Values.get(flat_section+"_FP").get("Net Premium"));
			CommonFunction.compareValues(Double.parseDouble(t_netP_expected),Double.parseDouble(t_netP_actual),"Net Premium");
			//fp_details_values.put("Net Premium", Double.parseDouble(t_netP_expected));
			
			
			double t_broker_comm = ((Double.parseDouble(t_NetNetP_expected) / (1-((Double.parseDouble((String)map_data.get("PS_"+code+"_PenComm_rate")) + Double.parseDouble((String)map_data.get("PS_"+code+"_BrokerComm_rate")))/100)))*((Double.parseDouble((String)map_data.get("PS_"+code+"_BrokerComm_rate"))/100)));
			String t_bc_expected = common.roundedOff(Double.toString(t_broker_comm));
			String t_bc_actual =  Double.toString(common_VELA.transaction_Details_Premium_Values.get(flat_section+"_FP").get("Broker Commission"));
			CommonFunction.compareValues(Double.parseDouble(t_bc_expected),Double.parseDouble(t_bc_actual),"Broker Commission");
			//fp_details_values.put("Broker Commission", Double.parseDouble(t_bc_expected));
			
			
			double t_grossP = Double.parseDouble(t_netP_expected) + Double.parseDouble(t_bc_expected);
			String t_grossP_actual = Double.toString(common_VELA.transaction_Details_Premium_Values.get(flat_section+"_FP").get("Gross Premium"));
			CommonFunction.compareValues(t_grossP,Double.parseDouble(t_grossP_actual)," Gross Premium");
			//fp_details_values.put("Gross Premium", t_grossP);
			
			
			double t_InsuranceTax = (t_grossP * common_VELA.transaction_Details_Premium_Values.get(flat_section+"_FP").get("Insurance Tax Rate"))/100.0;
			
			t_InsuranceTax = Double.parseDouble(common.roundedOff(Double.toString(t_InsuranceTax)));
			String t_InsuranceTax_actual = Double.toString(common_VELA.transaction_Details_Premium_Values.get(flat_section+"_FP").get("Insurance Tax"));
			//fp_details_values.put("Insurance Tax", t_InsuranceTax);
			
			//SPI  Transaction Total Premium verification : 
			double t_Premium = t_grossP + t_InsuranceTax;
			String t_p_expected = common.roundedOff(Double.toString(t_Premium));
			//fp_details_values.put("Total Premium", Double.parseDouble(t_p_expected));
			
			String t_p_actual = Double.toString(common_VELA.transaction_Details_Premium_Values.get(flat_section+"_FP").get("Total Premium"));
			
			//common.transaction_Details_Premium_Values.put(sectionName+"_FP", fp_details_values);
			
			// Add Flat premium values  to the MTA premium values to verify on documents :
			
			String sCover = null;
			
			if(sectionName.contains("Property Owners Liabilities")){
				sCover = "Liabilities - POL";
			}else if(sectionName.contains("Employers Liabilities")){
				sCover = "Liabilities - EL";
			}else{
				sCover = sectionName;
			}
						
			if(FP_Covers.contains(sCover) ){
				if(!sectionName.contains("Terrorism")){
					AdditionalExcTerrDocAct  = AdditionalExcTerrDocAct  + Double.parseDouble(t_grossP_actual);
				}else{
					AdditionalTerPDocAct  = AdditionalTerPDocAct  + Double.parseDouble(t_grossP_actual);
				}

				if(sectionName.contains("Terrorism")){
					AddTaxTerrDoc  = AddTaxTerrDoc  + Double.parseDouble(t_InsuranceTax_actual);						
				}
				
				String Nb_Status = (String)map_data.get("MTA_Status");
				if(common_POF.isMTARewindStarted){
					
					String newCover = "";
					if(sectionName.contains("PropertyOwnersLiabilities")){
						newCover = "Liabilities-POL";
					}else if(sectionName.contains("EmployersLiability")) {
						newCover = "Liabilities-EL";
					}else{
						newCover = sectionName;
					}
					
					String s_Cover = (String)map_data.get("CD_Add_"+newCover);
					
					if(sCover.contains("Yes")){
						rewindDoc_InsPTax  = rewindDoc_InsPTax + Double.parseDouble(t_InsuranceTax_actual);
						if(!sectionName.contains("Terrorism")){
							rewindMTADoc_Premium   = rewindMTADoc_Premium  + Double.parseDouble(t_grossP_actual);
						}else{
							rewindMTADoc_TerP   = Double.parseDouble(t_grossP_actual);
						}
					}
					
					
					
				}				
			}
			AdditionalInsTaxDocAct = AdditionalInsTaxDocAct + Double.parseDouble(t_InsuranceTax_actual);
			
			double premium_diff = Double.parseDouble(t_p_expected) - Double.parseDouble(t_p_actual);
			
			if(premium_diff<0.05 && premium_diff>-0.05){
				TestUtil.reportStatus("Total Premium [<b> "+t_p_expected+" </b>] matches with actual total premium [<b> "+t_p_actual+" </b>]as expected for "+sectionName+" in Flat Premium table .", "Pass", false);
				//customAssert.assertTrue(WriteDataToXl(TestBase.product+"_"+TestBase.businessEvent, "Premium Summary", testName, "PS_"+code+"_TotalPremium", p_expected,common.NB_excel_data_map),"Error while writing Total Premium for cover "+code+" to excel .");
				return 0;
			}else{
				TestUtil.reportStatus("<p style='color:red'> Mismatch in Expected Premium [<b> "+t_p_expected+"</b>] and Actual Premium [<b> "+t_p_actual+"</b>] for "+sectionName+" in Flat Premium table . </p>", "Fail", true);
				//customAssert.assertTrue(WriteDataToXl(TestBase.product+"_"+TestBase.businessEvent, "Premium Summary", testName, "PS_"+code+"_TotalPremium", p_expected,common.NB_excel_data_map),"Error while writing Total Premium for cover "+code+" to excel .");
				return 1;
			}
			
	
		
		
		
			
}catch(Throwable t) {
    String methodName = new Object(){}.getClass().getEnclosingMethod().getName();
    TestUtil.reportFunctionFailed("Failed in "+methodName+" function");
    Assert.fail("Transaction Premium verification issue.  \n", t);
    return 1;
}

	
}


/**
 * 
 * This method handles COA Flat Premium screens scripting.
 * 
 */

public boolean func_Flat_Premiums_(Map<Object, Object> map_data,Map<String, List<Map<String, String>>> internal_data_map){
	
	boolean retvalue = true;
	String isFlatPremium=null;
	try{
		isFlatPremium = (String)map_data.get("FP_isFlatPremium");
		if(isFlatPremium.equalsIgnoreCase("Yes"))
			customAssert.assertTrue(common.funcButtonSelection("Flat Premiums"), "Error while clicking on Flat Premiums button .");
		else
			return true;
		
		customAssert.assertTrue(common.funcPageNavigation("Flat Premiums", ""), "Navigation Problem to Flat Premiums page .");
		
		String[] fp_entries = ((String)map_data.get("FP_FlatPremium_Entries")).split(";");
		int no_of_fp_e = fp_entries.length;
		int[] total_fp_e = new int[no_of_fp_e];
		k.ImplicitWaitOff();
		for(int count=1;count<=no_of_fp_e;count++){
			
			customAssert.assertTrue(k.Click("POF_Add_Flat_P_btn"),"Unable to Click Add Flat Premium button . ");
			customAssert.assertTrue(Verify_FP_Section_Values(),"Error while verifying covers list in flat premium section dropdown . ");

			customAssert.assertTrue(k.DropDownSelection("POF_FP_Section", internal_data_map.get("Flat-Premiums").get(count-1).get("FP_Section")),"Unable to enter FP_Section in Flat Premium page .");
			customAssert.assertTrue(k.Input("POF_FP_Premium", internal_data_map.get("Flat-Premiums").get(count-1).get("FP_Premium")),"Unable to enter FP_Premium in Flat Premium page .");
			customAssert.assertTrue(k.Input("POF_FP_TaxRate", internal_data_map.get("Flat-Premiums").get(count-1).get("FP_TaxRate")),"Unable to enter FP_TaxRate in Flat Premium page .");
			customAssert.assertTrue(k.Input("POF_FP_Description", internal_data_map.get("Flat-Premiums").get(count-1).get("FP_Description")),"Unable to enter FP_Description in Flat Premium page .");
			
			customAssert.assertTrue(k.clickInnerButton("Inner_page_locator", "Save"), "Unable to click Inner Save button on Flat Premiums .");
			
			customAssert.assertTrue(get_Flat_Premium_Entries(count), "Error while reading Flat Premium Entries .");
			func_FP_Entries_Verification_MTA(internal_data_map.get("Flat-Premiums").get(count-1).get("FP_Section"),internal_data_map,count);
			
			//For each added entry in FP, cover name will be removed from Section List
			common_VELA.CoversDetails_data_list.remove(internal_data_map.get("Flat-Premiums").get(count-1).get("FP_Section").replaceAll(" ", ""));
		}
				
		driver.findElements(By.xpath("//*[@id='ex-back']")).get(0).click();
	
		TestUtil.reportStatus("Entered and Verified all the details on Flat Premiums page .", "Info", true);
		k.ImplicitWaitOn();
		return retvalue;
		
	}catch(Throwable t) {
        String methodName = new Object(){}.getClass().getEnclosingMethod().getName();
        TestUtil.reportFunctionFailed("Failed in "+methodName+" function");
        Assert.fail("Unable to to do operation on Flat Premium page. \n", t);k.ImplicitWaitOn();
        return false;
 }
}

public boolean get_Flat_Premium_Entries(int row_index){
	
	
	try{
	String testName = (String)common.MTA_excel_data_map.get("Automation Key");
	
	customAssert.assertTrue(common.funcPageNavigation("Flat Premiums", ""),"Flat Premiums page navigations issue(S)");
	
	if(TestBase.businessEvent.equalsIgnoreCase("Renewal")){
		int policy_Duration = Integer.parseInt((String)common.Renewal_excel_data_map.get("PS_Duration"));
	}else{
		int policy_Duration = Integer.parseInt((String)common.NB_excel_data_map.get("PS_Duration"));
	}
	
	
	String FPTble_xpath = "//table[@id='table0']";
	WebElement fp_Table = driver.findElement(By.xpath(FPTble_xpath));
	
	List<WebElement> colms = fp_Table.findElements(By.tagName("th"));
		//Map<SPI,MAP<NNP,12345.67>>
	
	int fp_tble_Rows = fp_Table.findElements(By.tagName("tr")).size();
	int fp_tble_Cols = colms.size();
	
	List<String> sectionNames = new ArrayList<>();
	String sectionName = null;
	String sectionValue = null;
	String headerName = null;
	
		
	if(fp_Table.isDisplayed()){
		
		//For Each Cover Row
		for(int row = row_index; row < fp_tble_Rows ;row ++){
			
			WebElement sec_Name = driver.findElement(By.xpath(FPTble_xpath+"//tbody//tr["+row+"]//td["+1+"]"));
			sectionName = sec_Name.getText();
			
			switch(sectionName){
			
			case "Totals":
				Map<String,Double> fp_Section_Vals_Total = new HashMap<>();
				//For Each Cols
				for(int col = 2; col <= fp_tble_Cols ;col ++){
			
					////p[text()=' Transaction Premium']//following-sibling::table[@id='table0']//thead//th[2]
					WebElement header_Name = driver.findElement(By.xpath(FPTble_xpath+"//thead//th["+col+"]"));
					headerName = header_Name.getText();
				
					if(!headerName.contains("Pen Comm %") && !headerName.contains("Broker Comm %") && !headerName.contains("Gross Comm %")
							&& !headerName.contains("Insurance Tax Rate") ){
						WebElement sec_Val = driver.findElement(By.xpath(FPTble_xpath+"//tbody//tr["+row+"]//td["+col+"]"));
						sectionValue = sec_Val.getText();
						sectionValue = sectionValue.replaceAll(",", "");
						fp_Section_Vals_Total.put(headerName, Double.parseDouble(sectionValue));
						
					}else{
						continue;
					}
					common_VELA.transaction_Details_Premium_Values.put(sectionName, fp_Section_Vals_Total);
			}
			
			break;
			
			default:
				Map<String,Double> fp_Section_Vals = new HashMap<>();
				//For Each Cols
				for(int col = 2; col <= fp_tble_Cols-2 ;col ++){
			
					////p[text()=' Transaction Premium']//following-sibling::table[@id='table0']//thead//th[2]
					WebElement header_Name = driver.findElement(By.xpath(FPTble_xpath+"//thead//th["+col+"]"));
					headerName = header_Name.getText();
					
					if(headerName.equalsIgnoreCase("Pen Commm")){
						headerName = "Pen Comm";
					}
				
					WebElement sec_Val = driver.findElement(By.xpath(FPTble_xpath+"//tbody//tr["+row+"]//td["+col+"]"));
					sectionValue = sec_Val.getText();
				
					fp_Section_Vals.put(headerName, Double.parseDouble(sectionValue));
			}
				common_VELA.transaction_Details_Premium_Values.put(sectionName+"_FP", fp_Section_Vals);
			
			break;
			
			}
			
		}
	
	}

	
}catch(Throwable t){
	
	//System.out.println("Error while reading Flat Premium Entries . ");
	return false;
	
	
}
	
	return true;
	
}

public boolean Verify_FP_Section_Values(){
	
	try{
		 
		int count = 0 , count_datasheet = 0;
		 String coverName = null , coverName_datasheet = null;
		 
		 	List<WebElement> names = driver.findElements(By.tagName("option"));
			List<String> coversNameList = new ArrayList<>();
			String coverName_withoutSpace =null,key=null;
			
			for(int i=0;i<names.size();i++){
				coverName = names.get(i).getText();
					
				coverName_withoutSpace = coverName.replaceAll(" ", "");
				if(coverName.contains("Annual Contract Works")){
					coverName_withoutSpace = "AnnualWorks";
				}
				if(coverName.contains("Single Project Contract Works")){
					coverName_withoutSpace = "SingleProject";
				}
				coversNameList.add(coverName_withoutSpace);
				
				if(common.currentRunningFlow.equalsIgnoreCase("MTA")){
						key = "CD_"+coverName_withoutSpace;
								
						if(common.MTA_excel_data_map.get(key).toString().equalsIgnoreCase("Yes")){
							continue;
						}else{
							if(common.MTA_excel_data_map.get("CD_Add_"+coverName_withoutSpace.replaceAll(" ", "")).toString().equalsIgnoreCase("Yes")){
						
							}else{
								TestUtil.reportStatus("Cover Name <b>  ["+coverName+"]  </b> should not present in the flat fremium section dropdown list as This cover is not selected on Cover Details page.", "FAIL", false);
							count++;
						}
					
					}
					}
				} //For loop
		 
			for(int p=0;p<common_VELA.CoversDetails_data_list.size();p++){
				coverName_datasheet = common_VELA.CoversDetails_data_list.get(p);
				
				if(coversNameList.contains(coverName_datasheet)){
					continue;
				}else{
					TestUtil.reportStatus("Cover Name <b>  ["+coverName_datasheet+"]  </b> is selected as 'NO' in datasheet but still listed in the flat premium section dropdown list.", "FAIL", false);
					count_datasheet++;
				}
			}
		 
		 
	
	}catch(Throwable t){
		return false;
		
	}
	
	return true;	
	
} 


public int func_FP_Entries_Verification_MTA(String sectionName,Map<String, List<Map<String, String>>> internal_data_map,int count){

	Map<Object,Object> map_data = common.MTA_excel_data_map;
	Map<Object,Object> NB_map_data = common.NB_excel_data_map;
	Map<Object, Object> data_map = null;
	
	
	double final_fp_NNP=0.0;
	String code=null,cover_code=null;
	
	Map<String,Double> fp_details_values = new HashMap<>();
	
	switch (TestBase.businessEvent) {
	case "Renewal":
		data_map = common.Renewal_excel_data_map;
		break;
	case "MTA":
		data_map = common.NB_excel_data_map;
		break;
	default:
		break;
	}
	
	
	
		
	switch(sectionName){
	
	case "Employers Liability":
		code = "EmployersLiability";
		cover_code = "EmployersLiability";
		break;
	case "Public & Products Liability":
		code = "Public&ProductsLiability";
		cover_code = "Public&ProductsLiability";
		break;
	case "Annual Works":
		code = "AnnualWorks";
		cover_code = "AnnualWorks";
		break;
	case "Single Project":
		code = "SingleProject";
		cover_code = "SingleProject";
		break;
	case "Own Plant":
		code = "OwnPlant";
		cover_code = "OwnPlant";
		break;
	case "Hired In Plant":
		code = "HiredInPlant";
		cover_code = "HiredInPlant";
		break;
	case "Abbey Legal Expenses":
		code = "LegalExpenses";
		cover_code = "LegalExpenses";
		break;
	case "JCT 6.5.1":
		code = "JCT6.5.1";
		cover_code = "JCT6.5.1";
		break;
	case "Property Owners Liability":
		code = "PropertyOwnersLiability";
		cover_code = "PropertyOwnersLiability";
		break;
	case "Terrorism":
		code = "Terrorism";
		cover_code = "Terrorism";
		break;
	case "Third Party Motor Liability":
		code ="ThirdPartyMotorLiability";
		cover_code ="ThirdPartyMotorLiability";
		break;		
	case "Combined Liability":
	    code ="CombinedLiability";
	    cover_code ="CombinedLiability";
	    break;
	
	default:
			System.out.println("**Cover Name is not in Scope for POF**");
		break;
	
	}
	
try{
		
		//TestUtil.reportStatus("---------------"+sectionName+"-----------------","Info",false);
		
			final_fp_NNP = Double.parseDouble(internal_data_map.get("Flat-Premiums").get(count-1).get("FP_Premium"));
		
			map_data.put(sectionName+"_FP", final_fp_NNP);
		
		
			String t_NetNetP_expected = common.roundedOff(Double.toString(final_fp_NNP));
			String t_NetNetP_actual = Double.toString(common_VELA.transaction_Details_Premium_Values.get(sectionName+"_FP").get("Net Net Premium"));
			CommonFunction.compareValues(Double.parseDouble(t_NetNetP_expected),Double.parseDouble(t_NetNetP_actual)," Net Net Premium");
			fp_details_values.put("Net Net Premium", Double.parseDouble(t_NetNetP_expected));
			
			double t_pen_comm = (( Double.parseDouble(t_NetNetP_expected) / (1-((Double.parseDouble((String)map_data.get("PS_"+code+"_PenComm_rate")) + Double.parseDouble((String)map_data.get("PS_"+code+"_BrokerComm_rate")))/100)))*((Double.parseDouble((String)map_data.get("PS_"+code+"_PenComm_rate"))/100)));
			String t_pc_expected = common.roundedOff(Double.toString(t_pen_comm));
			String t_pc_actual = Double.toString(common_VELA.transaction_Details_Premium_Values.get(sectionName+"_FP").get("Pen Comm"));
			CommonFunction.compareValues(Double.parseDouble(t_pc_expected),Double.parseDouble(t_pc_actual)," Pen Commission");
			fp_details_values.put("Pen Comm", Double.parseDouble(t_pc_expected));
			
			
			double t_netP = Double.parseDouble(t_pc_expected) + Double.parseDouble(t_NetNetP_expected);
			String t_netP_expected = common.roundedOff(Double.toString(t_netP));
			String t_netP_actual = Double.toString(common_VELA.transaction_Details_Premium_Values.get(sectionName+"_FP").get("Net Premium"));
			CommonFunction.compareValues(Double.parseDouble(t_netP_expected),Double.parseDouble(t_netP_actual),"Net Premium");
			fp_details_values.put("Net Premium", Double.parseDouble(t_netP_expected));
			
			
			double t_broker_comm = ((Double.parseDouble(t_NetNetP_expected) / (1-((Double.parseDouble((String)map_data.get("PS_"+code+"_PenComm_rate")) + Double.parseDouble((String)map_data.get("PS_"+code+"_BrokerComm_rate")))/100)))*((Double.parseDouble((String)map_data.get("PS_"+code+"_BrokerComm_rate"))/100)));
			String t_bc_expected = common.roundedOff(Double.toString(t_broker_comm));
			String t_bc_actual =  Double.toString(common_VELA.transaction_Details_Premium_Values.get(sectionName+"_FP").get("Broker Commission"));
			CommonFunction.compareValues(Double.parseDouble(t_bc_expected),Double.parseDouble(t_bc_actual),"Broker Commission");
			fp_details_values.put("Broker Commission", Double.parseDouble(t_bc_expected));
			
			
			double t_grossP = Double.parseDouble(t_netP_expected) + Double.parseDouble(t_bc_expected);
			String t_grossP_actual = Double.toString(common_VELA.transaction_Details_Premium_Values.get(sectionName+"_FP").get("Gross Premium"));
			CommonFunction.compareValues(t_grossP,Double.parseDouble(t_grossP_actual)," Gross Premium");
			fp_details_values.put("Gross Premium", t_grossP);
			
			double t_InsuranceTax = 0.0;
			if(((String)map_data.get("PS_TaxExempt")).equalsIgnoreCase("Yes") || ((String)map_data.get("PS_InsuranceTaxButton")).equalsIgnoreCase("Yes")){
				t_InsuranceTax = (t_grossP * 0.0)/100.0;
				fp_details_values.put("Insurance Tax Rate", Double.parseDouble("0.0"));
				
			}else{
				t_InsuranceTax = (t_grossP * Double.parseDouble(internal_data_map.get("Flat-Premiums").get(count-1).get("FP_TaxRate")))/100.0;
				fp_details_values.put("Insurance Tax Rate", Double.parseDouble(internal_data_map.get("Flat-Premiums").get(count-1).get("FP_TaxRate")));
			}
			
			t_InsuranceTax = Double.parseDouble(common.roundedOff(Double.toString(t_InsuranceTax)));
			String t_InsuranceTax_actual = Double.toString(common_VELA.transaction_Details_Premium_Values.get(sectionName+"_FP").get("Insurance Tax"));
			CommonFunction.compareValues(t_InsuranceTax,Double.parseDouble(t_InsuranceTax_actual),"Insurance Tax");
			fp_details_values.put("Insurance Tax", t_InsuranceTax);
			//SPI  Transaction Total Premium verification : 
			double t_Premium = t_grossP + t_InsuranceTax;
			String t_p_expected = common.roundedOff(Double.toString(t_Premium));
			fp_details_values.put("Total Premium", Double.parseDouble(t_p_expected));
			
			String t_p_actual = Double.toString(common_VELA.transaction_Details_Premium_Values.get(sectionName+"_FP").get("Total Premium"));
			
			common_VELA.transaction_Details_Premium_Values.put(sectionName+"_FP", fp_details_values);
			
				
			double premium_diff = Double.parseDouble(t_p_expected) - Double.parseDouble(t_p_actual);
			
			if(premium_diff<0.05 && premium_diff>-0.05){
				TestUtil.reportStatus("Total Premium [<b> "+t_p_expected+" </b>] matches with actual total premium [<b> "+t_p_actual+" </b>]as expected for "+sectionName+" in Flat Premium table .", "Pass", false);
				//customAssert.assertTrue(WriteDataToXl(TestBase.product+"_"+TestBase.businessEvent, "Premium Summary", testName, "PS_"+code+"_TotalPremium", p_expected,common.NB_excel_data_map),"Error while writing Total Premium for cover "+code+" to excel .");
				return 0;
			}else{
				TestUtil.reportStatus("<p style='color:red'> Mismatch in Expected Premium [<b> "+t_p_expected+"</b>] and Actual Premium [<b> "+t_p_actual+"</b>] for "+sectionName+" in Flat Premium table . </p>", "Fail", true);
				//customAssert.assertTrue(WriteDataToXl(TestBase.product+"_"+TestBase.businessEvent, "Premium Summary", testName, "PS_"+code+"_TotalPremium", p_expected,common.NB_excel_data_map),"Error while writing Total Premium for cover "+code+" to excel .");
				return 1;
			}
			
}catch(Throwable t) {
    String methodName = new Object(){}.getClass().getEnclosingMethod().getName();
    TestUtil.reportFunctionFailed("Failed in "+methodName+" function");
    Assert.fail("Transaction Premium verification issue.  \n", t);
    return 1;
}

	
}



public boolean removeEndorsement(Map<Object, Object> map_data) throws Exception {
	
	Iterator collectiveDataIT = EndorsementCollectiveData.entrySet().iterator();
	while(collectiveDataIT.hasNext()){
		Map.Entry collectiveDataMapValue = (Map.Entry)collectiveDataIT.next();
		String collectiveEndorsementCode = collectiveDataMapValue.getKey().toString();
		
		Iterator individualDataIT = EndorsementCollectiveData.get(collectiveEndorsementCode).entrySet().iterator();
		while(individualDataIT.hasNext()){
			Map.Entry individualDataMapValue = (Map.Entry)individualDataIT.next();
			String individualEndorsementSection = individualDataMapValue.getValue().toString();
		}
	}
	
	
	if(((String)common.MTA_excel_data_map.get("CD_Public&ProductsLiability")).equals("No")){	
	}
	if(((String)common.MTA_excel_data_map.get("CD_EmployersLiability")).equals("No")){	
	}
	if(((String)common.MTA_excel_data_map.get("CD_AnnualWorks")).equals("No")){	
	}
	if(((String)common.MTA_excel_data_map.get("CD_SingleProject")).equals("No")){	
	}
	if(((String)common.MTA_excel_data_map.get("CD_OwnPlant")).equals("No")){	
	}
	if(((String)common.MTA_excel_data_map.get("CD_HiredInPlant")).equals("No")){	
	}
	if(((String)common.MTA_excel_data_map.get("CD_JCT6.5.1")).equals("No")){	
	}
	if(((String)common.MTA_excel_data_map.get("CD_Terrorism")).equals("No")){	
	}
	if(((String)common.MTA_excel_data_map.get("CD_PropertyOwnersLiability")).equals("No")){	
	}
	if(((String)common.MTA_excel_data_map.get("CD_LegalExpenses")).equals("No")){	
	}
	
	
	
	return true;
	
}

// End of CommonFunction_VELA.java


}
